[0m18:34:11.668617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7C9F0E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CAE9F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CABFD310>]}


============================== 18:34:11.673118 | 9d1fc295-d469-4f6b-8d5a-57c30bcdccaa ==============================
[0m18:34:11.673118 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:34:11.673649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'c:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:34:11.764974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1fc295-d469-4f6b-8d5a-57c30bcdccaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CA5CCFC0>]}
[0m18:34:11.790008 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:11.791361 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:11.792423 [debug] [MainThread]: Command `cli deps` succeeded at 18:34:11.792237 after 0.26 seconds
[0m18:34:11.792972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CAF56F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CAF56250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CB105750>]}
[0m18:34:11.793300 [debug] [MainThread]: Flushing usage events
[0m18:34:12.925103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:33.899292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A13AE270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A232F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A2089310>]}


============================== 18:40:33.903893 | c5bad66e-40e9-4d66-8355-c016394cf6a9 ==============================
[0m18:40:33.903893 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:40:33.904852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:34.026476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5bad66e-40e9-4d66-8355-c016394cf6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A1A58FC0>]}
[0m18:40:34.053074 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:40:34.055857 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:40:34.057058 [debug] [MainThread]: Command `cli deps` succeeded at 18:40:34.056840 after 0.33 seconds
[0m18:40:34.057473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A23EAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A23EA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A2595750>]}
[0m18:40:34.057791 [debug] [MainThread]: Flushing usage events
[0m18:40:35.282270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:18.784201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C5BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D547890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D737ED0>]}


============================== 21:10:18.788465 | e8e643e9-6b82-4aac-98f2-fae15335cea0 ==============================
[0m21:10:18.788465 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:10:18.789355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:10:18.946629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5CC710F0>]}
[0m21:10:18.999569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D5F3BD0>]}
[0m21:10:19.002305 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:10:19.261268 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:10:19.356763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:10:19.357131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:10:19.386440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D808850>]}
[0m21:10:19.438084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:10:19.441661 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:10:19.483064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D56F4D0>]}
[0m21:10:19.483781 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m21:10:19.484634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5ED24130>]}
[0m21:10:19.486788 [info ] [MainThread]: 
[0m21:10:19.487443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:19.487983 [info ] [MainThread]: 
[0m21:10:19.488642 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:10:19.492805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:10:19.551890 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:10:19.552244 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:10:19.552476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:19.575128 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:10:19.576513 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:10:19.577212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:10:19.578240 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:10:19.584000 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.584380 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:10:19.584612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:19.585433 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:10:19.586479 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.586720 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:10:19.587092 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:19.587324 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.587519 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:10:19.589632 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:10:19.590315 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:10:19.590554 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.590749 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:10:19.591092 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:19.591337 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:10:19.593402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:10:19.597509 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:10:19.597788 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:10:19.598003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:19.598636 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:19.598944 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:10:19.599221 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:10:19.621588 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m21:10:19.622930 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:10:19.624023 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:10:19.624298 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:10:19.626963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5F0513D0>]}
[0m21:10:19.627422 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.627652 [debug] [MainThread]: On master: BEGIN
[0m21:10:19.627851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:19.628319 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:19.628547 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.628753 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.628932 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.629270 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:19.629510 [debug] [MainThread]: On master: Close
[0m21:10:19.632755 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.633221 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:10:19.634049 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:10:19.634389 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.639499 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.641719 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.669452 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.672073 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.672593 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:10:19.672996 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:10:19.673597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:19.673860 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.674096 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    select *
from main.campaign_interactions
where "platform" = 'google';
  );

[0m21:10:19.676449 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    select *
from main.campaign_interactions
where "platform" = 'google';
  );

[0m21:10:19.676778 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:10:19.677183 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:10:19.779804 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:10:19.780167 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:10:19.783424 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:10:19.786204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5F148350>]}
[0m21:10:19.786822 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.15s]
[0m21:10:19.787819 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.788171 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.789376 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:10:19.788551 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:10:19.790467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:10:19.790752 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.792627 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.794300 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.813068 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.814781 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.815210 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:10:19.815550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:19.816189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:19.816537 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.816872 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:10:19.822068 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:10:19.827327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.827670 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:10:19.829518 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:10:19.841256 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:10:19.841664 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.841935 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:10:19.849758 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:10:19.853930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.854576 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:10:19.855680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:19.857601 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:10:19.858063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5ED43CD0>]}
[0m21:10:19.858549 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m21:10:19.859371 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.860247 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.860636 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:10:19.861223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:10:19.861500 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.863345 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.864206 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.867125 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.868102 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.868463 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:10:19.868742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:19.869293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.869570 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.869803 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:10:19.870460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.873215 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.873579 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:10:19.874262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.875342 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:10:19.875625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.875863 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:10:19.879769 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:10:19.881708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.882250 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:10:19.882897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.885114 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:10:19.886063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5F0EF2F0>]}
[0m21:10:19.886957 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m21:10:19.887836 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.889539 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.890406 [debug] [MainThread]: On master: BEGIN
[0m21:10:19.890961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:10:19.891535 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:10:19.891790 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.892008 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.892197 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.892547 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:19.892770 [debug] [MainThread]: On master: Close
[0m21:10:19.893075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:19.893278 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:10:19.893447 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:10:19.893618 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:10:19.894203 [info ] [MainThread]: 
[0m21:10:19.894705 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:10:19.895684 [debug] [MainThread]: Command end result
[0m21:10:19.912275 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:10:19.914593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:10:19.921230 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:10:19.921602 [info ] [MainThread]: 
[0m21:10:19.922125 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:10:19.922735 [info ] [MainThread]: 
[0m21:10:19.923342 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:10:19.923928 [info ] [MainThread]: 
[0m21:10:19.924490 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:10:19.925442 [debug] [MainThread]: Command `dbt run` failed at 21:10:19.925341 after 1.39 seconds
[0m21:10:19.925735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5EBBFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5EAF76D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D781780>]}
[0m21:10:19.926032 [debug] [MainThread]: Flushing usage events
[0m21:10:21.906169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:10.133132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F65E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C705E7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C707D7ED0>]}


============================== 21:37:10.140383 | 21137d65-a4d9-4345-8671-e2968601f524 ==============================
[0m21:37:10.140383 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:37:10.142598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:37:10.337777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6FD190F0>]}
[0m21:37:10.397426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C70697BD0>]}
[0m21:37:10.400641 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:37:10.572400 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:37:10.697203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:10.697543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:10.734696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C708AA250>]}
[0m21:37:10.805696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:37:10.809919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:37:10.831454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7060F4D0>]}
[0m21:37:10.832065 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:37:10.832590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C71E50830>]}
[0m21:37:10.835792 [info ] [MainThread]: 
[0m21:37:10.836385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:37:10.836828 [info ] [MainThread]: 
[0m21:37:10.837449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:37:10.841947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:37:10.922425 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:37:10.923145 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:37:10.923618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:11.043280 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:37:11.044183 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:37:11.046427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:11.046890 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m21:37:11.047510 [info ] [MainThread]: 
[0m21:37:11.048207 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m21:37:11.049087 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 24092)
[0m21:37:11.050582 [debug] [MainThread]: Command `dbt run` failed at 21:37:11.050394 after 1.09 seconds
[0m21:37:11.051096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C720B0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C70682D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C71E27410>]}
[0m21:37:11.051561 [debug] [MainThread]: Flushing usage events
[0m21:37:13.119503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:33.308052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEE4FA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF477890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF667ED0>]}


============================== 21:38:33.312104 | 58c22afc-2525-4bd1-acd8-4725dced7272 ==============================
[0m21:38:33.312104 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:38:33.312966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:38:33.505103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEEBA10F0>]}
[0m21:38:33.571345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF523BD0>]}
[0m21:38:33.575541 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:38:33.750480 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:38:33.887257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:38:33.887603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:38:33.927754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF73A250>]}
[0m21:38:34.002701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:38:34.005633 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:38:34.026850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF49F4D0>]}
[0m21:38:34.027752 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:38:34.028437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0C4C830>]}
[0m21:38:34.030360 [info ] [MainThread]: 
[0m21:38:34.030984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:34.031580 [info ] [MainThread]: 
[0m21:38:34.032371 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:38:34.037019 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:38:34.112432 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:38:34.112885 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:38:34.113428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:34.235331 [debug] [ThreadPool]: SQL status: OK in 0.122 seconds
[0m21:38:34.237559 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:38:34.238743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:38:34.239636 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:38:34.244802 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.245093 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:38:34.245362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:34.246602 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:38:34.248128 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.248488 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:38:34.248980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:38:34.249274 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.249546 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:38:34.250971 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:38:34.251708 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:38:34.252003 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.252215 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:38:34.252580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:38:34.252801 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:38:34.254050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:38:34.258466 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:38:34.258751 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:38:34.258975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:34.259443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:38:34.259674 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:38:34.259886 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:38:34.280200 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m21:38:34.282028 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:38:34.284358 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:38:34.284641 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:38:34.286912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0EA14A0>]}
[0m21:38:34.287323 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.287561 [debug] [MainThread]: On master: BEGIN
[0m21:38:34.287760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:34.288221 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:38:34.288450 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.288663 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.288862 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.289202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:38:34.289444 [debug] [MainThread]: On master: Close
[0m21:38:34.291719 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.292160 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:38:34.292804 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:38:34.293535 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.301408 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.302309 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.338820 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.340461 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.341252 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:38:34.341617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:38:34.342281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.342618 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.343006 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"
main.campaign_interactions

)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:38:34.346838 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"
main.campaign_interactions

)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:38:34.347168 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:38:34.347536 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:38:34.358756 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:38:34.359267 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:38:34.362948 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near "."
[0m21:38:34.365546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF1034950>]}
[0m21:38:34.366217 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.07s]
[0m21:38:34.367116 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.367617 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.368875 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ".".
[0m21:38:34.368103 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:38:34.370394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:38:34.370729 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.372726 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.374072 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.400842 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.402067 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.402474 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:38:34.402855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:34.403641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.403980 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.404279 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:38:34.408964 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:38:34.417487 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.418070 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:38:34.419940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.423899 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.424399 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:38:34.425149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:34.442822 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:38:34.443911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.444550 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:38:34.452770 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:38:34.458276 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.458755 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:38:34.464406 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:38:34.467154 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:38:34.468269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0E707E0>]}
[0m21:38:34.469358 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m21:38:34.470427 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.471523 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.471985 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:38:34.473178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:38:34.473577 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.475654 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.477193 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.482443 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.484050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.485271 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:38:34.486158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:34.487225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.487726 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.488092 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:38:34.488860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:34.491300 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.491621 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:38:34.493351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.499395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.499847 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:38:34.500627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:34.502455 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:38:34.502858 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.503147 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:38:34.506840 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:38:34.510082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.510728 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:38:34.513881 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:38:34.515607 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:38:34.516393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0B76670>]}
[0m21:38:34.517632 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:38:34.519676 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.521805 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.522156 [debug] [MainThread]: On master: BEGIN
[0m21:38:34.522395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:34.522934 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:38:34.523216 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.523439 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.523661 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.524168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:38:34.524638 [debug] [MainThread]: On master: Close
[0m21:38:34.525158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:34.525480 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:38:34.525706 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:38:34.525918 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:38:34.526273 [info ] [MainThread]: 
[0m21:38:34.526878 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m21:38:34.528414 [debug] [MainThread]: Command end result
[0m21:38:34.555967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:38:34.559231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:38:34.569734 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:38:34.570595 [info ] [MainThread]: 
[0m21:38:34.572131 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:34.573174 [info ] [MainThread]: 
[0m21:38:34.574271 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near "."
[0m21:38:34.575121 [info ] [MainThread]: 
[0m21:38:34.575978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:38:34.577416 [debug] [MainThread]: Command `dbt run` failed at 21:38:34.577211 after 1.57 seconds
[0m21:38:34.578276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0AF3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0A805D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF6B1780>]}
[0m21:38:34.578933 [debug] [MainThread]: Flushing usage events
[0m21:38:36.992320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:42:07.551242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EA9CA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB947890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EBB37ED0>]}


============================== 21:42:07.554931 | c78674d6-9f20-4057-9939-e449667e90c1 ==============================
[0m21:42:07.554931 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:42:07.556133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:42:07.739054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB06D0F0>]}
[0m21:42:07.795163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB9F3BD0>]}
[0m21:42:07.798258 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:42:07.961229 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:42:08.085332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:42:08.085893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:42:08.126852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EBC0A250>]}
[0m21:42:08.200859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:42:08.203511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:42:08.228712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB96F4D0>]}
[0m21:42:08.229355 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:42:08.230049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED10C750>]}
[0m21:42:08.232025 [info ] [MainThread]: 
[0m21:42:08.232670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:42:08.233255 [info ] [MainThread]: 
[0m21:42:08.234084 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:42:08.239403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:42:08.331443 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:42:08.332082 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:42:08.332584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:08.374367 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m21:42:08.375685 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:42:08.376743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:42:08.377354 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:42:08.383152 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.383512 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:42:08.383753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:08.384728 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:42:08.385950 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.386219 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:42:08.386629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:42:08.386870 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.387111 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:42:08.387644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:42:08.388444 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:42:08.388706 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.388933 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:42:08.389304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:42:08.389553 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:42:08.391586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:42:08.396398 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:42:08.396714 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:42:08.396984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:08.397790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:42:08.398033 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:42:08.398257 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:42:08.412772 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:42:08.416286 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:42:08.418038 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:42:08.418524 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:42:08.422832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED371980>]}
[0m21:42:08.423553 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.423982 [debug] [MainThread]: On master: BEGIN
[0m21:42:08.424383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:42:08.425722 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:42:08.427329 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.428096 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.428473 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.429073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:42:08.429438 [debug] [MainThread]: On master: Close
[0m21:42:08.431952 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.432968 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:42:08.434067 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:42:08.434465 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.442804 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.445936 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.480154 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.481558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.482049 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:42:08.482412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:42:08.483134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.483461 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.483759 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:42:08.484392 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:42:08.484718 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:42:08.485088 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:42:08.490891 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:42:08.491253 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:42:08.494395 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:42:08.497041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED504A10>]}
[0m21:42:08.497958 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.06s]
[0m21:42:08.499212 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.499638 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.500839 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:42:08.500070 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:42:08.502618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:42:08.503015 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.505686 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.506690 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.523951 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.525284 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.525930 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:42:08.526337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:08.527040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.527392 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.527726 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:42:08.529035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.536082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.536471 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:42:08.537170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.541509 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.542187 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:42:08.543136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.561243 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:42:08.561710 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.562003 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:42:08.582223 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m21:42:08.586820 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.587274 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:42:08.594539 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:42:08.596733 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:42:08.597217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED33C7E0>]}
[0m21:42:08.597714 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:42:08.598971 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.600208 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.600722 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:42:08.601596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:42:08.602092 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.604418 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.605538 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.608788 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.609611 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.610131 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:42:08.610629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:08.611255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.611584 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.611874 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:42:08.612577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.615040 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.615355 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:42:08.615970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.618057 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.618341 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:42:08.618935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.620680 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:42:08.621147 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.621537 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:42:08.624934 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:42:08.629189 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.629856 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:42:08.633623 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:42:08.635009 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:42:08.635581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED06A670>]}
[0m21:42:08.637867 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m21:42:08.639318 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.641663 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.642458 [debug] [MainThread]: On master: BEGIN
[0m21:42:08.642915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:42:08.643751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:42:08.644128 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.644404 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.644673 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.645129 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:42:08.645437 [debug] [MainThread]: On master: Close
[0m21:42:08.645811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:08.646049 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:42:08.646241 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:42:08.646427 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:42:08.646712 [info ] [MainThread]: 
[0m21:42:08.647433 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:42:08.649299 [debug] [MainThread]: Command end result
[0m21:42:08.668788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:42:08.672510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:42:08.684783 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:42:08.685449 [info ] [MainThread]: 
[0m21:42:08.686566 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:42:08.687819 [info ] [MainThread]: 
[0m21:42:08.689001 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:42:08.690043 [info ] [MainThread]: 
[0m21:42:08.691479 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:42:08.693417 [debug] [MainThread]: Command `dbt run` failed at 21:42:08.693179 after 1.44 seconds
[0m21:42:08.694046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ECFBFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ECF485D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EBB81780>]}
[0m21:42:08.694647 [debug] [MainThread]: Flushing usage events
[0m21:42:10.392032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:13.697402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A73BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A8337890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A8527ED0>]}


============================== 21:43:13.701303 | 7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7 ==============================
[0m21:43:13.701303 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:43:13.702229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:43:13.898708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A7A610F0>]}
[0m21:43:13.992463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A83E3BD0>]}
[0m21:43:13.997193 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:43:14.192644 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:43:14.317073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:14.317445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:14.354420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A85F6250>]}
[0m21:43:14.436432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:43:14.439104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:43:14.461808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A835F4D0>]}
[0m21:43:14.462587 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:43:14.463313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9AF8750>]}
[0m21:43:14.465125 [info ] [MainThread]: 
[0m21:43:14.465923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:14.466485 [info ] [MainThread]: 
[0m21:43:14.467239 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:43:14.471857 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:43:14.546887 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:43:14.547327 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:43:14.547638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:14.585671 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m21:43:14.587968 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:43:14.589332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:43:14.589891 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:43:14.596363 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.596708 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:43:14.596961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:14.597845 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:14.599083 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.599352 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:43:14.599821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:14.600092 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.600333 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:43:14.600820 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:14.601590 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:43:14.601851 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.602055 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:43:14.602421 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:14.602703 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:43:14.604844 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:43:14.610621 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:43:14.611275 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:43:14.611804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:14.612759 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:14.613188 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:43:14.613535 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:43:14.633440 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m21:43:14.635668 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:43:14.636770 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:43:14.637114 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:43:14.639829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9D61980>]}
[0m21:43:14.640271 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.640539 [debug] [MainThread]: On master: BEGIN
[0m21:43:14.640766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:14.641259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:14.641522 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.641739 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.641958 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.642398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:14.642710 [debug] [MainThread]: On master: Close
[0m21:43:14.646042 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.646531 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:43:14.647391 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:43:14.647867 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.655409 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.656606 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.689898 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.691146 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.692054 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:43:14.692852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:43:14.693572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.693879 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.694188 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:43:14.694842 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:43:14.695144 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:43:14.695504 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:43:14.701448 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:43:14.701784 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:43:14.704766 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:43:14.707373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9EF4A10>]}
[0m21:43:14.708209 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.06s]
[0m21:43:14.709611 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.710037 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.711132 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:43:14.710494 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:43:14.712643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:43:14.713048 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.715045 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.715868 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.736266 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.737426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.738056 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:43:14.738528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:14.739217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.739594 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.739927 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:43:14.740988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.749452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.750021 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:43:14.750698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.753783 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.754106 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:43:14.754708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.771117 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:43:14.771687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.771969 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:43:14.793386 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m21:43:14.798766 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.799764 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:43:14.807658 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:43:14.810579 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:43:14.811147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9D2C7E0>]}
[0m21:43:14.811666 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m21:43:14.812948 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.814163 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.814760 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:43:14.815624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:43:14.816083 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.818141 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.818954 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.822063 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.822912 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.823315 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:43:14.823714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:14.824673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.825379 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.826040 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:43:14.826976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.830104 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.830647 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:43:14.831725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.836426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.836810 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:43:14.837517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.838923 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:43:14.839238 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.839503 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:43:14.843793 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:43:14.848941 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.849687 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:43:14.853583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:43:14.855086 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:43:14.855568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9A5A670>]}
[0m21:43:14.856081 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:43:14.857488 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.859571 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.859991 [debug] [MainThread]: On master: BEGIN
[0m21:43:14.860346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:14.861241 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:43:14.862159 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.862927 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.863315 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.863902 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:14.864233 [debug] [MainThread]: On master: Close
[0m21:43:14.864620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:14.864873 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:43:14.865079 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:43:14.865259 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:43:14.865555 [info ] [MainThread]: 
[0m21:43:14.866725 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m21:43:14.868534 [debug] [MainThread]: Command end result
[0m21:43:14.888239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:43:14.891769 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:43:14.940782 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:43:14.941544 [info ] [MainThread]: 
[0m21:43:14.955060 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:43:14.956085 [info ] [MainThread]: 
[0m21:43:14.957046 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:43:14.957813 [info ] [MainThread]: 
[0m21:43:14.958741 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:43:14.960210 [debug] [MainThread]: Command `dbt run` failed at 21:43:14.959919 after 1.46 seconds
[0m21:43:14.960914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A99B3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A99385D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A8571780>]}
[0m21:43:14.961385 [debug] [MainThread]: Flushing usage events
[0m21:43:16.273021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:30.111511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C3F8AA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40827890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40A17ED0>]}


============================== 21:45:30.115515 | 616ded49-5581-48a7-b711-0961340c6650 ==============================
[0m21:45:30.115515 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:45:30.116400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:30.296424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C3FF590F0>]}
[0m21:45:30.353631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C408D7BD0>]}
[0m21:45:30.356639 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:45:30.520783 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:45:30.642208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:45:30.642749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:45:30.682003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40AEA350>]}
[0m21:45:30.751946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:45:30.755292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:45:30.776178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C4084F4D0>]}
[0m21:45:30.776722 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:45:30.777473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41FF8750>]}
[0m21:45:30.779639 [info ] [MainThread]: 
[0m21:45:30.780421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:30.781031 [info ] [MainThread]: 
[0m21:45:30.781913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:45:30.786690 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:45:30.872328 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:45:30.873056 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:45:30.873445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:30.896381 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:45:30.897745 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:45:30.898717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:45:30.899138 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:45:30.904514 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.904795 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:45:30.905030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:30.905892 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:45:30.907011 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.907283 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:45:30.907905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:45:30.908347 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.908663 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:45:30.909153 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:45:30.909904 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:45:30.910139 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.910360 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:45:30.910725 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:45:30.911003 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:45:30.912931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:45:30.917306 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:45:30.917604 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:45:30.917845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:30.918493 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:45:30.918961 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:45:30.919316 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:45:30.932296 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:45:30.933845 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:45:30.934861 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:45:30.935204 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:45:30.937913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C422558B0>]}
[0m21:45:30.938333 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:30.938593 [debug] [MainThread]: On master: BEGIN
[0m21:45:30.938814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:30.939454 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:45:30.939721 [debug] [MainThread]: On master: COMMIT
[0m21:45:30.939971 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:30.940179 [debug] [MainThread]: On master: COMMIT
[0m21:45:30.940568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:45:30.940839 [debug] [MainThread]: On master: Close
[0m21:45:30.943726 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:45:30.944261 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:45:30.945271 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:45:30.945856 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:45:30.952205 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.953186 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:45:30.996676 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.997693 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.998080 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:45:30.998395 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:45:30.999127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:30.999462 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.999931 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:45:31.002578 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:45:31.003318 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:45:31.003820 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:45:31.013382 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:45:31.014185 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:45:31.020037 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:45:31.023166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C423E4950>]}
[0m21:45:31.023971 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.08s]
[0m21:45:31.025137 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:45:31.025782 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.027102 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:45:31.026302 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:45:31.028604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:45:31.028967 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.031032 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.031870 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.054123 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.055865 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.056379 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:45:31.056767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:31.057429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:31.057756 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.058071 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:45:31.059207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:31.064622 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.065559 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:45:31.066414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.069762 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.070309 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:45:31.071098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.091085 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:45:31.091597 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.091956 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:45:31.098360 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:45:31.103356 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.103716 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:45:31.108582 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:45:31.110755 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:45:31.111280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C422207E0>]}
[0m21:45:31.111791 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m21:45:31.112998 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.114224 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.114895 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:45:31.115862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:45:31.116310 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.119316 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.120499 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.123808 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.124646 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.125051 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:45:31.125383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:31.126052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:31.126360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.126657 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:45:31.127352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.129756 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.130061 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:45:31.130631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.132873 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.133320 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:45:31.133976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.136371 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:45:31.136895 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.137369 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:45:31.140958 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:45:31.143675 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.144102 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:45:31.147331 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:45:31.148705 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:45:31.149205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41F26670>]}
[0m21:45:31.149757 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m21:45:31.150786 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.152965 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:31.153451 [debug] [MainThread]: On master: BEGIN
[0m21:45:31.154065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:31.155248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:45:31.155924 [debug] [MainThread]: On master: COMMIT
[0m21:45:31.156479 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:31.156895 [debug] [MainThread]: On master: COMMIT
[0m21:45:31.157511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:45:31.157810 [debug] [MainThread]: On master: Close
[0m21:45:31.158202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:31.158475 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:45:31.158688 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:45:31.158895 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:45:31.159194 [info ] [MainThread]: 
[0m21:45:31.160015 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:45:31.161728 [debug] [MainThread]: Command end result
[0m21:45:31.181466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:45:31.183967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:45:31.192731 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:45:31.193362 [info ] [MainThread]: 
[0m21:45:31.194302 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:45:31.195147 [info ] [MainThread]: 
[0m21:45:31.195976 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:45:31.196759 [info ] [MainThread]: 
[0m21:45:31.197542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:45:31.198774 [debug] [MainThread]: Command `dbt run` failed at 21:45:31.198619 after 1.29 seconds
[0m21:45:31.199150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41E9FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41E305D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40A61780>]}
[0m21:45:31.199495 [debug] [MainThread]: Flushing usage events
[0m21:45:32.725844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:13.085097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021301F2A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021302EB7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213030A7ED0>]}


============================== 21:48:13.090431 | 922f0575-482f-48c7-b32d-8a919e4110de ==============================
[0m21:48:13.090431 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:48:13.091605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:13.315279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213025E10F0>]}
[0m21:48:13.376091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021302F67AC0>]}
[0m21:48:13.380509 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:48:13.562862 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:48:13.687141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:13.687658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:13.732823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002130317A350>]}
[0m21:48:13.801976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:48:13.806030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:48:13.856644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021302EDF4D0>]}
[0m21:48:13.857377 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:48:13.858031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213046BC750>]}
[0m21:48:13.860554 [info ] [MainThread]: 
[0m21:48:13.861196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:13.861738 [info ] [MainThread]: 
[0m21:48:13.862452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:48:13.867516 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:48:13.959413 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:48:13.959842 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:48:13.960109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:14.105672 [debug] [ThreadPool]: SQL status: OK in 0.145 seconds
[0m21:48:14.108883 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:48:14.110280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:48:14.111228 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:48:14.123110 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.123871 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:48:14.124317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:14.125924 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:48:14.128215 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.128826 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:48:14.129669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:14.130064 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.130502 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:48:14.132098 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:48:14.133889 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:48:14.134499 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.135242 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:48:14.136086 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:14.136656 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:48:14.139302 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:48:14.149465 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:48:14.150238 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:48:14.151259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:14.153041 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:48:14.154250 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:48:14.155293 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:48:14.189498 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m21:48:14.192796 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:48:14.195699 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:48:14.196464 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:48:14.200627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213049314A0>]}
[0m21:48:14.201470 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.202069 [debug] [MainThread]: On master: BEGIN
[0m21:48:14.202769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:14.203713 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:48:14.204154 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.204502 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.204798 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.205308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:14.205669 [debug] [MainThread]: On master: Close
[0m21:48:14.209737 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.210300 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:48:14.211675 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:48:14.212232 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.224431 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.225976 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.258618 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.260071 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.260470 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:48:14.260830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:14.261527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.261889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.262225 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:48:14.270540 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:48:14.271068 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:48:14.271582 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:48:14.285603 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:48:14.285989 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:48:14.289209 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:48:14.291703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021304AC4950>]}
[0m21:48:14.292384 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.08s]
[0m21:48:14.293543 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.294153 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.296123 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:48:14.294624 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:48:14.297824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:48:14.298230 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.300393 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.301424 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.327256 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.328684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.329196 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:48:14.329530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:14.330186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.330512 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.330804 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:48:14.333887 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:14.339719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.340095 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:48:14.340980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.343615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.344125 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:48:14.345003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:14.362639 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:48:14.363087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.363425 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:48:14.371342 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:48:14.378101 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.378625 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:48:14.383691 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:48:14.386070 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:48:14.386672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213049203C0>]}
[0m21:48:14.387267 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:48:14.388192 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.388981 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.389678 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:48:14.390457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:48:14.390871 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.393893 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.395171 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.398539 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.399564 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.400130 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:48:14.400605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:14.401328 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.401649 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.401956 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:48:14.402644 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:14.405197 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.405779 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:48:14.406907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.411213 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.411673 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:48:14.412470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:14.414122 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:48:14.414475 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.414768 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:48:14.417893 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:14.420167 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.420544 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:48:14.424180 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:14.427384 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:48:14.428336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002130461A5D0>]}
[0m21:48:14.429221 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:48:14.430411 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.431980 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.432343 [debug] [MainThread]: On master: BEGIN
[0m21:48:14.432641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:14.433279 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:48:14.433593 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.433857 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.434100 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.434542 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:14.434810 [debug] [MainThread]: On master: Close
[0m21:48:14.435155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:14.435368 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:48:14.435571 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:48:14.435764 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:48:14.436057 [info ] [MainThread]: 
[0m21:48:14.436655 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m21:48:14.438865 [debug] [MainThread]: Command end result
[0m21:48:14.461475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:48:14.463837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:48:14.471736 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:48:14.472509 [info ] [MainThread]: 
[0m21:48:14.473419 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:48:14.474457 [info ] [MainThread]: 
[0m21:48:14.475233 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:48:14.476459 [info ] [MainThread]: 
[0m21:48:14.477508 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:48:14.478963 [debug] [MainThread]: Command `dbt run` failed at 21:48:14.478735 after 1.69 seconds
[0m21:48:14.479598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213045980D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213045107D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213030F1780>]}
[0m21:48:14.480790 [debug] [MainThread]: Flushing usage events
[0m21:48:15.851073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:03.129613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BF46A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C03F7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C05E7ED0>]}


============================== 21:50:03.134499 | a35da4c1-35cb-4f38-956d-c2159769e729 ==============================
[0m21:50:03.134499 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:50:03.136512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:03.360654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BFB210F0>]}
[0m21:50:03.434509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C04A3AC0>]}
[0m21:50:03.439293 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:50:03.658686 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:50:03.787768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:03.788319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:03.834453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C06B6250>]}
[0m21:50:03.940249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:50:03.943014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:50:03.965985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C041F4D0>]}
[0m21:50:03.966763 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:50:03.967457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1BB8750>]}
[0m21:50:03.970168 [info ] [MainThread]: 
[0m21:50:03.970811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:03.971423 [info ] [MainThread]: 
[0m21:50:03.972318 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:50:03.982907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:50:04.067380 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:50:04.067801 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:50:04.068095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:04.112753 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m21:50:04.114496 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:50:04.115887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:50:04.116555 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:50:04.125681 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.126139 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:50:04.126421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:04.127389 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:04.128785 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.129092 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:50:04.129532 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:04.129793 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.130079 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:50:04.130665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:04.131681 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:50:04.132005 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.132266 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:50:04.132699 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:04.133060 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:50:04.137680 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:50:04.143465 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:50:04.143865 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:50:04.144119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:04.144658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:04.144948 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:50:04.145222 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:50:04.159642 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:50:04.161260 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:50:04.162372 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:50:04.162705 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:50:04.166158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1E21570>]}
[0m21:50:04.166817 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.167111 [debug] [MainThread]: On master: BEGIN
[0m21:50:04.167355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:04.167900 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:04.168156 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.168467 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.169034 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.169600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:04.169917 [debug] [MainThread]: On master: Close
[0m21:50:04.173025 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.173566 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:50:04.174366 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:50:04.174857 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.183223 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.186474 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.218213 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.219864 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.220533 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:50:04.221214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:04.221884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.222224 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.222511 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:50:04.223129 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:50:04.223408 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:50:04.223759 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:50:04.229902 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:50:04.230252 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:50:04.233364 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:50:04.235950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1FB4A10>]}
[0m21:50:04.236812 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.06s]
[0m21:50:04.238216 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.238830 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.240275 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:50:04.239491 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:50:04.241995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:50:04.242440 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.244646 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.246493 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.278306 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.279833 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.280392 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:50:04.280776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:04.281461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.281809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.282179 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:50:04.283256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.292451 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.292869 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:50:04.293642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.296650 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.297012 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:50:04.297665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.313944 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:50:04.314358 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.314638 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:50:04.322403 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:50:04.327102 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.327460 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:50:04.332871 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:50:04.335241 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:50:04.335901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1E103C0>]}
[0m21:50:04.337020 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:50:04.339093 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.340841 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.341391 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:50:04.342403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:50:04.342840 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.345613 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.346890 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.353347 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.356018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.356812 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:50:04.357184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:04.357895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.358249 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.358555 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:50:04.359307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.361851 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.362181 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:50:04.362768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.365068 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.365359 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:50:04.365927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.367359 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:50:04.367679 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.367945 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:50:04.372261 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:50:04.376709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.377262 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:50:04.380732 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:04.382161 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:50:04.382619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1B065D0>]}
[0m21:50:04.383121 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:50:04.384571 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.388036 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.389063 [debug] [MainThread]: On master: BEGIN
[0m21:50:04.389587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:04.390960 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:04.391331 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.391644 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.391942 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.392444 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:04.392830 [debug] [MainThread]: On master: Close
[0m21:50:04.393295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:04.393559 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:50:04.393872 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:50:04.394228 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:50:04.394821 [info ] [MainThread]: 
[0m21:50:04.395835 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m21:50:04.397680 [debug] [MainThread]: Command end result
[0m21:50:04.422905 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:50:04.427718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:50:04.434064 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:50:04.434616 [info ] [MainThread]: 
[0m21:50:04.436491 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:50:04.437971 [info ] [MainThread]: 
[0m21:50:04.439287 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:50:04.440132 [info ] [MainThread]: 
[0m21:50:04.441949 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:50:04.443775 [debug] [MainThread]: Command `dbt run` failed at 21:50:04.443581 after 1.64 seconds
[0m21:50:04.444253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1A880D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C19F87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C0631780>]}
[0m21:50:04.444639 [debug] [MainThread]: Flushing usage events
[0m21:50:06.953628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:02.985891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77606A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D776FF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7771E7ED0>]}


============================== 21:51:02.990295 | 2ab973f9-00ba-498f-a111-4cea6f43f81b ==============================
[0m21:51:02.990295 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:51:02.991350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:51:03.199693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7767210F0>]}
[0m21:51:03.264908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7770A7AC0>]}
[0m21:51:03.268217 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:51:03.475487 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:51:03.618050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:03.618502 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:03.663962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7772BA250>]}
[0m21:51:03.742571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:51:03.745702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:51:03.768725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77701F4D0>]}
[0m21:51:03.769623 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:51:03.770348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778878750>]}
[0m21:51:03.772319 [info ] [MainThread]: 
[0m21:51:03.773217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:03.773992 [info ] [MainThread]: 
[0m21:51:03.775020 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:51:03.780025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:51:03.868941 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:51:03.869371 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:51:03.869726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:03.917859 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m21:51:03.919265 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:51:03.921251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:51:03.922557 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:51:03.931121 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.931557 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:51:03.931829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:03.932774 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:03.934058 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.934379 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:51:03.934850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:03.935104 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.935350 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:51:03.935836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:03.936870 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:51:03.937194 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.937460 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:51:03.938037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:03.938362 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:51:03.940614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:51:03.945588 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:51:03.945953 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:51:03.946207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:03.946782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:03.947050 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:51:03.947313 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:51:03.962085 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:51:03.963727 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:51:03.964869 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:51:03.965228 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:51:03.969042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778AE1570>]}
[0m21:51:03.969744 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:03.970084 [debug] [MainThread]: On master: BEGIN
[0m21:51:03.970376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:03.971002 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:51:03.971361 [debug] [MainThread]: On master: COMMIT
[0m21:51:03.971706 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:03.971999 [debug] [MainThread]: On master: COMMIT
[0m21:51:03.972497 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:03.972832 [debug] [MainThread]: On master: Close
[0m21:51:03.976242 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:51:03.976884 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:51:03.978711 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:51:03.979243 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:51:03.989522 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:51:03.992222 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:51:04.028944 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.030170 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.030635 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:51:04.031001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:04.031679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.032032 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.032337 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m21:51:04.033320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.038804 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.039191 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */
alter view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" rename to "a_campaign_interactions"
[0m21:51:04.039875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.052198 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: COMMIT
[0m21:51:04.052732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.053053 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: COMMIT
[0m21:51:04.058890 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:04.063510 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.063915 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */
drop view if exists "ae_exam_db"."main"."a_campaign_interactions__dbt_backup" cascade
[0m21:51:04.064611 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.068206 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:51:04.072695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778C74350>]}
[0m21:51:04.073751 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.a_campaign_interactions .................. [[32mOK[0m in 0.09s]
[0m21:51:04.075141 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:51:04.075654 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.076103 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:51:04.077264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:51:04.077688 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.080582 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.082379 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.130561 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.131868 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.132393 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:51:04.132890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:04.133680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.134035 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.134370 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:51:04.135518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.140150 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.140710 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:51:04.142599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.147179 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.147659 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:51:04.148401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.157096 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:51:04.157548 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.158074 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:51:04.162308 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:51:04.165048 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.165413 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:51:04.168283 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:51:04.169664 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:51:04.170217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778ACD180>]}
[0m21:51:04.170769 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:51:04.171996 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.173211 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.173946 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:51:04.175220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:51:04.175823 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.179117 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.180483 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.184429 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.185493 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.185905 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:51:04.186315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:04.187049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.187432 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.187750 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:51:04.188494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.191576 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.191944 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:51:04.192593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.194951 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.195269 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:51:04.195823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.197182 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:51:04.197533 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.197833 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:51:04.201096 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:51:04.205575 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.206309 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:51:04.209834 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:51:04.212231 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:51:04.212923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778CA9810>]}
[0m21:51:04.213626 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:51:04.215159 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.217014 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:04.217399 [debug] [MainThread]: On master: BEGIN
[0m21:51:04.217667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:04.218259 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:51:04.218585 [debug] [MainThread]: On master: COMMIT
[0m21:51:04.218871 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:04.219123 [debug] [MainThread]: On master: COMMIT
[0m21:51:04.219551 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:04.219814 [debug] [MainThread]: On master: Close
[0m21:51:04.220188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:04.220476 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:51:04.220701 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:51:04.220956 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:51:04.221296 [info ] [MainThread]: 
[0m21:51:04.221817 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m21:51:04.223534 [debug] [MainThread]: Command end result
[0m21:51:04.257672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:51:04.262336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:51:04.270044 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:51:04.270673 [info ] [MainThread]: 
[0m21:51:04.271593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:04.272602 [info ] [MainThread]: 
[0m21:51:04.273306 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:51:04.275074 [debug] [MainThread]: Command `dbt run` succeeded at 21:51:04.274792 after 1.48 seconds
[0m21:51:04.276106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7787480D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7786C07D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D777231780>]}
[0m21:51:04.276882 [debug] [MainThread]: Flushing usage events
[0m21:51:06.550865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:32.146548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61A57A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B507890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B6F7ED0>]}


============================== 19:00:32.157229 | 29acc819-19fe-480f-8dc1-2ac8e7327ed3 ==============================
[0m19:00:32.157229 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:00:32.158887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:00:32.688133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61AC310F0>]}
[0m19:00:32.756604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B5B3AC0>]}
[0m19:00:32.802805 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:00:33.326811 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:00:33.478854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:33.479316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:33.486196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ae_exam_project.example
[0m19:00:33.545926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B7C6250>]}
[0m19:00:33.643903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:00:33.680787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:00:33.769344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B52F4D0>]}
[0m19:00:33.770127 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 428 macros
[0m19:00:33.771311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CCCC9F0>]}
[0m19:00:33.774748 [info ] [MainThread]: 
[0m19:00:33.776010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:33.777276 [info ] [MainThread]: 
[0m19:00:33.778765 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:00:33.790743 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:00:38.172896 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:00:38.173511 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:00:38.173940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:38.273264 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m19:00:38.276055 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:00:38.277533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m19:00:38.278295 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m19:00:38.287770 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.288258 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:00:38.288616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:38.290014 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:00:38.292150 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.292718 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m19:00:38.293675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:00:38.294164 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.294581 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m19:00:38.296353 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:00:38.297418 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:00:38.297752 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.298037 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:00:38.298557 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:00:38.298935 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m19:00:38.301727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m19:00:38.309565 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:00:38.310254 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m19:00:38.310726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:38.311764 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:00:38.312208 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:00:38.312578 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:00:38.336660 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:00:38.339308 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m19:00:38.362233 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m19:00:38.362859 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m19:00:38.367401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CF41A50>]}
[0m19:00:38.368239 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.368693 [debug] [MainThread]: On master: BEGIN
[0m19:00:38.369145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:38.369999 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:00:38.370353 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.370730 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.371251 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.371847 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:00:38.372214 [debug] [MainThread]: On master: Close
[0m19:00:38.376349 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.377010 [info ] [Thread-1 (]: 1 of 3 START sql view model main.model_stg_campaign_interactions ............... [RUN]
[0m19:00:38.378948 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:00:38.379558 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.389139 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.391580 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.433879 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.436353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.437166 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:00:38.437569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:38.438286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.438739 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.439110 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    select * from FROM "ae_exam_db"."main"."campaign_interactions"
  );

[0m19:00:38.447689 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    select * from FROM "ae_exam_db"."main"."campaign_interactions"
  );

[0m19:00:38.448078 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:00:38.448504 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: ROLLBACK
[0m19:00:38.706214 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:00:38.707019 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:00:38.711129 [debug] [Thread-1 (]: Runtime Error in model model_stg_campaign_interactions (models\staging\model_stg_campaign_interactions.sql)
  Parser Error: syntax error at or near "FROM"
[0m19:00:38.713972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61D0D0A10>]}
[0m19:00:38.714783 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.model_stg_campaign_interactions ...... [[31mERROR[0m in 0.33s]
[0m19:00:38.716654 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.717098 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.718374 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_stg_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model model_stg_campaign_interactions (models\staging\model_stg_campaign_interactions.sql)
  Parser Error: syntax error at or near "FROM".
[0m19:00:38.717639 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m19:00:38.720254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m19:00:38.720716 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.724162 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.725814 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.756840 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.758674 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.759607 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m19:00:38.760162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:38.761305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.762032 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.762494 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m19:00:38.767599 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:00:38.777183 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.777759 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:00:38.781632 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:00:38.787666 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.788520 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:00:38.789710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.809239 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:00:38.809906 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.810304 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:00:38.818042 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:00:38.822986 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.823371 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m19:00:38.828331 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:00:38.831352 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m19:00:38.832395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CF2C470>]}
[0m19:00:38.833764 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.11s]
[0m19:00:38.835188 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.836446 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.837593 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m19:00:38.839010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m19:00:38.839641 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.843388 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.845112 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.852303 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.854532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.855378 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m19:00:38.855965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:38.856975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.857431 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.857843 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m19:00:38.858750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:00:38.865359 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.866029 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m19:00:38.867678 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.871112 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.871832 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:00:38.873529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.876834 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:00:38.877386 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.877779 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:00:38.881546 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:00:38.885533 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.886517 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m19:00:38.890471 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:00:38.892999 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m19:00:38.893749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CC325D0>]}
[0m19:00:38.894474 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m19:00:38.895952 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.898070 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.898494 [debug] [MainThread]: On master: BEGIN
[0m19:00:38.898845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:38.899751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:00:38.900207 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.900549 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.900824 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.901320 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:00:38.901726 [debug] [MainThread]: On master: Close
[0m19:00:38.902206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:38.902504 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m19:00:38.902749 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m19:00:38.902982 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m19:00:38.903315 [info ] [MainThread]: 
[0m19:00:38.904034 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m19:00:38.905913 [debug] [MainThread]: Command end result
[0m19:00:38.933940 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:00:38.937860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:00:38.951122 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:00:38.952158 [info ] [MainThread]: 
[0m19:00:38.953986 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:00:38.955237 [info ] [MainThread]: 
[0m19:00:38.957084 [error] [MainThread]:   Runtime Error in model model_stg_campaign_interactions (models\staging\model_stg_campaign_interactions.sql)
  Parser Error: syntax error at or near "FROM"
[0m19:00:38.958651 [info ] [MainThread]: 
[0m19:00:38.960088 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m19:00:38.961987 [debug] [MainThread]: Command `dbt run` failed at 19:00:38.961806 after 7.28 seconds
[0m19:00:38.962512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B8C4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B71D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B741780>]}
[0m19:00:38.963015 [debug] [MainThread]: Flushing usage events
[0m19:00:41.052822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:45.173255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43C91A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D8A7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43DA97ED0>]}


============================== 19:02:45.179773 | f5d68e6e-3c06-48f9-a47d-244b872e504e ==============================
[0m19:02:45.179773 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:02:45.181976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:02:45.416607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43CFD10F0>]}
[0m19:02:45.481865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D957AC0>]}
[0m19:02:45.486778 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:02:45.685048 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:02:45.831470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:45.831895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:45.838293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ae_exam_project.example
[0m19:02:45.893008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43DB6A250>]}
[0m19:02:45.980825 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:02:45.983613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:02:46.031326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D8CF4D0>]}
[0m19:02:46.032462 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 428 macros
[0m19:02:46.033620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F0709F0>]}
[0m19:02:46.035981 [info ] [MainThread]: 
[0m19:02:46.036903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:02:46.037814 [info ] [MainThread]: 
[0m19:02:46.038922 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:02:46.048357 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:02:46.150756 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:02:46.151237 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:02:46.151694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:46.199653 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m19:02:46.201326 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:02:46.202374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m19:02:46.203015 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m19:02:46.210406 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.210881 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:02:46.211200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:46.212473 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:02:46.214080 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.214534 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m19:02:46.215090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:02:46.215472 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.215778 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m19:02:46.216365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:02:46.217341 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:02:46.217679 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.217960 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:02:46.218432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:02:46.218746 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m19:02:46.221230 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m19:02:46.227114 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:02:46.227481 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m19:02:46.227804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:46.228567 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:02:46.228935 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:02:46.229228 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:02:46.244616 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m19:02:46.246445 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m19:02:46.247742 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m19:02:46.248116 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m19:02:46.251531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F2D1B20>]}
[0m19:02:46.252048 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.252337 [debug] [MainThread]: On master: BEGIN
[0m19:02:46.252595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:46.253235 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:02:46.253552 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.253908 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.254213 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.254687 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:02:46.255005 [debug] [MainThread]: On master: Close
[0m19:02:46.260280 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.261026 [info ] [Thread-1 (]: 1 of 3 START sql view model main.model_stg_campaign_interactions ............... [RUN]
[0m19:02:46.262719 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:02:46.263765 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.271875 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.273034 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.315530 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.316855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.317461 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:02:46.317908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:02:46.318730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.319175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.319548 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m19:02:46.320609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.327778 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.328276 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:02:46.329187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:02:46.344564 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:02:46.345134 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.345506 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:02:46.350544 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:02:46.355744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.356443 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:02:46.357555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.361632 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:02:46.365827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F460410>]}
[0m19:02:46.366744 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.model_stg_campaign_interactions .......... [[32mOK[0m in 0.10s]
[0m19:02:46.367888 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.368467 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.369069 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m19:02:46.370505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m19:02:46.370924 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.373934 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.375160 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.403961 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.405434 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.406056 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m19:02:46.406543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:46.407349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.407810 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.408191 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m19:02:46.409537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.415400 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.415994 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:02:46.417324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.421580 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.422068 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:02:46.422924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:02:46.434532 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:02:46.435209 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.435661 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:02:46.439694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:02:46.442462 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.442827 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m19:02:46.447098 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:02:46.449057 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m19:02:46.449843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F2BD390>]}
[0m19:02:46.450815 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m19:02:46.452567 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.453896 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.454589 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m19:02:46.455840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m19:02:46.456394 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.459185 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.461736 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.465537 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.467101 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.467797 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m19:02:46.468291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:46.469239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.469711 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.470135 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m19:02:46.471149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.477852 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.478685 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m19:02:46.480503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.484385 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.484890 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:02:46.485857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:02:46.487682 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:02:46.488085 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.488431 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:02:46.491766 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:02:46.496018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.496620 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m19:02:46.500203 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:02:46.503238 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m19:02:46.504176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F4A3070>]}
[0m19:02:46.504933 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m19:02:46.506764 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.509570 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.510590 [debug] [MainThread]: On master: BEGIN
[0m19:02:46.511451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:46.513346 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:02:46.514151 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.514544 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.514845 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.515452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:02:46.515842 [debug] [MainThread]: On master: Close
[0m19:02:46.516370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:46.516713 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m19:02:46.517003 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m19:02:46.517257 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m19:02:46.517630 [info ] [MainThread]: 
[0m19:02:46.518563 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m19:02:46.520301 [debug] [MainThread]: Command end result
[0m19:02:46.550365 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:02:46.554821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:02:46.564562 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:02:46.565448 [info ] [MainThread]: 
[0m19:02:46.566728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:46.567787 [info ] [MainThread]: 
[0m19:02:46.569214 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:02:46.570955 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:46.570742 after 1.71 seconds
[0m19:02:46.571441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43EF69D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D9D8150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43DAE1780>]}
[0m19:02:46.571868 [debug] [MainThread]: Flushing usage events
[0m19:02:46.580591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:45.299993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74044A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7413D7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7415C7ED0>]}


============================== 19:16:45.307877 | 4755ab24-648c-451c-bf87-1ee084e7da3f ==============================
[0m19:16:45.307877 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:16:45.310217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:16:45.685398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B740B010F0>]}
[0m19:16:45.754529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B741483AC0>]}
[0m19:16:45.761114 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:16:46.143553 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:16:46.284721 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m19:16:46.285304 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\staging\my_second_dbt_model.sql
[0m19:16:46.285796 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\staging\my_first_dbt_model.sql
[0m19:16:46.370926 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ae_exam_project.example
[0m19:16:46.388775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B741699E50>]}
[0m19:16:46.472384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:16:46.476710 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:16:46.542694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7413FF4D0>]}
[0m19:16:46.543474 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m19:16:46.544331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742C60F30>]}
[0m19:16:46.547163 [info ] [MainThread]: 
[0m19:16:46.548459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:46.549202 [info ] [MainThread]: 
[0m19:16:46.550202 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:16:46.552689 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:16:46.673713 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:16:46.674233 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:16:46.674662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:46.837747 [debug] [ThreadPool]: SQL status: OK in 0.163 seconds
[0m19:16:46.840004 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:16:46.841204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m19:16:46.842369 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m19:16:46.850636 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.851088 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:16:46.851420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:46.853007 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:16:46.854845 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.855246 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m19:16:46.855938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:16:46.856305 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.856606 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m19:16:46.858374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:16:46.859552 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:16:46.859978 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.860321 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:16:46.860930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:16:46.861396 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m19:16:46.864142 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m19:16:46.871049 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:16:46.871512 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m19:16:46.871850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:46.872549 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:16:46.872883 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:16:46.873213 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:16:46.913470 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m19:16:46.915848 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m19:16:46.919271 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m19:16:46.919769 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m19:16:46.923847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742C13A00>]}
[0m19:16:46.924697 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:46.925165 [debug] [MainThread]: On master: BEGIN
[0m19:16:46.925550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:46.926267 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:16:46.926734 [debug] [MainThread]: On master: COMMIT
[0m19:16:46.927110 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:46.927456 [debug] [MainThread]: On master: COMMIT
[0m19:16:46.928140 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:16:46.928724 [debug] [MainThread]: On master: Close
[0m19:16:46.933908 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:46.935073 [info ] [Thread-1 (]: 1 of 1 START sql view model main.model_stg_campaign_interactions ............... [RUN]
[0m19:16:46.936895 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:16:46.937847 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:46.947385 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:46.950585 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:46.999253 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.001243 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.001822 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:16:47.002488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:47.003581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:16:47.004098 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.004509 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m19:16:47.007079 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:16:47.014952 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.015439 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."main"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:16:47.017440 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:16:47.020370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.020733 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:16:47.021376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:16:47.041114 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:16:47.041774 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.042342 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:16:47.048564 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:16:47.056707 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.057657 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:16:47.062574 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:16:47.065057 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:16:47.067673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74302CF50>]}
[0m19:16:47.068419 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.model_stg_campaign_interactions .......... [[32mOK[0m in 0.13s]
[0m19:16:47.070495 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:47.072735 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:47.073182 [debug] [MainThread]: On master: BEGIN
[0m19:16:47.073491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:47.074175 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:16:47.074878 [debug] [MainThread]: On master: COMMIT
[0m19:16:47.075305 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:47.075608 [debug] [MainThread]: On master: COMMIT
[0m19:16:47.076119 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:16:47.076439 [debug] [MainThread]: On master: Close
[0m19:16:47.076872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:47.077144 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m19:16:47.077383 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m19:16:47.077596 [debug] [MainThread]: Connection 'model.ae_exam_project.model_stg_campaign_interactions' was properly closed.
[0m19:16:47.077872 [info ] [MainThread]: 
[0m19:16:47.078687 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m19:16:47.080166 [debug] [MainThread]: Command end result
[0m19:16:47.115777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:16:47.121173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:16:47.132344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:16:47.132971 [info ] [MainThread]: 
[0m19:16:47.134312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:47.135278 [info ] [MainThread]: 
[0m19:16:47.136135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:16:47.137623 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:47.137451 after 2.10 seconds
[0m19:16:47.138102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742BEFD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742FB6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742FB6D50>]}
[0m19:16:47.138514 [debug] [MainThread]: Flushing usage events
[0m19:16:48.462263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:51.249639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A62F5A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A63EE7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A640D7ED0>]}


============================== 19:19:51.258897 | a37cb77d-3016-4281-8c9a-2b630217eda6 ==============================
[0m19:19:51.258897 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:19:51.260796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:51.575891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A636110F0>]}
[0m19:19:51.649284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A63F97AC0>]}
[0m19:19:51.654934 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:19:51.926069 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:19:52.051889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:52.052312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:52.088088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A641A8A50>]}
[0m19:19:52.154900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:19:52.158641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:19:52.217363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A63F0F4D0>]}
[0m19:19:52.218257 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m19:19:52.219377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A656F4BB0>]}
[0m19:19:52.222815 [info ] [MainThread]: 
[0m19:19:52.223893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:52.224786 [info ] [MainThread]: 
[0m19:19:52.226128 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:19:52.228676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:19:52.399252 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:19:52.399882 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:19:52.400279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:52.522453 [debug] [ThreadPool]: SQL status: OK in 0.122 seconds
[0m19:19:52.524868 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:19:52.526238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m19:19:52.526825 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:19:52.532993 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.533523 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:19:52.533898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:52.535093 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:19:52.536416 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.536714 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:19:52.537191 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:19:52.537474 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.537779 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:19:52.539309 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:19:52.540522 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:19:52.540912 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.541423 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:19:52.548091 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:19:52.548616 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:19:52.550875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m19:19:52.557746 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:19:52.558131 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:19:52.558432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:52.559165 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:19:52.559514 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:19:52.559824 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:19:52.580360 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:19:52.581708 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:19:52.583765 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:19:52.584233 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:19:52.585386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65AD01F0>]}
[0m19:19:52.585928 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.586281 [debug] [MainThread]: On master: BEGIN
[0m19:19:52.586593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:52.587311 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:19:52.587686 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.588010 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.588293 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.588833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:19:52.589228 [debug] [MainThread]: On master: Close
[0m19:19:52.593862 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.594502 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:19:52.595720 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:19:52.596261 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.610312 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.611984 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.660918 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.662166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.662762 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:19:52.663197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:52.664133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:52.664602 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.665002 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m19:19:52.666123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:52.672687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.673095 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:19:52.675228 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:52.689058 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:19:52.689570 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.689997 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:19:52.698111 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:19:52.703086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.703495 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:19:52.704282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:52.706793 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:19:52.709893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A656CB7D0>]}
[0m19:19:52.711268 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.11s]
[0m19:19:52.713420 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.715733 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.716335 [debug] [MainThread]: On master: BEGIN
[0m19:19:52.716798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:52.717762 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:19:52.718266 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.718837 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.719214 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.719928 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:19:52.720350 [debug] [MainThread]: On master: Close
[0m19:19:52.720881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:52.721328 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m19:19:52.721674 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m19:19:52.722006 [debug] [MainThread]: Connection 'model.ae_exam_project.model_stg_campaign_interactions' was properly closed.
[0m19:19:52.722437 [info ] [MainThread]: 
[0m19:19:52.723320 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m19:19:52.725453 [debug] [MainThread]: Command end result
[0m19:19:52.762916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:19:52.766038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:19:52.775800 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:19:52.776668 [info ] [MainThread]: 
[0m19:19:52.777740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:52.778807 [info ] [MainThread]: 
[0m19:19:52.779835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:19:52.781722 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:52.781279 after 1.87 seconds
[0m19:19:52.782667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A656C3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65A1FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65A1D630>]}
[0m19:19:52.783483 [debug] [MainThread]: Flushing usage events
[0m19:19:54.022033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:44.977696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD17C1A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18B97890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18D87ED0>]}


============================== 19:38:44.986197 | 9e4fdc09-2286-40df-8cb0-fb8f1acae517 ==============================
[0m19:38:44.986197 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:38:44.987981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:38:45.436851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD182C10F0>]}
[0m19:38:45.541286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18C47AC0>]}
[0m19:38:45.547773 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:38:45.803979 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:38:45.936709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:38:45.937127 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:38:45.970000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18E58A50>]}
[0m19:38:46.044744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:38:46.049791 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:38:46.113500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18BBF4D0>]}
[0m19:38:46.114343 [info ] [MainThread]: Found 2 models, 2 sources, 429 macros
[0m19:38:46.115333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A394670>]}
[0m19:38:46.118454 [info ] [MainThread]: 
[0m19:38:46.119581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:46.120793 [info ] [MainThread]: 
[0m19:38:46.122130 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:38:46.135360 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:38:46.268492 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:38:46.268993 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:38:46.269396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:46.418535 [debug] [ThreadPool]: SQL status: OK in 0.149 seconds
[0m19:38:46.421859 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:38:46.423040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m19:38:46.423638 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:38:46.429550 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.429889 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:38:46.430150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:46.431396 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:38:46.432837 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.433140 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:38:46.433596 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:38:46.433920 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.434271 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:38:46.435781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:38:46.436694 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:38:46.437015 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.437285 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:38:46.437721 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:38:46.438026 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:38:46.440488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m19:38:46.446632 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:38:46.446966 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:38:46.447272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:46.447837 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:38:46.448178 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:38:46.448502 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:38:46.469379 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:38:46.470873 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:38:46.473106 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:38:46.473484 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:38:46.475337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A52FC70>]}
[0m19:38:46.475838 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.476134 [debug] [MainThread]: On master: BEGIN
[0m19:38:46.476379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:46.476966 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:38:46.477256 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.477569 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.477850 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.478350 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:38:46.478776 [debug] [MainThread]: On master: Close
[0m19:38:46.483635 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.484700 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:38:46.486213 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:38:46.486791 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.495364 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.499232 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.538321 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.540636 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.541425 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:38:46.541845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:38:46.542651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.543162 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.543542 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m19:38:46.544547 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.552187 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.552630 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:38:46.554062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.556960 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.557326 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:38:46.557982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:38:46.570800 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:38:46.571293 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.571608 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:38:46.576753 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:38:46.582103 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.582488 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:38:46.585817 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:38:46.589112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:38:46.592538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A33F4D0>]}
[0m19:38:46.593357 [info ] [Thread-1 (]: 1 of 2 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.10s]
[0m19:38:46.595017 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.595615 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.596204 [info ] [Thread-1 (]: 2 of 2 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m19:38:46.597179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m19:38:46.597664 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.600140 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.601489 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.605089 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.606687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.607545 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m19:38:46.608137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:46.609225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.609748 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.610269 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m19:38:46.612393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.617275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.617791 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m19:38:46.618728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.620475 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:38:46.621035 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.621515 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:38:46.625586 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:38:46.629178 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.629622 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m19:38:46.630364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:38:46.632033 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m19:38:46.632721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A32BC20>]}
[0m19:38:46.633500 [info ] [Thread-1 (]: 2 of 2 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.04s]
[0m19:38:46.635170 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.637782 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.638669 [debug] [MainThread]: On master: BEGIN
[0m19:38:46.639354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:38:46.640645 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:38:46.641650 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.642382 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.642924 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.643651 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:38:46.644022 [debug] [MainThread]: On master: Close
[0m19:38:46.644463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:46.644750 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m19:38:46.644987 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m19:38:46.645213 [debug] [MainThread]: Connection 'model.ae_exam_project.model_stg_campaign_master' was properly closed.
[0m19:38:46.645530 [info ] [MainThread]: 
[0m19:38:46.646552 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m19:38:46.648249 [debug] [MainThread]: Command end result
[0m19:38:46.669285 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:38:46.674517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:38:46.683009 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:38:46.683622 [info ] [MainThread]: 
[0m19:38:46.684635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:46.685492 [info ] [MainThread]: 
[0m19:38:46.687098 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:38:46.689020 [debug] [MainThread]: Command `dbt run` succeeded at 19:38:46.688737 after 2.10 seconds
[0m19:38:46.689849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A776CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A59BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A298B50>]}
[0m19:38:46.690522 [debug] [MainThread]: Flushing usage events
[0m19:38:48.444770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:24.486165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C40BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5047890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5237ED0>]}


============================== 22:55:24.491091 | 1741de61-ecea-45f1-a05d-bbe4101ea44c ==============================
[0m22:55:24.491091 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:55:24.491892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:24.650944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C47710F0>]}
[0m22:55:24.702618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C50F7AC0>]}
[0m22:55:24.705465 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:55:24.857540 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:55:24.953869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:24.954238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:24.980923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5308650>]}
[0m22:55:25.033351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m22:55:25.037112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m22:55:25.061677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C506F4D0>]}
[0m22:55:25.062446 [info ] [MainThread]: Found 6 models, 3 sources, 429 macros
[0m22:55:25.063442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C67E4C90>]}
[0m22:55:25.068512 [info ] [MainThread]: 
[0m22:55:25.069178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:55:25.069786 [info ] [MainThread]: 
[0m22:55:25.070595 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:55:25.076460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m22:55:25.140240 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:55:25.140636 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:55:25.140905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:25.172374 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m22:55:25.174731 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:55:25.176863 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:55:25.177255 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:55:25.177619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.178538 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.179732 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:55:25.180490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m22:55:25.181644 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m22:55:25.189123 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.189569 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:55:25.189861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.190769 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.191879 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.192315 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m22:55:25.192921 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.193393 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.193752 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m22:55:25.195818 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:55:25.196838 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m22:55:25.197178 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.197413 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m22:55:25.197880 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.198119 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m22:55:25.198577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_main, now create_ae_exam_db_staging)
[0m22:55:25.198952 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m22:55:25.200791 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.201107 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:55:25.201370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.202211 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.203261 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.203548 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m22:55:25.204001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.204231 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.204444 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m22:55:25.204875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.205619 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m22:55:25.205874 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.206080 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m22:55:25.206475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.206756 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m22:55:25.208938 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m22:55:25.214376 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m22:55:25.214745 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m22:55:25.214980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:25.215484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.215758 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m22:55:25.215974 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:55:25.231525 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:55:25.233166 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m22:55:25.234308 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m22:55:25.234573 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m22:55:25.235006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_main, now list_ae_exam_db_staging)
[0m22:55:25.236279 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m22:55:25.236610 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m22:55:25.238165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.238679 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.238909 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m22:55:25.239122 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:55:25.242197 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:55:25.243311 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m22:55:25.243809 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m22:55:25.244041 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m22:55:25.245310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C698FBA0>]}
[0m22:55:25.245685 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.245906 [debug] [MainThread]: On master: BEGIN
[0m22:55:25.246101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:25.246520 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.246760 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.246994 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.247175 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.247517 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.247773 [debug] [MainThread]: On master: Close
[0m22:55:25.250851 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.251301 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m22:55:25.252088 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m22:55:25.252458 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.258503 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.260550 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.287887 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.290144 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.290533 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m22:55:25.290816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:25.291482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.291875 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.292181 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m22:55:25.293551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.299039 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.299422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m22:55:25.301301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:55:25.305563 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.305936 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m22:55:25.306605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.316825 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m22:55:25.317257 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.317525 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m22:55:25.322132 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:55:25.326311 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.326677 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m22:55:25.330241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.333113 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m22:55:25.335491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C66F7F50>]}
[0m22:55:25.336095 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.08s]
[0m22:55:25.336997 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.337414 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.337761 [info ] [Thread-1 (]: 2 of 4 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m22:55:25.338489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m22:55:25.338851 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.341010 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.342266 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.344960 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.346441 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.346997 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m22:55:25.347456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:25.348105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.348389 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.348700 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m22:55:25.349653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.352440 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.352847 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m22:55:25.353639 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.355757 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.356048 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m22:55:25.356583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.357707 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m22:55:25.358058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.358337 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m22:55:25.361501 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.363931 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.364298 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m22:55:25.367209 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.368343 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m22:55:25.368779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C67BE150>]}
[0m22:55:25.369320 [info ] [Thread-1 (]: 2 of 4 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m22:55:25.370150 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.370482 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.370829 [info ] [Thread-1 (]: 3 of 4 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m22:55:25.371614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_order_transactions)
[0m22:55:25.371890 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.373847 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.375032 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.378116 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.380080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.380576 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m22:55:25.380963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:25.381754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.382089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.382364 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m22:55:25.383266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.385377 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.385666 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m22:55:25.386232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.387371 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m22:55:25.387672 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.387914 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m22:55:25.390999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.393143 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.393858 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m22:55:25.395281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.396821 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m22:55:25.397348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C6BE0550>]}
[0m22:55:25.397851 [info ] [Thread-1 (]: 3 of 4 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m22:55:25.398682 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.399484 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.399939 [info ] [Thread-1 (]: 4 of 4 START sql view model main.model_int_campaign_conversions ................ [RUN]
[0m22:55:25.400659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m22:55:25.400966 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.403502 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.404760 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.407221 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.409108 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.409796 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m22:55:25.410370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:25.411004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.411303 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.411577 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."main"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m22:55:25.413463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.416175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.416505 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."main"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m22:55:25.417210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.418165 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m22:55:25.418447 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.418690 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m22:55:25.421991 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.424140 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.424637 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."main"."model_int_campaign_conversions__dbt_backup" cascade
[0m22:55:25.425575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.427306 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m22:55:25.428042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C6AEAF50>]}
[0m22:55:25.428763 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.model_int_campaign_conversions ........... [[32mOK[0m in 0.03s]
[0m22:55:25.429613 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.430982 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.431284 [debug] [MainThread]: On master: BEGIN
[0m22:55:25.431494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:25.431943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.432166 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.432356 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.432534 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.432916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.433247 [debug] [MainThread]: On master: Close
[0m22:55:25.433628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:25.433884 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m22:55:25.434055 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m22:55:25.434230 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m22:55:25.434488 [info ] [MainThread]: 
[0m22:55:25.435071 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m22:55:25.436333 [debug] [MainThread]: Command end result
[0m22:55:25.452252 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m22:55:25.454516 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m22:55:25.461196 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m22:55:25.461765 [info ] [MainThread]: 
[0m22:55:25.462528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:55:25.463069 [info ] [MainThread]: 
[0m22:55:25.463769 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:55:25.464745 [debug] [MainThread]: Command `dbt run` succeeded at 22:55:25.464606 after 1.15 seconds
[0m22:55:25.465075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5281780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282BECFC360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C40116D0>]}
[0m22:55:25.465363 [debug] [MainThread]: Flushing usage events
[0m22:55:26.620148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:51.316465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024669E2A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466ADB7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466AFA7ED0>]}


============================== 23:03:51.322308 | b76cd84d-fcac-47b8-a639-040d5a1acb61 ==============================
[0m23:03:51.322308 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:03:51.323092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:03:51.558982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466A4E90F0>]}
[0m23:03:51.612421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466AE67AC0>]}
[0m23:03:51.615825 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:03:51.764742 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:03:51.860480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:03:51.860836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:03:51.896149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466B078850>]}
[0m23:03:51.947995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:03:51.950857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:03:51.980276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466ADDF4D0>]}
[0m23:03:51.980847 [info ] [MainThread]: Found 6 models, 3 sources, 429 macros
[0m23:03:51.981452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466C56CC90>]}
[0m23:03:51.983663 [info ] [MainThread]: 
[0m23:03:51.984215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:51.984671 [info ] [MainThread]: 
[0m23:03:51.985450 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:03:51.990174 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m23:03:52.054805 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:03:52.055169 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.055402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:52.217136 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.217573 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:03:52.219393 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:03:52.219786 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.220025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:52.315190 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.315721 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:03:52.317235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:52.317555 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m23:03:52.317806 [info ] [MainThread]: 
[0m23:03:52.318421 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m23:03:52.319011 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 15188)
[0m23:03:52.320007 [debug] [MainThread]: Command `dbt run` failed at 23:03:52.319887 after 1.30 seconds
[0m23:03:52.320331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466C7275F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466AE52D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466C3E7290>]}
[0m23:03:52.320641 [debug] [MainThread]: Flushing usage events
[0m23:03:54.046086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:06.021704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021817D1A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818C97890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818E87ED0>]}


============================== 23:04:06.025132 | 86619b78-09c6-4747-aaff-038655e24215 ==============================
[0m23:04:06.025132 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:04:06.026475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:06.191015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218183C90F0>]}
[0m23:04:06.242237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818D47AC0>]}
[0m23:04:06.245052 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:04:06.387629 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:04:06.483953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:06.484328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:06.511383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818F58850>]}
[0m23:04:06.566848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:04:06.568956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:04:06.590953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818CBF4D0>]}
[0m23:04:06.591462 [info ] [MainThread]: Found 6 models, 3 sources, 429 macros
[0m23:04:06.592046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A45CC90>]}
[0m23:04:06.593655 [info ] [MainThread]: 
[0m23:04:06.594179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:06.594700 [info ] [MainThread]: 
[0m23:04:06.595384 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:04:06.599644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m23:04:06.657921 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:04:06.658303 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:04:06.658562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:06.734602 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m23:04:06.736588 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:04:06.738358 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:04:06.738693 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:04:06.738934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.739832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.740921 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:04:06.741697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m23:04:06.742630 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m23:04:06.748743 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.749129 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:04:06.749364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.750291 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.751425 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.751680 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m23:04:06.752085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.752312 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.752509 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m23:04:06.754150 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.754984 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:04:06.755232 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.755441 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:04:06.770672 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m23:04:06.771037 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m23:04:06.771509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m23:04:06.771842 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m23:04:06.773595 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.773860 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:04:06.774081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.774874 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.775856 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.776101 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m23:04:06.776471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.776699 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.776895 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m23:04:06.777267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.778038 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:04:06.778341 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.778582 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:04:06.778970 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.779212 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m23:04:06.780983 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m23:04:06.785055 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:04:06.785350 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m23:04:06.785559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:06.786144 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.786393 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:04:06.786604 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.802872 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m23:04:06.804019 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m23:04:06.806489 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m23:04:06.806804 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m23:04:06.807227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m23:04:06.809141 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:04:06.809448 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m23:04:06.809655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.810162 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.810581 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:04:06.810818 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.813403 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:04:06.814377 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m23:04:06.814859 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m23:04:06.815080 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m23:04:06.815452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m23:04:06.816999 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:04:06.817240 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m23:04:06.817442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.817878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.818088 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:04:06.818414 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.821125 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:04:06.822088 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m23:04:06.822538 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m23:04:06.822763 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m23:04:06.823130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m23:04:06.824513 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:04:06.824767 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m23:04:06.824971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.825430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.825660 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:04:06.825866 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.828871 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:04:06.829982 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m23:04:06.830528 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m23:04:06.830765 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m23:04:06.832220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A617BA0>]}
[0m23:04:06.832585 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:06.832798 [debug] [MainThread]: On master: BEGIN
[0m23:04:06.833016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:06.833472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:06.833677 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.833874 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:06.834055 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.834373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:06.834614 [debug] [MainThread]: On master: Close
[0m23:04:06.838129 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.838633 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m23:04:06.839456 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m23:04:06.839832 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.845340 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.846810 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.875314 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.876713 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.877073 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m23:04:06.877330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:06.877929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.878191 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.878446 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m23:04:06.879289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.884438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.884787 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m23:04:06.886006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.888528 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.888955 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m23:04:06.889578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.899030 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:04:06.899422 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.899683 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:04:06.903245 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.907174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.907494 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m23:04:06.910892 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.912993 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m23:04:06.915332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A2DBD10>]}
[0m23:04:06.915905 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m23:04:06.917332 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.917690 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.918045 [info ] [Thread-1 (]: 2 of 4 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m23:04:06.918815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m23:04:06.919179 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.921465 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.922627 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.925245 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.926276 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.926645 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m23:04:06.926888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:06.927446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.927711 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.927980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m23:04:06.928765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.931286 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.931597 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m23:04:06.932164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.934930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.935446 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m23:04:06.936208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.937589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:04:06.937916 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.938165 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:04:06.941190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.942921 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.943256 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m23:04:06.946306 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.947816 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m23:04:06.948409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A433E30>]}
[0m23:04:06.949444 [info ] [Thread-1 (]: 2 of 4 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m23:04:06.950421 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.950757 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.951117 [info ] [Thread-1 (]: 3 of 4 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m23:04:06.951803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_order_transactions)
[0m23:04:06.952120 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.954458 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.955350 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.957591 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.958659 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.959008 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m23:04:06.959263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:06.959856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.960118 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.960363 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m23:04:06.961152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.963223 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.963532 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m23:04:06.964200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.966831 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.967189 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m23:04:06.967920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.969427 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:04:06.970038 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.970313 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:04:06.973433 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.975299 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.975612 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m23:04:06.978720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.980232 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m23:04:06.980748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A89DE50>]}
[0m23:04:06.981274 [info ] [Thread-1 (]: 3 of 4 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m23:04:06.982131 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.982927 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:06.983348 [info ] [Thread-1 (]: 4 of 4 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m23:04:06.984095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m23:04:06.984663 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:06.987495 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.988601 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:06.991023 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.991935 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.992278 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m23:04:06.992521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:06.993053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.993326 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.993618 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m23:04:06.995132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.997716 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.998132 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m23:04:06.999025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:07.000871 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m23:04:07.001297 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:07.001621 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m23:04:07.004731 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:07.006684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:07.006982 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m23:04:07.007535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:07.008585 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m23:04:07.009063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A8D96D0>]}
[0m23:04:07.009519 [info ] [Thread-1 (]: 4 of 4 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m23:04:07.010356 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:07.011651 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:07.011929 [debug] [MainThread]: On master: BEGIN
[0m23:04:07.012145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:07.012632 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:07.012869 [debug] [MainThread]: On master: COMMIT
[0m23:04:07.013075 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:07.013350 [debug] [MainThread]: On master: COMMIT
[0m23:04:07.013815 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:07.014073 [debug] [MainThread]: On master: Close
[0m23:04:07.014387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:07.014595 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m23:04:07.014779 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m23:04:07.014966 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m23:04:07.015245 [info ] [MainThread]: 
[0m23:04:07.015834 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:04:07.017136 [debug] [MainThread]: Command end result
[0m23:04:07.035607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:04:07.037806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:04:07.043522 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m23:04:07.043896 [info ] [MainThread]: 
[0m23:04:07.044475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:07.045057 [info ] [MainThread]: 
[0m23:04:07.045911 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:04:07.047001 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:07.046855 after 1.17 seconds
[0m23:04:07.047330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818ED1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021812A0C360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021815FB0B90>]}
[0m23:04:07.047668 [debug] [MainThread]: Flushing usage events
[0m23:04:08.088062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:31.838503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4152A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D424B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D426A7ED0>]}


============================== 00:11:31.843361 | 2a3895b1-86d6-4d8b-accd-a24399b046da ==============================
[0m00:11:31.843361 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:11:31.844431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:32.169427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D41BE10F0>]}
[0m00:11:32.226238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D42563AC0>]}
[0m00:11:32.229915 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:11:32.507865 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:11:32.607983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:32.608359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:32.636180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D42778850>]}
[0m00:11:32.692747 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:11:32.695636 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:11:32.735402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D424DF4D0>]}
[0m00:11:32.735920 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:11:32.736430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D43CD4C90>]}
[0m00:11:32.738561 [info ] [MainThread]: 
[0m00:11:32.739134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:32.739640 [info ] [MainThread]: 
[0m00:11:32.740283 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:11:32.745130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:11:32.818388 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:32.818771 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:32.819093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:33.012857 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.013329 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:11:33.015084 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:33.015445 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.015697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:33.164671 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.165402 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:11:33.168123 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:33.168835 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.169364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:33.282610 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.283014 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:11:33.284365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:33.284694 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m00:11:33.285197 [info ] [MainThread]: 
[0m00:11:33.285645 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m00:11:33.286206 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 12736)
[0m00:11:33.287221 [debug] [MainThread]: Command `dbt run` failed at 00:11:33.287082 after 1.82 seconds
[0m00:11:33.287539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D43E87860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D42552D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D43B3F410>]}
[0m00:11:33.287850 [debug] [MainThread]: Flushing usage events
[0m00:11:35.362832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:39.386044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D4ACA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5A47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5C37ED0>]}


============================== 00:11:39.389773 | 0ac483ee-72fb-47a3-95e8-12baa2d0ba06 ==============================
[0m00:11:39.389773 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:11:39.390502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:11:39.554576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D51710F0>]}
[0m00:11:39.605818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5AF3AC0>]}
[0m00:11:39.608685 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:11:39.751721 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:11:39.848199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:39.848557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:39.875181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5D08850>]}
[0m00:11:39.928981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:11:39.931036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:11:39.949108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5A6F4D0>]}
[0m00:11:39.949584 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:11:39.950456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7264C90>]}
[0m00:11:39.952531 [info ] [MainThread]: 
[0m00:11:39.953090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:39.953527 [info ] [MainThread]: 
[0m00:11:39.954296 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:11:39.958661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:11:40.014166 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:40.014576 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:40.014874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:40.088273 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m00:11:40.089966 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:11:40.091621 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:40.091897 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:40.092125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.093077 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.094304 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:11:40.096865 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:40.097549 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:40.097889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.099017 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.100175 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:11:40.100900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m00:11:40.101868 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:11:40.108228 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.108685 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:11:40.108926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.109799 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.110899 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.111186 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:11:40.111623 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.111827 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.112024 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:11:40.113279 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.114050 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:11:40.114325 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.114521 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:11:40.114895 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.115137 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:11:40.115608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:11:40.115987 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:11:40.117306 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.117577 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:11:40.117814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.118720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.119834 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.120112 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:11:40.120503 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.120730 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.120927 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:11:40.121420 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.122085 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:11:40.122317 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.122509 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:11:40.122856 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.123082 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:11:40.123495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:11:40.123961 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:11:40.125155 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.125387 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:11:40.125643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.126329 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.127330 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.127553 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:11:40.127908 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.128228 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.128456 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:11:40.128844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.129506 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:11:40.129730 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.129925 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:11:40.135382 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m00:11:40.135758 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:11:40.137660 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m00:11:40.142290 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:11:40.142587 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:11:40.142795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:40.143434 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.143750 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:11:40.143976 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.160374 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:11:40.161687 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:11:40.163757 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:11:40.164095 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:11:40.164565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m00:11:40.165794 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:11:40.166040 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:11:40.166235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.166964 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.167215 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:11:40.167488 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.170373 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:11:40.171588 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:11:40.172089 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:11:40.172337 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:11:40.172715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m00:11:40.174010 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:11:40.174240 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:11:40.174440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.175356 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.175601 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:11:40.175815 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.178503 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:11:40.179503 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:11:40.179957 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:11:40.180182 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:11:40.180548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:11:40.182139 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:11:40.182394 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:11:40.182584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.183034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.183238 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:11:40.183478 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.186190 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:11:40.187144 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:11:40.187650 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:11:40.187876 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:11:40.188722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7650940>]}
[0m00:11:40.189154 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.189376 [debug] [MainThread]: On master: BEGIN
[0m00:11:40.189563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:40.189990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.190198 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.190392 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.190583 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.190930 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.191180 [debug] [MainThread]: On master: Close
[0m00:11:40.194573 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.194993 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:11:40.195764 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:11:40.196143 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.202031 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.204286 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.230395 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.232135 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.232662 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:11:40.232953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:40.233556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.233830 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.234072 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:11:40.234887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.239686 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.240062 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:11:40.241054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.243708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.244033 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:11:40.244609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.254700 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:11:40.255096 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.255363 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:11:40.258639 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.262553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.263065 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:11:40.266312 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.268365 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:11:40.270601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D70CBE90>]}
[0m00:11:40.271196 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:11:40.272784 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.273088 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.273474 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:11:40.274120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:11:40.274439 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.276760 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.278211 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.280576 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.281895 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.282353 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:11:40.282644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.283248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.283534 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.283796 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:11:40.284561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.287137 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.287672 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:11:40.288741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.291233 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.291569 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:11:40.292211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.293296 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:11:40.293675 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.293944 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:11:40.297306 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.299230 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.299578 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:11:40.302445 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:11:40.303795 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:11:40.304268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D76BC1B0>]}
[0m00:11:40.304754 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:11:40.305588 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.305910 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.306306 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:11:40.306982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:11:40.307313 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.309804 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.310771 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.313392 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.314480 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.314964 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:11:40.315234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.315892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.316187 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.316449 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:11:40.317207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.319468 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.319783 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:11:40.320383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.321437 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:11:40.321783 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.322056 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:11:40.325091 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.327715 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.328159 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:11:40.328829 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.329929 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:11:40.330372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D76DEA30>]}
[0m00:11:40.330825 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.02s]
[0m00:11:40.331544 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.331913 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.332383 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:11:40.333088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:11:40.333411 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.335753 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.337417 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.340498 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.341820 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.342434 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:11:40.342742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.343354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.343625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.343870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:11:40.344648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.346990 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.347329 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:11:40.348010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.350320 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.350690 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:11:40.351327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.352388 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:11:40.352731 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.353018 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:11:40.356415 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.358534 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.358922 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:11:40.361683 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:11:40.362999 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:11:40.363604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7629D50>]}
[0m00:11:40.364090 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:11:40.364972 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.365704 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.366150 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:11:40.366952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:11:40.367282 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.370454 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.372145 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.374411 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.375351 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.375681 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:11:40.375919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.376467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.376732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.376987 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:11:40.382207 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:11:40.382672 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:11:40.383123 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: ROLLBACK
[0m00:11:40.395564 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_campaign_conversions'
[0m00:11:40.395961 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:11:40.399654 [debug] [Thread-1 (]: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:11:40.400266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D725CF30>]}
[0m00:11:40.401173 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model intermediate.model_int_campaign_conversions  [[31mERROR[0m in 0.03s]
[0m00:11:40.402247 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.402873 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_campaign_conversions' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^.
[0m00:11:40.404152 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:11:40.404489 [info ] [Thread-1 (]: 6 of 6 SKIP relation mart.model_mart_campaign_performance ...................... [[33mSKIP[0m]
[0m00:11:40.405190 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:11:40.406438 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.406710 [debug] [MainThread]: On master: BEGIN
[0m00:11:40.406920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:40.407405 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.407686 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.407984 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.408217 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.408685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.408919 [debug] [MainThread]: On master: Close
[0m00:11:40.409224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:40.409409 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m00:11:40.409591 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m00:11:40.409757 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m00:11:40.410021 [info ] [MainThread]: 
[0m00:11:40.410617 [info ] [MainThread]: Finished running 1 Table model, 5 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m00:11:40.412030 [debug] [MainThread]: Command end result
[0m00:11:40.481664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:11:40.483634 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:11:40.488820 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:11:40.489349 [info ] [MainThread]: 
[0m00:11:40.490181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:11:40.491056 [info ] [MainThread]: 
[0m00:11:40.491676 [error] [MainThread]:   Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:11:40.492271 [info ] [MainThread]: 
[0m00:11:40.492873 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m00:11:40.493777 [debug] [MainThread]: Command `dbt run` failed at 00:11:40.493678 after 1.24 seconds
[0m00:11:40.494106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7768350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D1E733B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D778BB90>]}
[0m00:11:40.494402 [debug] [MainThread]: Flushing usage events
[0m00:11:41.762894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:14:26.545063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E848A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9407890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E95F7ED0>]}


============================== 00:14:26.550540 | f07fb684-517f-4f89-9d16-6e296b9b5fff ==============================
[0m00:14:26.550540 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:14:26.551344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:26.760234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B310F0>]}
[0m00:14:26.811525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E94B3AC0>]}
[0m00:14:26.814748 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:14:26.961143 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:14:27.075831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:27.076224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:27.102918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E96C8850>]}
[0m00:14:27.155906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:14:27.158461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:14:27.183140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E942F4D0>]}
[0m00:14:27.183618 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:14:27.184451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EABACC90>]}
[0m00:14:27.186482 [info ] [MainThread]: 
[0m00:14:27.187131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:27.187681 [info ] [MainThread]: 
[0m00:14:27.188304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:14:27.193233 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:14:27.252148 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:14:27.252535 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:14:27.252776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:27.331537 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m00:14:27.333085 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:14:27.334899 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:14:27.335214 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:14:27.335541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.336470 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.337617 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:14:27.339740 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:14:27.340127 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:14:27.340471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.341594 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.342830 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:14:27.343482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m00:14:27.344244 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:14:27.350064 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.350406 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:14:27.350624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.351546 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.352667 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.352926 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:14:27.353341 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.353644 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.353868 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:14:27.355834 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.356741 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:14:27.357014 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.357248 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:14:27.357724 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.357983 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:14:27.358472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:14:27.358851 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:14:27.360245 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.360534 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:14:27.360768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.361661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.362808 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.363061 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:14:27.363668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.364371 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.365124 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:14:27.366362 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.369007 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:14:27.369295 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.369520 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:14:27.369915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.370149 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:14:27.370567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:14:27.370962 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:14:27.372435 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.372692 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:14:27.372896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.373587 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.374581 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.374813 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:14:27.375170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.375388 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.375578 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:14:27.375952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.376599 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:14:27.376805 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.377093 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:14:27.377455 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.377673 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:14:27.379783 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m00:14:27.384363 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:14:27.384706 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:14:27.384959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:27.385644 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.385897 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:14:27.386159 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.522574 [debug] [ThreadPool]: SQL status: OK in 0.136 seconds
[0m00:14:27.523837 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:14:27.540421 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:14:27.540745 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:14:27.541307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:14:27.542522 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:14:27.542794 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:14:27.543034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.543675 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.543968 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:14:27.544202 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.547036 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:14:27.548119 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:14:27.548628 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:14:27.548857 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:14:27.549417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m00:14:27.550601 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:14:27.550834 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:14:27.551150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.551622 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.551851 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:14:27.552061 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.554753 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:14:27.555782 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:14:27.556295 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:14:27.556510 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:14:27.556977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:14:27.558624 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:14:27.558889 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:14:27.559133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.559591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.559838 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:14:27.560061 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.562766 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:14:27.563933 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:14:27.564451 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:14:27.564673 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:14:27.573279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAFA06D0>]}
[0m00:14:27.573892 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.574151 [debug] [MainThread]: On master: BEGIN
[0m00:14:27.574339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:27.574805 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.575025 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.575217 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.575395 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.575713 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.575920 [debug] [MainThread]: On master: Close
[0m00:14:27.587387 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.587851 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:14:27.588707 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:14:27.589034 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.594826 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.595812 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.631489 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.632606 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.632980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:14:27.633231 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:27.633837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.634156 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.634410 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:14:27.635205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.640751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.641159 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:14:27.657193 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:14:27.659817 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.660143 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:14:27.660741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.670719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:14:27.671149 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.671432 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:14:27.710960 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m00:14:27.716735 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.717121 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:14:27.737883 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m00:14:27.741222 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:14:27.743861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAAB7E90>]}
[0m00:14:27.744488 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.15s]
[0m00:14:27.745760 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.746090 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.746637 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:14:27.747554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:14:27.747872 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.750221 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.751096 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.753415 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.754365 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.754701 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:14:27.754947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.755514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.755770 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.756005 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:14:27.756728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.758936 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.759239 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:14:27.759798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.762002 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.762293 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:14:27.763241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.764743 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:14:27.765067 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.765334 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:14:27.807617 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m00:14:27.809395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.809699 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:14:27.831441 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:14:27.833222 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:14:27.833907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EB0101B0>]}
[0m00:14:27.834660 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.09s]
[0m00:14:27.836171 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.836526 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.836936 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:14:27.837642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:14:27.837977 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.840200 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.841267 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.843934 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.844889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.845303 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:14:27.845566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.846118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.846372 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.846614 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:14:27.847382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.849554 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.849858 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:14:27.850414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.852489 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.852782 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:14:27.853410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.854363 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:14:27.854664 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.854906 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:14:27.875017 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m00:14:27.877418 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.877905 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:14:27.894670 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:14:27.895791 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:14:27.896205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAFFC0F0>]}
[0m00:14:27.896628 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.06s]
[0m00:14:27.897407 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.897745 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.898083 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:14:27.898762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:14:27.899157 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.901314 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.902513 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.906133 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.907166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.907579 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:14:27.907821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.908374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.908644 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.908886 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:14:27.909651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.911742 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.912029 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:14:27.912566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.914590 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.914873 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:14:27.915388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.916353 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:14:27.916628 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.916869 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:14:27.920820 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:14:27.923058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.923422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:14:27.926653 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:14:27.928053 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:14:27.928546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAE363D0>]}
[0m00:14:27.929103 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:14:27.929958 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.930675 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.931117 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:14:27.931632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:14:27.932009 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.934431 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.935590 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.937921 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.939036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.939432 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:14:27.939797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.940442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.940794 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.941119 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:14:27.949972 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:14:27.950381 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:14:27.950760 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: ROLLBACK
[0m00:14:27.962593 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_campaign_conversions'
[0m00:14:27.962960 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:14:27.966158 [debug] [Thread-1 (]: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:14:27.966614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EABB4F30>]}
[0m00:14:27.967147 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model intermediate.model_int_campaign_conversions  [[31mERROR[0m in 0.03s]
[0m00:14:27.968079 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.968679 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_campaign_conversions' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^.
[0m00:14:27.969952 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:14:27.970386 [info ] [Thread-1 (]: 6 of 6 SKIP relation mart.model_mart_campaign_performance ...................... [[33mSKIP[0m]
[0m00:14:27.971127 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:14:27.972620 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.972885 [debug] [MainThread]: On master: BEGIN
[0m00:14:27.973085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:27.973575 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.973815 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.974009 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.974202 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.974557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.974795 [debug] [MainThread]: On master: Close
[0m00:14:27.975075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:27.975275 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m00:14:27.975449 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m00:14:27.975608 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m00:14:27.975860 [info ] [MainThread]: 
[0m00:14:27.976486 [info ] [MainThread]: Finished running 1 Table model, 5 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m00:14:27.978021 [debug] [MainThread]: Command end result
[0m00:14:28.045944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:14:28.048358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:14:28.053912 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:14:28.054308 [info ] [MainThread]: 
[0m00:14:28.054885 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:14:28.055657 [info ] [MainThread]: 
[0m00:14:28.056371 [error] [MainThread]:   Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:14:28.057003 [info ] [MainThread]: 
[0m00:14:28.057547 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m00:14:28.058336 [debug] [MainThread]: Command `dbt run` failed at 00:14:28.058213 after 1.78 seconds
[0m00:14:28.058656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E582F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8AE7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EB10FFB0>]}
[0m00:14:28.059026 [debug] [MainThread]: Flushing usage events
[0m00:14:30.358204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:15.218655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA3AFA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4A77890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4C67ED0>]}


============================== 00:16:15.222327 | 66bdb0f1-a2af-43c6-8d59-afb0e395a138 ==============================
[0m00:16:15.222327 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:16:15.223133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:15.410010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA41A10F0>]}
[0m00:16:15.476425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4B27AC0>]}
[0m00:16:15.479906 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:16:15.654799 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:16:15.791573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:15.792226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:15.844573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4D38850>]}
[0m00:16:15.911170 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:16:15.914252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:16:15.943569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4A9F4D0>]}
[0m00:16:15.944463 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:16:15.945149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA6310C90>]}
[0m00:16:15.947882 [info ] [MainThread]: 
[0m00:16:15.948748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:15.949349 [info ] [MainThread]: 
[0m00:16:15.950598 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:16:15.956050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:16:16.026318 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:16.026772 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.027140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:16.406256 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.406623 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:16:16.408635 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:16.409153 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.409444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:16.519185 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.519689 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:16:16.521499 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:16.521811 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.522022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:16.626362 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.626728 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:16:16.627767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:16.628018 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m00:16:16.628253 [info ] [MainThread]: 
[0m00:16:16.628858 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m00:16:16.629630 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 10268)
[0m00:16:16.630863 [debug] [MainThread]: Command `dbt run` failed at 00:16:16.630739 after 1.71 seconds
[0m00:16:16.631237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA64C7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4B12D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA617B590>]}
[0m00:16:16.631537 [debug] [MainThread]: Flushing usage events
[0m00:16:17.872138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:22.052066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCBACA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCA47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCC37ED0>]}


============================== 00:16:22.056185 | a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a ==============================
[0m00:16:22.056185 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:16:22.056894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:16:22.242312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCC1710F0>]}
[0m00:16:22.301770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCAF3AC0>]}
[0m00:16:22.304945 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:16:22.477262 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:16:22.597083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:22.597723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:22.629808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCD0C850>]}
[0m00:16:22.692483 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:16:22.694836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:16:22.716523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCA6F4D0>]}
[0m00:16:22.717653 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:16:22.718403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE234C90>]}
[0m00:16:22.721189 [info ] [MainThread]: 
[0m00:16:22.721923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:22.722435 [info ] [MainThread]: 
[0m00:16:22.723163 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:16:22.729654 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:16:22.802592 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:22.803182 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:22.803656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:22.893660 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m00:16:22.895887 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:16:22.898062 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:22.898648 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:22.898933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.899851 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.901005 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:16:22.903152 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:22.903594 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:22.903889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.904855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.905918 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:16:22.906588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:16:22.907610 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:16:22.915660 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.916120 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:16:22.916408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.917487 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.918707 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.918998 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:16:22.919454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.919715 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.919935 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:16:22.921135 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.921952 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:16:22.922234 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.922468 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:16:22.922903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.923165 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:16:22.923634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:16:22.924062 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:16:22.925479 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.925761 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:16:22.926000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.926816 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.928106 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.928426 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:16:22.928905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.929173 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.929431 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:16:22.930068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.931135 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:16:22.931507 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.931760 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:16:22.932249 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.932556 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:16:22.933374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:16:22.934216 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:16:22.935791 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.936141 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:16:22.936421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.937370 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.939087 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.939401 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:16:22.939879 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.940132 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.940355 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:16:22.940846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.941619 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:16:22.941922 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.942155 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:16:22.942585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.942855 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:16:22.944863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:16:22.950256 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:16:22.950656 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:16:22.950970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:22.951724 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.952058 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:16:22.952330 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:22.973684 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:16:22.974977 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:16:22.977443 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:16:22.977832 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:16:22.978367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:16:22.979871 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:16:22.980212 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:16:22.980465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.981148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.981436 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:16:22.981676 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:22.985824 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:16:22.987568 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:16:22.988217 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:16:22.988511 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:16:22.989019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:16:22.990520 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:16:22.990836 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:16:22.991832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.992384 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.992650 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:16:22.992977 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:22.996215 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:16:22.997479 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:16:22.998082 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:16:22.998354 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:16:22.998810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:16:23.000688 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:16:23.001061 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:16:23.001298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:23.001823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:23.002077 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:16:23.002299 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:23.005517 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:16:23.006777 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:16:23.007378 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:16:23.007665 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:16:23.008504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE620390>]}
[0m00:16:23.009020 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.009287 [debug] [MainThread]: On master: BEGIN
[0m00:16:23.009511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:23.010096 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:16:23.010385 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.010620 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.010816 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.011253 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:16:23.011515 [debug] [MainThread]: On master: Close
[0m00:16:23.014365 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.014997 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:16:23.015840 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:16:23.016199 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.023766 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.025355 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.058408 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.059546 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.060134 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:16:23.060551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:23.061333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.061653 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.061944 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:16:23.064905 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.071961 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.072423 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:16:23.073718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.076772 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.077242 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:16:23.077944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.089780 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:16:23.090253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.090549 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:16:23.095765 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:16:23.100773 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.101194 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:16:23.105330 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:16:23.107735 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:16:23.110339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE097E90>]}
[0m00:16:23.111042 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.09s]
[0m00:16:23.112045 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.112630 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.113253 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:16:23.114160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:16:23.114593 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.117466 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.118537 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.121120 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.122162 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.122541 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:16:23.122817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.123512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.123992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.124359 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:16:23.125235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.128476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.128894 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:16:23.129561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.134026 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.134458 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:16:23.135258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.136589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:16:23.137052 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.137477 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:16:23.140827 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.142761 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.143170 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:16:23.146079 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.147426 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:16:23.148117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE68C1B0>]}
[0m00:16:23.148689 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:16:23.149586 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.150075 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.151134 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:16:23.152053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:16:23.152551 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.155069 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.156160 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.159362 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.160471 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.160987 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:16:23.161331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.161921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.162239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.162548 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:16:23.163290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.165865 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.166986 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:16:23.168347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.170954 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.171376 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:16:23.172077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.173222 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:16:23.173631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.173932 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:16:23.177142 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.179515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.179917 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:16:23.183098 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.184889 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:16:23.185454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE6780F0>]}
[0m00:16:23.186025 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:16:23.187251 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.187846 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.188327 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:16:23.189034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:16:23.189383 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.191645 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.192751 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.195828 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.196926 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.197435 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:16:23.197744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.198398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.198860 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.199299 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:16:23.201201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.204152 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.204565 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:16:23.205282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.207923 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.208381 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:16:23.209130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.210225 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:16:23.210581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.210897 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:16:23.214033 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.217519 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.218028 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:16:23.221467 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.222880 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:16:23.223458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE4B73D0>]}
[0m00:16:23.224341 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:16:23.225260 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.226245 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.226697 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:16:23.227454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:16:23.227849 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.230576 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.232390 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.235745 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.236933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.237460 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:16:23.237757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.238556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.239132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.239538 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:16:23.241202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.246123 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.246556 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:16:23.247326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.248756 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:16:23.249472 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.250182 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:16:23.253852 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.256154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.256546 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:16:23.257209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.258545 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:16:23.259096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE6D0C20>]}
[0m00:16:23.259642 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:16:23.260484 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.261327 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.261781 [info ] [Thread-1 (]: 6 of 6 START sql Table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:16:23.262461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:16:23.262931 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.267928 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:16:23.269891 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.353451 [debug] [Thread-1 (]: Compilation Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m00:16:23.354183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE21B590>]}
[0m00:16:23.354808 [error] [Thread-1 (]: 6 of 6 ERROR creating sql Table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:16:23.355769 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.356599 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb').
[0m00:16:23.359039 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.359598 [debug] [MainThread]: On master: BEGIN
[0m00:16:23.360023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:23.360836 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:16:23.361347 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.361749 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.362124 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.362969 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:16:23.363534 [debug] [MainThread]: On master: Close
[0m00:16:23.364229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:23.364714 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:16:23.365070 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:16:23.365414 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:16:23.365924 [info ] [MainThread]: 
[0m00:16:23.366743 [info ] [MainThread]: Finished running 1 Table model, 5 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m00:16:23.370235 [debug] [MainThread]: Command end result
[0m00:16:23.400834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:16:23.406799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:16:23.418377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:16:23.419027 [info ] [MainThread]: 
[0m00:16:23.420368 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:16:23.420954 [info ] [MainThread]: 
[0m00:16:23.423958 [error] [MainThread]:   Compilation Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m00:16:23.426708 [info ] [MainThread]: 
[0m00:16:23.428208 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:16:23.429900 [debug] [MainThread]: Command `dbt run` failed at 00:16:23.429582 after 1.54 seconds
[0m00:16:23.430477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCC5BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCB335F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE6F7EF0>]}
[0m00:16:23.431102 [debug] [MainThread]: Flushing usage events
[0m00:16:24.665217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:06.546268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E46A7A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47A07890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47BF7ED0>]}


============================== 00:18:06.551880 | 041331f8-165e-4288-9618-c94b3cc80670 ==============================
[0m00:18:06.551880 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:06.552951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:06.764803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E471310F0>]}
[0m00:18:06.816490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47AB3AC0>]}
[0m00:18:06.819786 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:18:06.964777 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:07.059082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:07.059417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:07.086515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47CC8850>]}
[0m00:18:07.140088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:07.142532 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:07.176258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47A2F4D0>]}
[0m00:18:07.176754 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:18:07.177427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E491B4C90>]}
[0m00:18:07.179513 [info ] [MainThread]: 
[0m00:18:07.180129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:07.180698 [info ] [MainThread]: 
[0m00:18:07.181535 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:18:07.186371 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:18:07.252709 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:07.253106 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:07.253372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:07.360826 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m00:18:07.362565 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:07.364359 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:07.364652 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:07.364982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.365819 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.366836 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:07.368202 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:07.368453 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:07.368672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.369501 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.370445 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:07.371323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:18:07.372046 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:18:07.377655 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.377973 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:07.378255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.379164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.380228 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.380462 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:18:07.380870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.381084 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.381282 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:18:07.382467 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.383448 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:07.383780 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.384000 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:07.384380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.384629 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:18:07.385065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:18:07.385430 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:18:07.386879 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.387169 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:07.387410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.388182 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.389181 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.389446 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:18:07.389821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.390044 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.390236 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:18:07.390611 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.391254 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:07.391477 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.391680 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:07.392022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.392281 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:18:07.392698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:18:07.393122 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:18:07.394459 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.394759 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:07.395002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.395820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.396911 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.397177 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:18:07.397577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.397815 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.398014 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:18:07.398399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.399050 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:07.399278 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.399471 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:07.399807 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.400019 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:18:07.402146 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m00:18:07.407104 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:07.407538 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:18:07.407777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:07.408405 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.408670 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:07.408892 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.428599 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:18:07.429862 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:18:07.431899 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:18:07.432174 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:18:07.432598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m00:18:07.434234 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:07.434579 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:18:07.434803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.436021 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.436291 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:07.436507 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.439151 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:18:07.440111 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:18:07.440598 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:18:07.440815 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:18:07.441195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:18:07.442401 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:07.442633 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:18:07.442857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.443392 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.443682 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:07.443886 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.446550 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:18:07.447502 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:18:07.447959 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:18:07.448189 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:18:07.448554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:18:07.450286 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:07.450552 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:18:07.450756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.451222 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.451453 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:07.451722 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.454563 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:07.455624 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:18:07.456205 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:18:07.456421 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:18:07.457421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E495A4AE0>]}
[0m00:18:07.457800 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.458010 [debug] [MainThread]: On master: BEGIN
[0m00:18:07.458225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:07.458643 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.458868 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.459069 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.459244 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.459588 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.459823 [debug] [MainThread]: On master: Close
[0m00:18:07.463341 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.463787 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:18:07.464448 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:18:07.464775 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.470472 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.471438 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.498704 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.499872 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.500263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:18:07.500536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:07.501107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.501421 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.501678 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:18:07.503274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.508133 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.508453 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:18:07.509595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.512376 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.512842 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:18:07.513659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.522908 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:07.523312 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.523622 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:07.527950 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:18:07.532050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.532406 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:18:07.536009 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.538639 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:18:07.540995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E49023F50>]}
[0m00:18:07.541543 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:18:07.542674 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.543049 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.543441 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:18:07.544190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:18:07.544498 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.546907 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.547869 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.550011 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.550869 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.551188 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:18:07.551431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.551976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.552252 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.552483 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:18:07.553311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.555469 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.555821 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:18:07.556434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.559265 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.559748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:18:07.560631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.562013 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:07.562616 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.562985 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:07.566152 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.567781 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.568053 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:18:07.571340 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.572595 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:18:07.573172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E4960C1B0>]}
[0m00:18:07.573853 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:18:07.574736 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.575083 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.575451 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:18:07.576176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:18:07.576471 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.578360 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.579378 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.582610 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.583723 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.584077 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:18:07.584322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.584840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.585088 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.585322 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:18:07.586059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.588239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.588660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:18:07.589391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.591506 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.591803 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:18:07.592387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.593519 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:07.593871 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.594114 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:07.597239 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.599851 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.600230 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:18:07.603345 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.605007 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:18:07.605513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E495F8050>]}
[0m00:18:07.606039 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:18:07.606874 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.607240 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.607621 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:18:07.608214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:18:07.608516 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.610521 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.611512 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.614868 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.616485 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.617044 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:18:07.617318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.617973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.618419 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.618692 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:18:07.619599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.621868 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.622173 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:18:07.622763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.624896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.625180 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:18:07.625733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.626950 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:07.627263 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.627509 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:07.630793 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.633670 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.634081 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:18:07.637329 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.638522 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:18:07.638958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E4943B7D0>]}
[0m00:18:07.639410 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:18:07.640389 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.641226 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.641799 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:18:07.642599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:18:07.643342 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.645591 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.646816 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.649903 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.651505 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.651933 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:18:07.652209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.652793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.653158 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.653476 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:18:07.654885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.659532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.659921 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:18:07.660590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.662782 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.663278 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:18:07.664057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.665373 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:07.665814 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.666428 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:07.669762 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.671451 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.671739 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:18:07.674784 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.675922 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:18:07.676396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E49680C20>]}
[0m00:18:07.676849 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:18:07.677729 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.678559 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.678976 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:18:07.679747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:18:07.680120 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.735449 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.736407 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.752500 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.753937 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.754365 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:18:07.754680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.755321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.755602 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.755961 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final;
    );
  
  
[0m00:18:07.764666 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final;
    );
  
  
[0m00:18:07.765121 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:18:07.765495 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:18:07.777149 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:18:07.777535 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:18:07.780968 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:07.781407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47C69E50>]}
[0m00:18:07.781918 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.10s]
[0m00:18:07.782739 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.783460 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final".
[0m00:18:07.784985 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.785238 [debug] [MainThread]: On master: BEGIN
[0m00:18:07.785436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:07.785904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.786208 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.786445 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.786626 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.787003 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.787239 [debug] [MainThread]: On master: Close
[0m00:18:07.787537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:07.787734 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:18:07.787907 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:18:07.788067 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:18:07.788715 [info ] [MainThread]: 
[0m00:18:07.789337 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m00:18:07.790745 [debug] [MainThread]: Command end result
[0m00:18:07.806500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:07.808850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:07.815618 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:18:07.816179 [info ] [MainThread]: 
[0m00:18:07.816810 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:07.817749 [info ] [MainThread]: 
[0m00:18:07.818398 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:07.819036 [info ] [MainThread]: 
[0m00:18:07.819668 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:18:07.820580 [debug] [MainThread]: Command `dbt run` failed at 00:18:07.820478 after 1.46 seconds
[0m00:18:07.820885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E48DBE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E477B16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47C69FD0>]}
[0m00:18:07.821167 [debug] [MainThread]: Flushing usage events
[0m00:18:09.177318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:24.275894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A982A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA7B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA9A7ED0>]}


============================== 00:18:24.279396 | c4b9e962-56b6-4af5-b433-7b7371ea765e ==============================
[0m00:18:24.279396 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:24.280089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:24.439871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A9EE10F0>]}
[0m00:18:24.490384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA863AC0>]}
[0m00:18:24.493128 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:18:24.630103 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:24.723334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:24.723656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:24.749887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AAA78850>]}
[0m00:18:24.804547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:24.806694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:24.826237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA7DF4D0>]}
[0m00:18:24.826774 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:18:24.827368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABF64C90>]}
[0m00:18:24.829212 [info ] [MainThread]: 
[0m00:18:24.829858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:24.830517 [info ] [MainThread]: 
[0m00:18:24.831406 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:18:24.835987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:18:24.889642 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:24.889982 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:24.890212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:24.919742 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m00:18:24.920967 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:24.922669 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:24.922987 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:24.923442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.924321 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.925284 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:24.926929 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:24.927244 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:24.927490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.928431 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.929379 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:24.930074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:18:24.930459 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:18:24.935984 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.936322 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:24.936560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.937423 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.938530 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.938799 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:18:24.939179 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.939390 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.939581 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:18:24.939966 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.940667 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:24.940911 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.941114 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:24.941445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.941664 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:18:24.942116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:18:24.942525 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:18:24.943891 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.944153 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:24.944368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.945055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.946145 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.946372 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:18:24.946720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.946953 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.947141 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:18:24.947507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.948142 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:24.948359 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.948553 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:24.948869 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.949088 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:18:24.949456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:18:24.949759 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:18:24.950920 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.951151 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:24.951351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.951964 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.952977 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.953312 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:18:24.953769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.953983 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.954182 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:18:24.954543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.955207 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:24.955433 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.955664 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:24.956015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.956250 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:18:24.958056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:18:24.962376 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:24.962647 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:18:24.962935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:24.963650 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.963911 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:24.964124 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:24.979696 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:18:24.980917 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:18:24.982154 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:18:24.982555 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:18:24.983289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:18:24.985126 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:24.985618 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:18:24.985964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.986564 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.986816 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:24.987023 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:24.989823 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:24.990873 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:18:24.991405 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:18:24.991641 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:18:24.992046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m00:18:24.993380 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:24.993726 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:18:24.993959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.994597 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.994840 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:24.995055 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:24.998369 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:24.999740 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:18:25.000251 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:18:25.000558 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:18:25.000955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m00:18:25.002542 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:25.002777 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:18:25.003016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:25.004183 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:25.004418 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:25.004625 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:25.007416 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:25.008416 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:18:25.008878 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:18:25.009100 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:18:25.010089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC350A10>]}
[0m00:18:25.010447 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.010664 [debug] [MainThread]: On master: BEGIN
[0m00:18:25.010849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:25.011259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.011480 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.011675 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.011849 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.012203 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.012440 [debug] [MainThread]: On master: Close
[0m00:18:25.014944 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.015521 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:18:25.016372 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:18:25.016735 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.022063 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.022951 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.050025 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.051853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.052249 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:18:25.052493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:25.053027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.053488 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.053737 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:18:25.054542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.059392 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.059839 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:18:25.060493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.062866 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.063219 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:18:25.063816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.072951 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:25.073396 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.073714 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:25.077771 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:18:25.081531 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.081838 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:18:25.084827 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.086935 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:18:25.088862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABDD3F50>]}
[0m00:18:25.089465 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:18:25.090679 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.091063 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.091424 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:18:25.092151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:18:25.092503 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.095124 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.096030 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.098250 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.099016 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.099353 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:18:25.099603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.100137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.100382 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.100645 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:18:25.101410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.103615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.103921 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:18:25.104481 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.106695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.106981 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:18:25.107499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.108436 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:25.108709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.108937 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:25.112165 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.114698 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.115087 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:18:25.118080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.119341 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:18:25.119813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC3C01B0>]}
[0m00:18:25.120290 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:18:25.121122 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.121444 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.121828 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:18:25.122521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:18:25.122859 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.124919 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.125929 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.129263 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.130399 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.130758 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:18:25.131004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.131598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.131873 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.132108 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:18:25.132877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.135077 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.135370 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:18:25.135950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.137889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.138154 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:18:25.138691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.139603 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:25.139877 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.140116 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:25.143006 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.145722 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.146230 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:18:25.149687 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.150874 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:18:25.151294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC3AC050>]}
[0m00:18:25.151729 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:18:25.152579 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.152949 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.153353 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:18:25.153994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:18:25.154265 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.156283 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.157058 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.159659 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.160803 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.161266 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:18:25.161606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.162312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.162597 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.162861 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:18:25.163733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.165883 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.166187 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:18:25.166752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.168687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.168965 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:18:25.169478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.170491 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:25.170775 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.171009 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:25.174050 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.176308 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.176653 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:18:25.179786 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.180970 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:18:25.181429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC1EB7D0>]}
[0m00:18:25.181898 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:18:25.182673 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.183457 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.184013 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:18:25.184771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:18:25.185082 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.187634 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.188592 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.190827 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.191750 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.192090 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:18:25.192432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.193150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.193452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.193740 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:18:25.195580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.200360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.200720 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:18:25.201362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.203761 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.204224 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:18:25.204908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.205925 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:25.206250 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.206494 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:25.209601 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.211655 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.212245 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:18:25.215656 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.216825 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:18:25.217296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC434C20>]}
[0m00:18:25.217741 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:18:25.218674 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.219636 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.220016 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:18:25.220761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:18:25.221033 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.274377 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.275268 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.291502 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.292558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.293059 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:18:25.293424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.294002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.294273 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.294571 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:25.295287 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:25.295639 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:18:25.296236 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:18:25.302492 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:18:25.302913 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:18:25.305965 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:25.306398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC2A0290>]}
[0m00:18:25.306877 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:18:25.307744 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.308607 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final".
[0m00:18:25.310332 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.310613 [debug] [MainThread]: On master: BEGIN
[0m00:18:25.310815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:25.311300 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.311541 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.311736 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.311930 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.312288 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.312526 [debug] [MainThread]: On master: Close
[0m00:18:25.312852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:25.313081 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:18:25.313306 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:18:25.313493 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:18:25.313776 [info ] [MainThread]: 
[0m00:18:25.314332 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m00:18:25.316077 [debug] [MainThread]: Command end result
[0m00:18:25.333264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:25.336396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:25.347254 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:18:25.347859 [info ] [MainThread]: 
[0m00:18:25.348639 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:25.349238 [info ] [MainThread]: 
[0m00:18:25.349868 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:25.350509 [info ] [MainThread]: 
[0m00:18:25.351116 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:18:25.352408 [debug] [MainThread]: Command `dbt run` failed at 00:18:25.352153 after 1.22 seconds
[0m00:18:25.352998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AAA21D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A973DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA8B30B0>]}
[0m00:18:25.353627 [debug] [MainThread]: Flushing usage events
[0m00:18:26.595450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:45.655274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017320B7A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321AF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321CEBED0>]}


============================== 00:18:45.658923 | 22ac0a56-746e-4a8f-8f7e-e87d65c84429 ==============================
[0m00:18:45.658923 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:45.660086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:45.821708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173212210F0>]}
[0m00:18:45.872193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321BA7AC0>]}
[0m00:18:45.876109 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:18:46.019173 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:46.114729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:46.115155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:46.143433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321DB8850>]}
[0m00:18:46.198093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:46.199940 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:46.218937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321B1F4D0>]}
[0m00:18:46.219410 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:18:46.220072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017323344C90>]}
[0m00:18:46.221730 [info ] [MainThread]: 
[0m00:18:46.222394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:46.222916 [info ] [MainThread]: 
[0m00:18:46.223535 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:18:46.227978 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:18:46.284066 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:46.284476 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:46.284766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:46.312057 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m00:18:46.313336 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:46.314928 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:46.315195 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:46.315427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.316255 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.317150 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:46.318462 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:46.318708 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:46.318915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.319616 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.320504 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:46.321131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m00:18:46.321479 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:18:46.327083 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.327455 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:46.327680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.328551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.329599 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.329837 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:18:46.330218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.330440 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.330634 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:18:46.331036 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.331688 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:46.331916 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.332127 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:46.332466 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.332705 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:18:46.333232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:18:46.333641 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:18:46.334925 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.335159 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:46.335358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.336179 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.337158 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.337384 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:18:46.337752 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.337970 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.338173 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:18:46.338546 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.339193 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:46.339425 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.339618 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:46.339958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.340189 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:18:46.340567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:18:46.340876 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:18:46.342032 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.342338 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:46.342547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.343319 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.344385 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.344625 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:18:46.345017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.345230 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.345435 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:18:46.345841 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.346541 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:46.346746 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.346933 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:46.347273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.347496 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:18:46.349244 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m00:18:46.353864 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:46.354194 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:18:46.354409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:46.355033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.355291 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:46.355505 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.368844 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m00:18:46.370779 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:18:46.372404 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:18:46.372897 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:18:46.374101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m00:18:46.375348 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:46.375580 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:18:46.375779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.376339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.376569 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:46.376769 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.379627 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:46.380721 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:18:46.381274 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:18:46.381523 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:18:46.381971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:18:46.383417 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:46.383722 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:18:46.383962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.384525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.384746 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:46.384945 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.387789 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:46.388893 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:18:46.389479 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:18:46.389706 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:18:46.390112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:18:46.391638 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:46.391904 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:18:46.392177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.393339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.393624 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:46.393851 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.396694 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:46.397730 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:18:46.398231 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:18:46.398460 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:18:46.399310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017323734600>]}
[0m00:18:46.399663 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.399881 [debug] [MainThread]: On master: BEGIN
[0m00:18:46.400068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:46.400535 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:46.400741 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.400924 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.401122 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.401488 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:46.401714 [debug] [MainThread]: On master: Close
[0m00:18:46.404083 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.404611 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:18:46.405528 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:18:46.405952 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.411981 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.413119 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.439804 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.441818 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.442309 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:18:46.442571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:46.443235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.443543 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.443787 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:18:46.444545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.449378 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.449689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:18:46.450269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.452579 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.452867 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:18:46.453518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.463650 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:46.464047 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.464309 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:46.468417 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:18:46.472347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.472748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:18:46.475670 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.477827 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:18:46.479913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173231ABF50>]}
[0m00:18:46.480460 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:18:46.481545 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.481938 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.482405 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:18:46.483228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:18:46.483541 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.485966 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.486829 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.489070 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.489929 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.490259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:18:46.490506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.491049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.491302 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.491531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:18:46.492271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.494567 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.494873 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:18:46.495459 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.497880 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.498259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:18:46.498918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.500254 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:46.500676 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.500990 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:46.504426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.506648 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.507136 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:18:46.510207 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.511422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:18:46.511890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173237A01B0>]}
[0m00:18:46.512386 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:18:46.513510 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.514024 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.514425 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:18:46.515223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:18:46.515535 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.517614 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.518405 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.521107 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.522087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.522477 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:18:46.522747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.523465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.523961 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.524268 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:18:46.525419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.527750 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.528056 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:18:46.529213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.531291 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.531594 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:18:46.532167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.533155 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:46.533497 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.533792 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:46.536591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:18:46.538693 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.539112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:18:46.541982 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:18:46.543659 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:18:46.544337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732378C0F0>]}
[0m00:18:46.544904 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:18:46.545768 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.546206 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.546529 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:18:46.547264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:18:46.547572 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.549458 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.550253 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.552899 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.553890 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.554251 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:18:46.554527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.555089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.555408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.555708 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:18:46.556609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.559887 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.560324 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:18:46.561063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.563186 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.563512 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:18:46.564123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.565098 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:46.565377 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.565619 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:46.568881 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.570966 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.571263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:18:46.574118 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:18:46.576428 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:18:46.576994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173235CB7D0>]}
[0m00:18:46.577538 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:18:46.578354 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.579124 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.579531 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:18:46.580268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:18:46.580546 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.582947 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.583874 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.586134 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.586933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.587258 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:18:46.587502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.588042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.588287 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.588647 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:18:46.590282 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.595525 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.595918 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:18:46.596625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.598778 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.599125 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:18:46.599701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.600673 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:46.600966 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.601213 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:46.604134 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.606116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.606498 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:18:46.609603 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.610764 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:18:46.611244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173237E4C20>]}
[0m00:18:46.611714 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:18:46.612478 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.613268 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.613675 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:18:46.614308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:18:46.614682 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.668839 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.669737 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.685170 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.686159 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.686549 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:18:46.686809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.687407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.687690 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.687987 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:46.698784 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:46.699256 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:18:46.699632 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:18:46.704988 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:18:46.705358 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:18:46.708348 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Catalog Error: Table with name impressions does not exist!
  Did you mean "pg_description"?
  
  LINE 76:   from impressions i
                  ^
[0m00:18:46.708739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173237B8470>]}
[0m00:18:46.709235 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:18:46.710128 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.710641 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Catalog Error: Table with name impressions does not exist!
  Did you mean "pg_description"?
  
  LINE 76:   from impressions i
                  ^.
[0m00:18:46.712225 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.712535 [debug] [MainThread]: On master: BEGIN
[0m00:18:46.712782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:46.713413 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:18:46.713677 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.713884 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.714068 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.714441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:46.714789 [debug] [MainThread]: On master: Close
[0m00:18:46.715201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:46.715432 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m00:18:46.715656 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m00:18:46.715900 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:18:46.716231 [info ] [MainThread]: 
[0m00:18:46.716875 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:18:46.718654 [debug] [MainThread]: Command end result
[0m00:18:46.740724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:46.743457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:46.749569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:18:46.749942 [info ] [MainThread]: 
[0m00:18:46.750646 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:46.751197 [info ] [MainThread]: 
[0m00:18:46.751802 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Catalog Error: Table with name impressions does not exist!
  Did you mean "pg_description"?
  
  LINE 76:   from impressions i
                  ^
[0m00:18:46.752409 [info ] [MainThread]: 
[0m00:18:46.752993 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:18:46.753938 [debug] [MainThread]: Command `dbt run` failed at 00:18:46.753828 after 1.24 seconds
[0m00:18:46.754246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017322F2A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173218924B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017322F406B0>]}
[0m00:18:46.754524 [debug] [MainThread]: Flushing usage events
[0m00:18:48.010299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:31.975911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA6F8A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7F17890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA8107ED0>]}


============================== 00:19:31.979411 | 5b393a79-e6c8-40dc-b7f6-738bffcb2662 ==============================
[0m00:19:31.979411 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:19:31.980801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:19:32.152675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA76410F0>]}
[0m00:19:32.209302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7FC7AC0>]}
[0m00:19:32.212869 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:19:32.381460 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:19:32.503844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:32.504195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:32.532722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA81D8850>]}
[0m00:19:32.586764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:19:32.589016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:19:32.608223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7F3F4D0>]}
[0m00:19:32.608698 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:19:32.609338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA96BCC90>]}
[0m00:19:32.610957 [info ] [MainThread]: 
[0m00:19:32.611577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:32.612061 [info ] [MainThread]: 
[0m00:19:32.612752 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:19:32.617574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:19:32.674998 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:19:32.675396 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:19:32.675678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:32.706772 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m00:19:32.708066 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:19:32.709763 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:19:32.710064 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:19:32.710300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.711213 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.712201 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:19:32.713913 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:19:32.714246 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:19:32.714720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.715653 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.716853 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:19:32.717633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m00:19:32.718074 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:19:32.724260 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.724643 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:19:32.724868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.725758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.727579 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.728089 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:19:32.728748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.729108 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.729446 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:19:32.730020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.730927 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:19:32.731196 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.731407 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:19:32.731807 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.732052 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:19:32.732508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m00:19:32.732863 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:19:32.734455 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.734733 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:19:32.735021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.735804 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.736848 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.737090 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:19:32.737513 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.737771 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.738015 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:19:32.738418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.739129 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:19:32.739369 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.739562 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:19:32.739911 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.740148 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:19:32.740579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m00:19:32.740905 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:19:32.742173 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.742417 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:19:32.742626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.743373 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.744463 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.744751 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:19:32.745132 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.745357 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.745613 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:19:32.746118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.746855 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:19:32.747122 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.747354 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:19:32.747859 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.748101 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:19:32.750139 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m00:19:32.755398 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:19:32.755757 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:19:32.756146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:32.756828 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.757200 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:19:32.757550 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.769884 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:19:32.770997 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:19:32.772000 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:19:32.772301 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:19:32.772703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m00:19:32.774124 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:19:32.774391 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:19:32.774602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.775061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.775299 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:19:32.775503 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.778370 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:19:32.779543 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:19:32.780150 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:19:32.780427 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:19:32.780927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:19:32.782569 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:19:32.782974 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:19:32.783230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.783722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.783975 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:19:32.784185 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.787102 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:19:32.788237 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:19:32.788736 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:19:32.788988 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:19:32.789397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m00:19:32.790972 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:19:32.791257 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:19:32.791493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.792671 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.792985 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:19:32.793219 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.797779 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:19:32.799104 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:19:32.799653 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:19:32.799891 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:19:32.800956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9AB4A10>]}
[0m00:19:32.801316 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:32.801522 [debug] [MainThread]: On master: BEGIN
[0m00:19:32.801704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:32.802148 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:32.802361 [debug] [MainThread]: On master: COMMIT
[0m00:19:32.802558 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:32.802744 [debug] [MainThread]: On master: COMMIT
[0m00:19:32.803116 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:32.803465 [debug] [MainThread]: On master: Close
[0m00:19:32.806201 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.806618 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:19:32.807501 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:19:32.807912 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.813835 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.814745 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.841739 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.842855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.843336 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:19:32.843684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:32.844534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.844915 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.845174 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:19:32.846126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.851912 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.852382 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:19:32.853237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.856765 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.857270 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:19:32.858173 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.872441 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:19:32.872955 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.873385 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:19:32.877971 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:19:32.883559 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.884025 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:19:32.887314 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.890140 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:19:32.892909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA95C7F50>]}
[0m00:19:32.893705 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.08s]
[0m00:19:32.894988 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.895777 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.896625 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:19:32.897447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:19:32.897957 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.902066 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.903629 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.906878 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.908116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.908482 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:19:32.908730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:32.909638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.909926 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.910179 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:19:32.910875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.912948 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.913304 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:19:32.913987 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.917051 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.917479 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:19:32.918167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.919258 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:19:32.919573 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.919816 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:19:32.922960 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.924837 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.925171 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:19:32.928021 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:19:32.929210 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:19:32.929670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9B201B0>]}
[0m00:19:32.930169 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:19:32.931075 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.931597 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.932208 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:19:32.933177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:19:32.933714 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.936241 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.937152 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.939761 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.940638 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.940981 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:19:32.941252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:32.941812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.942121 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.942370 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:19:32.943180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.945384 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.945677 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:19:32.946245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.949290 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.949810 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:19:32.950540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.951614 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:19:32.951908 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.952168 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:19:32.955458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.957612 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.957922 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:19:32.961134 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.962531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:19:32.963306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9B0C050>]}
[0m00:19:32.964270 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:19:32.965457 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.966019 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:19:32.966605 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:19:32.967387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:19:32.967693 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:19:32.970559 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.971552 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:19:32.974355 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.975244 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.975585 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:19:32.975844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:32.976434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.976701 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.976947 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:19:32.977714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.981028 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.981652 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:19:32.982682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.985633 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.985995 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:19:32.986642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.987660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:19:32.987947 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.988189 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:19:32.991193 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.993942 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.994446 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:19:32.997775 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.999291 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:19:32.999904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA994AC50>]}
[0m00:19:33.000556 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:19:33.001622 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:19:33.002568 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.002987 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:19:33.003651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:19:33.003970 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.006258 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.007299 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.009475 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.010310 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.010798 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:19:33.011388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:33.012154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:33.012443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.012713 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:19:33.014330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:33.019485 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.019862 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:19:33.020556 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:33.022503 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.022792 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:19:33.023438 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:33.024455 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:19:33.024771 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.025035 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:19:33.028235 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:33.030076 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.030450 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:19:33.033417 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:19:33.035031 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:19:33.035544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9B94C20>]}
[0m00:19:33.036056 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:19:33.036969 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.037890 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.038280 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:19:33.038962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:19:33.039311 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.118639 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.120077 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.144342 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.145904 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.146497 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:19:33.146857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:33.147493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:33.147808 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.148145 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:19:33.151538 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:19:33.152072 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:19:33.152529 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:19:33.158889 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:19:33.159350 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:19:33.164345 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 20:   group by campaign_id, date(interaction_timestamp)
                                        ^
[0m00:19:33.164959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9ABF650>]}
[0m00:19:33.165762 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.13s]
[0m00:19:33.166998 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.167679 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 20:   group by campaign_id, date(interaction_timestamp)
                                        ^.
[0m00:19:33.169843 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:33.170339 [debug] [MainThread]: On master: BEGIN
[0m00:19:33.170653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:33.171300 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:19:33.171743 [debug] [MainThread]: On master: COMMIT
[0m00:19:33.171998 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:33.172233 [debug] [MainThread]: On master: COMMIT
[0m00:19:33.172747 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:33.173053 [debug] [MainThread]: On master: Close
[0m00:19:33.173533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:33.173772 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:19:33.173971 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:19:33.174164 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:19:33.174480 [info ] [MainThread]: 
[0m00:19:33.175042 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:19:33.176691 [debug] [MainThread]: Command end result
[0m00:19:33.194417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:19:33.196886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:19:33.204007 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:19:33.204571 [info ] [MainThread]: 
[0m00:19:33.205007 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:19:33.205391 [info ] [MainThread]: 
[0m00:19:33.205789 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 20:   group by campaign_id, date(interaction_timestamp)
                                        ^
[0m00:19:33.206146 [info ] [MainThread]: 
[0m00:19:33.206447 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:19:33.207125 [debug] [MainThread]: Command `dbt run` failed at 00:19:33.207022 after 1.38 seconds
[0m00:19:33.207442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA8010F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7596750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9BB8170>]}
[0m00:19:33.207739 [debug] [MainThread]: Flushing usage events
[0m00:19:34.674641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:18.151603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8DD6A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8ECF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EEE7ED0>]}


============================== 00:21:18.155217 | a1a00333-fab1-496b-a4a8-1c638967da6e ==============================
[0m00:21:18.155217 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:21:18.156501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:18.319678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8E4210F0>]}
[0m00:21:18.371844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EDA7AC0>]}
[0m00:21:18.374820 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:21:18.523247 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:21:18.620433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:18.620887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:18.647645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EFB8850>]}
[0m00:21:18.699590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:18.701977 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:18.721821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8ED1F4D0>]}
[0m00:21:18.722326 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:21:18.723321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA904D4C90>]}
[0m00:21:18.725139 [info ] [MainThread]: 
[0m00:21:18.725733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:18.726326 [info ] [MainThread]: 
[0m00:21:18.727027 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:21:18.731608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:21:18.787041 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:18.787444 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:18.787689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:18.806336 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:21:18.807611 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:18.809540 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:18.809905 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:18.810172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.811125 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.812214 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:18.813833 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:18.814288 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:18.814593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.815986 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.817845 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:18.818903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:21:18.819482 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:21:18.825284 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.825637 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:18.825959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.826821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.827946 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.828203 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:21:18.828610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.828839 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.829061 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:21:18.829467 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.830158 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:18.830405 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.830624 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:18.830982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.831207 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:21:18.831639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:21:18.832009 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:21:18.833702 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.834063 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:18.834315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.835519 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.836714 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.837016 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:21:18.837499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.837769 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.837990 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:21:18.838444 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.839172 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:18.839420 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.839619 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:18.840040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.840343 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:21:18.840788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:21:18.841179 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:21:18.842566 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.842850 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:18.843094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.843934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.845076 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.845331 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:21:18.845744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.845990 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.846217 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:21:18.846634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.847399 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:18.847614 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.847808 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:18.848218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.848512 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:21:18.850415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m00:21:18.855061 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:18.855363 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:21:18.855581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:18.856281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.856542 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:18.856759 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.868603 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:21:18.869844 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:21:18.870879 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:21:18.871145 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:21:18.871582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:21:18.873179 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:18.874442 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:21:18.874771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.875534 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.875944 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:18.876215 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.879455 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:18.880558 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:21:18.881096 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:21:18.881333 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:21:18.881739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m00:21:18.883347 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:18.883624 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:21:18.883861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.884358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.884575 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:18.884771 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.887753 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:18.888875 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:21:18.889378 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:21:18.889610 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:21:18.890022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m00:21:18.891599 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:18.891897 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:21:18.892150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.892650 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.893012 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:18.893250 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.896408 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:18.897624 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:21:18.898161 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:21:18.898405 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:21:18.899488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA908C0AE0>]}
[0m00:21:18.899907 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:18.900151 [debug] [MainThread]: On master: BEGIN
[0m00:21:18.900361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:21:18.900852 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:18.901100 [debug] [MainThread]: On master: COMMIT
[0m00:21:18.901458 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:18.901692 [debug] [MainThread]: On master: COMMIT
[0m00:21:18.902106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:18.902372 [debug] [MainThread]: On master: Close
[0m00:21:18.904522 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.905039 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:21:18.905772 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:21:18.906095 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.913060 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.914065 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.940957 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.942084 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.942466 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:21:18.942712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:18.943295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:18.943577 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.943824 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:21:18.944647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:18.950123 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.950481 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:21:18.951121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.953505 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.953851 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:21:18.954435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.963969 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:18.964335 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.964591 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:18.968826 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:21:18.972753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.973108 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:21:18.976435 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:18.978746 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:21:18.980835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA903D7F50>]}
[0m00:21:18.981397 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:21:18.982309 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.982622 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:18.982989 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:21:18.983664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:21:18.984018 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:21:18.986358 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.987185 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:21:18.989449 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.990679 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.991034 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:21:18.991296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:18.991848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:18.992116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.992364 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:21:18.993101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.995509 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.995942 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:21:18.996621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.999683 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:19.000039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:21:19.000660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.001678 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:19.001970 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:19.002214 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:19.005436 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.007367 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:19.007681 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:21:19.010509 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:21:19.011844 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:21:19.012405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9092C1B0>]}
[0m00:21:19.013039 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:21:19.013971 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:19.014443 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.014905 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:21:19.015668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:21:19.016039 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.017921 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.018752 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.021671 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.022672 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.023039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:21:19.023318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.023880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.024174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.024418 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:21:19.025127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.027256 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.027589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:21:19.028287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.031222 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.031655 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:21:19.032424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.033573 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:19.033899 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.034161 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:19.037624 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.039617 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.039926 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:21:19.042856 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.044362 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:21:19.044967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90918050>]}
[0m00:21:19.045587 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:21:19.046414 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.046817 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.047407 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:21:19.048283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:21:19.048716 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.050835 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.051600 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.054403 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.055337 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.055702 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:21:19.056005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.056553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.056830 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.057083 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:21:19.057841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.060696 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.061028 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:21:19.061732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.064402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.064866 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:21:19.065597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.066689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:19.067001 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.067248 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:19.070426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.072440 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.072741 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:21:19.075871 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.077139 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:21:19.077568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90756C50>]}
[0m00:21:19.078109 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:21:19.079043 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.080272 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.080952 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:21:19.081768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:21:19.082143 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.084674 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.085709 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.087929 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.088809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.089126 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:21:19.089369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.089927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.090205 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.090466 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:21:19.091757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.096347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.096857 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:21:19.097945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.100502 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.100898 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:21:19.101544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.102649 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:19.102979 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.103256 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:19.109918 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:21:19.112212 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.112827 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:21:19.115940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.117271 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:21:19.117745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90977770>]}
[0m00:21:19.118228 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.04s]
[0m00:21:19.119458 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.120385 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.120750 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:21:19.121451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:21:19.121788 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.175303 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.176258 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.192823 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.193984 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.194412 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:21:19.194736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.195352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.195652 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.195999 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:21:19.199883 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:21:19.200270 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:21:19.200617 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:21:19.205805 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:21:19.206216 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:21:19.209273 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Values list "cv" does not have a column named "converted_customers"
  
  LINE 74:     co.total_cost / nullif(cv.converted_customers, 0) as cac,
                                      ^
[0m00:21:19.209690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA907FACF0>]}
[0m00:21:19.210180 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:21:19.211621 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.212248 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Values list "cv" does not have a column named "converted_customers"
  
  LINE 74:     co.total_cost / nullif(cv.converted_customers, 0) as cac,
                                      ^.
[0m00:21:19.214092 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:19.214370 [debug] [MainThread]: On master: BEGIN
[0m00:21:19.214578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:21:19.215057 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:19.215355 [debug] [MainThread]: On master: COMMIT
[0m00:21:19.215622 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:19.215852 [debug] [MainThread]: On master: COMMIT
[0m00:21:19.216269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:19.216514 [debug] [MainThread]: On master: Close
[0m00:21:19.216818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:19.217004 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:21:19.217178 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:21:19.217333 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:21:19.217604 [info ] [MainThread]: 
[0m00:21:19.218175 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:21:19.219744 [debug] [MainThread]: Command end result
[0m00:21:19.237146 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:19.239154 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:19.245121 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:21:19.245706 [info ] [MainThread]: 
[0m00:21:19.246731 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:21:19.247553 [info ] [MainThread]: 
[0m00:21:19.248389 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Values list "cv" does not have a column named "converted_customers"
  
  LINE 74:     co.total_cost / nullif(cv.converted_customers, 0) as cac,
                                      ^
[0m00:21:19.249553 [info ] [MainThread]: 
[0m00:21:19.250259 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:21:19.251105 [debug] [MainThread]: Command `dbt run` failed at 00:21:19.250980 after 1.27 seconds
[0m00:21:19.251392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9007E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9092FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9092F9B0>]}
[0m00:21:19.251657 [debug] [MainThread]: Flushing usage events
[0m00:21:20.671514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:37.672424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F935ACA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936A47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936C37ED0>]}


============================== 00:21:37.675740 | 0a09640d-18cb-4600-8cee-6e562bb8341a ==============================
[0m00:21:37.675740 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:21:37.676499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:37.837915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9361790F0>]}
[0m00:21:37.890375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936AF7AC0>]}
[0m00:21:37.893247 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:21:38.038526 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:21:38.142483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:38.143021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:38.173105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936D08850>]}
[0m00:21:38.228666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:38.230783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:38.248358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936A6F4D0>]}
[0m00:21:38.248846 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:21:38.249470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938260C90>]}
[0m00:21:38.251129 [info ] [MainThread]: 
[0m00:21:38.251625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:38.252163 [info ] [MainThread]: 
[0m00:21:38.252960 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:21:38.257707 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:21:38.313032 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:38.313480 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:38.313736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:38.343293 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m00:21:38.344620 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:38.346280 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:38.346588 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:38.346836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.347729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.348905 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:38.350565 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:38.350860 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:38.351176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.351966 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.352926 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:38.353727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:21:38.354126 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:21:38.360003 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.360328 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:38.360553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.361395 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.362434 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.362664 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:21:38.363149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.363447 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.363647 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:21:38.364040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.364726 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:38.364958 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.365162 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:38.365497 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.365724 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:21:38.366364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m00:21:38.366710 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:21:38.367884 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.368120 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:38.368334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.368980 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.369939 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.370189 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:21:38.370545 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.370771 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.370972 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:21:38.371338 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.371968 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:38.372203 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.372389 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:38.372712 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.373031 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:21:38.373479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m00:21:38.373820 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:21:38.375135 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.375369 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:38.375567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.376402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.377357 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.377584 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:21:38.377948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.378188 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.378371 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:21:38.378769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.379432 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:38.379672 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.380027 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:38.380426 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.380642 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:21:38.382473 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m00:21:38.387307 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:38.387679 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:21:38.387959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:38.388629 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.388890 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:38.389106 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.404556 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:21:38.405680 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:21:38.406842 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:21:38.407125 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:21:38.407618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m00:21:38.408899 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:38.409153 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:21:38.409370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.409874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.410081 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:38.410308 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.413179 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:38.414343 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:21:38.414842 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:21:38.415067 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:21:38.415451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m00:21:38.416783 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:38.417023 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:21:38.417223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.418281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.418526 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:38.418734 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.421339 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:21:38.422366 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:21:38.422924 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:21:38.423161 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:21:38.423855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m00:21:38.425414 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:38.425673 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:21:38.426007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.426483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.426692 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:38.426882 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.429542 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:21:38.430504 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:21:38.430963 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:21:38.431173 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:21:38.431953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938650940>]}
[0m00:21:38.432313 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.432523 [debug] [MainThread]: On master: BEGIN
[0m00:21:38.432717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:21:38.433130 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.433398 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.433639 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.433879 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.434242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.434489 [debug] [MainThread]: On master: Close
[0m00:21:38.437399 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.437822 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:21:38.438631 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:21:38.439013 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.445121 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.446297 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.472601 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.474038 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.474567 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:21:38.474901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:38.475529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.475853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.476281 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:21:38.477366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.482154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.482470 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:21:38.483089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.485450 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.485741 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:21:38.486388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.495942 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:38.496374 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.496640 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:38.501120 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:21:38.505087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.505426 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:21:38.508449 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.510486 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:21:38.512416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938167F50>]}
[0m00:21:38.512968 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:21:38.513771 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.514113 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.514486 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:21:38.515174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:21:38.515523 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.517905 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.518744 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.521184 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.522089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.522434 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:21:38.522690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.523276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.523584 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.523817 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:21:38.524632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.527604 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.528112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:21:38.528774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.531166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.531449 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:21:38.532022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.533039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:38.533408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.533709 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:38.536786 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.538460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.538719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:21:38.541700 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.543432 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:21:38.544297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9386BC1B0>]}
[0m00:21:38.544819 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:21:38.545664 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.546124 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.546537 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:21:38.547234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:21:38.547573 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.549534 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.550421 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.553237 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.554175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.554529 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:21:38.554798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.555368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.555631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.555888 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:21:38.556622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.559026 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.559507 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:21:38.560353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.562757 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.563110 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:21:38.563844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.564831 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:38.565115 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.565355 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:38.568952 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.570911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.571190 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:21:38.573964 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:21:38.575278 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:21:38.575843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9386A80F0>]}
[0m00:21:38.576477 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:21:38.577538 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.578029 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.578882 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:21:38.579677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:21:38.579995 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.581941 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.582707 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.585173 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.586015 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.586375 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:21:38.586620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.587170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.587426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.587663 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:21:38.588408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.590493 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.590835 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:21:38.591596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.594370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.594736 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:21:38.595409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.596454 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:38.596744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.596980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:38.600190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.602255 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.602573 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:21:38.605674 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.606994 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:21:38.607447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9384E6C50>]}
[0m00:21:38.608038 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:21:38.608930 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.609857 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.610486 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:21:38.611562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:21:38.611973 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.614638 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.615613 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.617870 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.618883 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.619215 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:21:38.619452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.620036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.620301 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.620545 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:21:38.621824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.626446 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.626990 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:21:38.628061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.630559 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.630876 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:21:38.631489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.632453 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:38.632732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.632992 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:38.636219 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.637854 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.638145 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:21:38.641453 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.642915 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:21:38.643625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938700C20>]}
[0m00:21:38.644441 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:21:38.645537 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.646404 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.646800 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:21:38.647504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:21:38.647832 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.699846 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.700768 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.717875 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.718859 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.719253 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:21:38.719526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.720077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.720464 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.720773 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:21:38.752200 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m00:21:38.754658 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.754992 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m00:21:38.756840 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:21:38.760677 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:21:38.760989 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.761237 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:21:38.766210 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:21:38.767976 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.768462 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m00:21:38.769255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.770399 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:21:38.770863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F937E4B350>]}
[0m00:21:38.771333 [info ] [Thread-1 (]: 6 of 6 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.12s]
[0m00:21:38.772110 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.773618 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.773999 [debug] [MainThread]: On master: BEGIN
[0m00:21:38.774265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:21:38.774776 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.775025 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.775228 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.775431 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.775806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.776045 [debug] [MainThread]: On master: Close
[0m00:21:38.776352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:38.776532 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m00:21:38.776702 [debug] [MainThread]: Connection 'list_ae_exam_db_report' was properly closed.
[0m00:21:38.776855 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:21:38.777124 [info ] [MainThread]: 
[0m00:21:38.777705 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m00:21:38.779033 [debug] [MainThread]: Command end result
[0m00:21:38.796075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:38.798121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:38.803811 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:21:38.804212 [info ] [MainThread]: 
[0m00:21:38.804807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:21:38.805374 [info ] [MainThread]: 
[0m00:21:38.806046 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:21:38.806836 [debug] [MainThread]: Command `dbt run` succeeded at 00:21:38.806684 after 1.27 seconds
[0m00:21:38.807154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936785A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93872BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93872B830>]}
[0m00:21:38.807572 [debug] [MainThread]: Flushing usage events
[0m00:21:41.692290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:49.013616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A548BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A55837890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A55A27ED0>]}


============================== 00:23:49.017011 | 48643ea4-b647-4c57-a05f-34233aa9502f ==============================
[0m00:23:49.017011 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:23:49.018280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:23:49.178266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A54F610F0>]}
[0m00:23:49.228719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A558E7AC0>]}
[0m00:23:49.231556 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:23:49.368284 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:23:49.464080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:49.464438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:49.491323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A55AF8850>]}
[0m00:23:49.549182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:23:49.551108 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:23:49.568692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5585F4D0>]}
[0m00:23:49.569304 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:23:49.569982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56FE4AD0>]}
[0m00:23:49.571731 [info ] [MainThread]: 
[0m00:23:49.572259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:49.572888 [info ] [MainThread]: 
[0m00:23:49.573698 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:23:49.578071 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:23:49.636450 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.636999 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.637373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:49.658968 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:23:49.660414 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.662243 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.662586 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.662875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.663772 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.664814 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.666323 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.666661 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.666994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.667938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.668886 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.671082 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.671425 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.671694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.672829 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.674226 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.675020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m00:23:49.675635 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m00:23:49.681236 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.681601 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.681846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.683035 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.685296 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.685594 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m00:23:49.686041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.686313 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.686538 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m00:23:49.687010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.687699 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:49.687936 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.688147 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:49.694276 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m00:23:49.694632 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m00:23:49.695174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_mart)
[0m00:23:49.695533 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:23:49.696716 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.696978 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.697190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.697893 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.698890 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.699513 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:23:49.700000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.700339 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.700586 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:23:49.700989 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.701660 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:49.701973 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.702185 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:49.702530 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.702757 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:23:49.703320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:23:49.703682 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:23:49.705187 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.705427 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.705639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.706324 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.707382 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.707616 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:23:49.708010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.708234 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.708445 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:23:49.708819 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.709469 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:49.709682 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.709955 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:49.710319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.710569 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:23:49.711015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:23:49.711331 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:23:49.712584 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.712831 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.713154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.713852 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.714805 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.715041 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:23:49.715391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.715628 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.715828 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:23:49.716198 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.716831 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:49.717050 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.717234 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:49.717563 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.717792 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:23:49.719470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:23:49.723934 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:49.724233 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:23:49.724461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:49.725023 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.725255 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:49.725473 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.736524 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m00:23:49.738029 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:23:49.739129 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:23:49.739397 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:23:49.739890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:23:49.741138 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:49.741386 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:23:49.741591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.742220 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.742448 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:49.742661 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.745411 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:49.746453 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:23:49.746951 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:23:49.747180 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:23:49.747562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:23:49.748738 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:49.749064 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:23:49.749256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.750005 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.750253 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:49.750462 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.753178 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:49.754228 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:23:49.754795 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:23:49.755010 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:23:49.755413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m00:23:49.757034 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:49.757314 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:23:49.757549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.758249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.758465 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:49.758676 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.761502 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:23:49.762715 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:23:49.763216 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:23:49.763445 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:23:49.765304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A573D8600>]}
[0m00:23:49.765687 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:49.765909 [debug] [MainThread]: On master: BEGIN
[0m00:23:49.766103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:49.766522 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:49.766747 [debug] [MainThread]: On master: COMMIT
[0m00:23:49.766946 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:49.767132 [debug] [MainThread]: On master: COMMIT
[0m00:23:49.767462 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:49.767690 [debug] [MainThread]: On master: Close
[0m00:23:49.770001 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.770546 [info ] [Thread-1 (]: 1 of 7 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:23:49.771257 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:23:49.771654 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.777139 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.777949 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.805516 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.806532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.806910 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:23:49.807160 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:23:49.807708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.807986 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.808228 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:23:49.809042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.813896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.814232 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:23:49.814840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.816980 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.817335 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:23:49.817997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.827771 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:49.828201 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.828475 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:49.832105 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.836300 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.836648 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:23:49.839732 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.841893 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:23:49.843899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56EE5B50>]}
[0m00:23:49.844572 [info ] [Thread-1 (]: 1 of 7 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:23:49.845841 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.846178 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.846708 [info ] [Thread-1 (]: 2 of 7 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:23:49.847431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:23:49.847715 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.849849 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.850799 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.853946 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.854902 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.855293 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:23:49.855547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.856114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.856384 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.856625 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:23:49.857377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.859454 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.859727 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:23:49.860328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.862307 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.862588 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:23:49.863119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.864432 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:49.864801 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.865079 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:49.868241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.870507 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.870854 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:23:49.873883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.875072 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:23:49.875497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57450050>]}
[0m00:23:49.875965 [info ] [Thread-1 (]: 2 of 7 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:23:49.876795 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.877123 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.877492 [info ] [Thread-1 (]: 3 of 7 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:23:49.878221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:23:49.878534 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.880713 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.881644 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.884456 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.885791 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.886279 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:23:49.886541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.887090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.887358 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.887610 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:23:49.888322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.890476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.890764 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:23:49.891296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.893289 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.893603 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:23:49.894151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.895124 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:23:49.895400 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.895698 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:23:49.898887 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.901171 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.901637 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:23:49.904898 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.906069 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:23:49.906476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57411590>]}
[0m00:23:49.906920 [info ] [Thread-1 (]: 3 of 7 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:23:49.907771 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.908100 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.908433 [info ] [Thread-1 (]: 4 of 7 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:23:49.909197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:23:49.909465 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.911483 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.912332 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.914548 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.915342 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.915657 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:23:49.915896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.916442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.916727 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.916974 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:23:49.917886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.921275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.921704 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:23:49.922430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.924548 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.924848 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:23:49.925448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.926555 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:23:49.927044 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.927320 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:23:49.930586 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.932402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.932686 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:23:49.935588 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:23:49.938695 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:23:49.939170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A572658D0>]}
[0m00:23:49.939670 [info ] [Thread-1 (]: 4 of 7 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:23:49.940541 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.941397 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:49.941925 [info ] [Thread-1 (]: 5 of 7 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:23:49.942546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:23:49.942874 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:49.945160 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.946080 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:49.948344 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.949269 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.949604 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:23:49.949849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.950456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.950786 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.951183 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:23:49.953561 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:23:50.005535 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.005930 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:23:50.006604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.008605 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.008889 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:23:50.009464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.010487 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:23:50.010771 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.011023 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:23:50.014508 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:50.016753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.017551 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:23:50.021031 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:50.022369 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:23:50.022831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57403E00>]}
[0m00:23:50.023355 [info ] [Thread-1 (]: 5 of 7 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.08s]
[0m00:23:50.024093 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:50.024731 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.025127 [info ] [Thread-1 (]: 6 of 7 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:23:50.025669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:23:50.026004 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.029561 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.030563 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.047103 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.048121 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.048478 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:23:50.048729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:50.049318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:50.049581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.049958 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:23:50.079572 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m00:23:50.082132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.082643 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m00:23:50.083451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.086261 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.086594 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m00:23:50.087238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.091137 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:23:50.091481 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.091732 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:23:50.097016 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:23:50.099237 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.099559 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m00:23:50.102576 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:50.103858 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:23:50.104312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56BED850>]}
[0m00:23:50.104783 [info ] [Thread-1 (]: 6 of 7 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.08s]
[0m00:23:50.105570 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.106288 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.106664 [info ] [Thread-1 (]: 7 of 7 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m00:23:50.107338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m00:23:50.107680 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.109806 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.111310 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.113767 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.115855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.116470 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m00:23:50.117148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:50.117866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:50.118235 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.118526 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc;
    );
  
  
[0m00:23:50.119341 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc;
    );
  
  
[0m00:23:50.119694 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:23:50.120201 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: ROLLBACK
[0m00:23:50.125516 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.report_campaign_effectiveness'
[0m00:23:50.125847 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m00:23:50.128728 [debug] [Thread-1 (]: Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Parser Error: syntax error at or near ";"
[0m00:23:50.129207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57451C70>]}
[0m00:23:50.129886 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model report.report_campaign_effectiveness ..... [[31mERROR[0m in 0.02s]
[0m00:23:50.130636 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.131119 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.report_campaign_effectiveness' to be skipped because of status 'error'.  Reason: Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Parser Error: syntax error at or near ";".
[0m00:23:50.132696 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:50.132948 [debug] [MainThread]: On master: BEGIN
[0m00:23:50.133161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:50.133700 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:50.133986 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.134276 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:50.134496 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.134933 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:50.135250 [debug] [MainThread]: On master: Close
[0m00:23:50.135713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:50.135942 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m00:23:50.136177 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m00:23:50.136359 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m00:23:50.136657 [info ] [MainThread]: 
[0m00:23:50.137256 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:23:50.139274 [debug] [MainThread]: Command end result
[0m00:23:50.158386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:23:50.160909 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:23:50.166338 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:23:50.166715 [info ] [MainThread]: 
[0m00:23:50.167397 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:23:50.167885 [info ] [MainThread]: 
[0m00:23:50.168478 [error] [MainThread]:   Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Parser Error: syntax error at or near ";"
[0m00:23:50.169008 [info ] [MainThread]: 
[0m00:23:50.169526 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m00:23:50.170529 [debug] [MainThread]: Command `dbt run` failed at 00:23:50.170374 after 1.30 seconds
[0m00:23:50.170923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A555D1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A54E42990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56BECE90>]}
[0m00:23:50.171273 [debug] [MainThread]: Flushing usage events
[0m00:23:51.599632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:59.114350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E0A3A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E19C7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1BB7ED0>]}


============================== 00:23:59.117600 | 20335673-f2f7-4480-9c07-4164b857c457 ==============================
[0m00:23:59.117600 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:23:59.118838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:59.278879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E10F10F0>]}
[0m00:23:59.329569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1A73AC0>]}
[0m00:23:59.332472 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:23:59.481375 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:23:59.578293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:59.578639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:59.605251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1C88850>]}
[0m00:23:59.658395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:23:59.660504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:23:59.692206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E19EF4D0>]}
[0m00:23:59.692705 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:23:59.693228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E31A4AD0>]}
[0m00:23:59.694887 [info ] [MainThread]: 
[0m00:23:59.695516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:59.696072 [info ] [MainThread]: 
[0m00:23:59.696857 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:23:59.701353 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:23:59.757169 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.757708 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.758067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:59.789225 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m00:23:59.790559 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.792283 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.792563 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.792790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.793647 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.794596 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.795962 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.796213 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.796423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.797143 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.798054 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.800102 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.800463 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.800697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.801468 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.802591 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.803251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m00:23:59.803619 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m00:23:59.808353 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.808625 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.808913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.809685 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.810892 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.811123 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m00:23:59.811524 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.811883 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.812101 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m00:23:59.812492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.813365 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:59.813620 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.813824 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:59.814181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.814401 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m00:23:59.814812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m00:23:59.815177 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:23:59.816568 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.816815 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.817022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.817717 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.818670 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.818902 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:23:59.819304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.819516 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.819852 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:23:59.820250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.820972 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:59.821185 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.821379 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:59.821879 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.822141 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:23:59.822534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:23:59.822849 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:23:59.824421 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.824677 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.824904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.825585 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.826546 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.826776 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:23:59.827129 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.827353 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.827549 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:23:59.827897 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.828538 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:59.828762 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.828965 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:59.829619 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.829939 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:23:59.830468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:23:59.830869 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:23:59.832551 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.832932 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.833380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.834382 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.835544 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.835794 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:23:59.836189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.836412 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.836604 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:23:59.836975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.837634 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:59.837872 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.838085 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:59.838437 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.838686 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:23:59.841187 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:23:59.846258 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:59.846599 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:23:59.846823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:59.847379 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.847622 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:59.847831 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.859390 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m00:23:59.861152 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:23:59.862230 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:23:59.862502 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:23:59.862927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:23:59.864229 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:59.864477 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:23:59.864685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.865175 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.865394 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:59.865604 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.868257 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:59.869308 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:23:59.869853 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:23:59.870104 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:23:59.870520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:23:59.871714 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:59.872628 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:23:59.872865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.873310 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.873533 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:59.873728 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.876401 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:59.877447 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:23:59.877890 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:23:59.878126 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:23:59.878604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:23:59.880253 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:59.880940 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:23:59.881171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.881614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.882000 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:59.882205 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.884934 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:59.885978 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:23:59.886444 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:23:59.886668 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:23:59.887698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E3598600>]}
[0m00:23:59.888047 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:59.888254 [debug] [MainThread]: On master: BEGIN
[0m00:23:59.888435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:59.888833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:59.889048 [debug] [MainThread]: On master: COMMIT
[0m00:23:59.889291 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:59.889507 [debug] [MainThread]: On master: COMMIT
[0m00:23:59.889827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:59.890071 [debug] [MainThread]: On master: Close
[0m00:23:59.892975 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.893471 [info ] [Thread-1 (]: 1 of 7 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:23:59.894288 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:23:59.894624 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.900185 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.901064 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.930780 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.931749 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.932302 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:23:59.932649 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:23:59.933212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:59.933476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.933719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:23:59.934495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.939372 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.939706 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:23:59.940367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.942434 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.942718 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:23:59.943277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.953147 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:59.953607 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.953875 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:59.958320 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:23:59.962352 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.962693 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:23:59.965854 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:59.968288 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:23:59.970552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E300BC50>]}
[0m00:23:59.971190 [info ] [Thread-1 (]: 1 of 7 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:23:59.972232 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.972551 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:23:59.972952 [info ] [Thread-1 (]: 2 of 7 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:23:59.973706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:23:59.974025 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:23:59.975996 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.976962 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:23:59.979531 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.980423 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.980777 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:23:59.981027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:59.981567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:59.981832 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.982106 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:23:59.982837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.984985 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.985317 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:23:59.986002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.988619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.989052 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:23:59.989967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.991493 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:59.991911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.992313 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:59.995460 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:59.997189 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.997464 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:24:00.000213 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:24:00.002692 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:24:00.003476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E3610050>]}
[0m00:24:00.004512 [info ] [Thread-1 (]: 2 of 7 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:24:00.005719 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:24:00.006211 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.006920 [info ] [Thread-1 (]: 3 of 7 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:24:00.007964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:24:00.008372 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.010787 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.012135 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.015149 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.016444 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.017079 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:24:00.017641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.018588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.019083 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.019371 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:24:00.020187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.022517 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.022903 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:24:00.023601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.025816 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.026144 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:24:00.026765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.027797 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:24:00.028112 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.028360 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:24:00.031437 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.034895 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.035369 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:24:00.038476 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.039895 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:24:00.040443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E35DD4F0>]}
[0m00:24:00.040934 [info ] [Thread-1 (]: 3 of 7 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:24:00.041862 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.042225 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.042564 [info ] [Thread-1 (]: 4 of 7 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:24:00.043280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:24:00.043598 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.045512 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.046282 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.048818 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.049952 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.050472 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:24:00.050830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.051477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.051928 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.052358 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:24:00.053246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.055905 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.056228 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:24:00.056852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.058848 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.059125 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:24:00.059678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.060738 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:24:00.061025 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.061266 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:24:00.064509 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.066430 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.066778 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:24:00.069771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.072665 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:24:00.073145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E3425750>]}
[0m00:24:00.073741 [info ] [Thread-1 (]: 4 of 7 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:24:00.074601 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.075274 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.075666 [info ] [Thread-1 (]: 5 of 7 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:24:00.076466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:24:00.076864 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.079282 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.080191 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.082736 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.084090 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.084579 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:24:00.084907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.085681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.085971 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.086227 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:24:00.087473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.136976 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.137360 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:24:00.138001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.139992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.140305 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:24:00.140985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.142146 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:24:00.142443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.142693 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:24:00.146007 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.147726 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.148009 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:24:00.151035 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.152535 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:24:00.152969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E35A43D0>]}
[0m00:24:00.153542 [info ] [Thread-1 (]: 5 of 7 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.08s]
[0m00:24:00.154359 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.155178 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.155556 [info ] [Thread-1 (]: 6 of 7 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:24:00.156306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:24:00.156665 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.159887 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.160856 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.177433 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.178498 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.178913 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:24:00.179188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.179857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.180255 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.180573 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:24:00.208566 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m00:24:00.210896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.211216 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m00:24:00.211872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.213928 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.214227 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m00:24:00.214782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.219440 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:24:00.219925 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.220313 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:24:00.225593 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:24:00.227658 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.227942 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m00:24:00.230915 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.232282 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:24:00.232838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1DF0350>]}
[0m00:24:00.233437 [info ] [Thread-1 (]: 6 of 7 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.08s]
[0m00:24:00.234316 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.235231 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.235612 [info ] [Thread-1 (]: 7 of 7 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m00:24:00.236508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m00:24:00.237046 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.240179 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.241231 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.244600 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.245957 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.246549 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m00:24:00.247035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.248004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.248420 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.248717 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m00:24:00.252619 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.255515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.255914 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m00:24:00.256596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.257729 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m00:24:00.258050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.258328 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m00:24:00.262062 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.263885 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.264186 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m00:24:00.265093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.267095 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m00:24:00.267852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1D44050>]}
[0m00:24:00.268560 [info ] [Thread-1 (]: 7 of 7 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.03s]
[0m00:24:00.269503 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.270933 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:00.271297 [debug] [MainThread]: On master: BEGIN
[0m00:24:00.271542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:24:00.272188 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:24:00.272550 [debug] [MainThread]: On master: COMMIT
[0m00:24:00.272845 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:00.273104 [debug] [MainThread]: On master: COMMIT
[0m00:24:00.273602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:24:00.273881 [debug] [MainThread]: On master: Close
[0m00:24:00.274258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:00.274486 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:24:00.274706 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:24:00.274883 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m00:24:00.275218 [info ] [MainThread]: 
[0m00:24:00.275830 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m00:24:00.278067 [debug] [MainThread]: Command end result
[0m00:24:00.295099 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:24:00.296965 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:24:00.303617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:24:00.304015 [info ] [MainThread]: 
[0m00:24:00.304690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:24:00.305233 [info ] [MainThread]: 
[0m00:24:00.305760 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m00:24:00.306557 [debug] [MainThread]: Command `dbt run` succeeded at 00:24:00.306452 after 1.33 seconds
[0m00:24:00.306884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E2E58110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E175DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E346B1D0>]}
[0m00:24:00.307218 [debug] [MainThread]: Flushing usage events
[0m00:24:01.566748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:38.674015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF9E0E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAD7F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAAD5310>]}


============================== 14:32:38.680523 | 652a9f27-15b1-4bb8-95ba-964c7306b826 ==============================
[0m14:32:38.680523 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:32:38.681414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:32:38.844852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '652a9f27-15b1-4bb8-95ba-964c7306b826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFA4ACFC0>]}
[0m14:32:38.893482 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:32:38.896279 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:32:38.897630 [debug] [MainThread]: Command `cli deps` succeeded at 14:32:38.897407 after 0.49 seconds
[0m14:32:38.898168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAE3AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAE3A250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAFE5750>]}
[0m14:32:38.898743 [debug] [MainThread]: Flushing usage events
[0m14:32:40.383676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:20.359299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029503E6A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504DF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504FE7ED0>]}


============================== 15:02:20.365141 | 50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e ==============================
[0m15:02:20.365141 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:02:20.366503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:02:20.617319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295045210F0>]}
[0m15:02:20.694805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504EA7AC0>]}
[0m15:02:20.698750 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:02:21.118147 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:02:21.262136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:21.262651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:21.301328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295050B8850>]}
[0m15:02:21.380819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m15:02:21.407882 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m15:02:21.441917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504E1F4D0>]}
[0m15:02:21.442796 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m15:02:21.444233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506694AD0>]}
[0m15:02:21.447671 [info ] [MainThread]: 
[0m15:02:21.448954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:21.449999 [info ] [MainThread]: 
[0m15:02:21.451463 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:02:21.467479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m15:02:21.564975 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.565506 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.565848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:21.596067 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m15:02:21.598551 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.600739 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.601118 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.601432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.602646 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.604219 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.606478 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.606881 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.607207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.608313 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.609533 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.612243 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.612664 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.613080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.614394 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.615881 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.617073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m15:02:21.617613 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m15:02:21.624022 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.624474 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.624811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.625850 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.627282 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.627685 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m15:02:21.628377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.628721 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.629042 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m15:02:21.630153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.631113 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m15:02:21.631491 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.631823 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m15:02:21.632386 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.632757 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m15:02:21.633524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m15:02:21.634206 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m15:02:21.635890 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.636250 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.636599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.637843 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.639330 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.639649 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m15:02:21.640160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.640437 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.640707 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m15:02:21.641296 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.642303 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m15:02:21.642657 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.642976 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m15:02:21.643465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.643794 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m15:02:21.644636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m15:02:21.645243 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m15:02:21.647523 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.647915 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.648218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.649298 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.650821 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.651128 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m15:02:21.651585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.651945 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.652366 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m15:02:21.653257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.654566 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m15:02:21.654968 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.655250 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m15:02:21.655749 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.656060 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m15:02:21.656625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m15:02:21.657179 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m15:02:21.658915 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.659233 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.659507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.660429 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.662047 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.662393 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m15:02:21.662922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.663220 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.663482 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m15:02:21.664102 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.665133 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m15:02:21.665497 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.665811 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m15:02:21.666351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.666698 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m15:02:21.669450 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m15:02:21.675568 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m15:02:21.676275 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m15:02:21.676753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:21.677463 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.677848 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m15:02:21.678209 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.697684 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:02:21.700048 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m15:02:21.701369 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m15:02:21.701773 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m15:02:21.702320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m15:02:21.704032 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m15:02:21.704373 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m15:02:21.704681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.705897 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.706446 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m15:02:21.706776 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.711052 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:02:21.712740 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m15:02:21.713493 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m15:02:21.713908 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m15:02:21.715925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m15:02:21.718525 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m15:02:21.719142 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m15:02:21.719623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.720529 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.721055 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m15:02:21.721540 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.726741 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:02:21.728620 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m15:02:21.729321 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m15:02:21.729679 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m15:02:21.730298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m15:02:21.732686 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m15:02:21.733047 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m15:02:21.733351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.734910 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:02:21.735300 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m15:02:21.735657 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.739457 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:02:21.740919 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m15:02:21.741601 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m15:02:21.741928 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m15:02:21.743538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506A88EF0>]}
[0m15:02:21.744637 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:21.745590 [debug] [MainThread]: On master: BEGIN
[0m15:02:21.745990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:21.747023 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:02:21.747482 [debug] [MainThread]: On master: COMMIT
[0m15:02:21.747848 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:21.748175 [debug] [MainThread]: On master: COMMIT
[0m15:02:21.748765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:02:21.749194 [debug] [MainThread]: On master: Close
[0m15:02:21.753512 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.754418 [info ] [Thread-1 (]: 1 of 7 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m15:02:21.755500 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m15:02:21.755992 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.765344 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.768312 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.815041 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.818105 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.818628 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m15:02:21.819093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:21.819962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.820414 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.820774 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m15:02:21.821980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.830855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.831464 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m15:02:21.833243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.836540 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.837020 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m15:02:21.837806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:21.854715 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m15:02:21.855346 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.855776 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m15:02:21.861381 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:02:21.868269 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.868864 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m15:02:21.872883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:21.876660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m15:02:21.881566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506ADC050>]}
[0m15:02:21.882515 [info ] [Thread-1 (]: 1 of 7 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.12s]
[0m15:02:21.884805 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.885470 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.886125 [info ] [Thread-1 (]: 2 of 7 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m15:02:21.887159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m15:02:21.887704 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.891142 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.893388 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.898405 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.899979 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.900661 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m15:02:21.901133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:21.901977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.902464 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.902898 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m15:02:21.904294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.909327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.910596 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m15:02:21.912205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.916553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.917266 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m15:02:21.918736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.923870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m15:02:21.924641 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.925115 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m15:02:21.929609 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:02:21.934904 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.936091 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m15:02:21.939768 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:21.941937 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m15:02:21.942781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506B00050>]}
[0m15:02:21.943633 [info ] [Thread-1 (]: 2 of 7 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.06s]
[0m15:02:21.945490 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.947001 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m15:02:21.947988 [info ] [Thread-1 (]: 3 of 7 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m15:02:21.949606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m15:02:21.950191 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m15:02:21.953760 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.954993 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m15:02:21.958838 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.960956 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.962078 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m15:02:21.963517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:21.964905 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:02:21.965754 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.966764 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m15:02:21.968796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.973739 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.974506 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m15:02:21.975855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.982828 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.983419 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m15:02:21.984440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:21.986048 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m15:02:21.986490 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.986841 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m15:02:21.990334 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:21.993229 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.994108 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m15:02:21.999122 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:02:22.002036 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m15:02:22.002797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506AC94F0>]}
[0m15:02:22.003657 [info ] [Thread-1 (]: 3 of 7 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.05s]
[0m15:02:22.005059 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m15:02:22.005570 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.006164 [info ] [Thread-1 (]: 4 of 7 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m15:02:22.007170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m15:02:22.007778 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.011402 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.015059 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.018482 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.019744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.020366 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m15:02:22.020819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.021740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.022275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.022703 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m15:02:22.023877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.029356 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.030530 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m15:02:22.031838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.035609 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.036203 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m15:02:22.037078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:22.038577 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m15:02:22.038981 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.039337 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m15:02:22.043412 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.049364 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.050036 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m15:02:22.053978 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.058656 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m15:02:22.059428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506915250>]}
[0m15:02:22.060890 [info ] [Thread-1 (]: 4 of 7 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.05s]
[0m15:02:22.063179 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.065407 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.066336 [info ] [Thread-1 (]: 5 of 7 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m15:02:22.067466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m15:02:22.068248 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.071823 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.073155 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.079858 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.082818 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.083468 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m15:02:22.084023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.084961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.085444 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.085939 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m15:02:22.088138 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:02:22.160943 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.161749 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m15:02:22.163005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.166668 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.167116 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m15:02:22.167963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:22.169368 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m15:02:22.169790 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.170150 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m15:02:22.173613 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.176314 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.176790 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m15:02:22.180973 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.182456 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m15:02:22.183200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506AB4A60>]}
[0m15:02:22.184909 [info ] [Thread-1 (]: 5 of 7 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.12s]
[0m15:02:22.186920 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.188171 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.188889 [info ] [Thread-1 (]: 6 of 7 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m15:02:22.190163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m15:02:22.190860 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.195708 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.196907 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.229502 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.232454 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.233423 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m15:02:22.234208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.235249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.235797 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.236348 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m15:02:22.286872 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m15:02:22.289994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.290433 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m15:02:22.291986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.295755 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.296295 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m15:02:22.297421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.302805 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m15:02:22.303251 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.303605 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m15:02:22.309443 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:02:22.312555 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.313013 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m15:02:22.316972 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.318837 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m15:02:22.319420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950623C530>]}
[0m15:02:22.320063 [info ] [Thread-1 (]: 6 of 7 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.13s]
[0m15:02:22.322018 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.323292 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.324122 [info ] [Thread-1 (]: 7 of 7 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m15:02:22.325512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m15:02:22.327037 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.330336 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.332291 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.335917 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.337191 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.337795 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m15:02:22.338231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.338998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.339443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.339821 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m15:02:22.347098 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:02:22.351992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.353023 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m15:02:22.354419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.358610 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.359162 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m15:02:22.360151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:22.362345 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m15:02:22.363099 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.363723 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m15:02:22.369568 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:02:22.372058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.372687 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m15:02:22.379920 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:02:22.383563 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m15:02:22.384575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506278470>]}
[0m15:02:22.385489 [info ] [Thread-1 (]: 7 of 7 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.06s]
[0m15:02:22.386968 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.389242 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:22.389867 [debug] [MainThread]: On master: BEGIN
[0m15:02:22.390490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:22.392037 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:02:22.392729 [debug] [MainThread]: On master: COMMIT
[0m15:02:22.393221 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:22.394037 [debug] [MainThread]: On master: COMMIT
[0m15:02:22.395103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:02:22.395613 [debug] [MainThread]: On master: Close
[0m15:02:22.396240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:22.396668 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m15:02:22.397034 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m15:02:22.397446 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m15:02:22.398413 [info ] [MainThread]: 
[0m15:02:22.399408 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:02:22.402677 [debug] [MainThread]: Command end result
[0m15:02:22.452982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m15:02:22.455795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m15:02:22.466994 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m15:02:22.467700 [info ] [MainThread]: 
[0m15:02:22.468742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:22.469515 [info ] [MainThread]: 
[0m15:02:22.470305 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:02:22.471564 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:22.471364 after 2.32 seconds
[0m15:02:22.472025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504EEF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504488350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506B23AD0>]}
[0m15:02:22.472431 [debug] [MainThread]: Flushing usage events
[0m15:02:25.550095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:26.336136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C703AAA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704A27890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704C17ED0>]}


============================== 19:13:26.343667 | 502e799f-e176-4d6b-bb7a-232ce96ba40a ==============================
[0m19:13:26.343667 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:13:26.344989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:26.587241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7041510F0>]}
[0m19:13:26.652977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704AD3AC0>]}
[0m19:13:26.656805 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:13:27.004688 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:13:27.132274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:27.132670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:27.172607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704CE8850>]}
[0m19:13:27.257044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:13:27.272476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:13:27.298206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704A4F4D0>]}
[0m19:13:27.299038 [info ] [MainThread]: Found 8 models, 4 sources, 429 macros
[0m19:13:27.300384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7061F8AD0>]}
[0m19:13:27.304312 [info ] [MainThread]: 
[0m19:13:27.305076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:27.305691 [info ] [MainThread]: 
[0m19:13:27.306527 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:13:27.313326 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:13:27.411387 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.411902 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.412251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:27.441029 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m19:13:27.442974 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.445188 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.445576 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.446242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.447370 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.448698 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.450417 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.450740 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.451059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.452063 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.453320 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.455466 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.455939 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.456439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.457911 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.459414 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.460580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m19:13:27.461652 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m19:13:27.467881 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.468228 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.468579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.469548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.470863 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.471147 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m19:13:27.471637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.471999 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.472345 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m19:13:27.474908 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:13:27.476120 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:13:27.476652 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.477061 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:13:27.477735 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.478186 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m19:13:27.478893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m19:13:27.479455 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:13:27.481462 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.481881 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.482249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.483382 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.485065 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.485471 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:13:27.486751 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.487202 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.487572 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:13:27.488278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.489793 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:13:27.490255 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.490601 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:13:27.491257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.492026 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:13:27.493315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m19:13:27.493966 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m19:13:27.496659 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.497176 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.497585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.498827 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.500947 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.501407 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m19:13:27.502061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.502448 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.502786 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m19:13:27.503493 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.505840 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:13:27.506678 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.507313 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:13:27.508401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.509322 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m19:13:27.510537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m19:13:27.511128 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m19:13:27.512898 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.513223 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.513515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.514556 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.515935 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.516230 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m19:13:27.516702 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.517183 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.517776 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m19:13:27.519160 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.520108 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:13:27.520413 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.520657 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:13:27.521090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.521465 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m19:13:27.524176 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m19:13:27.530322 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:13:27.530701 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m19:13:27.530975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:27.532295 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.532705 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:13:27.533023 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.559980 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:13:27.563817 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m19:13:27.565947 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m19:13:27.566633 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m19:13:27.567701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m19:13:27.570582 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:13:27.571025 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:13:27.571398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.572701 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.573086 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:13:27.573377 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.577442 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:13:27.579947 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:13:27.580743 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:13:27.581074 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:13:27.581593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m19:13:27.583232 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:13:27.583540 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m19:13:27.583847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.585438 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:13:27.585808 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:13:27.586116 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.591158 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:13:27.593101 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m19:13:27.593908 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m19:13:27.594260 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m19:13:27.594841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m19:13:27.597150 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:13:27.597512 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m19:13:27.597823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.599030 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.599458 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:13:27.599777 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.603725 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:13:27.605253 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m19:13:27.605813 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m19:13:27.606098 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m19:13:27.607838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7065ECEF0>]}
[0m19:13:27.608383 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:27.608733 [debug] [MainThread]: On master: BEGIN
[0m19:13:27.609036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:27.610147 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:13:27.610543 [debug] [MainThread]: On master: COMMIT
[0m19:13:27.610885 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:27.611162 [debug] [MainThread]: On master: COMMIT
[0m19:13:27.611639 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:13:27.612013 [debug] [MainThread]: On master: Close
[0m19:13:27.617264 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.617912 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:13:27.619240 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:13:27.619883 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.627908 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.631087 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.672306 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.675015 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.675623 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:13:27.676362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:27.677353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.677799 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.678226 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m19:13:27.680028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.686661 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.687145 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:13:27.688873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.691971 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.692490 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:13:27.693752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.706305 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:13:27.706797 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.707243 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:13:27.714740 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:13:27.720409 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.720804 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:13:27.725415 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:13:27.728282 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:13:27.731094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C706644050>]}
[0m19:13:27.731921 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.11s]
[0m19:13:27.733153 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.733732 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.734706 [info ] [Thread-1 (]: 2 of 8 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m19:13:27.735642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m19:13:27.736066 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.738707 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.740091 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.744173 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.746042 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.746804 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m19:13:27.747406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.748796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.749634 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.750321 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m19:13:27.752149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.759402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.761150 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m19:13:27.763648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.770009 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.771094 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m19:13:27.772563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.775047 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:13:27.775619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.776263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:13:27.780294 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.783827 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.784259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m19:13:27.787435 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.790483 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m19:13:27.791604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C706660050>]}
[0m19:13:27.792893 [info ] [Thread-1 (]: 2 of 8 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.06s]
[0m19:13:27.794384 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.795017 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.796059 [info ] [Thread-1 (]: 3 of 8 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m19:13:27.796987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m19:13:27.797518 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.801013 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.802992 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.809529 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.812453 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.814238 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m19:13:27.815779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.817223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:13:27.817785 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.818223 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m19:13:27.819612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.824285 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.824795 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m19:13:27.825931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.833996 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.834973 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m19:13:27.836324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.838362 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:13:27.839007 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.839559 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:13:27.843436 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.848288 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.848808 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m19:13:27.852283 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.853864 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m19:13:27.854695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70662D590>]}
[0m19:13:27.855547 [info ] [Thread-1 (]: 3 of 8 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.06s]
[0m19:13:27.857071 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.857824 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.858392 [info ] [Thread-1 (]: 4 of 8 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m19:13:27.859571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m19:13:27.860478 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.864654 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.866001 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.869339 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.871315 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.872367 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m19:13:27.872859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.873670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.874092 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.874465 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m19:13:27.875608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.881030 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.882040 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m19:13:27.883449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.887018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.887390 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m19:13:27.888084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:27.890847 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:13:27.891327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.891700 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:13:27.895609 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.900288 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.901242 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m19:13:27.904961 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.910005 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m19:13:27.911497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70647E850>]}
[0m19:13:27.913075 [info ] [Thread-1 (]: 4 of 8 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.05s]
[0m19:13:27.914887 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.916373 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:27.916972 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m19:13:27.917883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m19:13:27.918440 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:27.922790 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.924204 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:27.929768 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.932635 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.933678 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m19:13:27.934231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.935209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.935718 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.936100 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m19:13:27.937874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.004645 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.005258 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m19:13:28.006223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.009482 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.010043 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m19:13:28.010958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.012938 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:13:28.013438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.013823 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:13:28.017361 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.019615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.019955 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m19:13:28.023774 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.025396 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m19:13:28.025974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C706640FA0>]}
[0m19:13:28.026769 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.11s]
[0m19:13:28.028673 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:28.030038 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.030658 [info ] [Thread-1 (]: 6 of 8 START sql view model intermediate.model_int_new_customer_converted ...... [RUN]
[0m19:13:28.031668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_new_customer_converted)
[0m19:13:28.032245 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.035024 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.036337 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.039533 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.041036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.041956 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m19:13:28.042683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:28.043693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.044235 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.044812 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m19:13:28.047579 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:13:28.053166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.053898 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m19:13:28.054945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.056449 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:13:28.056828 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.057146 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:13:28.061004 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.065778 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.066247 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m19:13:28.067069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.069077 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m19:13:28.069680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70620F0B0>]}
[0m19:13:28.070260 [info ] [Thread-1 (]: 6 of 8 OK created sql view model intermediate.model_int_new_customer_converted . [[32mOK[0m in 0.04s]
[0m19:13:28.071942 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.072491 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.073068 [info ] [Thread-1 (]: 7 of 8 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m19:13:28.073982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m19:13:28.074498 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.081905 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.083649 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.109282 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.112163 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.113399 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m19:13:28.114512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:28.116076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.116724 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.117242 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m19:13:28.171008 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m19:13:28.173718 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.174100 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m19:13:28.175322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.178858 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.179251 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m19:13:28.179960 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.185062 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:13:28.185426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.185733 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:13:28.192771 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:13:28.195373 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.195778 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m19:13:28.199146 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.200792 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m19:13:28.201290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C705E53C50>]}
[0m19:13:28.201847 [info ] [Thread-1 (]: 7 of 8 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.13s]
[0m19:13:28.203065 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.204377 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.204944 [info ] [Thread-1 (]: 8 of 8 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m19:13:28.206004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m19:13:28.206592 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.210764 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.212625 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.218436 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.219708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.220313 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m19:13:28.220750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:28.221525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.221923 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.222276 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m19:13:28.232351 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m19:13:28.235167 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.235547 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m19:13:28.236258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.239966 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.240609 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m19:13:28.241864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.244152 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:13:28.245021 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.245654 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:13:28.251757 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:13:28.253788 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.254126 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m19:13:28.257348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.258923 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m19:13:28.259593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7065F2570>]}
[0m19:13:28.260501 [info ] [Thread-1 (]: 8 of 8 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.05s]
[0m19:13:28.262240 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.265189 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:28.265600 [debug] [MainThread]: On master: BEGIN
[0m19:13:28.265879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:28.266486 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:13:28.266762 [debug] [MainThread]: On master: COMMIT
[0m19:13:28.267016 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:28.267333 [debug] [MainThread]: On master: COMMIT
[0m19:13:28.267874 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:13:28.268223 [debug] [MainThread]: On master: Close
[0m19:13:28.268689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:28.268968 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m19:13:28.269213 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m19:13:28.269426 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m19:13:28.269758 [info ] [MainThread]: 
[0m19:13:28.270610 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m19:13:28.273652 [debug] [MainThread]: Command end result
[0m19:13:28.301248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:13:28.303955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:13:28.313296 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:13:28.314242 [info ] [MainThread]: 
[0m19:13:28.315803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:28.317313 [info ] [MainThread]: 
[0m19:13:28.318383 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:13:28.319743 [debug] [MainThread]: Command `dbt run` succeeded at 19:13:28.319566 after 2.33 seconds
[0m19:13:28.320211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704049BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C701D538F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704C9BB90>]}
[0m19:13:28.320632 [debug] [MainThread]: Flushing usage events
[0m19:13:31.297731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:40.652083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69B76A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C6E7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C8D7ED0>]}


============================== 19:26:40.660263 | 38bda598-d3ce-4b3b-93b0-08e897a937e3 ==============================
[0m19:26:40.660263 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:26:40.662020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:26:40.955072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69BE110F0>]}
[0m19:26:41.035488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C793AC0>]}
[0m19:26:41.040026 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:26:41.240812 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:26:41.369557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:41.369947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:41.405208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C9A8850>]}
[0m19:26:41.507457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:26:41.525083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:26:41.569791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C70F4D0>]}
[0m19:26:41.571052 [info ] [MainThread]: Found 8 models, 4 sources, 429 macros
[0m19:26:41.572345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69DE98AD0>]}
[0m19:26:41.575698 [info ] [MainThread]: 
[0m19:26:41.576686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:41.577452 [info ] [MainThread]: 
[0m19:26:41.578942 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:26:41.591501 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:26:41.699056 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.699820 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.700392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:41.825698 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m19:26:41.828806 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.830847 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.831224 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.831546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.832927 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.834424 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.836327 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.837137 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.837517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.839303 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:26:41.840689 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.842914 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.843235 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.843517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.844520 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.845796 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.847471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m19:26:41.848312 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:26:41.858132 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.858698 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.859078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.860156 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.861542 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.861851 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:26:41.862399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.862786 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.863162 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:26:41.864923 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.866099 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:26:41.866610 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.867002 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:26:41.867871 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.868369 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:26:41.869217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m19:26:41.869875 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m19:26:41.871469 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.871775 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.872035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.873025 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.874438 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.874709 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m19:26:41.875174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.875474 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.875791 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m19:26:41.876355 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.877804 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:26:41.878469 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.878962 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:26:41.879627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.879984 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m19:26:41.880645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_report)
[0m19:26:41.881296 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m19:26:41.884886 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.885885 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.886467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.888008 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.890023 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.890629 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m19:26:41.891822 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.892744 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.893798 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m19:26:41.895225 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.896652 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:26:41.897041 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.897379 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:26:41.897916 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.898203 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m19:26:41.898855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m19:26:41.899488 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m19:26:41.902857 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.903594 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.904137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.905568 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.907567 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.908147 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m19:26:41.908884 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.909328 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.909668 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m19:26:41.910289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.911296 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:26:41.911682 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.911991 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:26:41.912495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.912803 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m19:26:41.915802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m19:26:41.924467 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:26:41.924935 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:26:41.925241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:41.925928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.926297 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:26:41.926619 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:41.961451 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m19:26:41.963957 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:26:41.966685 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:26:41.968062 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:26:41.970370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m19:26:41.975387 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:26:41.975888 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m19:26:41.976230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.976917 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.977240 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:26:41.977551 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:41.981972 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:26:41.984959 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m19:26:41.986425 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m19:26:41.987105 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m19:26:41.987865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m19:26:41.990383 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:26:41.991015 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m19:26:41.992256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.993089 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.993420 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:26:41.993723 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:41.997443 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:26:41.999117 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m19:26:42.000494 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m19:26:42.001161 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m19:26:42.002275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m19:26:42.005376 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:26:42.005745 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m19:26:42.005997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:42.006557 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:42.006933 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:26:42.007330 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:42.012499 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:26:42.014879 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m19:26:42.015957 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m19:26:42.016618 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m19:26:42.019044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E28CA10>]}
[0m19:26:42.019737 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.020070 [debug] [MainThread]: On master: BEGIN
[0m19:26:42.020344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:42.020946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:26:42.021295 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.021617 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.021902 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.022400 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:26:42.022717 [debug] [MainThread]: On master: Close
[0m19:26:42.028034 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.029198 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:26:42.030532 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:26:42.031108 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.042272 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.044090 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.092993 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.094366 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.095587 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:26:42.096419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:42.097618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.098171 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.098624 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m19:26:42.100090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.109494 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.110505 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:26:42.112587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.115751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.116315 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:26:42.117467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.134032 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:26:42.135050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.135644 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:26:42.141000 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:26:42.147182 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.147905 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:26:42.152125 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.155957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:26:42.160271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E2E8290>]}
[0m19:26:42.161620 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.13s]
[0m19:26:42.163264 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.164177 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.164874 [info ] [Thread-1 (]: 2 of 8 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m19:26:42.166726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m19:26:42.167373 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.170774 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.173044 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.180236 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.181619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.182275 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m19:26:42.182837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.183886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.184409 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.185023 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m19:26:42.186837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.191684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.192567 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m19:26:42.193932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.199231 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.200528 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m19:26:42.201934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.206206 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:26:42.207270 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.208090 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:26:42.212513 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.218030 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.219189 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m19:26:42.224455 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.226690 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m19:26:42.228415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E304050>]}
[0m19:26:42.230201 [info ] [Thread-1 (]: 2 of 8 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.06s]
[0m19:26:42.232406 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.234234 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.236088 [info ] [Thread-1 (]: 3 of 8 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m19:26:42.237447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m19:26:42.238378 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.242084 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.243705 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.247497 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.248578 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.249646 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m19:26:42.251580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.253681 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.254429 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.255258 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m19:26:42.257130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.261146 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.261936 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m19:26:42.263931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.269667 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.270507 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m19:26:42.271880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.274039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:26:42.274545 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.274942 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:26:42.278674 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.284938 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.285696 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m19:26:42.289881 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.292171 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m19:26:42.293126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E2D9590>]}
[0m19:26:42.294040 [info ] [Thread-1 (]: 3 of 8 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.06s]
[0m19:26:42.295716 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.296231 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.296975 [info ] [Thread-1 (]: 4 of 8 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m19:26:42.298113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m19:26:42.298887 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.303973 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.305404 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.311593 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.313568 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.314256 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m19:26:42.314656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.315437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.316421 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.317403 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m19:26:42.319031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.324463 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.325329 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m19:26:42.326926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.332955 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.334434 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m19:26:42.335729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.337810 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:26:42.338561 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.339135 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:26:42.343088 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.347520 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.348332 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m19:26:42.353038 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.359617 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m19:26:42.360885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E11DF50>]}
[0m19:26:42.363219 [info ] [Thread-1 (]: 4 of 8 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.06s]
[0m19:26:42.364822 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.366549 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.368053 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m19:26:42.369468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m19:26:42.370103 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.375190 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.378571 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.382700 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.385136 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.385925 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m19:26:42.386509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.388169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.389275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.390049 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m19:26:42.392244 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:26:42.467132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.467987 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m19:26:42.469218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.474108 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.474763 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m19:26:42.475796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.477446 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:26:42.477843 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.478196 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:26:42.482027 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.485535 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.486201 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m19:26:42.489689 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.493695 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m19:26:42.495029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E2E0750>]}
[0m19:26:42.496226 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.13s]
[0m19:26:42.497581 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.499100 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.499922 [info ] [Thread-1 (]: 6 of 8 START sql view model intermediate.model_int_new_customer_converted ...... [RUN]
[0m19:26:42.501635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_new_customer_converted)
[0m19:26:42.502535 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.507911 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.509625 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.512991 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.514141 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.514835 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m19:26:42.515373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.516691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.517253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.517918 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m19:26:42.522969 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.527100 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.527627 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m19:26:42.528448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.531025 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.531375 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m19:26:42.532025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.534359 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:26:42.535274 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.536047 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:26:42.540566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.542819 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.543178 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m19:26:42.546250 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.547731 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m19:26:42.548266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C8F8DD0>]}
[0m19:26:42.548876 [info ] [Thread-1 (]: 6 of 8 OK created sql view model intermediate.model_int_new_customer_converted . [[32mOK[0m in 0.05s]
[0m19:26:42.550481 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.551923 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.553158 [info ] [Thread-1 (]: 7 of 8 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m19:26:42.554585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m19:26:42.555237 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.560331 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.561615 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.593930 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.595603 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.596507 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m19:26:42.597105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.598111 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.598733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.599659 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select *
  from "ae_exam_db"."intermediate"."model_int_new_customer_converted"
),
final as (
  select
    cn.campaign_name,
    i.date,
    coalesce(i.impressions,0) as impressions,
    coalesce(cl.clicks,0) as clicks,
    coalesce(cv.conversions,0) as conversions,
    coalesce(ROUND(cv.total_revenue,2),0) as total_revenue,
    coalesce(ROUND(co.total_cost,2),0) as total_cost,
    coalesce(ROUND((co.total_cost / ncc.new_customers),2),0) as cac,
    coalesce(ROUND((cv.total_revenue/co.total_cost)*100,2),0) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m19:26:42.675280 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m19:26:42.681463 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.682138 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m19:26:42.684027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.688691 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.689340 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m19:26:42.690515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.699685 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:26:42.700750 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.701708 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:26:42.709088 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:26:42.711876 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.712354 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m19:26:42.716200 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.718421 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m19:26:42.719156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69DA79910>]}
[0m19:26:42.719943 [info ] [Thread-1 (]: 7 of 8 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.16s]
[0m19:26:42.721136 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.722651 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.723431 [info ] [Thread-1 (]: 8 of 8 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m19:26:42.724785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m19:26:42.725924 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.732125 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.733978 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.739864 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.741508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.742308 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m19:26:42.742746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.743502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.744013 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.744433 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m19:26:42.752225 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:26:42.757293 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.758198 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m19:26:42.759115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.762290 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.762743 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m19:26:42.763980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.765988 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:26:42.766614 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.767307 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:26:42.772834 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:26:42.775809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.776445 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m19:26:42.780568 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.783046 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m19:26:42.784078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C948E30>]}
[0m19:26:42.784989 [info ] [Thread-1 (]: 8 of 8 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.06s]
[0m19:26:42.786575 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.788770 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.789268 [debug] [MainThread]: On master: BEGIN
[0m19:26:42.789762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:26:42.790723 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:26:42.791224 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.791608 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.792025 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.792818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:26:42.793270 [debug] [MainThread]: On master: Close
[0m19:26:42.793915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:42.794439 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m19:26:42.794861 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m19:26:42.795190 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m19:26:42.795817 [info ] [MainThread]: 
[0m19:26:42.796928 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m19:26:42.802474 [debug] [MainThread]: Command end result
[0m19:26:42.837535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:26:42.840503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:26:42.848247 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:26:42.848819 [info ] [MainThread]: 
[0m19:26:42.850427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:42.851659 [info ] [MainThread]: 
[0m19:26:42.852711 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:26:42.854086 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:42.853905 after 2.55 seconds
[0m19:26:42.854532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C948E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69BD08E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E30FA70>]}
[0m19:26:42.854936 [debug] [MainThread]: Flushing usage events
[0m19:26:45.798806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:27.139427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594B6EA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C667890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C857ED0>]}


============================== 20:56:27.145440 | fc464780-df03-4eca-abce-caf959451afb ==============================
[0m20:56:27.145440 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:56:27.147580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:27.479748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BD910F0>]}
[0m20:56:27.553976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C713AC0>]}
[0m20:56:27.557700 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m20:56:27.797505 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:56:27.925661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:27.926208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:27.966795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C928850>]}
[0m20:56:28.044075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m20:56:28.061922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m20:56:28.089502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C68F4D0>]}
[0m20:56:28.090372 [info ] [MainThread]: Found 8 models, 4 sources, 429 macros
[0m20:56:28.091268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594DE18AD0>]}
[0m20:56:28.095360 [info ] [MainThread]: 
[0m20:56:28.096182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:28.096834 [info ] [MainThread]: 
[0m20:56:28.097660 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:56:28.103900 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m20:56:28.208441 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.208928 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.209266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:28.235399 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:56:28.238108 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.241290 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.241840 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.242273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.243677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.245550 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.247799 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.248236 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.248601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.250153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.252826 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.255956 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.256378 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.256694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.257845 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.259214 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.260726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m20:56:28.262284 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m20:56:28.268760 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.269122 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.269385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.270438 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.271954 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.272359 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m20:56:28.273510 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.274292 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.275014 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m20:56:28.277195 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:28.278634 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m20:56:28.279066 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.279365 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m20:56:28.279928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.280253 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m20:56:28.280852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m20:56:28.281331 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m20:56:28.284006 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.284501 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.284834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.285807 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.287184 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.287466 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m20:56:28.287925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.288297 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.288692 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m20:56:28.289288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.290280 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m20:56:28.290616 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.290881 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m20:56:28.291332 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.291586 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m20:56:28.292146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m20:56:28.292636 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m20:56:28.295527 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.295974 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.296292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.297238 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.298531 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.298846 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m20:56:28.299324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.299691 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.300047 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m20:56:28.300666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.301608 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m20:56:28.301899 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.302153 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m20:56:28.302585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.302914 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m20:56:28.303566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m20:56:28.304077 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m20:56:28.306136 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.306467 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.306745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.307504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.308696 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.308983 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m20:56:28.309419 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.309708 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.309974 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m20:56:28.310567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.311599 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m20:56:28.311980 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.312276 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m20:56:28.312792 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.313072 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m20:56:28.315819 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m20:56:28.321815 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m20:56:28.322155 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m20:56:28.322480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:28.323565 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.323984 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m20:56:28.324328 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.343330 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:56:28.345826 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m20:56:28.347166 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m20:56:28.347565 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m20:56:28.348110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m20:56:28.349708 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m20:56:28.350025 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m20:56:28.350287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.351896 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:28.352386 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m20:56:28.352743 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.356652 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:56:28.358061 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m20:56:28.358644 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m20:56:28.358917 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m20:56:28.359382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m20:56:28.361181 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m20:56:28.361663 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m20:56:28.362036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.363206 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.363710 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m20:56:28.364025 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.368922 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:56:28.370348 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m20:56:28.370926 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m20:56:28.371194 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m20:56:28.371681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m20:56:28.373684 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m20:56:28.373991 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m20:56:28.374274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.375610 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.376082 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m20:56:28.376628 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.381577 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:56:28.383348 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m20:56:28.384067 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m20:56:28.384445 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m20:56:28.386172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E20C6D0>]}
[0m20:56:28.386890 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:28.387291 [debug] [MainThread]: On master: BEGIN
[0m20:56:28.387649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:28.388405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:56:28.388735 [debug] [MainThread]: On master: COMMIT
[0m20:56:28.389044 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:28.389324 [debug] [MainThread]: On master: COMMIT
[0m20:56:28.389817 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:28.390187 [debug] [MainThread]: On master: Close
[0m20:56:28.395469 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.396118 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m20:56:28.397229 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m20:56:28.397823 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.404523 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.406220 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.451397 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.453742 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.454447 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m20:56:28.455344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:56:28.456523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.457008 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.457365 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m20:56:28.458443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.465828 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.466331 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m20:56:28.467981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.471411 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.471868 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m20:56:28.472618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.486668 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m20:56:28.487292 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.487608 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m20:56:28.492924 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:56:28.498088 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.498486 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m20:56:28.501775 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.504436 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m20:56:28.507262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E268290>]}
[0m20:56:28.508068 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.11s]
[0m20:56:28.510215 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.510941 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.512050 [info ] [Thread-1 (]: 2 of 8 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m20:56:28.513209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m20:56:28.513831 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.517070 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.518171 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.523236 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.525065 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.526199 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m20:56:28.526737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.528285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.529028 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.529557 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m20:56:28.531697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.537109 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.537680 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m20:56:28.538789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.541759 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.542098 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m20:56:28.542751 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.545076 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m20:56:28.546508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.547524 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m20:56:28.552336 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.555371 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.555766 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m20:56:28.559157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.561210 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m20:56:28.562177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E280050>]}
[0m20:56:28.564525 [info ] [Thread-1 (]: 2 of 8 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.05s]
[0m20:56:28.566614 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.567338 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.567997 [info ] [Thread-1 (]: 3 of 8 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m20:56:28.569066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m20:56:28.569548 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.572792 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.574126 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.579339 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.581591 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.582254 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m20:56:28.582714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.583603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.584095 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.584507 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m20:56:28.585552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.590041 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.590644 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m20:56:28.591585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.598016 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.599314 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m20:56:28.600779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.602388 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m20:56:28.602767 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.603101 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m20:56:28.606838 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.609342 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.609692 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m20:56:28.613246 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.616069 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m20:56:28.616785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E24D590>]}
[0m20:56:28.617498 [info ] [Thread-1 (]: 3 of 8 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.05s]
[0m20:56:28.619486 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.620086 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.620623 [info ] [Thread-1 (]: 4 of 8 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m20:56:28.621697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m20:56:28.622259 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.625314 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.626295 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.632306 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.633614 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.634217 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m20:56:28.634731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.635529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.635939 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.636293 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m20:56:28.637249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.641341 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.641805 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m20:56:28.642631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.648619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.649204 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m20:56:28.650169 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.652026 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m20:56:28.652695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.653270 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m20:56:28.656868 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.659383 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.659922 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m20:56:28.664144 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.669833 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m20:56:28.670838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E09A150>]}
[0m20:56:28.671609 [info ] [Thread-1 (]: 4 of 8 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.05s]
[0m20:56:28.673065 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.674659 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.675334 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m20:56:28.676595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m20:56:28.677281 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.683424 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.685232 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.688284 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.689385 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.690087 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m20:56:28.690716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.691559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.691981 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.692375 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m20:56:28.694093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.764871 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.765463 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m20:56:28.766575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.769841 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.770251 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m20:56:28.770975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.772536 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m20:56:28.773135 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.773543 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m20:56:28.778898 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:56:28.781525 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.781988 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m20:56:28.785778 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.787455 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m20:56:28.788023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E23BD90>]}
[0m20:56:28.788752 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.11s]
[0m20:56:28.790668 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.792224 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.792857 [info ] [Thread-1 (]: 6 of 8 START sql view model intermediate.model_int_new_customer_converted ...... [RUN]
[0m20:56:28.794043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_new_customer_converted)
[0m20:56:28.794652 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.797676 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.798660 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.801736 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.802695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.803204 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m20:56:28.803651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.804472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.804987 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.805681 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m20:56:28.808862 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.814803 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.815877 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m20:56:28.817290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.820531 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.821027 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m20:56:28.821966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.823426 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m20:56:28.823792 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.824086 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m20:56:28.828372 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.832481 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.832994 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m20:56:28.837265 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.839358 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m20:56:28.839982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594B5FA9F0>]}
[0m20:56:28.840719 [info ] [Thread-1 (]: 6 of 8 OK created sql view model intermediate.model_int_new_customer_converted . [[32mOK[0m in 0.05s]
[0m20:56:28.842692 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.844108 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.844948 [info ] [Thread-1 (]: 7 of 8 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m20:56:28.846286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m20:56:28.847268 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.852426 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.854249 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.885225 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.887618 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.888431 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m20:56:28.888896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.889689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.890065 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.890500 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select 
    campaign_id,
    date,
    count(distinct customer_id) as new_customers
  from "ae_exam_db"."intermediate"."model_int_new_customer_converted"
  group by campaign_id,date
),
final as (
  select
    cn.campaign_name,
    i.date,
    coalesce(i.impressions,0) as impressions,
    coalesce(cl.clicks,0) as clicks,
    coalesce(cv.conversions,0) as conversions,
    coalesce(ROUND(cv.total_revenue,2),0) as total_revenue,
    coalesce(ROUND(co.total_cost,2),0) as total_cost,
    coalesce(ROUND((co.total_cost / ncc.new_customers),2),0) as cac,
    coalesce(ROUND((cv.total_revenue/co.total_cost)*100,2),0) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m20:56:28.954364 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m20:56:28.957563 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.957988 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m20:56:28.959314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.963379 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.963779 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m20:56:28.964545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.969325 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m20:56:28.969696 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.970008 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m20:56:28.975955 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:56:28.978654 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.979097 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m20:56:28.982720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.984362 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m20:56:28.984930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594D9F9610>]}
[0m20:56:28.985505 [info ] [Thread-1 (]: 7 of 8 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.14s]
[0m20:56:28.987630 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.988814 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:28.989448 [info ] [Thread-1 (]: 8 of 8 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m20:56:28.990468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m20:56:28.990969 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:28.996220 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:28.998201 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:29.002287 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.003633 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.004235 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m20:56:29.004709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:29.005475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:29.005898 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.006290 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m20:56:29.015138 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:56:29.018777 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.019500 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m20:56:29.020265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:29.024304 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.024834 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m20:56:29.026020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:29.028448 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m20:56:29.029224 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.030499 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m20:56:29.035827 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:29.039588 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.040215 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m20:56:29.045267 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:29.049842 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m20:56:29.050690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594D9F9E50>]}
[0m20:56:29.051409 [info ] [Thread-1 (]: 8 of 8 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.06s]
[0m20:56:29.052954 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:29.055113 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:29.055516 [debug] [MainThread]: On master: BEGIN
[0m20:56:29.055946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:29.056785 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:56:29.057190 [debug] [MainThread]: On master: COMMIT
[0m20:56:29.057552 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:29.057951 [debug] [MainThread]: On master: COMMIT
[0m20:56:29.058602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:29.059059 [debug] [MainThread]: On master: Close
[0m20:56:29.059538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:29.059833 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m20:56:29.060125 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m20:56:29.060398 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m20:56:29.061165 [info ] [MainThread]: 
[0m20:56:29.062348 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m20:56:29.066378 [debug] [MainThread]: Command end result
[0m20:56:29.104666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m20:56:29.110948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m20:56:29.126402 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m20:56:29.127351 [info ] [MainThread]: 
[0m20:56:29.129001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:29.130410 [info ] [MainThread]: 
[0m20:56:29.132658 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:56:29.134650 [debug] [MainThread]: Command `dbt run` succeeded at 20:56:29.134400 after 2.31 seconds
[0m20:56:29.135339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BCF2B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594B5F82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E28BEF0>]}
[0m20:56:29.135867 [debug] [MainThread]: Flushing usage events
[0m20:56:32.149121 [debug] [MainThread]: An error was encountered while trying to flush usage events
