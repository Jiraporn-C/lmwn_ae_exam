[0m18:34:11.668617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7C9F0E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CAE9F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CABFD310>]}


============================== 18:34:11.673118 | 9d1fc295-d469-4f6b-8d5a-57c30bcdccaa ==============================
[0m18:34:11.673118 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:34:11.673649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'c:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:34:11.764974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1fc295-d469-4f6b-8d5a-57c30bcdccaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CA5CCFC0>]}
[0m18:34:11.790008 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:11.791361 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:11.792423 [debug] [MainThread]: Command `cli deps` succeeded at 18:34:11.792237 after 0.26 seconds
[0m18:34:11.792972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CAF56F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CAF56250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7CB105750>]}
[0m18:34:11.793300 [debug] [MainThread]: Flushing usage events
[0m18:34:12.925103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:33.899292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A13AE270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A232F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A2089310>]}


============================== 18:40:33.903893 | c5bad66e-40e9-4d66-8355-c016394cf6a9 ==============================
[0m18:40:33.903893 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:40:33.904852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:34.026476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5bad66e-40e9-4d66-8355-c016394cf6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A1A58FC0>]}
[0m18:40:34.053074 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:40:34.055857 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:40:34.057058 [debug] [MainThread]: Command `cli deps` succeeded at 18:40:34.056840 after 0.33 seconds
[0m18:40:34.057473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A23EAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A23EA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A2595750>]}
[0m18:40:34.057791 [debug] [MainThread]: Flushing usage events
[0m18:40:35.282270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:18.784201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5C5BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D547890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D737ED0>]}


============================== 21:10:18.788465 | e8e643e9-6b82-4aac-98f2-fae15335cea0 ==============================
[0m21:10:18.788465 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:10:18.789355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:10:18.946629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5CC710F0>]}
[0m21:10:18.999569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D5F3BD0>]}
[0m21:10:19.002305 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:10:19.261268 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:10:19.356763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:10:19.357131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:10:19.386440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D808850>]}
[0m21:10:19.438084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:10:19.441661 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:10:19.483064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D56F4D0>]}
[0m21:10:19.483781 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m21:10:19.484634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5ED24130>]}
[0m21:10:19.486788 [info ] [MainThread]: 
[0m21:10:19.487443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:19.487983 [info ] [MainThread]: 
[0m21:10:19.488642 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:10:19.492805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:10:19.551890 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:10:19.552244 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:10:19.552476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:19.575128 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:10:19.576513 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:10:19.577212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:10:19.578240 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:10:19.584000 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.584380 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:10:19.584612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:19.585433 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:10:19.586479 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.586720 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:10:19.587092 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:19.587324 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.587519 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:10:19.589632 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:10:19.590315 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:10:19.590554 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:10:19.590749 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:10:19.591092 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:19.591337 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:10:19.593402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:10:19.597509 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:10:19.597788 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:10:19.598003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:19.598636 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:19.598944 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:10:19.599221 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:10:19.621588 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m21:10:19.622930 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:10:19.624023 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:10:19.624298 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:10:19.626963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5F0513D0>]}
[0m21:10:19.627422 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.627652 [debug] [MainThread]: On master: BEGIN
[0m21:10:19.627851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:19.628319 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:19.628547 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.628753 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.628932 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.629270 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:19.629510 [debug] [MainThread]: On master: Close
[0m21:10:19.632755 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.633221 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:10:19.634049 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:10:19.634389 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.639499 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.641719 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.669452 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.672073 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.672593 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:10:19.672996 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:10:19.673597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:19.673860 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:10:19.674096 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    select *
from main.campaign_interactions
where "platform" = 'google';
  );

[0m21:10:19.676449 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    select *
from main.campaign_interactions
where "platform" = 'google';
  );

[0m21:10:19.676778 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:10:19.677183 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:10:19.779804 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:10:19.780167 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:10:19.783424 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:10:19.786204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5F148350>]}
[0m21:10:19.786822 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.15s]
[0m21:10:19.787819 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:10:19.788171 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.789376 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:10:19.788551 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:10:19.790467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:10:19.790752 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.792627 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.794300 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.813068 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.814781 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.815210 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:10:19.815550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:19.816189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:19.816537 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.816872 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:10:19.822068 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:10:19.827327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.827670 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:10:19.829518 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:10:19.841256 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:10:19.841664 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.841935 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:10:19.849758 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:10:19.853930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:10:19.854576 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:10:19.855680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:19.857601 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:10:19.858063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5ED43CD0>]}
[0m21:10:19.858549 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m21:10:19.859371 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:10:19.860247 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.860636 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:10:19.861223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:10:19.861500 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.863345 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.864206 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.867125 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.868102 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.868463 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:10:19.868742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:19.869293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.869570 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.869803 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:10:19.870460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.873215 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.873579 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:10:19.874262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.875342 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:10:19.875625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.875863 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:10:19.879769 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:10:19.881708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:10:19.882250 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:10:19.882897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:10:19.885114 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:10:19.886063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e643e9-6b82-4aac-98f2-fae15335cea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5F0EF2F0>]}
[0m21:10:19.886957 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m21:10:19.887836 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:10:19.889539 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.890406 [debug] [MainThread]: On master: BEGIN
[0m21:10:19.890961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:10:19.891535 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:10:19.891790 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.892008 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:19.892197 [debug] [MainThread]: On master: COMMIT
[0m21:10:19.892547 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:19.892770 [debug] [MainThread]: On master: Close
[0m21:10:19.893075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:19.893278 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:10:19.893447 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:10:19.893618 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:10:19.894203 [info ] [MainThread]: 
[0m21:10:19.894705 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:10:19.895684 [debug] [MainThread]: Command end result
[0m21:10:19.912275 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:10:19.914593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:10:19.921230 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:10:19.921602 [info ] [MainThread]: 
[0m21:10:19.922125 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:10:19.922735 [info ] [MainThread]: 
[0m21:10:19.923342 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:10:19.923928 [info ] [MainThread]: 
[0m21:10:19.924490 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:10:19.925442 [debug] [MainThread]: Command `dbt run` failed at 21:10:19.925341 after 1.39 seconds
[0m21:10:19.925735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5EBBFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5EAF76D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5D781780>]}
[0m21:10:19.926032 [debug] [MainThread]: Flushing usage events
[0m21:10:21.906169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:10.133132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F65E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C705E7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C707D7ED0>]}


============================== 21:37:10.140383 | 21137d65-a4d9-4345-8671-e2968601f524 ==============================
[0m21:37:10.140383 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:37:10.142598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:37:10.337777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6FD190F0>]}
[0m21:37:10.397426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C70697BD0>]}
[0m21:37:10.400641 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:37:10.572400 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:37:10.697203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:10.697543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:10.734696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C708AA250>]}
[0m21:37:10.805696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:37:10.809919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:37:10.831454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7060F4D0>]}
[0m21:37:10.832065 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:37:10.832590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21137d65-a4d9-4345-8671-e2968601f524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C71E50830>]}
[0m21:37:10.835792 [info ] [MainThread]: 
[0m21:37:10.836385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:37:10.836828 [info ] [MainThread]: 
[0m21:37:10.837449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:37:10.841947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:37:10.922425 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:37:10.923145 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:37:10.923618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:11.043280 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:37:11.044183 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:37:11.046427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:11.046890 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m21:37:11.047510 [info ] [MainThread]: 
[0m21:37:11.048207 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m21:37:11.049087 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 24092)
[0m21:37:11.050582 [debug] [MainThread]: Command `dbt run` failed at 21:37:11.050394 after 1.09 seconds
[0m21:37:11.051096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C720B0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C70682D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C71E27410>]}
[0m21:37:11.051561 [debug] [MainThread]: Flushing usage events
[0m21:37:13.119503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:33.308052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEE4FA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF477890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF667ED0>]}


============================== 21:38:33.312104 | 58c22afc-2525-4bd1-acd8-4725dced7272 ==============================
[0m21:38:33.312104 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:38:33.312966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:38:33.505103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEEBA10F0>]}
[0m21:38:33.571345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF523BD0>]}
[0m21:38:33.575541 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:38:33.750480 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:38:33.887257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:38:33.887603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:38:33.927754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF73A250>]}
[0m21:38:34.002701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:38:34.005633 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:38:34.026850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF49F4D0>]}
[0m21:38:34.027752 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:38:34.028437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0C4C830>]}
[0m21:38:34.030360 [info ] [MainThread]: 
[0m21:38:34.030984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:34.031580 [info ] [MainThread]: 
[0m21:38:34.032371 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:38:34.037019 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:38:34.112432 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:38:34.112885 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:38:34.113428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:34.235331 [debug] [ThreadPool]: SQL status: OK in 0.122 seconds
[0m21:38:34.237559 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:38:34.238743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:38:34.239636 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:38:34.244802 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.245093 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:38:34.245362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:34.246602 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:38:34.248128 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.248488 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:38:34.248980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:38:34.249274 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.249546 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:38:34.250971 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:38:34.251708 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:38:34.252003 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:38:34.252215 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:38:34.252580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:38:34.252801 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:38:34.254050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:38:34.258466 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:38:34.258751 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:38:34.258975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:34.259443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:38:34.259674 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:38:34.259886 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:38:34.280200 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m21:38:34.282028 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:38:34.284358 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:38:34.284641 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:38:34.286912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0EA14A0>]}
[0m21:38:34.287323 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.287561 [debug] [MainThread]: On master: BEGIN
[0m21:38:34.287760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:34.288221 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:38:34.288450 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.288663 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.288862 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.289202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:38:34.289444 [debug] [MainThread]: On master: Close
[0m21:38:34.291719 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.292160 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:38:34.292804 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:38:34.293535 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.301408 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.302309 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.338820 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.340461 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.341252 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:38:34.341617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:38:34.342281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.342618 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:38:34.343006 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"
main.campaign_interactions

)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:38:34.346838 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"
main.campaign_interactions

)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:38:34.347168 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:38:34.347536 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:38:34.358756 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:38:34.359267 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:38:34.362948 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near "."
[0m21:38:34.365546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF1034950>]}
[0m21:38:34.366217 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.07s]
[0m21:38:34.367116 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:38:34.367617 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.368875 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ".".
[0m21:38:34.368103 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:38:34.370394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:38:34.370729 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.372726 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.374072 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.400842 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.402067 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.402474 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:38:34.402855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:34.403641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.403980 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.404279 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:38:34.408964 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:38:34.417487 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.418070 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:38:34.419940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.423899 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.424399 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:38:34.425149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:34.442822 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:38:34.443911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.444550 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:38:34.452770 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:38:34.458276 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:38:34.458755 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:38:34.464406 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:38:34.467154 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:38:34.468269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0E707E0>]}
[0m21:38:34.469358 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m21:38:34.470427 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:38:34.471523 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.471985 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:38:34.473178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:38:34.473577 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.475654 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.477193 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.482443 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.484050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.485271 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:38:34.486158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:34.487225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.487726 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.488092 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:38:34.488860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:34.491300 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.491621 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:38:34.493351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:34.499395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.499847 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:38:34.500627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:34.502455 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:38:34.502858 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.503147 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:38:34.506840 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:38:34.510082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:38:34.510728 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:38:34.513881 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:38:34.515607 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:38:34.516393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58c22afc-2525-4bd1-acd8-4725dced7272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0B76670>]}
[0m21:38:34.517632 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:38:34.519676 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:38:34.521805 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.522156 [debug] [MainThread]: On master: BEGIN
[0m21:38:34.522395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:34.522934 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:38:34.523216 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.523439 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:34.523661 [debug] [MainThread]: On master: COMMIT
[0m21:38:34.524168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:38:34.524638 [debug] [MainThread]: On master: Close
[0m21:38:34.525158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:34.525480 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:38:34.525706 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:38:34.525918 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:38:34.526273 [info ] [MainThread]: 
[0m21:38:34.526878 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m21:38:34.528414 [debug] [MainThread]: Command end result
[0m21:38:34.555967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:38:34.559231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:38:34.569734 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:38:34.570595 [info ] [MainThread]: 
[0m21:38:34.572131 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:34.573174 [info ] [MainThread]: 
[0m21:38:34.574271 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near "."
[0m21:38:34.575121 [info ] [MainThread]: 
[0m21:38:34.575978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:38:34.577416 [debug] [MainThread]: Command `dbt run` failed at 21:38:34.577211 after 1.57 seconds
[0m21:38:34.578276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0AF3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0A805D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEF6B1780>]}
[0m21:38:34.578933 [debug] [MainThread]: Flushing usage events
[0m21:38:36.992320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:42:07.551242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EA9CA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB947890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EBB37ED0>]}


============================== 21:42:07.554931 | c78674d6-9f20-4057-9939-e449667e90c1 ==============================
[0m21:42:07.554931 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:42:07.556133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:42:07.739054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB06D0F0>]}
[0m21:42:07.795163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB9F3BD0>]}
[0m21:42:07.798258 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:42:07.961229 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:42:08.085332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:42:08.085893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:42:08.126852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EBC0A250>]}
[0m21:42:08.200859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:42:08.203511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:42:08.228712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EB96F4D0>]}
[0m21:42:08.229355 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:42:08.230049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED10C750>]}
[0m21:42:08.232025 [info ] [MainThread]: 
[0m21:42:08.232670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:42:08.233255 [info ] [MainThread]: 
[0m21:42:08.234084 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:42:08.239403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:42:08.331443 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:42:08.332082 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:42:08.332584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:08.374367 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m21:42:08.375685 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:42:08.376743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:42:08.377354 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:42:08.383152 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.383512 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:42:08.383753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:08.384728 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:42:08.385950 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.386219 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:42:08.386629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:42:08.386870 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.387111 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:42:08.387644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:42:08.388444 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:42:08.388706 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:42:08.388933 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:42:08.389304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:42:08.389553 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:42:08.391586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:42:08.396398 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:42:08.396714 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:42:08.396984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:08.397790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:42:08.398033 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:42:08.398257 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:42:08.412772 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:42:08.416286 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:42:08.418038 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:42:08.418524 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:42:08.422832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED371980>]}
[0m21:42:08.423553 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.423982 [debug] [MainThread]: On master: BEGIN
[0m21:42:08.424383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:42:08.425722 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:42:08.427329 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.428096 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.428473 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.429073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:42:08.429438 [debug] [MainThread]: On master: Close
[0m21:42:08.431952 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.432968 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:42:08.434067 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:42:08.434465 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.442804 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.445936 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.480154 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.481558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.482049 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:42:08.482412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:42:08.483134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.483461 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:42:08.483759 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:42:08.484392 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:42:08.484718 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:42:08.485088 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:42:08.490891 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:42:08.491253 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:42:08.494395 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:42:08.497041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED504A10>]}
[0m21:42:08.497958 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.06s]
[0m21:42:08.499212 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:42:08.499638 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.500839 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:42:08.500070 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:42:08.502618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:42:08.503015 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.505686 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.506690 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.523951 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.525284 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.525930 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:42:08.526337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:08.527040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.527392 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.527726 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:42:08.529035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.536082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.536471 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:42:08.537170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.541509 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.542187 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:42:08.543136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.561243 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:42:08.561710 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.562003 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:42:08.582223 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m21:42:08.586820 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:42:08.587274 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:42:08.594539 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:42:08.596733 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:42:08.597217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED33C7E0>]}
[0m21:42:08.597714 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:42:08.598971 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:42:08.600208 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.600722 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:42:08.601596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:42:08.602092 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.604418 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.605538 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.608788 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.609611 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.610131 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:42:08.610629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:08.611255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:42:08.611584 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.611874 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:42:08.612577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.615040 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.615355 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:42:08.615970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.618057 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.618341 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:42:08.618935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:42:08.620680 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:42:08.621147 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.621537 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:42:08.624934 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:42:08.629189 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:42:08.629856 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:42:08.633623 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:42:08.635009 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:42:08.635581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78674d6-9f20-4057-9939-e449667e90c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ED06A670>]}
[0m21:42:08.637867 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m21:42:08.639318 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:42:08.641663 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.642458 [debug] [MainThread]: On master: BEGIN
[0m21:42:08.642915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:42:08.643751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:42:08.644128 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.644404 [debug] [MainThread]: Using duckdb connection "master"
[0m21:42:08.644673 [debug] [MainThread]: On master: COMMIT
[0m21:42:08.645129 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:42:08.645437 [debug] [MainThread]: On master: Close
[0m21:42:08.645811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:08.646049 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:42:08.646241 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:42:08.646427 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:42:08.646712 [info ] [MainThread]: 
[0m21:42:08.647433 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:42:08.649299 [debug] [MainThread]: Command end result
[0m21:42:08.668788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:42:08.672510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:42:08.684783 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:42:08.685449 [info ] [MainThread]: 
[0m21:42:08.686566 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:42:08.687819 [info ] [MainThread]: 
[0m21:42:08.689001 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:42:08.690043 [info ] [MainThread]: 
[0m21:42:08.691479 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:42:08.693417 [debug] [MainThread]: Command `dbt run` failed at 21:42:08.693179 after 1.44 seconds
[0m21:42:08.694046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ECFBFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239ECF485D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239EBB81780>]}
[0m21:42:08.694647 [debug] [MainThread]: Flushing usage events
[0m21:42:10.392032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:13.697402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A73BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A8337890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A8527ED0>]}


============================== 21:43:13.701303 | 7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7 ==============================
[0m21:43:13.701303 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:43:13.702229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:43:13.898708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A7A610F0>]}
[0m21:43:13.992463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A83E3BD0>]}
[0m21:43:13.997193 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:43:14.192644 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:43:14.317073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:14.317445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:14.354420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A85F6250>]}
[0m21:43:14.436432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:43:14.439104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:43:14.461808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A835F4D0>]}
[0m21:43:14.462587 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:43:14.463313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9AF8750>]}
[0m21:43:14.465125 [info ] [MainThread]: 
[0m21:43:14.465923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:14.466485 [info ] [MainThread]: 
[0m21:43:14.467239 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:43:14.471857 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:43:14.546887 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:43:14.547327 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:43:14.547638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:14.585671 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m21:43:14.587968 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:43:14.589332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:43:14.589891 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:43:14.596363 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.596708 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:43:14.596961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:14.597845 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:14.599083 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.599352 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:43:14.599821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:14.600092 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.600333 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:43:14.600820 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:14.601590 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:43:14.601851 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:43:14.602055 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:43:14.602421 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:14.602703 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:43:14.604844 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:43:14.610621 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:43:14.611275 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:43:14.611804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:14.612759 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:14.613188 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:43:14.613535 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:43:14.633440 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m21:43:14.635668 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:43:14.636770 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:43:14.637114 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:43:14.639829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9D61980>]}
[0m21:43:14.640271 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.640539 [debug] [MainThread]: On master: BEGIN
[0m21:43:14.640766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:14.641259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:14.641522 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.641739 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.641958 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.642398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:14.642710 [debug] [MainThread]: On master: Close
[0m21:43:14.646042 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.646531 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:43:14.647391 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:43:14.647867 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.655409 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.656606 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.689898 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.691146 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.692054 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:43:14.692852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:43:14.693572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.693879 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:43:14.694188 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:43:14.694842 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (

select *
from "ae_exam_db"."main"."campaign_interactions"


)

select *
from raw_camp_data
where "platform" = 'google';
  );

[0m21:43:14.695144 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:43:14.695504 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:43:14.701448 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:43:14.701784 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:43:14.704766 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:43:14.707373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9EF4A10>]}
[0m21:43:14.708209 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.06s]
[0m21:43:14.709611 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:43:14.710037 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.711132 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:43:14.710494 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:43:14.712643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:43:14.713048 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.715045 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.715868 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.736266 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.737426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.738056 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:43:14.738528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:14.739217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.739594 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.739927 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:43:14.740988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.749452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.750021 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:43:14.750698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.753783 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.754106 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:43:14.754708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.771117 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:43:14.771687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.771969 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:43:14.793386 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m21:43:14.798766 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:43:14.799764 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:43:14.807658 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:43:14.810579 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:43:14.811147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9D2C7E0>]}
[0m21:43:14.811666 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m21:43:14.812948 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:43:14.814163 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.814760 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:43:14.815624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:43:14.816083 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.818141 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.818954 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.822063 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.822912 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.823315 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:43:14.823714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:14.824673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.825379 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.826040 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:43:14.826976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:14.830104 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.830647 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:43:14.831725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.836426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.836810 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:43:14.837517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:14.838923 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:43:14.839238 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.839503 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:43:14.843793 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:43:14.848941 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:43:14.849687 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:43:14.853583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:43:14.855086 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:43:14.855568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2c254d-9f03-458a-8b72-a3f6bbbf4ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A9A5A670>]}
[0m21:43:14.856081 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:43:14.857488 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:43:14.859571 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.859991 [debug] [MainThread]: On master: BEGIN
[0m21:43:14.860346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:14.861241 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:43:14.862159 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.862927 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:14.863315 [debug] [MainThread]: On master: COMMIT
[0m21:43:14.863902 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:14.864233 [debug] [MainThread]: On master: Close
[0m21:43:14.864620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:14.864873 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:43:14.865079 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:43:14.865259 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:43:14.865555 [info ] [MainThread]: 
[0m21:43:14.866725 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m21:43:14.868534 [debug] [MainThread]: Command end result
[0m21:43:14.888239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:43:14.891769 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:43:14.940782 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:43:14.941544 [info ] [MainThread]: 
[0m21:43:14.955060 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:43:14.956085 [info ] [MainThread]: 
[0m21:43:14.957046 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:43:14.957813 [info ] [MainThread]: 
[0m21:43:14.958741 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:43:14.960210 [debug] [MainThread]: Command `dbt run` failed at 21:43:14.959919 after 1.46 seconds
[0m21:43:14.960914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A99B3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A99385D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162A8571780>]}
[0m21:43:14.961385 [debug] [MainThread]: Flushing usage events
[0m21:43:16.273021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:30.111511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C3F8AA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40827890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40A17ED0>]}


============================== 21:45:30.115515 | 616ded49-5581-48a7-b711-0961340c6650 ==============================
[0m21:45:30.115515 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:45:30.116400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:30.296424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C3FF590F0>]}
[0m21:45:30.353631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C408D7BD0>]}
[0m21:45:30.356639 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:45:30.520783 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:45:30.642208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:45:30.642749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:45:30.682003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40AEA350>]}
[0m21:45:30.751946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:45:30.755292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:45:30.776178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C4084F4D0>]}
[0m21:45:30.776722 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:45:30.777473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41FF8750>]}
[0m21:45:30.779639 [info ] [MainThread]: 
[0m21:45:30.780421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:30.781031 [info ] [MainThread]: 
[0m21:45:30.781913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:45:30.786690 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:45:30.872328 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:45:30.873056 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:45:30.873445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:30.896381 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:45:30.897745 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:45:30.898717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:45:30.899138 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:45:30.904514 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.904795 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:45:30.905030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:30.905892 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:45:30.907011 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.907283 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:45:30.907905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:45:30.908347 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.908663 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:45:30.909153 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:45:30.909904 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:45:30.910139 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:45:30.910360 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:45:30.910725 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:45:30.911003 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:45:30.912931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:45:30.917306 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:45:30.917604 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:45:30.917845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:30.918493 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:45:30.918961 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:45:30.919316 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:45:30.932296 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:45:30.933845 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:45:30.934861 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:45:30.935204 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:45:30.937913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C422558B0>]}
[0m21:45:30.938333 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:30.938593 [debug] [MainThread]: On master: BEGIN
[0m21:45:30.938814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:30.939454 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:45:30.939721 [debug] [MainThread]: On master: COMMIT
[0m21:45:30.939971 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:30.940179 [debug] [MainThread]: On master: COMMIT
[0m21:45:30.940568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:45:30.940839 [debug] [MainThread]: On master: Close
[0m21:45:30.943726 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:45:30.944261 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:45:30.945271 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:45:30.945856 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:45:30.952205 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.953186 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:45:30.996676 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.997693 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.998080 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:45:30.998395 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:45:30.999127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:30.999462 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:45:30.999931 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:45:31.002578 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:45:31.003318 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:45:31.003820 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:45:31.013382 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:45:31.014185 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:45:31.020037 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:45:31.023166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C423E4950>]}
[0m21:45:31.023971 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.08s]
[0m21:45:31.025137 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:45:31.025782 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.027102 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:45:31.026302 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:45:31.028604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:45:31.028967 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.031032 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.031870 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.054123 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.055865 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.056379 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:45:31.056767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:31.057429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:31.057756 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.058071 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:45:31.059207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:31.064622 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.065559 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:45:31.066414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.069762 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.070309 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:45:31.071098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.091085 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:45:31.091597 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.091956 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:45:31.098360 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:45:31.103356 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:45:31.103716 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:45:31.108582 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:45:31.110755 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:45:31.111280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C422207E0>]}
[0m21:45:31.111791 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m21:45:31.112998 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:45:31.114224 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.114895 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:45:31.115862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:45:31.116310 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.119316 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.120499 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.123808 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.124646 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.125051 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:45:31.125383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:31.126052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:45:31.126360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.126657 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:45:31.127352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.129756 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.130061 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:45:31.130631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.132873 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.133320 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:45:31.133976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:45:31.136371 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:45:31.136895 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.137369 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:45:31.140958 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:45:31.143675 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:45:31.144102 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:45:31.147331 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:45:31.148705 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:45:31.149205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616ded49-5581-48a7-b711-0961340c6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41F26670>]}
[0m21:45:31.149757 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m21:45:31.150786 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:45:31.152965 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:31.153451 [debug] [MainThread]: On master: BEGIN
[0m21:45:31.154065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:31.155248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:45:31.155924 [debug] [MainThread]: On master: COMMIT
[0m21:45:31.156479 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:31.156895 [debug] [MainThread]: On master: COMMIT
[0m21:45:31.157511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:45:31.157810 [debug] [MainThread]: On master: Close
[0m21:45:31.158202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:31.158475 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:45:31.158688 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:45:31.158895 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:45:31.159194 [info ] [MainThread]: 
[0m21:45:31.160015 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:45:31.161728 [debug] [MainThread]: Command end result
[0m21:45:31.181466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:45:31.183967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:45:31.192731 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:45:31.193362 [info ] [MainThread]: 
[0m21:45:31.194302 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:45:31.195147 [info ] [MainThread]: 
[0m21:45:31.195976 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:45:31.196759 [info ] [MainThread]: 
[0m21:45:31.197542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:45:31.198774 [debug] [MainThread]: Command `dbt run` failed at 21:45:31.198619 after 1.29 seconds
[0m21:45:31.199150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41E9FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C41E305D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C40A61780>]}
[0m21:45:31.199495 [debug] [MainThread]: Flushing usage events
[0m21:45:32.725844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:13.085097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021301F2A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021302EB7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213030A7ED0>]}


============================== 21:48:13.090431 | 922f0575-482f-48c7-b32d-8a919e4110de ==============================
[0m21:48:13.090431 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:48:13.091605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:13.315279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213025E10F0>]}
[0m21:48:13.376091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021302F67AC0>]}
[0m21:48:13.380509 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:48:13.562862 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:48:13.687141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:13.687658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:13.732823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002130317A350>]}
[0m21:48:13.801976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:48:13.806030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:48:13.856644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021302EDF4D0>]}
[0m21:48:13.857377 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:48:13.858031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213046BC750>]}
[0m21:48:13.860554 [info ] [MainThread]: 
[0m21:48:13.861196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:13.861738 [info ] [MainThread]: 
[0m21:48:13.862452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:48:13.867516 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:48:13.959413 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:48:13.959842 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:48:13.960109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:14.105672 [debug] [ThreadPool]: SQL status: OK in 0.145 seconds
[0m21:48:14.108883 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:48:14.110280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:48:14.111228 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:48:14.123110 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.123871 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:48:14.124317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:14.125924 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:48:14.128215 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.128826 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:48:14.129669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:14.130064 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.130502 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:48:14.132098 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:48:14.133889 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:48:14.134499 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:48:14.135242 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:48:14.136086 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:14.136656 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:48:14.139302 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:48:14.149465 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:48:14.150238 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:48:14.151259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:14.153041 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:48:14.154250 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:48:14.155293 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:48:14.189498 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m21:48:14.192796 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:48:14.195699 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:48:14.196464 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:48:14.200627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213049314A0>]}
[0m21:48:14.201470 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.202069 [debug] [MainThread]: On master: BEGIN
[0m21:48:14.202769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:14.203713 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:48:14.204154 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.204502 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.204798 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.205308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:14.205669 [debug] [MainThread]: On master: Close
[0m21:48:14.209737 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.210300 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:48:14.211675 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:48:14.212232 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.224431 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.225976 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.258618 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.260071 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.260470 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:48:14.260830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:14.261527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.261889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:48:14.262225 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:48:14.270540 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    -- models/Test/a_campaign_interactions.sql

with raw_camp_data as (

    select *
    from "ae_exam_db"."main"."campaign_interactions"

)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:48:14.271068 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:48:14.271582 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:48:14.285603 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:48:14.285989 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:48:14.289209 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:48:14.291703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021304AC4950>]}
[0m21:48:14.292384 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.08s]
[0m21:48:14.293543 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:48:14.294153 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.296123 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:48:14.294624 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:48:14.297824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:48:14.298230 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.300393 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.301424 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.327256 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.328684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.329196 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:48:14.329530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:14.330186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.330512 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.330804 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:48:14.333887 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:14.339719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.340095 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:48:14.340980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.343615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.344125 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:48:14.345003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:14.362639 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:48:14.363087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.363425 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:48:14.371342 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:48:14.378101 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:48:14.378625 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:48:14.383691 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:48:14.386070 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:48:14.386672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213049203C0>]}
[0m21:48:14.387267 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:48:14.388192 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:48:14.388981 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.389678 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:48:14.390457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:48:14.390871 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.393893 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.395171 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.398539 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.399564 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.400130 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:48:14.400605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:14.401328 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.401649 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.401956 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:48:14.402644 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:14.405197 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.405779 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:48:14.406907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:14.411213 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.411673 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:48:14.412470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:14.414122 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:48:14.414475 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.414768 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:48:14.417893 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:14.420167 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:48:14.420544 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:48:14.424180 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:14.427384 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:48:14.428336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922f0575-482f-48c7-b32d-8a919e4110de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002130461A5D0>]}
[0m21:48:14.429221 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:48:14.430411 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:48:14.431980 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.432343 [debug] [MainThread]: On master: BEGIN
[0m21:48:14.432641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:14.433279 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:48:14.433593 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.433857 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:14.434100 [debug] [MainThread]: On master: COMMIT
[0m21:48:14.434542 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:14.434810 [debug] [MainThread]: On master: Close
[0m21:48:14.435155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:14.435368 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:48:14.435571 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:48:14.435764 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:48:14.436057 [info ] [MainThread]: 
[0m21:48:14.436655 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m21:48:14.438865 [debug] [MainThread]: Command end result
[0m21:48:14.461475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:48:14.463837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:48:14.471736 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:48:14.472509 [info ] [MainThread]: 
[0m21:48:14.473419 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:48:14.474457 [info ] [MainThread]: 
[0m21:48:14.475233 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:48:14.476459 [info ] [MainThread]: 
[0m21:48:14.477508 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:48:14.478963 [debug] [MainThread]: Command `dbt run` failed at 21:48:14.478735 after 1.69 seconds
[0m21:48:14.479598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213045980D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213045107D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213030F1780>]}
[0m21:48:14.480790 [debug] [MainThread]: Flushing usage events
[0m21:48:15.851073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:03.129613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BF46A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C03F7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C05E7ED0>]}


============================== 21:50:03.134499 | a35da4c1-35cb-4f38-956d-c2159769e729 ==============================
[0m21:50:03.134499 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:50:03.136512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:03.360654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BFB210F0>]}
[0m21:50:03.434509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C04A3AC0>]}
[0m21:50:03.439293 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:50:03.658686 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:50:03.787768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:03.788319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:03.834453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C06B6250>]}
[0m21:50:03.940249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:50:03.943014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:50:03.965985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C041F4D0>]}
[0m21:50:03.966763 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:50:03.967457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1BB8750>]}
[0m21:50:03.970168 [info ] [MainThread]: 
[0m21:50:03.970811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:03.971423 [info ] [MainThread]: 
[0m21:50:03.972318 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:50:03.982907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:50:04.067380 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:50:04.067801 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:50:04.068095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:04.112753 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m21:50:04.114496 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:50:04.115887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:50:04.116555 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:50:04.125681 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.126139 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:50:04.126421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:04.127389 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:04.128785 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.129092 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:50:04.129532 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:04.129793 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.130079 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:50:04.130665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:04.131681 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:50:04.132005 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:50:04.132266 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:50:04.132699 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:04.133060 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:50:04.137680 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:50:04.143465 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:50:04.143865 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:50:04.144119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:04.144658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:04.144948 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:50:04.145222 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:50:04.159642 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:50:04.161260 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:50:04.162372 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:50:04.162705 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:50:04.166158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1E21570>]}
[0m21:50:04.166817 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.167111 [debug] [MainThread]: On master: BEGIN
[0m21:50:04.167355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:04.167900 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:04.168156 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.168467 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.169034 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.169600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:04.169917 [debug] [MainThread]: On master: Close
[0m21:50:04.173025 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.173566 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:50:04.174366 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:50:04.174857 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.183223 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.186474 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.218213 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.219864 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.220533 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:50:04.221214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:04.221884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.222224 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:50:04.222511 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:50:04.223129 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google';
  );

[0m21:50:04.223408 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:50:04.223759 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: ROLLBACK
[0m21:50:04.229902 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.a_campaign_interactions'
[0m21:50:04.230252 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:50:04.233364 [debug] [Thread-1 (]: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:50:04.235950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1FB4A10>]}
[0m21:50:04.236812 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.a_campaign_interactions .............. [[31mERROR[0m in 0.06s]
[0m21:50:04.238216 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:50:04.238830 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.240275 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.a_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";".
[0m21:50:04.239491 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:50:04.241995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:50:04.242440 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.244646 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.246493 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.278306 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.279833 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.280392 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:50:04.280776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:04.281461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.281809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.282179 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:50:04.283256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.292451 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.292869 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:50:04.293642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.296650 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.297012 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:50:04.297665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.313944 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:50:04.314358 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.314638 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:50:04.322403 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:50:04.327102 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:50:04.327460 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:50:04.332871 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:50:04.335241 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:50:04.335901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1E103C0>]}
[0m21:50:04.337020 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:50:04.339093 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:50:04.340841 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.341391 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:50:04.342403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:50:04.342840 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.345613 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.346890 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.353347 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.356018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.356812 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:50:04.357184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:04.357895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:04.358249 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.358555 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:50:04.359307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.361851 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.362181 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:50:04.362768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.365068 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.365359 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:50:04.365927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:04.367359 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:50:04.367679 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.367945 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:50:04.372261 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:50:04.376709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:50:04.377262 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:50:04.380732 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:04.382161 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:50:04.382619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35da4c1-35cb-4f38-956d-c2159769e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1B065D0>]}
[0m21:50:04.383121 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:50:04.384571 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:50:04.388036 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.389063 [debug] [MainThread]: On master: BEGIN
[0m21:50:04.389587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:04.390960 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:04.391331 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.391644 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:04.391942 [debug] [MainThread]: On master: COMMIT
[0m21:50:04.392444 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:04.392830 [debug] [MainThread]: On master: Close
[0m21:50:04.393295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:04.393559 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:50:04.393872 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:50:04.394228 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:50:04.394821 [info ] [MainThread]: 
[0m21:50:04.395835 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m21:50:04.397680 [debug] [MainThread]: Command end result
[0m21:50:04.422905 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:50:04.427718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:50:04.434064 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:50:04.434616 [info ] [MainThread]: 
[0m21:50:04.436491 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:50:04.437971 [info ] [MainThread]: 
[0m21:50:04.439287 [error] [MainThread]:   Runtime Error in model a_campaign_interactions (models\Test\a_campaign_interactions.sql)
  Parser Error: syntax error at or near ";"
[0m21:50:04.440132 [info ] [MainThread]: 
[0m21:50:04.441949 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:50:04.443775 [debug] [MainThread]: Command `dbt run` failed at 21:50:04.443581 after 1.64 seconds
[0m21:50:04.444253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C1A880D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C19F87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C0631780>]}
[0m21:50:04.444639 [debug] [MainThread]: Flushing usage events
[0m21:50:06.953628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:02.985891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77606A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D776FF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7771E7ED0>]}


============================== 21:51:02.990295 | 2ab973f9-00ba-498f-a111-4cea6f43f81b ==============================
[0m21:51:02.990295 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:51:02.991350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:51:03.199693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7767210F0>]}
[0m21:51:03.264908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7770A7AC0>]}
[0m21:51:03.268217 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m21:51:03.475487 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:51:03.618050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:03.618502 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:03.663962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7772BA250>]}
[0m21:51:03.742571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:51:03.745702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:51:03.768725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77701F4D0>]}
[0m21:51:03.769623 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 428 macros
[0m21:51:03.770348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778878750>]}
[0m21:51:03.772319 [info ] [MainThread]: 
[0m21:51:03.773217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:03.773992 [info ] [MainThread]: 
[0m21:51:03.775020 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:51:03.780025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m21:51:03.868941 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m21:51:03.869371 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m21:51:03.869726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:03.917859 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m21:51:03.919265 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m21:51:03.921251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m21:51:03.922557 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m21:51:03.931121 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.931557 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m21:51:03.931829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:03.932774 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:03.934058 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.934379 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m21:51:03.934850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:03.935104 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.935350 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m21:51:03.935836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:03.936870 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:51:03.937194 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m21:51:03.937460 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m21:51:03.938037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:03.938362 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m21:51:03.940614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m21:51:03.945588 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:51:03.945953 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m21:51:03.946207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:03.946782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:03.947050 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m21:51:03.947313 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m21:51:03.962085 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:51:03.963727 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m21:51:03.964869 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m21:51:03.965228 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m21:51:03.969042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778AE1570>]}
[0m21:51:03.969744 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:03.970084 [debug] [MainThread]: On master: BEGIN
[0m21:51:03.970376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:03.971002 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:51:03.971361 [debug] [MainThread]: On master: COMMIT
[0m21:51:03.971706 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:03.971999 [debug] [MainThread]: On master: COMMIT
[0m21:51:03.972497 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:03.972832 [debug] [MainThread]: On master: Close
[0m21:51:03.976242 [debug] [Thread-1 (]: Began running node model.ae_exam_project.a_campaign_interactions
[0m21:51:03.976884 [info ] [Thread-1 (]: 1 of 3 START sql view model main.a_campaign_interactions ....................... [RUN]
[0m21:51:03.978711 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.a_campaign_interactions'
[0m21:51:03.979243 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.a_campaign_interactions
[0m21:51:03.989522 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.a_campaign_interactions"
[0m21:51:03.992222 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.a_campaign_interactions
[0m21:51:04.028944 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.030170 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.030635 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: BEGIN
[0m21:51:04.031001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:04.031679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.032032 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.032337 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m21:51:04.033320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.038804 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.039191 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */
alter view "ae_exam_db"."main"."a_campaign_interactions__dbt_tmp" rename to "a_campaign_interactions"
[0m21:51:04.039875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.052198 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: COMMIT
[0m21:51:04.052732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.053053 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: COMMIT
[0m21:51:04.058890 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:04.063510 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.a_campaign_interactions"
[0m21:51:04.063915 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.a_campaign_interactions"} */
drop view if exists "ae_exam_db"."main"."a_campaign_interactions__dbt_backup" cascade
[0m21:51:04.064611 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.068206 [debug] [Thread-1 (]: On model.ae_exam_project.a_campaign_interactions: Close
[0m21:51:04.072695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778C74350>]}
[0m21:51:04.073751 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.a_campaign_interactions .................. [[32mOK[0m in 0.09s]
[0m21:51:04.075141 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.a_campaign_interactions
[0m21:51:04.075654 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.076103 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:51:04.077264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.a_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m21:51:04.077688 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.080582 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.082379 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.130561 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.131868 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.132393 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m21:51:04.132890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:04.133680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.134035 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.134370 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:51:04.135518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.140150 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.140710 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:51:04.142599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.147179 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.147659 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:51:04.148401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.157096 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:51:04.157548 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.158074 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m21:51:04.162308 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:51:04.165048 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m21:51:04.165413 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:51:04.168283 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:51:04.169664 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m21:51:04.170217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778ACD180>]}
[0m21:51:04.170769 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m21:51:04.171996 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m21:51:04.173211 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.173946 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:51:04.175220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m21:51:04.175823 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.179117 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.180483 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.184429 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.185493 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.185905 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m21:51:04.186315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:04.187049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:04.187432 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.187750 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:51:04.188494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.191576 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.191944 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m21:51:04.192593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.194951 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.195269 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:51:04.195823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:04.197182 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:51:04.197533 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.197833 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m21:51:04.201096 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:51:04.205575 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m21:51:04.206309 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:51:04.209834 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:51:04.212231 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m21:51:04.212923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab973f9-00ba-498f-a111-4cea6f43f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D778CA9810>]}
[0m21:51:04.213626 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m21:51:04.215159 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m21:51:04.217014 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:04.217399 [debug] [MainThread]: On master: BEGIN
[0m21:51:04.217667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:04.218259 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:51:04.218585 [debug] [MainThread]: On master: COMMIT
[0m21:51:04.218871 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:04.219123 [debug] [MainThread]: On master: COMMIT
[0m21:51:04.219551 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:04.219814 [debug] [MainThread]: On master: Close
[0m21:51:04.220188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:04.220476 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m21:51:04.220701 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m21:51:04.220956 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m21:51:04.221296 [info ] [MainThread]: 
[0m21:51:04.221817 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m21:51:04.223534 [debug] [MainThread]: Command end result
[0m21:51:04.257672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m21:51:04.262336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m21:51:04.270044 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m21:51:04.270673 [info ] [MainThread]: 
[0m21:51:04.271593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:04.272602 [info ] [MainThread]: 
[0m21:51:04.273306 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:51:04.275074 [debug] [MainThread]: Command `dbt run` succeeded at 21:51:04.274792 after 1.48 seconds
[0m21:51:04.276106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7787480D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7786C07D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D777231780>]}
[0m21:51:04.276882 [debug] [MainThread]: Flushing usage events
[0m21:51:06.550865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:32.146548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61A57A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B507890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B6F7ED0>]}


============================== 19:00:32.157229 | 29acc819-19fe-480f-8dc1-2ac8e7327ed3 ==============================
[0m19:00:32.157229 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:00:32.158887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:00:32.688133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61AC310F0>]}
[0m19:00:32.756604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B5B3AC0>]}
[0m19:00:32.802805 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:00:33.326811 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:00:33.478854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:33.479316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:33.486196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ae_exam_project.example
[0m19:00:33.545926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B7C6250>]}
[0m19:00:33.643903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:00:33.680787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:00:33.769344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B52F4D0>]}
[0m19:00:33.770127 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 428 macros
[0m19:00:33.771311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CCCC9F0>]}
[0m19:00:33.774748 [info ] [MainThread]: 
[0m19:00:33.776010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:33.777276 [info ] [MainThread]: 
[0m19:00:33.778765 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:00:33.790743 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:00:38.172896 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:00:38.173511 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:00:38.173940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:38.273264 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m19:00:38.276055 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:00:38.277533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m19:00:38.278295 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m19:00:38.287770 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.288258 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:00:38.288616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:38.290014 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:00:38.292150 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.292718 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m19:00:38.293675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:00:38.294164 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.294581 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m19:00:38.296353 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:00:38.297418 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:00:38.297752 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:00:38.298037 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:00:38.298557 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:00:38.298935 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m19:00:38.301727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m19:00:38.309565 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:00:38.310254 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m19:00:38.310726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:38.311764 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:00:38.312208 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:00:38.312578 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:00:38.336660 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:00:38.339308 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m19:00:38.362233 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m19:00:38.362859 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m19:00:38.367401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CF41A50>]}
[0m19:00:38.368239 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.368693 [debug] [MainThread]: On master: BEGIN
[0m19:00:38.369145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:38.369999 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:00:38.370353 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.370730 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.371251 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.371847 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:00:38.372214 [debug] [MainThread]: On master: Close
[0m19:00:38.376349 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.377010 [info ] [Thread-1 (]: 1 of 3 START sql view model main.model_stg_campaign_interactions ............... [RUN]
[0m19:00:38.378948 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:00:38.379558 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.389139 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.391580 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.433879 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.436353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.437166 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:00:38.437569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:38.438286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.438739 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:00:38.439110 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    select * from FROM "ae_exam_db"."main"."campaign_interactions"
  );

[0m19:00:38.447689 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    select * from FROM "ae_exam_db"."main"."campaign_interactions"
  );

[0m19:00:38.448078 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:00:38.448504 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: ROLLBACK
[0m19:00:38.706214 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:00:38.707019 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:00:38.711129 [debug] [Thread-1 (]: Runtime Error in model model_stg_campaign_interactions (models\staging\model_stg_campaign_interactions.sql)
  Parser Error: syntax error at or near "FROM"
[0m19:00:38.713972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61D0D0A10>]}
[0m19:00:38.714783 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.model_stg_campaign_interactions ...... [[31mERROR[0m in 0.33s]
[0m19:00:38.716654 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:00:38.717098 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.718374 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_stg_campaign_interactions' to be skipped because of status 'error'.  Reason: Runtime Error in model model_stg_campaign_interactions (models\staging\model_stg_campaign_interactions.sql)
  Parser Error: syntax error at or near "FROM".
[0m19:00:38.717639 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m19:00:38.720254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m19:00:38.720716 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.724162 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.725814 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.756840 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.758674 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.759607 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m19:00:38.760162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:38.761305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.762032 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.762494 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m19:00:38.767599 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:00:38.777183 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.777759 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:00:38.781632 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:00:38.787666 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.788520 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:00:38.789710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.809239 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:00:38.809906 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.810304 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:00:38.818042 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:00:38.822986 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:00:38.823371 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m19:00:38.828331 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:00:38.831352 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m19:00:38.832395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CF2C470>]}
[0m19:00:38.833764 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.11s]
[0m19:00:38.835188 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m19:00:38.836446 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.837593 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m19:00:38.839010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m19:00:38.839641 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.843388 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.845112 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.852303 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.854532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.855378 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m19:00:38.855965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:38.856975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.857431 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.857843 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m19:00:38.858750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:00:38.865359 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.866029 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m19:00:38.867678 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.871112 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.871832 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:00:38.873529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:00:38.876834 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:00:38.877386 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.877779 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:00:38.881546 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:00:38.885533 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:00:38.886517 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m19:00:38.890471 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:00:38.892999 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m19:00:38.893749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29acc819-19fe-480f-8dc1-2ac8e7327ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CC325D0>]}
[0m19:00:38.894474 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m19:00:38.895952 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m19:00:38.898070 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.898494 [debug] [MainThread]: On master: BEGIN
[0m19:00:38.898845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:38.899751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:00:38.900207 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.900549 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:38.900824 [debug] [MainThread]: On master: COMMIT
[0m19:00:38.901320 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:00:38.901726 [debug] [MainThread]: On master: Close
[0m19:00:38.902206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:38.902504 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m19:00:38.902749 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m19:00:38.902982 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m19:00:38.903315 [info ] [MainThread]: 
[0m19:00:38.904034 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m19:00:38.905913 [debug] [MainThread]: Command end result
[0m19:00:38.933940 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:00:38.937860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:00:38.951122 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:00:38.952158 [info ] [MainThread]: 
[0m19:00:38.953986 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:00:38.955237 [info ] [MainThread]: 
[0m19:00:38.957084 [error] [MainThread]:   Runtime Error in model model_stg_campaign_interactions (models\staging\model_stg_campaign_interactions.sql)
  Parser Error: syntax error at or near "FROM"
[0m19:00:38.958651 [info ] [MainThread]: 
[0m19:00:38.960088 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m19:00:38.961987 [debug] [MainThread]: Command `dbt run` failed at 19:00:38.961806 after 7.28 seconds
[0m19:00:38.962512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B8C4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B71D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61B741780>]}
[0m19:00:38.963015 [debug] [MainThread]: Flushing usage events
[0m19:00:41.052822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:45.173255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43C91A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D8A7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43DA97ED0>]}


============================== 19:02:45.179773 | f5d68e6e-3c06-48f9-a47d-244b872e504e ==============================
[0m19:02:45.179773 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:02:45.181976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:02:45.416607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43CFD10F0>]}
[0m19:02:45.481865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D957AC0>]}
[0m19:02:45.486778 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:02:45.685048 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:02:45.831470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:45.831895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:45.838293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ae_exam_project.example
[0m19:02:45.893008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43DB6A250>]}
[0m19:02:45.980825 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:02:45.983613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:02:46.031326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D8CF4D0>]}
[0m19:02:46.032462 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 428 macros
[0m19:02:46.033620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F0709F0>]}
[0m19:02:46.035981 [info ] [MainThread]: 
[0m19:02:46.036903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:02:46.037814 [info ] [MainThread]: 
[0m19:02:46.038922 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:02:46.048357 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:02:46.150756 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:02:46.151237 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:02:46.151694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:46.199653 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m19:02:46.201326 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:02:46.202374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m19:02:46.203015 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m19:02:46.210406 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.210881 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:02:46.211200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:46.212473 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:02:46.214080 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.214534 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m19:02:46.215090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:02:46.215472 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.215778 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m19:02:46.216365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:02:46.217341 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:02:46.217679 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:02:46.217960 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:02:46.218432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:02:46.218746 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m19:02:46.221230 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m19:02:46.227114 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:02:46.227481 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m19:02:46.227804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:46.228567 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:02:46.228935 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:02:46.229228 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:02:46.244616 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m19:02:46.246445 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m19:02:46.247742 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m19:02:46.248116 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m19:02:46.251531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F2D1B20>]}
[0m19:02:46.252048 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.252337 [debug] [MainThread]: On master: BEGIN
[0m19:02:46.252595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:46.253235 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:02:46.253552 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.253908 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.254213 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.254687 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:02:46.255005 [debug] [MainThread]: On master: Close
[0m19:02:46.260280 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.261026 [info ] [Thread-1 (]: 1 of 3 START sql view model main.model_stg_campaign_interactions ............... [RUN]
[0m19:02:46.262719 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:02:46.263765 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.271875 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.273034 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.315530 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.316855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.317461 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:02:46.317908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:02:46.318730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.319175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.319548 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m19:02:46.320609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.327778 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.328276 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:02:46.329187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:02:46.344564 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:02:46.345134 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.345506 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:02:46.350544 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:02:46.355744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:02:46.356443 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:02:46.357555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.361632 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:02:46.365827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F460410>]}
[0m19:02:46.366744 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.model_stg_campaign_interactions .......... [[32mOK[0m in 0.10s]
[0m19:02:46.367888 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:02:46.368467 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.369069 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m19:02:46.370505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.my_first_dbt_model)
[0m19:02:46.370924 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.373934 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.375160 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.403961 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.405434 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.406056 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: BEGIN
[0m19:02:46.406543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:46.407349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.407810 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.408191 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */

  
    
    

    create  table
      "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m19:02:46.409537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.415400 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.415994 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:02:46.417324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.421580 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.422068 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
alter table "ae_exam_db"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:02:46.422924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:02:46.434532 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:02:46.435209 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.435661 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: COMMIT
[0m19:02:46.439694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:02:46.442462 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_first_dbt_model"
[0m19:02:46.442827 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_first_dbt_model"} */
drop table if exists "ae_exam_db"."main"."my_first_dbt_model__dbt_backup" cascade
[0m19:02:46.447098 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:02:46.449057 [debug] [Thread-1 (]: On model.ae_exam_project.my_first_dbt_model: Close
[0m19:02:46.449843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F2BD390>]}
[0m19:02:46.450815 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m19:02:46.452567 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_first_dbt_model
[0m19:02:46.453896 [debug] [Thread-1 (]: Began running node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.454589 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m19:02:46.455840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.my_first_dbt_model, now model.ae_exam_project.my_second_dbt_model)
[0m19:02:46.456394 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.459185 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.461736 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.465537 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.467101 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.467797 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: BEGIN
[0m19:02:46.468291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:46.469239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.469711 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.470135 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */

  
  create view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "ae_exam_db"."main"."my_first_dbt_model"
where id = 1
  );

[0m19:02:46.471149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.477852 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.478685 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m19:02:46.480503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:02:46.484385 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.484890 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
alter view "ae_exam_db"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:02:46.485857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:02:46.487682 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:02:46.488085 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.488431 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: COMMIT
[0m19:02:46.491766 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:02:46.496018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.my_second_dbt_model"
[0m19:02:46.496620 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.my_second_dbt_model"} */
drop view if exists "ae_exam_db"."main"."my_second_dbt_model__dbt_backup" cascade
[0m19:02:46.500203 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:02:46.503238 [debug] [Thread-1 (]: On model.ae_exam_project.my_second_dbt_model: Close
[0m19:02:46.504176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d68e6e-3c06-48f9-a47d-244b872e504e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43F4A3070>]}
[0m19:02:46.504933 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m19:02:46.506764 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.my_second_dbt_model
[0m19:02:46.509570 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.510590 [debug] [MainThread]: On master: BEGIN
[0m19:02:46.511451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:46.513346 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:02:46.514151 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.514544 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:46.514845 [debug] [MainThread]: On master: COMMIT
[0m19:02:46.515452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:02:46.515842 [debug] [MainThread]: On master: Close
[0m19:02:46.516370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:46.516713 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m19:02:46.517003 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m19:02:46.517257 [debug] [MainThread]: Connection 'model.ae_exam_project.my_second_dbt_model' was properly closed.
[0m19:02:46.517630 [info ] [MainThread]: 
[0m19:02:46.518563 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m19:02:46.520301 [debug] [MainThread]: Command end result
[0m19:02:46.550365 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:02:46.554821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:02:46.564562 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:02:46.565448 [info ] [MainThread]: 
[0m19:02:46.566728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:46.567787 [info ] [MainThread]: 
[0m19:02:46.569214 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:02:46.570955 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:46.570742 after 1.71 seconds
[0m19:02:46.571441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43EF69D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43D9D8150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B43DAE1780>]}
[0m19:02:46.571868 [debug] [MainThread]: Flushing usage events
[0m19:02:46.580591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:45.299993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74044A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7413D7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7415C7ED0>]}


============================== 19:16:45.307877 | 4755ab24-648c-451c-bf87-1ee084e7da3f ==============================
[0m19:16:45.307877 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:16:45.310217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:16:45.685398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B740B010F0>]}
[0m19:16:45.754529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B741483AC0>]}
[0m19:16:45.761114 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:16:46.143553 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:16:46.284721 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m19:16:46.285304 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\staging\my_second_dbt_model.sql
[0m19:16:46.285796 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\staging\my_first_dbt_model.sql
[0m19:16:46.370926 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ae_exam_project.example
[0m19:16:46.388775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B741699E50>]}
[0m19:16:46.472384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:16:46.476710 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:16:46.542694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7413FF4D0>]}
[0m19:16:46.543474 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m19:16:46.544331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742C60F30>]}
[0m19:16:46.547163 [info ] [MainThread]: 
[0m19:16:46.548459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:46.549202 [info ] [MainThread]: 
[0m19:16:46.550202 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:16:46.552689 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:16:46.673713 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:16:46.674233 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:16:46.674662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:46.837747 [debug] [ThreadPool]: SQL status: OK in 0.163 seconds
[0m19:16:46.840004 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:16:46.841204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m19:16:46.842369 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m19:16:46.850636 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.851088 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:16:46.851420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:46.853007 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:16:46.854845 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.855246 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m19:16:46.855938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:16:46.856305 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.856606 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m19:16:46.858374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:16:46.859552 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:16:46.859978 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m19:16:46.860321 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m19:16:46.860930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:16:46.861396 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m19:16:46.864142 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m19:16:46.871049 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:16:46.871512 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m19:16:46.871850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:46.872549 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:16:46.872883 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m19:16:46.873213 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:16:46.913470 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m19:16:46.915848 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m19:16:46.919271 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m19:16:46.919769 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m19:16:46.923847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742C13A00>]}
[0m19:16:46.924697 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:46.925165 [debug] [MainThread]: On master: BEGIN
[0m19:16:46.925550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:46.926267 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:16:46.926734 [debug] [MainThread]: On master: COMMIT
[0m19:16:46.927110 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:46.927456 [debug] [MainThread]: On master: COMMIT
[0m19:16:46.928140 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:16:46.928724 [debug] [MainThread]: On master: Close
[0m19:16:46.933908 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:46.935073 [info ] [Thread-1 (]: 1 of 1 START sql view model main.model_stg_campaign_interactions ............... [RUN]
[0m19:16:46.936895 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:16:46.937847 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:46.947385 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:46.950585 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:46.999253 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.001243 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.001822 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:16:47.002488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:47.003581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:16:47.004098 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.004509 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m19:16:47.007079 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:16:47.014952 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.015439 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."main"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:16:47.017440 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:16:47.020370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.020733 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:16:47.021376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:16:47.041114 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:16:47.041774 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.042342 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:16:47.048564 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:16:47.056707 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:16:47.057657 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."main"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:16:47.062574 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:16:47.065057 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:16:47.067673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4755ab24-648c-451c-bf87-1ee084e7da3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74302CF50>]}
[0m19:16:47.068419 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.model_stg_campaign_interactions .......... [[32mOK[0m in 0.13s]
[0m19:16:47.070495 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:16:47.072735 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:47.073182 [debug] [MainThread]: On master: BEGIN
[0m19:16:47.073491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:47.074175 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:16:47.074878 [debug] [MainThread]: On master: COMMIT
[0m19:16:47.075305 [debug] [MainThread]: Using duckdb connection "master"
[0m19:16:47.075608 [debug] [MainThread]: On master: COMMIT
[0m19:16:47.076119 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:16:47.076439 [debug] [MainThread]: On master: Close
[0m19:16:47.076872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:47.077144 [debug] [MainThread]: Connection 'create_ae_exam_db_main' was properly closed.
[0m19:16:47.077383 [debug] [MainThread]: Connection 'list_ae_exam_db_main' was properly closed.
[0m19:16:47.077596 [debug] [MainThread]: Connection 'model.ae_exam_project.model_stg_campaign_interactions' was properly closed.
[0m19:16:47.077872 [info ] [MainThread]: 
[0m19:16:47.078687 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m19:16:47.080166 [debug] [MainThread]: Command end result
[0m19:16:47.115777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:16:47.121173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:16:47.132344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:16:47.132971 [info ] [MainThread]: 
[0m19:16:47.134312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:47.135278 [info ] [MainThread]: 
[0m19:16:47.136135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:16:47.137623 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:47.137451 after 2.10 seconds
[0m19:16:47.138102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742BEFD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742FB6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B742FB6D50>]}
[0m19:16:47.138514 [debug] [MainThread]: Flushing usage events
[0m19:16:48.462263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:51.249639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A62F5A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A63EE7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A640D7ED0>]}


============================== 19:19:51.258897 | a37cb77d-3016-4281-8c9a-2b630217eda6 ==============================
[0m19:19:51.258897 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:19:51.260796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:51.575891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A636110F0>]}
[0m19:19:51.649284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A63F97AC0>]}
[0m19:19:51.654934 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:19:51.926069 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:19:52.051889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:52.052312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:52.088088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A641A8A50>]}
[0m19:19:52.154900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:19:52.158641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:19:52.217363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A63F0F4D0>]}
[0m19:19:52.218257 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m19:19:52.219377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A656F4BB0>]}
[0m19:19:52.222815 [info ] [MainThread]: 
[0m19:19:52.223893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:52.224786 [info ] [MainThread]: 
[0m19:19:52.226128 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:19:52.228676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:19:52.399252 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:19:52.399882 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:19:52.400279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:52.522453 [debug] [ThreadPool]: SQL status: OK in 0.122 seconds
[0m19:19:52.524868 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:19:52.526238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m19:19:52.526825 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:19:52.532993 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.533523 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:19:52.533898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:52.535093 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:19:52.536416 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.536714 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:19:52.537191 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:19:52.537474 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.537779 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:19:52.539309 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:19:52.540522 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:19:52.540912 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:19:52.541423 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:19:52.548091 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:19:52.548616 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:19:52.550875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m19:19:52.557746 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:19:52.558131 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:19:52.558432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:52.559165 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:19:52.559514 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:19:52.559824 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:19:52.580360 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:19:52.581708 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:19:52.583765 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:19:52.584233 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:19:52.585386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65AD01F0>]}
[0m19:19:52.585928 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.586281 [debug] [MainThread]: On master: BEGIN
[0m19:19:52.586593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:52.587311 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:19:52.587686 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.588010 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.588293 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.588833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:19:52.589228 [debug] [MainThread]: On master: Close
[0m19:19:52.593862 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.594502 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:19:52.595720 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:19:52.596261 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.610312 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.611984 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.660918 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.662166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.662762 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:19:52.663197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:52.664133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:52.664602 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.665002 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with raw_camp_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from raw_camp_data
where platform = 'google'
  );

[0m19:19:52.666123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:19:52.672687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.673095 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:19:52.675228 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:19:52.689058 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:19:52.689570 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.689997 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:19:52.698111 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:19:52.703086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:19:52.703495 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:19:52.704282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:19:52.706793 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:19:52.709893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37cb77d-3016-4281-8c9a-2b630217eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A656CB7D0>]}
[0m19:19:52.711268 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.11s]
[0m19:19:52.713420 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:19:52.715733 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.716335 [debug] [MainThread]: On master: BEGIN
[0m19:19:52.716798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:52.717762 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:19:52.718266 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.718837 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:52.719214 [debug] [MainThread]: On master: COMMIT
[0m19:19:52.719928 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:19:52.720350 [debug] [MainThread]: On master: Close
[0m19:19:52.720881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:52.721328 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m19:19:52.721674 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m19:19:52.722006 [debug] [MainThread]: Connection 'model.ae_exam_project.model_stg_campaign_interactions' was properly closed.
[0m19:19:52.722437 [info ] [MainThread]: 
[0m19:19:52.723320 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m19:19:52.725453 [debug] [MainThread]: Command end result
[0m19:19:52.762916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:19:52.766038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:19:52.775800 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:19:52.776668 [info ] [MainThread]: 
[0m19:19:52.777740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:52.778807 [info ] [MainThread]: 
[0m19:19:52.779835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:19:52.781722 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:52.781279 after 1.87 seconds
[0m19:19:52.782667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A656C3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65A1FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65A1D630>]}
[0m19:19:52.783483 [debug] [MainThread]: Flushing usage events
[0m19:19:54.022033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:44.977696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD17C1A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18B97890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18D87ED0>]}


============================== 19:38:44.986197 | 9e4fdc09-2286-40df-8cb0-fb8f1acae517 ==============================
[0m19:38:44.986197 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:38:44.987981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:38:45.436851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD182C10F0>]}
[0m19:38:45.541286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18C47AC0>]}
[0m19:38:45.547773 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:38:45.803979 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:38:45.936709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:38:45.937127 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:38:45.970000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18E58A50>]}
[0m19:38:46.044744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:38:46.049791 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:38:46.113500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD18BBF4D0>]}
[0m19:38:46.114343 [info ] [MainThread]: Found 2 models, 2 sources, 429 macros
[0m19:38:46.115333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A394670>]}
[0m19:38:46.118454 [info ] [MainThread]: 
[0m19:38:46.119581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:46.120793 [info ] [MainThread]: 
[0m19:38:46.122130 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:38:46.135360 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:38:46.268492 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:38:46.268993 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:38:46.269396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:46.418535 [debug] [ThreadPool]: SQL status: OK in 0.149 seconds
[0m19:38:46.421859 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:38:46.423040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m19:38:46.423638 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:38:46.429550 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.429889 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:38:46.430150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:46.431396 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:38:46.432837 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.433140 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:38:46.433596 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:38:46.433920 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.434271 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:38:46.435781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:38:46.436694 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:38:46.437015 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:38:46.437285 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:38:46.437721 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:38:46.438026 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:38:46.440488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m19:38:46.446632 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:38:46.446966 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:38:46.447272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:46.447837 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:38:46.448178 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:38:46.448502 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:38:46.469379 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:38:46.470873 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:38:46.473106 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:38:46.473484 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:38:46.475337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A52FC70>]}
[0m19:38:46.475838 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.476134 [debug] [MainThread]: On master: BEGIN
[0m19:38:46.476379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:46.476966 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:38:46.477256 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.477569 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.477850 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.478350 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:38:46.478776 [debug] [MainThread]: On master: Close
[0m19:38:46.483635 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.484700 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:38:46.486213 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:38:46.486791 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.495364 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.499232 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.538321 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.540636 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.541425 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:38:46.541845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:38:46.542651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.543162 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.543542 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m19:38:46.544547 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.552187 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.552630 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:38:46.554062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.556960 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.557326 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:38:46.557982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:38:46.570800 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:38:46.571293 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.571608 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:38:46.576753 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:38:46.582103 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:38:46.582488 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:38:46.585817 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:38:46.589112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:38:46.592538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A33F4D0>]}
[0m19:38:46.593357 [info ] [Thread-1 (]: 1 of 2 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.10s]
[0m19:38:46.595017 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:38:46.595615 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.596204 [info ] [Thread-1 (]: 2 of 2 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m19:38:46.597179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m19:38:46.597664 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.600140 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.601489 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.605089 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.606687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.607545 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m19:38:46.608137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:46.609225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.609748 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.610269 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m19:38:46.612393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.617275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.617791 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m19:38:46.618728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:38:46.620475 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:38:46.621035 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.621515 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:38:46.625586 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:38:46.629178 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:38:46.629622 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m19:38:46.630364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:38:46.632033 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m19:38:46.632721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4fdc09-2286-40df-8cb0-fb8f1acae517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A32BC20>]}
[0m19:38:46.633500 [info ] [Thread-1 (]: 2 of 2 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.04s]
[0m19:38:46.635170 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m19:38:46.637782 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.638669 [debug] [MainThread]: On master: BEGIN
[0m19:38:46.639354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:38:46.640645 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:38:46.641650 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.642382 [debug] [MainThread]: Using duckdb connection "master"
[0m19:38:46.642924 [debug] [MainThread]: On master: COMMIT
[0m19:38:46.643651 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:38:46.644022 [debug] [MainThread]: On master: Close
[0m19:38:46.644463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:46.644750 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m19:38:46.644987 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m19:38:46.645213 [debug] [MainThread]: Connection 'model.ae_exam_project.model_stg_campaign_master' was properly closed.
[0m19:38:46.645530 [info ] [MainThread]: 
[0m19:38:46.646552 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m19:38:46.648249 [debug] [MainThread]: Command end result
[0m19:38:46.669285 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:38:46.674517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:38:46.683009 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:38:46.683622 [info ] [MainThread]: 
[0m19:38:46.684635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:46.685492 [info ] [MainThread]: 
[0m19:38:46.687098 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:38:46.689020 [debug] [MainThread]: Command `dbt run` succeeded at 19:38:46.688737 after 2.10 seconds
[0m19:38:46.689849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A776CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A59BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A298B50>]}
[0m19:38:46.690522 [debug] [MainThread]: Flushing usage events
[0m19:38:48.444770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:24.486165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C40BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5047890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5237ED0>]}


============================== 22:55:24.491091 | 1741de61-ecea-45f1-a05d-bbe4101ea44c ==============================
[0m22:55:24.491091 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:55:24.491892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:24.650944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C47710F0>]}
[0m22:55:24.702618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C50F7AC0>]}
[0m22:55:24.705465 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:55:24.857540 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:55:24.953869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:24.954238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:24.980923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5308650>]}
[0m22:55:25.033351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m22:55:25.037112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m22:55:25.061677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C506F4D0>]}
[0m22:55:25.062446 [info ] [MainThread]: Found 6 models, 3 sources, 429 macros
[0m22:55:25.063442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C67E4C90>]}
[0m22:55:25.068512 [info ] [MainThread]: 
[0m22:55:25.069178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:55:25.069786 [info ] [MainThread]: 
[0m22:55:25.070595 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:55:25.076460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m22:55:25.140240 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:55:25.140636 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:55:25.140905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:25.172374 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m22:55:25.174731 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:55:25.176863 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:55:25.177255 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:55:25.177619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.178538 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.179732 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:55:25.180490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_main)
[0m22:55:25.181644 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "main"
"
[0m22:55:25.189123 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.189569 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:55:25.189861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.190769 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.191879 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.192315 [debug] [ThreadPool]: On create_ae_exam_db_main: BEGIN
[0m22:55:25.192921 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.193393 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.193752 [debug] [ThreadPool]: On create_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_main"} */

    
    
        create schema if not exists "ae_exam_db"."main"
    
[0m22:55:25.195818 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:55:25.196838 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m22:55:25.197178 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_main"
[0m22:55:25.197413 [debug] [ThreadPool]: On create_ae_exam_db_main: COMMIT
[0m22:55:25.197880 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.198119 [debug] [ThreadPool]: On create_ae_exam_db_main: Close
[0m22:55:25.198577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_main, now create_ae_exam_db_staging)
[0m22:55:25.198952 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m22:55:25.200791 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.201107 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:55:25.201370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.202211 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.203261 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.203548 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m22:55:25.204001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.204231 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.204444 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m22:55:25.204875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.205619 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m22:55:25.205874 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:55:25.206080 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m22:55:25.206475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.206756 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m22:55:25.208938 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_main'
[0m22:55:25.214376 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m22:55:25.214745 [debug] [ThreadPool]: On list_ae_exam_db_main: BEGIN
[0m22:55:25.214980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:25.215484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:55:25.215758 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_main"
[0m22:55:25.215974 [debug] [ThreadPool]: On list_ae_exam_db_main: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_main"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:55:25.231525 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:55:25.233166 [debug] [ThreadPool]: On list_ae_exam_db_main: ROLLBACK
[0m22:55:25.234308 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_main'
[0m22:55:25.234573 [debug] [ThreadPool]: On list_ae_exam_db_main: Close
[0m22:55:25.235006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_main, now list_ae_exam_db_staging)
[0m22:55:25.236279 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m22:55:25.236610 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m22:55:25.238165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:25.238679 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:55:25.238909 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m22:55:25.239122 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:55:25.242197 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:55:25.243311 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m22:55:25.243809 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m22:55:25.244041 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m22:55:25.245310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C698FBA0>]}
[0m22:55:25.245685 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.245906 [debug] [MainThread]: On master: BEGIN
[0m22:55:25.246101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:25.246520 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.246760 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.246994 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.247175 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.247517 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.247773 [debug] [MainThread]: On master: Close
[0m22:55:25.250851 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.251301 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m22:55:25.252088 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m22:55:25.252458 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.258503 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.260550 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.287887 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.290144 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.290533 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m22:55:25.290816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:25.291482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.291875 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.292181 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m22:55:25.293551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.299039 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.299422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m22:55:25.301301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:55:25.305563 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.305936 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m22:55:25.306605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.316825 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m22:55:25.317257 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.317525 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m22:55:25.322132 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:55:25.326311 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:55:25.326677 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m22:55:25.330241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.333113 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m22:55:25.335491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C66F7F50>]}
[0m22:55:25.336095 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.08s]
[0m22:55:25.336997 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m22:55:25.337414 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.337761 [info ] [Thread-1 (]: 2 of 4 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m22:55:25.338489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m22:55:25.338851 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.341010 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.342266 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.344960 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.346441 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.346997 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m22:55:25.347456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:25.348105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.348389 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.348700 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m22:55:25.349653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.352440 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.352847 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m22:55:25.353639 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.355757 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.356048 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m22:55:25.356583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.357707 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m22:55:25.358058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.358337 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m22:55:25.361501 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.363931 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:55:25.364298 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m22:55:25.367209 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.368343 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m22:55:25.368779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C67BE150>]}
[0m22:55:25.369320 [info ] [Thread-1 (]: 2 of 4 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m22:55:25.370150 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m22:55:25.370482 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.370829 [info ] [Thread-1 (]: 3 of 4 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m22:55:25.371614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_order_transactions)
[0m22:55:25.371890 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.373847 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.375032 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.378116 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.380080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.380576 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m22:55:25.380963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:25.381754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.382089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.382364 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m22:55:25.383266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.385377 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.385666 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m22:55:25.386232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.387371 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m22:55:25.387672 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.387914 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m22:55:25.390999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.393143 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:55:25.393858 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m22:55:25.395281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.396821 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m22:55:25.397348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C6BE0550>]}
[0m22:55:25.397851 [info ] [Thread-1 (]: 3 of 4 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m22:55:25.398682 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m22:55:25.399484 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.399939 [info ] [Thread-1 (]: 4 of 4 START sql view model main.model_int_campaign_conversions ................ [RUN]
[0m22:55:25.400659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m22:55:25.400966 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.403502 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.404760 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.407221 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.409108 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.409796 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m22:55:25.410370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:25.411004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.411303 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.411577 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."main"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m22:55:25.413463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:55:25.416175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.416505 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."main"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m22:55:25.417210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.418165 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m22:55:25.418447 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.418690 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m22:55:25.421991 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:55:25.424140 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:55:25.424637 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."main"."model_int_campaign_conversions__dbt_backup" cascade
[0m22:55:25.425575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:55:25.427306 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m22:55:25.428042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1741de61-ecea-45f1-a05d-bbe4101ea44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C6AEAF50>]}
[0m22:55:25.428763 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.model_int_campaign_conversions ........... [[32mOK[0m in 0.03s]
[0m22:55:25.429613 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m22:55:25.430982 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.431284 [debug] [MainThread]: On master: BEGIN
[0m22:55:25.431494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:25.431943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.432166 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.432356 [debug] [MainThread]: Using duckdb connection "master"
[0m22:55:25.432534 [debug] [MainThread]: On master: COMMIT
[0m22:55:25.432916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:55:25.433247 [debug] [MainThread]: On master: Close
[0m22:55:25.433628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:25.433884 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m22:55:25.434055 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m22:55:25.434230 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m22:55:25.434488 [info ] [MainThread]: 
[0m22:55:25.435071 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m22:55:25.436333 [debug] [MainThread]: Command end result
[0m22:55:25.452252 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m22:55:25.454516 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m22:55:25.461196 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m22:55:25.461765 [info ] [MainThread]: 
[0m22:55:25.462528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:55:25.463069 [info ] [MainThread]: 
[0m22:55:25.463769 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:55:25.464745 [debug] [MainThread]: Command `dbt run` succeeded at 22:55:25.464606 after 1.15 seconds
[0m22:55:25.465075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C5281780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282BECFC360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282C40116D0>]}
[0m22:55:25.465363 [debug] [MainThread]: Flushing usage events
[0m22:55:26.620148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:51.316465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024669E2A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466ADB7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466AFA7ED0>]}


============================== 23:03:51.322308 | b76cd84d-fcac-47b8-a639-040d5a1acb61 ==============================
[0m23:03:51.322308 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:03:51.323092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:03:51.558982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466A4E90F0>]}
[0m23:03:51.612421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466AE67AC0>]}
[0m23:03:51.615825 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:03:51.764742 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:03:51.860480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:03:51.860836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:03:51.896149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466B078850>]}
[0m23:03:51.947995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:03:51.950857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:03:51.980276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466ADDF4D0>]}
[0m23:03:51.980847 [info ] [MainThread]: Found 6 models, 3 sources, 429 macros
[0m23:03:51.981452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76cd84d-fcac-47b8-a639-040d5a1acb61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466C56CC90>]}
[0m23:03:51.983663 [info ] [MainThread]: 
[0m23:03:51.984215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:51.984671 [info ] [MainThread]: 
[0m23:03:51.985450 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:03:51.990174 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m23:03:52.054805 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:03:52.055169 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.055402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:52.217136 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.217573 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:03:52.219393 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:03:52.219786 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.220025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:52.315190 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:03:52.315721 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:03:52.317235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:52.317555 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m23:03:52.317806 [info ] [MainThread]: 
[0m23:03:52.318421 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m23:03:52.319011 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 15188)
[0m23:03:52.320007 [debug] [MainThread]: Command `dbt run` failed at 23:03:52.319887 after 1.30 seconds
[0m23:03:52.320331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466C7275F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466AE52D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466C3E7290>]}
[0m23:03:52.320641 [debug] [MainThread]: Flushing usage events
[0m23:03:54.046086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:06.021704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021817D1A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818C97890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818E87ED0>]}


============================== 23:04:06.025132 | 86619b78-09c6-4747-aaff-038655e24215 ==============================
[0m23:04:06.025132 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:04:06.026475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:06.191015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218183C90F0>]}
[0m23:04:06.242237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818D47AC0>]}
[0m23:04:06.245052 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:04:06.387629 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:04:06.483953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:06.484328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:06.511383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818F58850>]}
[0m23:04:06.566848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:04:06.568956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:04:06.590953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818CBF4D0>]}
[0m23:04:06.591462 [info ] [MainThread]: Found 6 models, 3 sources, 429 macros
[0m23:04:06.592046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A45CC90>]}
[0m23:04:06.593655 [info ] [MainThread]: 
[0m23:04:06.594179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:06.594700 [info ] [MainThread]: 
[0m23:04:06.595384 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:04:06.599644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m23:04:06.657921 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:04:06.658303 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:04:06.658562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:06.734602 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m23:04:06.736588 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:04:06.738358 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:04:06.738693 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:04:06.738934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.739832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.740921 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:04:06.741697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m23:04:06.742630 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m23:04:06.748743 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.749129 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:04:06.749364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.750291 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.751425 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.751680 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m23:04:06.752085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.752312 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.752509 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m23:04:06.754150 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.754984 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:04:06.755232 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:04:06.755441 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:04:06.770672 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m23:04:06.771037 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m23:04:06.771509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m23:04:06.771842 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m23:04:06.773595 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.773860 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:04:06.774081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.774874 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.775856 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.776101 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m23:04:06.776471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.776699 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.776895 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m23:04:06.777267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.778038 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:04:06.778341 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:04:06.778582 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:04:06.778970 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.779212 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m23:04:06.780983 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m23:04:06.785055 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:04:06.785350 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m23:04:06.785559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:06.786144 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:04:06.786393 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:04:06.786604 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.802872 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m23:04:06.804019 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m23:04:06.806489 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m23:04:06.806804 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m23:04:06.807227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m23:04:06.809141 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:04:06.809448 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m23:04:06.809655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.810162 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.810581 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:04:06.810818 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.813403 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:04:06.814377 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m23:04:06.814859 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m23:04:06.815080 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m23:04:06.815452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m23:04:06.816999 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:04:06.817240 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m23:04:06.817442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.817878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.818088 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:04:06.818414 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.821125 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:04:06.822088 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m23:04:06.822538 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m23:04:06.822763 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m23:04:06.823130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m23:04:06.824513 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:04:06.824767 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m23:04:06.824971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.825430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:04:06.825660 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:04:06.825866 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:04:06.828871 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:04:06.829982 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m23:04:06.830528 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m23:04:06.830765 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m23:04:06.832220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A617BA0>]}
[0m23:04:06.832585 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:06.832798 [debug] [MainThread]: On master: BEGIN
[0m23:04:06.833016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:06.833472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:06.833677 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.833874 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:06.834055 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.834373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:06.834614 [debug] [MainThread]: On master: Close
[0m23:04:06.838129 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.838633 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m23:04:06.839456 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m23:04:06.839832 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.845340 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.846810 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.875314 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.876713 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.877073 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m23:04:06.877330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:06.877929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.878191 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.878446 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m23:04:06.879289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.884438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.884787 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m23:04:06.886006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.888528 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.888955 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m23:04:06.889578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.899030 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:04:06.899422 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.899683 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:04:06.903245 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.907174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:04:06.907494 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m23:04:06.910892 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.912993 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m23:04:06.915332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A2DBD10>]}
[0m23:04:06.915905 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m23:04:06.917332 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:04:06.917690 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.918045 [info ] [Thread-1 (]: 2 of 4 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m23:04:06.918815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m23:04:06.919179 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.921465 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.922627 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.925245 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.926276 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.926645 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m23:04:06.926888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:06.927446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.927711 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.927980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m23:04:06.928765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.931286 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.931597 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m23:04:06.932164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.934930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.935446 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m23:04:06.936208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.937589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:04:06.937916 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.938165 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:04:06.941190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.942921 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:04:06.943256 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m23:04:06.946306 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.947816 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m23:04:06.948409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A433E30>]}
[0m23:04:06.949444 [info ] [Thread-1 (]: 2 of 4 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m23:04:06.950421 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m23:04:06.950757 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.951117 [info ] [Thread-1 (]: 3 of 4 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m23:04:06.951803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_order_transactions)
[0m23:04:06.952120 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.954458 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.955350 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.957591 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.958659 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.959008 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m23:04:06.959263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:06.959856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.960118 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.960363 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m23:04:06.961152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.963223 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.963532 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m23:04:06.964200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.966831 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.967189 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m23:04:06.967920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.969427 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:04:06.970038 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.970313 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:04:06.973433 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.975299 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:04:06.975612 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m23:04:06.978720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:06.980232 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m23:04:06.980748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A89DE50>]}
[0m23:04:06.981274 [info ] [Thread-1 (]: 3 of 4 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m23:04:06.982131 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m23:04:06.982927 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:06.983348 [info ] [Thread-1 (]: 4 of 4 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m23:04:06.984095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m23:04:06.984663 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:06.987495 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.988601 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:06.991023 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.991935 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.992278 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m23:04:06.992521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:06.993053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:06.993326 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.993618 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m23:04:06.995132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:06.997716 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:06.998132 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m23:04:06.999025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:04:07.000871 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m23:04:07.001297 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:07.001621 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m23:04:07.004731 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:04:07.006684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m23:04:07.006982 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m23:04:07.007535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:04:07.008585 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m23:04:07.009063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86619b78-09c6-4747-aaff-038655e24215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181A8D96D0>]}
[0m23:04:07.009519 [info ] [Thread-1 (]: 4 of 4 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m23:04:07.010356 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m23:04:07.011651 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:07.011929 [debug] [MainThread]: On master: BEGIN
[0m23:04:07.012145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:07.012632 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:07.012869 [debug] [MainThread]: On master: COMMIT
[0m23:04:07.013075 [debug] [MainThread]: Using duckdb connection "master"
[0m23:04:07.013350 [debug] [MainThread]: On master: COMMIT
[0m23:04:07.013815 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:04:07.014073 [debug] [MainThread]: On master: Close
[0m23:04:07.014387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:07.014595 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m23:04:07.014779 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m23:04:07.014966 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m23:04:07.015245 [info ] [MainThread]: 
[0m23:04:07.015834 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:04:07.017136 [debug] [MainThread]: Command end result
[0m23:04:07.035607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:04:07.037806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:04:07.043522 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m23:04:07.043896 [info ] [MainThread]: 
[0m23:04:07.044475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:07.045057 [info ] [MainThread]: 
[0m23:04:07.045911 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:04:07.047001 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:07.046855 after 1.17 seconds
[0m23:04:07.047330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818ED1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021812A0C360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021815FB0B90>]}
[0m23:04:07.047668 [debug] [MainThread]: Flushing usage events
[0m23:04:08.088062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:31.838503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4152A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D424B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D426A7ED0>]}


============================== 00:11:31.843361 | 2a3895b1-86d6-4d8b-accd-a24399b046da ==============================
[0m00:11:31.843361 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:11:31.844431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:32.169427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D41BE10F0>]}
[0m00:11:32.226238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D42563AC0>]}
[0m00:11:32.229915 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:11:32.507865 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:11:32.607983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:32.608359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:32.636180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D42778850>]}
[0m00:11:32.692747 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:11:32.695636 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:11:32.735402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D424DF4D0>]}
[0m00:11:32.735920 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:11:32.736430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3895b1-86d6-4d8b-accd-a24399b046da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D43CD4C90>]}
[0m00:11:32.738561 [info ] [MainThread]: 
[0m00:11:32.739134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:32.739640 [info ] [MainThread]: 
[0m00:11:32.740283 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:11:32.745130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:11:32.818388 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:32.818771 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:32.819093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:33.012857 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.013329 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:11:33.015084 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:33.015445 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.015697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:33.164671 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.165402 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:11:33.168123 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:33.168835 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.169364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:33.282610 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:33.283014 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:11:33.284365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:33.284694 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m00:11:33.285197 [info ] [MainThread]: 
[0m00:11:33.285645 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m00:11:33.286206 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 12736)
[0m00:11:33.287221 [debug] [MainThread]: Command `dbt run` failed at 00:11:33.287082 after 1.82 seconds
[0m00:11:33.287539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D43E87860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D42552D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D43B3F410>]}
[0m00:11:33.287850 [debug] [MainThread]: Flushing usage events
[0m00:11:35.362832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:39.386044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D4ACA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5A47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5C37ED0>]}


============================== 00:11:39.389773 | 0ac483ee-72fb-47a3-95e8-12baa2d0ba06 ==============================
[0m00:11:39.389773 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:11:39.390502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:11:39.554576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D51710F0>]}
[0m00:11:39.605818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5AF3AC0>]}
[0m00:11:39.608685 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:11:39.751721 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:11:39.848199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:39.848557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:39.875181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5D08850>]}
[0m00:11:39.928981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:11:39.931036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:11:39.949108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D5A6F4D0>]}
[0m00:11:39.949584 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:11:39.950456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7264C90>]}
[0m00:11:39.952531 [info ] [MainThread]: 
[0m00:11:39.953090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:39.953527 [info ] [MainThread]: 
[0m00:11:39.954296 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:11:39.958661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:11:40.014166 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:40.014576 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:40.014874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:40.088273 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m00:11:40.089966 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:11:40.091621 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:40.091897 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:40.092125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.093077 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.094304 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:11:40.096865 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:11:40.097549 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:11:40.097889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.099017 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.100175 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:11:40.100900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m00:11:40.101868 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:11:40.108228 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.108685 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:11:40.108926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.109799 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.110899 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.111186 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:11:40.111623 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.111827 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.112024 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:11:40.113279 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.114050 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:11:40.114325 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:11:40.114521 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:11:40.114895 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.115137 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:11:40.115608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:11:40.115987 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:11:40.117306 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.117577 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:11:40.117814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.118720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.119834 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.120112 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:11:40.120503 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.120730 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.120927 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:11:40.121420 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.122085 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:11:40.122317 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:11:40.122509 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:11:40.122856 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.123082 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:11:40.123495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:11:40.123961 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:11:40.125155 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.125387 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:11:40.125643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.126329 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.127330 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.127553 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:11:40.127908 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.128228 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.128456 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:11:40.128844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.129506 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:11:40.129730 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:11:40.129925 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:11:40.135382 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m00:11:40.135758 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:11:40.137660 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m00:11:40.142290 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:11:40.142587 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:11:40.142795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:40.143434 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.143750 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:11:40.143976 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.160374 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:11:40.161687 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:11:40.163757 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:11:40.164095 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:11:40.164565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m00:11:40.165794 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:11:40.166040 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:11:40.166235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.166964 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.167215 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:11:40.167488 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.170373 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:11:40.171588 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:11:40.172089 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:11:40.172337 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:11:40.172715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m00:11:40.174010 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:11:40.174240 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:11:40.174440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.175356 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:11:40.175601 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:11:40.175815 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.178503 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:11:40.179503 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:11:40.179957 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:11:40.180182 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:11:40.180548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:11:40.182139 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:11:40.182394 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:11:40.182584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:40.183034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:40.183238 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:11:40.183478 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:11:40.186190 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:11:40.187144 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:11:40.187650 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:11:40.187876 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:11:40.188722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7650940>]}
[0m00:11:40.189154 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.189376 [debug] [MainThread]: On master: BEGIN
[0m00:11:40.189563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:40.189990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.190198 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.190392 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.190583 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.190930 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.191180 [debug] [MainThread]: On master: Close
[0m00:11:40.194573 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.194993 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:11:40.195764 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:11:40.196143 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.202031 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.204286 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.230395 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.232135 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.232662 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:11:40.232953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:40.233556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.233830 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.234072 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:11:40.234887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.239686 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.240062 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:11:40.241054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.243708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.244033 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:11:40.244609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.254700 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:11:40.255096 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.255363 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:11:40.258639 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.262553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:11:40.263065 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:11:40.266312 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.268365 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:11:40.270601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D70CBE90>]}
[0m00:11:40.271196 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:11:40.272784 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:11:40.273088 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.273474 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:11:40.274120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:11:40.274439 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.276760 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.278211 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.280576 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.281895 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.282353 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:11:40.282644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.283248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.283534 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.283796 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:11:40.284561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.287137 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.287672 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:11:40.288741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.291233 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.291569 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:11:40.292211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.293296 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:11:40.293675 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.293944 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:11:40.297306 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.299230 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:11:40.299578 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:11:40.302445 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:11:40.303795 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:11:40.304268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D76BC1B0>]}
[0m00:11:40.304754 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:11:40.305588 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:11:40.305910 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.306306 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:11:40.306982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:11:40.307313 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.309804 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.310771 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.313392 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.314480 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.314964 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:11:40.315234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.315892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.316187 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.316449 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:11:40.317207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.319468 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.319783 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:11:40.320383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.321437 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:11:40.321783 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.322056 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:11:40.325091 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.327715 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:11:40.328159 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:11:40.328829 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.329929 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:11:40.330372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D76DEA30>]}
[0m00:11:40.330825 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.02s]
[0m00:11:40.331544 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:11:40.331913 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.332383 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:11:40.333088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:11:40.333411 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.335753 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.337417 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.340498 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.341820 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.342434 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:11:40.342742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.343354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.343625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.343870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:11:40.344648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.346990 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.347329 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:11:40.348010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.350320 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.350690 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:11:40.351327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:40.352388 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:11:40.352731 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.353018 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:11:40.356415 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:40.358534 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:11:40.358922 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:11:40.361683 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:11:40.362999 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:11:40.363604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7629D50>]}
[0m00:11:40.364090 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:11:40.364972 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:11:40.365704 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.366150 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:11:40.366952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:11:40.367282 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.370454 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.372145 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.374411 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.375351 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.375681 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:11:40.375919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:40.376467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:40.376732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:11:40.376987 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:11:40.382207 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:11:40.382672 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:11:40.383123 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: ROLLBACK
[0m00:11:40.395564 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_campaign_conversions'
[0m00:11:40.395961 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:11:40.399654 [debug] [Thread-1 (]: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:11:40.400266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac483ee-72fb-47a3-95e8-12baa2d0ba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D725CF30>]}
[0m00:11:40.401173 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model intermediate.model_int_campaign_conversions  [[31mERROR[0m in 0.03s]
[0m00:11:40.402247 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:11:40.402873 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_campaign_conversions' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^.
[0m00:11:40.404152 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:11:40.404489 [info ] [Thread-1 (]: 6 of 6 SKIP relation mart.model_mart_campaign_performance ...................... [[33mSKIP[0m]
[0m00:11:40.405190 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:11:40.406438 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.406710 [debug] [MainThread]: On master: BEGIN
[0m00:11:40.406920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:40.407405 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.407686 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.407984 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:40.408217 [debug] [MainThread]: On master: COMMIT
[0m00:11:40.408685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:40.408919 [debug] [MainThread]: On master: Close
[0m00:11:40.409224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:40.409409 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m00:11:40.409591 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m00:11:40.409757 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m00:11:40.410021 [info ] [MainThread]: 
[0m00:11:40.410617 [info ] [MainThread]: Finished running 1 Table model, 5 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m00:11:40.412030 [debug] [MainThread]: Command end result
[0m00:11:40.481664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:11:40.483634 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:11:40.488820 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:11:40.489349 [info ] [MainThread]: 
[0m00:11:40.490181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:11:40.491056 [info ] [MainThread]: 
[0m00:11:40.491676 [error] [MainThread]:   Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:11:40.492271 [info ] [MainThread]: 
[0m00:11:40.492873 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m00:11:40.493777 [debug] [MainThread]: Command `dbt run` failed at 00:11:40.493678 after 1.24 seconds
[0m00:11:40.494106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D7768350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D1E733B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D778BB90>]}
[0m00:11:40.494402 [debug] [MainThread]: Flushing usage events
[0m00:11:41.762894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:14:26.545063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E848A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9407890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E95F7ED0>]}


============================== 00:14:26.550540 | f07fb684-517f-4f89-9d16-6e296b9b5fff ==============================
[0m00:14:26.550540 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:14:26.551344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:26.760234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B310F0>]}
[0m00:14:26.811525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E94B3AC0>]}
[0m00:14:26.814748 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:14:26.961143 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:14:27.075831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:27.076224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:27.102918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E96C8850>]}
[0m00:14:27.155906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:14:27.158461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:14:27.183140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E942F4D0>]}
[0m00:14:27.183618 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:14:27.184451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EABACC90>]}
[0m00:14:27.186482 [info ] [MainThread]: 
[0m00:14:27.187131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:27.187681 [info ] [MainThread]: 
[0m00:14:27.188304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:14:27.193233 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:14:27.252148 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:14:27.252535 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:14:27.252776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:27.331537 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m00:14:27.333085 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:14:27.334899 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:14:27.335214 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:14:27.335541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.336470 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.337617 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:14:27.339740 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:14:27.340127 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:14:27.340471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.341594 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.342830 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:14:27.343482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m00:14:27.344244 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:14:27.350064 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.350406 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:14:27.350624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.351546 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.352667 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.352926 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:14:27.353341 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.353644 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.353868 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:14:27.355834 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.356741 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:14:27.357014 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:14:27.357248 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:14:27.357724 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.357983 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:14:27.358472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:14:27.358851 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:14:27.360245 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.360534 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:14:27.360768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.361661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.362808 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.363061 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:14:27.363668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.364371 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.365124 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:14:27.366362 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.369007 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:14:27.369295 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:14:27.369520 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:14:27.369915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.370149 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:14:27.370567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:14:27.370962 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:14:27.372435 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.372692 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:14:27.372896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.373587 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.374581 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.374813 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:14:27.375170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.375388 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.375578 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:14:27.375952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.376599 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:14:27.376805 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:14:27.377093 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:14:27.377455 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.377673 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:14:27.379783 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m00:14:27.384363 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:14:27.384706 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:14:27.384959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:27.385644 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.385897 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:14:27.386159 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.522574 [debug] [ThreadPool]: SQL status: OK in 0.136 seconds
[0m00:14:27.523837 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:14:27.540421 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:14:27.540745 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:14:27.541307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:14:27.542522 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:14:27.542794 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:14:27.543034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.543675 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:14:27.543968 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:14:27.544202 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.547036 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:14:27.548119 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:14:27.548628 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:14:27.548857 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:14:27.549417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m00:14:27.550601 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:14:27.550834 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:14:27.551150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.551622 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.551851 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:14:27.552061 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.554753 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:14:27.555782 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:14:27.556295 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:14:27.556510 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:14:27.556977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:14:27.558624 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:14:27.558889 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:14:27.559133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:27.559591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:14:27.559838 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:14:27.560061 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:14:27.562766 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:14:27.563933 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:14:27.564451 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:14:27.564673 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:14:27.573279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAFA06D0>]}
[0m00:14:27.573892 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.574151 [debug] [MainThread]: On master: BEGIN
[0m00:14:27.574339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:27.574805 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.575025 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.575217 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.575395 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.575713 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.575920 [debug] [MainThread]: On master: Close
[0m00:14:27.587387 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.587851 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:14:27.588707 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:14:27.589034 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.594826 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.595812 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.631489 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.632606 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.632980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:14:27.633231 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:27.633837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.634156 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.634410 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:14:27.635205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.640751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.641159 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:14:27.657193 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:14:27.659817 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.660143 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:14:27.660741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.670719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:14:27.671149 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.671432 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:14:27.710960 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m00:14:27.716735 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:14:27.717121 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:14:27.737883 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m00:14:27.741222 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:14:27.743861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAAB7E90>]}
[0m00:14:27.744488 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.15s]
[0m00:14:27.745760 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:14:27.746090 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.746637 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:14:27.747554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:14:27.747872 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.750221 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.751096 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.753415 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.754365 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.754701 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:14:27.754947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.755514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.755770 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.756005 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:14:27.756728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.758936 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.759239 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:14:27.759798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.762002 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.762293 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:14:27.763241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.764743 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:14:27.765067 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.765334 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:14:27.807617 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m00:14:27.809395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:14:27.809699 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:14:27.831441 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:14:27.833222 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:14:27.833907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EB0101B0>]}
[0m00:14:27.834660 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.09s]
[0m00:14:27.836171 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:14:27.836526 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.836936 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:14:27.837642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:14:27.837977 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.840200 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.841267 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.843934 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.844889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.845303 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:14:27.845566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.846118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.846372 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.846614 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:14:27.847382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.849554 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.849858 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:14:27.850414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.852489 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.852782 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:14:27.853410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.854363 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:14:27.854664 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.854906 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:14:27.875017 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m00:14:27.877418 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:14:27.877905 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:14:27.894670 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:14:27.895791 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:14:27.896205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAFFC0F0>]}
[0m00:14:27.896628 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.06s]
[0m00:14:27.897407 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:14:27.897745 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.898083 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:14:27.898762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:14:27.899157 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.901314 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.902513 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.906133 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.907166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.907579 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:14:27.907821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.908374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.908644 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.908886 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:14:27.909651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.911742 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.912029 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:14:27.912566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.914590 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.914873 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:14:27.915388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:14:27.916353 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:14:27.916628 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.916869 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:14:27.920820 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:14:27.923058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:14:27.923422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:14:27.926653 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:14:27.928053 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:14:27.928546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EAE363D0>]}
[0m00:14:27.929103 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:14:27.929958 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:14:27.930675 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.931117 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:14:27.931632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:14:27.932009 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.934431 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.935590 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.937921 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.939036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.939432 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:14:27.939797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:27.940442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:14:27.940794 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:14:27.941119 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:14:27.949972 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_timestamp,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_timestamp,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:14:27.950381 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:14:27.950760 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: ROLLBACK
[0m00:14:27.962593 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_campaign_conversions'
[0m00:14:27.962960 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:14:27.966158 [debug] [Thread-1 (]: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:14:27.966614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07fb684-517f-4f89-9d16-6e296b9b5fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EABB4F30>]}
[0m00:14:27.967147 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model intermediate.model_int_campaign_conversions  [[31mERROR[0m in 0.03s]
[0m00:14:27.968079 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:14:27.968679 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_campaign_conversions' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^.
[0m00:14:27.969952 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:14:27.970386 [info ] [Thread-1 (]: 6 of 6 SKIP relation mart.model_mart_campaign_performance ...................... [[33mSKIP[0m]
[0m00:14:27.971127 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:14:27.972620 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.972885 [debug] [MainThread]: On master: BEGIN
[0m00:14:27.973085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:27.973575 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.973815 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.974009 [debug] [MainThread]: Using duckdb connection "master"
[0m00:14:27.974202 [debug] [MainThread]: On master: COMMIT
[0m00:14:27.974557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:14:27.974795 [debug] [MainThread]: On master: Close
[0m00:14:27.975075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:27.975275 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m00:14:27.975449 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m00:14:27.975608 [debug] [MainThread]: Connection 'model.ae_exam_project.model_int_campaign_conversions' was properly closed.
[0m00:14:27.975860 [info ] [MainThread]: 
[0m00:14:27.976486 [info ] [MainThread]: Finished running 1 Table model, 5 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m00:14:27.978021 [debug] [MainThread]: Command end result
[0m00:14:28.045944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:14:28.048358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:14:28.053912 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:14:28.054308 [info ] [MainThread]: 
[0m00:14:28.054885 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:14:28.055657 [info ] [MainThread]: 
[0m00:14:28.056371 [error] [MainThread]:   Runtime Error in model model_int_campaign_conversions (models\intermediate\model_int_campaign_conversions.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 7:     interaction_timestamp,
              ^
[0m00:14:28.057003 [info ] [MainThread]: 
[0m00:14:28.057547 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m00:14:28.058336 [debug] [MainThread]: Command `dbt run` failed at 00:14:28.058213 after 1.78 seconds
[0m00:14:28.058656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E582F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8AE7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EB10FFB0>]}
[0m00:14:28.059026 [debug] [MainThread]: Flushing usage events
[0m00:14:30.358204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:15.218655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA3AFA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4A77890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4C67ED0>]}


============================== 00:16:15.222327 | 66bdb0f1-a2af-43c6-8d59-afb0e395a138 ==============================
[0m00:16:15.222327 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:16:15.223133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:15.410010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA41A10F0>]}
[0m00:16:15.476425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4B27AC0>]}
[0m00:16:15.479906 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:16:15.654799 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:16:15.791573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:15.792226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:15.844573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4D38850>]}
[0m00:16:15.911170 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:16:15.914252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:16:15.943569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4A9F4D0>]}
[0m00:16:15.944463 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:16:15.945149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66bdb0f1-a2af-43c6-8d59-afb0e395a138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA6310C90>]}
[0m00:16:15.947882 [info ] [MainThread]: 
[0m00:16:15.948748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:15.949349 [info ] [MainThread]: 
[0m00:16:15.950598 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:16:15.956050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:16:16.026318 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:16.026772 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.027140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:16.406256 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.406623 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:16:16.408635 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:16.409153 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.409444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:16.519185 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.519689 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:16:16.521499 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:16.521811 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.522022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:16.626362 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:16.626728 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:16:16.627767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:16.628018 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m00:16:16.628253 [info ] [MainThread]: 
[0m00:16:16.628858 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m00:16:16.629630 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 10268)
[0m00:16:16.630863 [debug] [MainThread]: Command `dbt run` failed at 00:16:16.630739 after 1.71 seconds
[0m00:16:16.631237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA64C7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA4B12D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA617B590>]}
[0m00:16:16.631537 [debug] [MainThread]: Flushing usage events
[0m00:16:17.872138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:22.052066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCBACA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCA47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCC37ED0>]}


============================== 00:16:22.056185 | a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a ==============================
[0m00:16:22.056185 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:16:22.056894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:16:22.242312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCC1710F0>]}
[0m00:16:22.301770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCAF3AC0>]}
[0m00:16:22.304945 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:16:22.477262 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:16:22.597083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:22.597723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:22.629808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCD0C850>]}
[0m00:16:22.692483 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:16:22.694836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:16:22.716523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCA6F4D0>]}
[0m00:16:22.717653 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:16:22.718403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE234C90>]}
[0m00:16:22.721189 [info ] [MainThread]: 
[0m00:16:22.721923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:22.722435 [info ] [MainThread]: 
[0m00:16:22.723163 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:16:22.729654 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:16:22.802592 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:22.803182 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:22.803656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:22.893660 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m00:16:22.895887 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:16:22.898062 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:22.898648 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:22.898933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.899851 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.901005 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:16:22.903152 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:16:22.903594 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:16:22.903889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.904855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.905918 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:16:22.906588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:16:22.907610 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:16:22.915660 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.916120 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:16:22.916408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.917487 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.918707 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.918998 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:16:22.919454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.919715 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.919935 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:16:22.921135 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.921952 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:16:22.922234 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:16:22.922468 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:16:22.922903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.923165 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:16:22.923634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:16:22.924062 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:16:22.925479 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.925761 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:16:22.926000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.926816 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.928106 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.928426 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:16:22.928905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.929173 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.929431 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:16:22.930068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.931135 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:16:22.931507 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:16:22.931760 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:16:22.932249 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.932556 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:16:22.933374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:16:22.934216 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:16:22.935791 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.936141 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:16:22.936421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.937370 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.939087 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.939401 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:16:22.939879 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.940132 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.940355 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:16:22.940846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.941619 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:16:22.941922 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:16:22.942155 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:16:22.942585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:22.942855 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:16:22.944863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:16:22.950256 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:16:22.950656 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:16:22.950970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:22.951724 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.952058 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:16:22.952330 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:22.973684 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:16:22.974977 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:16:22.977443 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:16:22.977832 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:16:22.978367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:16:22.979871 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:16:22.980212 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:16:22.980465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.981148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.981436 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:16:22.981676 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:22.985824 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:16:22.987568 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:16:22.988217 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:16:22.988511 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:16:22.989019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:16:22.990520 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:16:22.990836 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:16:22.991832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:22.992384 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:16:22.992650 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:16:22.992977 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:22.996215 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:16:22.997479 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:16:22.998082 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:16:22.998354 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:16:22.998810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:16:23.000688 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:16:23.001061 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:16:23.001298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:23.001823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:16:23.002077 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:16:23.002299 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:16:23.005517 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:16:23.006777 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:16:23.007378 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:16:23.007665 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:16:23.008504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE620390>]}
[0m00:16:23.009020 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.009287 [debug] [MainThread]: On master: BEGIN
[0m00:16:23.009511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:23.010096 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:16:23.010385 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.010620 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.010816 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.011253 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:16:23.011515 [debug] [MainThread]: On master: Close
[0m00:16:23.014365 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.014997 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:16:23.015840 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:16:23.016199 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.023766 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.025355 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.058408 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.059546 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.060134 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:16:23.060551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:23.061333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.061653 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.061944 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:16:23.064905 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.071961 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.072423 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:16:23.073718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.076772 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.077242 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:16:23.077944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.089780 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:16:23.090253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.090549 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:16:23.095765 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:16:23.100773 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:16:23.101194 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:16:23.105330 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:16:23.107735 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:16:23.110339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE097E90>]}
[0m00:16:23.111042 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.09s]
[0m00:16:23.112045 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:16:23.112630 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.113253 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:16:23.114160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:16:23.114593 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.117466 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.118537 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.121120 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.122162 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.122541 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:16:23.122817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.123512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.123992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.124359 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:16:23.125235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.128476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.128894 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:16:23.129561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.134026 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.134458 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:16:23.135258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.136589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:16:23.137052 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.137477 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:16:23.140827 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.142761 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:16:23.143170 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:16:23.146079 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.147426 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:16:23.148117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE68C1B0>]}
[0m00:16:23.148689 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:16:23.149586 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:16:23.150075 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.151134 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:16:23.152053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:16:23.152551 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.155069 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.156160 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.159362 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.160471 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.160987 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:16:23.161331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.161921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.162239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.162548 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:16:23.163290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.165865 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.166986 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:16:23.168347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.170954 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.171376 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:16:23.172077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.173222 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:16:23.173631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.173932 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:16:23.177142 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.179515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:16:23.179917 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:16:23.183098 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.184889 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:16:23.185454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE6780F0>]}
[0m00:16:23.186025 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:16:23.187251 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:16:23.187846 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.188327 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:16:23.189034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:16:23.189383 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.191645 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.192751 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.195828 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.196926 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.197435 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:16:23.197744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.198398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.198860 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.199299 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:16:23.201201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.204152 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.204565 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:16:23.205282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.207923 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.208381 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:16:23.209130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.210225 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:16:23.210581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.210897 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:16:23.214033 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.217519 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:16:23.218028 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:16:23.221467 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.222880 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:16:23.223458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE4B73D0>]}
[0m00:16:23.224341 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:16:23.225260 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:16:23.226245 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.226697 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:16:23.227454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:16:23.227849 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.230576 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.232390 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.235745 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.236933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.237460 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:16:23.237757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:23.238556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.239132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.239538 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:16:23.241202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:16:23.246123 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.246556 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:16:23.247326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.248756 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:16:23.249472 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.250182 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:16:23.253852 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:16:23.256154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:16:23.256546 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:16:23.257209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:16:23.258545 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:16:23.259096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE6D0C20>]}
[0m00:16:23.259642 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:16:23.260484 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:16:23.261327 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.261781 [info ] [Thread-1 (]: 6 of 6 START sql Table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:16:23.262461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:16:23.262931 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.267928 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:16:23.269891 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.353451 [debug] [Thread-1 (]: Compilation Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m00:16:23.354183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a03ee5b9-2bf4-49a2-936d-4bfde22fbe4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE21B590>]}
[0m00:16:23.354808 [error] [Thread-1 (]: 6 of 6 ERROR creating sql Table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:16:23.355769 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:16:23.356599 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb').
[0m00:16:23.359039 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.359598 [debug] [MainThread]: On master: BEGIN
[0m00:16:23.360023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:23.360836 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:16:23.361347 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.361749 [debug] [MainThread]: Using duckdb connection "master"
[0m00:16:23.362124 [debug] [MainThread]: On master: COMMIT
[0m00:16:23.362969 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:16:23.363534 [debug] [MainThread]: On master: Close
[0m00:16:23.364229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:23.364714 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:16:23.365070 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:16:23.365414 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:16:23.365924 [info ] [MainThread]: 
[0m00:16:23.366743 [info ] [MainThread]: Finished running 1 Table model, 5 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m00:16:23.370235 [debug] [MainThread]: Command end result
[0m00:16:23.400834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:16:23.406799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:16:23.418377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:16:23.419027 [info ] [MainThread]: 
[0m00:16:23.420368 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:16:23.420954 [info ] [MainThread]: 
[0m00:16:23.423958 [error] [MainThread]:   Compilation Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m00:16:23.426708 [info ] [MainThread]: 
[0m00:16:23.428208 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:16:23.429900 [debug] [MainThread]: Command `dbt run` failed at 00:16:23.429582 after 1.54 seconds
[0m00:16:23.430477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCC5BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCCB335F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FCE6F7EF0>]}
[0m00:16:23.431102 [debug] [MainThread]: Flushing usage events
[0m00:16:24.665217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:06.546268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E46A7A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47A07890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47BF7ED0>]}


============================== 00:18:06.551880 | 041331f8-165e-4288-9618-c94b3cc80670 ==============================
[0m00:18:06.551880 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:06.552951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:06.764803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E471310F0>]}
[0m00:18:06.816490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47AB3AC0>]}
[0m00:18:06.819786 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:18:06.964777 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:07.059082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:07.059417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:07.086515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47CC8850>]}
[0m00:18:07.140088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:07.142532 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:07.176258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47A2F4D0>]}
[0m00:18:07.176754 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:18:07.177427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E491B4C90>]}
[0m00:18:07.179513 [info ] [MainThread]: 
[0m00:18:07.180129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:07.180698 [info ] [MainThread]: 
[0m00:18:07.181535 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:18:07.186371 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:18:07.252709 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:07.253106 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:07.253372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:07.360826 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m00:18:07.362565 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:07.364359 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:07.364652 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:07.364982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.365819 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.366836 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:07.368202 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:07.368453 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:07.368672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.369501 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.370445 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:07.371323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:18:07.372046 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:18:07.377655 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.377973 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:07.378255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.379164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.380228 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.380462 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:18:07.380870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.381084 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.381282 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:18:07.382467 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.383448 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:07.383780 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:07.384000 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:07.384380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.384629 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:18:07.385065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:18:07.385430 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:18:07.386879 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.387169 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:07.387410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.388182 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.389181 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.389446 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:18:07.389821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.390044 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.390236 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:18:07.390611 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.391254 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:07.391477 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:07.391680 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:07.392022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.392281 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:18:07.392698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:18:07.393122 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:18:07.394459 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.394759 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:07.395002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.395820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.396911 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.397177 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:18:07.397577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.397815 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.398014 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:18:07.398399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.399050 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:07.399278 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:07.399471 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:07.399807 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.400019 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:18:07.402146 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m00:18:07.407104 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:07.407538 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:18:07.407777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:07.408405 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.408670 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:07.408892 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.428599 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:18:07.429862 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:18:07.431899 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:18:07.432174 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:18:07.432598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m00:18:07.434234 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:07.434579 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:18:07.434803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.436021 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.436291 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:07.436507 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.439151 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:18:07.440111 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:18:07.440598 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:18:07.440815 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:18:07.441195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:18:07.442401 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:07.442633 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:18:07.442857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.443392 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:07.443682 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:07.443886 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.446550 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:18:07.447502 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:18:07.447959 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:18:07.448189 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:18:07.448554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:18:07.450286 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:07.450552 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:18:07.450756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:07.451222 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:07.451453 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:07.451722 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:07.454563 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:07.455624 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:18:07.456205 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:18:07.456421 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:18:07.457421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E495A4AE0>]}
[0m00:18:07.457800 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.458010 [debug] [MainThread]: On master: BEGIN
[0m00:18:07.458225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:07.458643 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.458868 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.459069 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.459244 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.459588 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.459823 [debug] [MainThread]: On master: Close
[0m00:18:07.463341 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.463787 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:18:07.464448 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:18:07.464775 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.470472 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.471438 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.498704 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.499872 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.500263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:18:07.500536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:07.501107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.501421 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.501678 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:18:07.503274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.508133 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.508453 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:18:07.509595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.512376 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.512842 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:18:07.513659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.522908 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:07.523312 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.523622 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:07.527950 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:18:07.532050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:07.532406 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:18:07.536009 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.538639 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:18:07.540995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E49023F50>]}
[0m00:18:07.541543 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:18:07.542674 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:07.543049 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.543441 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:18:07.544190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:18:07.544498 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.546907 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.547869 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.550011 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.550869 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.551188 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:18:07.551431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.551976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.552252 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.552483 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:18:07.553311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.555469 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.555821 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:18:07.556434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.559265 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.559748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:18:07.560631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.562013 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:07.562616 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.562985 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:07.566152 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.567781 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:07.568053 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:18:07.571340 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.572595 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:18:07.573172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E4960C1B0>]}
[0m00:18:07.573853 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:18:07.574736 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:07.575083 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.575451 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:18:07.576176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:18:07.576471 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.578360 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.579378 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.582610 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.583723 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.584077 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:18:07.584322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.584840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.585088 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.585322 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:18:07.586059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.588239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.588660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:18:07.589391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.591506 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.591803 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:18:07.592387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.593519 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:07.593871 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.594114 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:07.597239 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.599851 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:07.600230 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:18:07.603345 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.605007 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:18:07.605513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E495F8050>]}
[0m00:18:07.606039 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:18:07.606874 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:18:07.607240 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.607621 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:18:07.608214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:18:07.608516 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.610521 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.611512 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.614868 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.616485 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.617044 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:18:07.617318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.617973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.618419 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.618692 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:18:07.619599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.621868 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.622173 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:18:07.622763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.624896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.625180 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:18:07.625733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.626950 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:07.627263 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.627509 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:07.630793 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.633670 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:07.634081 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:18:07.637329 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.638522 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:18:07.638958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E4943B7D0>]}
[0m00:18:07.639410 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:18:07.640389 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:07.641226 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.641799 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:18:07.642599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:18:07.643342 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.645591 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.646816 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.649903 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.651505 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.651933 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:18:07.652209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.652793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.653158 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.653476 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:18:07.654885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.659532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.659921 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:18:07.660590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.662782 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.663278 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:18:07.664057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:07.665373 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:07.665814 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.666428 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:07.669762 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.671451 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:07.671739 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:18:07.674784 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:07.675922 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:18:07.676396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E49680C20>]}
[0m00:18:07.676849 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:18:07.677729 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:07.678559 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.678976 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:18:07.679747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:18:07.680120 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.735449 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.736407 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.752500 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.753937 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.754365 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:18:07.754680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:07.755321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:07.755602 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:07.755961 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final;
    );
  
  
[0m00:18:07.764666 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final;
    );
  
  
[0m00:18:07.765121 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:18:07.765495 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:18:07.777149 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:18:07.777535 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:18:07.780968 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:07.781407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041331f8-165e-4288-9618-c94b3cc80670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47C69E50>]}
[0m00:18:07.781918 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.10s]
[0m00:18:07.782739 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:07.783460 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final".
[0m00:18:07.784985 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.785238 [debug] [MainThread]: On master: BEGIN
[0m00:18:07.785436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:07.785904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.786208 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.786445 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:07.786626 [debug] [MainThread]: On master: COMMIT
[0m00:18:07.787003 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:07.787239 [debug] [MainThread]: On master: Close
[0m00:18:07.787537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:07.787734 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:18:07.787907 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:18:07.788067 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:18:07.788715 [info ] [MainThread]: 
[0m00:18:07.789337 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m00:18:07.790745 [debug] [MainThread]: Command end result
[0m00:18:07.806500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:07.808850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:07.815618 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:18:07.816179 [info ] [MainThread]: 
[0m00:18:07.816810 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:07.817749 [info ] [MainThread]: 
[0m00:18:07.818398 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:07.819036 [info ] [MainThread]: 
[0m00:18:07.819668 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:18:07.820580 [debug] [MainThread]: Command `dbt run` failed at 00:18:07.820478 after 1.46 seconds
[0m00:18:07.820885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E48DBE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E477B16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47C69FD0>]}
[0m00:18:07.821167 [debug] [MainThread]: Flushing usage events
[0m00:18:09.177318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:24.275894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A982A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA7B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA9A7ED0>]}


============================== 00:18:24.279396 | c4b9e962-56b6-4af5-b433-7b7371ea765e ==============================
[0m00:18:24.279396 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:24.280089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:24.439871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A9EE10F0>]}
[0m00:18:24.490384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA863AC0>]}
[0m00:18:24.493128 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:18:24.630103 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:24.723334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:24.723656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:24.749887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AAA78850>]}
[0m00:18:24.804547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:24.806694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:24.826237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA7DF4D0>]}
[0m00:18:24.826774 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:18:24.827368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABF64C90>]}
[0m00:18:24.829212 [info ] [MainThread]: 
[0m00:18:24.829858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:24.830517 [info ] [MainThread]: 
[0m00:18:24.831406 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:18:24.835987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:18:24.889642 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:24.889982 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:24.890212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:24.919742 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m00:18:24.920967 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:24.922669 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:24.922987 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:24.923442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.924321 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.925284 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:24.926929 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:24.927244 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:24.927490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.928431 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.929379 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:24.930074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:18:24.930459 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:18:24.935984 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.936322 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:24.936560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.937423 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.938530 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.938799 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:18:24.939179 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.939390 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.939581 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:18:24.939966 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.940667 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:24.940911 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:24.941114 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:24.941445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.941664 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:18:24.942116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:18:24.942525 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:18:24.943891 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.944153 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:24.944368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.945055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.946145 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.946372 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:18:24.946720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.946953 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.947141 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:18:24.947507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.948142 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:24.948359 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:24.948553 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:24.948869 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.949088 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:18:24.949456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:18:24.949759 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:18:24.950920 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.951151 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:24.951351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.951964 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.952977 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.953312 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:18:24.953769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.953983 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.954182 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:18:24.954543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.955207 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:24.955433 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:24.955664 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:24.956015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:24.956250 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:18:24.958056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:18:24.962376 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:24.962647 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:18:24.962935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:24.963650 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.963911 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:24.964124 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:24.979696 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:18:24.980917 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:18:24.982154 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:18:24.982555 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:18:24.983289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:18:24.985126 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:24.985618 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:18:24.985964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.986564 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.986816 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:24.987023 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:24.989823 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:24.990873 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:18:24.991405 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:18:24.991641 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:18:24.992046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m00:18:24.993380 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:24.993726 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:18:24.993959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:24.994597 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:24.994840 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:24.995055 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:24.998369 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:24.999740 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:18:25.000251 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:18:25.000558 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:18:25.000955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m00:18:25.002542 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:25.002777 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:18:25.003016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:25.004183 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:25.004418 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:25.004625 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:25.007416 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:25.008416 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:18:25.008878 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:18:25.009100 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:18:25.010089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC350A10>]}
[0m00:18:25.010447 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.010664 [debug] [MainThread]: On master: BEGIN
[0m00:18:25.010849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:25.011259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.011480 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.011675 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.011849 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.012203 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.012440 [debug] [MainThread]: On master: Close
[0m00:18:25.014944 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.015521 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:18:25.016372 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:18:25.016735 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.022063 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.022951 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.050025 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.051853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.052249 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:18:25.052493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:25.053027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.053488 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.053737 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:18:25.054542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.059392 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.059839 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:18:25.060493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.062866 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.063219 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:18:25.063816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.072951 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:25.073396 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.073714 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:25.077771 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:18:25.081531 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:25.081838 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:18:25.084827 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.086935 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:18:25.088862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABDD3F50>]}
[0m00:18:25.089465 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:18:25.090679 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:25.091063 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.091424 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:18:25.092151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:18:25.092503 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.095124 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.096030 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.098250 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.099016 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.099353 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:18:25.099603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.100137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.100382 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.100645 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:18:25.101410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.103615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.103921 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:18:25.104481 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.106695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.106981 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:18:25.107499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.108436 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:25.108709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.108937 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:25.112165 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.114698 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:25.115087 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:18:25.118080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.119341 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:18:25.119813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC3C01B0>]}
[0m00:18:25.120290 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:18:25.121122 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:25.121444 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.121828 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:18:25.122521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:18:25.122859 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.124919 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.125929 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.129263 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.130399 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.130758 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:18:25.131004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.131598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.131873 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.132108 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:18:25.132877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.135077 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.135370 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:18:25.135950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.137889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.138154 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:18:25.138691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.139603 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:25.139877 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.140116 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:25.143006 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.145722 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:25.146230 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:18:25.149687 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.150874 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:18:25.151294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC3AC050>]}
[0m00:18:25.151729 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:18:25.152579 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:18:25.152949 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.153353 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:18:25.153994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:18:25.154265 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.156283 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.157058 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.159659 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.160803 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.161266 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:18:25.161606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.162312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.162597 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.162861 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:18:25.163733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.165883 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.166187 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:18:25.166752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.168687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.168965 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:18:25.169478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.170491 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:25.170775 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.171009 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:25.174050 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.176308 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:25.176653 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:18:25.179786 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.180970 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:18:25.181429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC1EB7D0>]}
[0m00:18:25.181898 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:18:25.182673 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:25.183457 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.184013 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:18:25.184771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:18:25.185082 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.187634 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.188592 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.190827 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.191750 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.192090 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:18:25.192432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.193150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.193452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.193740 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:18:25.195580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.200360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.200720 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:18:25.201362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.203761 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.204224 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:18:25.204908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:25.205925 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:25.206250 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.206494 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:25.209601 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.211655 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:25.212245 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:18:25.215656 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:25.216825 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:18:25.217296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC434C20>]}
[0m00:18:25.217741 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:18:25.218674 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:25.219636 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.220016 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:18:25.220761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:18:25.221033 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.274377 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.275268 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.291502 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.292558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.293059 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:18:25.293424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:25.294002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:25.294273 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:25.294571 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:25.295287 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
)
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:25.295639 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:18:25.296236 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:18:25.302492 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:18:25.302913 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:18:25.305965 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:25.306398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b9e962-56b6-4af5-b433-7b7371ea765e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC2A0290>]}
[0m00:18:25.306877 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:18:25.307744 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:25.308607 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final".
[0m00:18:25.310332 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.310613 [debug] [MainThread]: On master: BEGIN
[0m00:18:25.310815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:25.311300 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.311541 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.311736 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:25.311930 [debug] [MainThread]: On master: COMMIT
[0m00:18:25.312288 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:25.312526 [debug] [MainThread]: On master: Close
[0m00:18:25.312852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:25.313081 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:18:25.313306 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:18:25.313493 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:18:25.313776 [info ] [MainThread]: 
[0m00:18:25.314332 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m00:18:25.316077 [debug] [MainThread]: Command end result
[0m00:18:25.333264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:25.336396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:25.347254 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:18:25.347859 [info ] [MainThread]: 
[0m00:18:25.348639 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:25.349238 [info ] [MainThread]: 
[0m00:18:25.349868 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Parser Error: syntax error at or near "final"
[0m00:18:25.350509 [info ] [MainThread]: 
[0m00:18:25.351116 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:18:25.352408 [debug] [MainThread]: Command `dbt run` failed at 00:18:25.352153 after 1.22 seconds
[0m00:18:25.352998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AAA21D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A973DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AA8B30B0>]}
[0m00:18:25.353627 [debug] [MainThread]: Flushing usage events
[0m00:18:26.595450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:45.655274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017320B7A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321AF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321CEBED0>]}


============================== 00:18:45.658923 | 22ac0a56-746e-4a8f-8f7e-e87d65c84429 ==============================
[0m00:18:45.658923 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:18:45.660086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:45.821708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173212210F0>]}
[0m00:18:45.872193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321BA7AC0>]}
[0m00:18:45.876109 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:18:46.019173 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:18:46.114729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:46.115155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:46.143433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321DB8850>]}
[0m00:18:46.198093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:46.199940 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:46.218937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017321B1F4D0>]}
[0m00:18:46.219410 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:18:46.220072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017323344C90>]}
[0m00:18:46.221730 [info ] [MainThread]: 
[0m00:18:46.222394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:46.222916 [info ] [MainThread]: 
[0m00:18:46.223535 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:18:46.227978 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:18:46.284066 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:46.284476 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:46.284766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:46.312057 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m00:18:46.313336 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:46.314928 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:46.315195 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:46.315427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.316255 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.317150 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:46.318462 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:18:46.318708 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:18:46.318915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.319616 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.320504 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:18:46.321131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m00:18:46.321479 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:18:46.327083 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.327455 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:46.327680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.328551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.329599 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.329837 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:18:46.330218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.330440 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.330634 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:18:46.331036 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.331688 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:46.331916 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:18:46.332127 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:18:46.332466 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.332705 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:18:46.333232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:18:46.333641 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:18:46.334925 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.335159 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:46.335358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.336179 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.337158 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.337384 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:18:46.337752 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.337970 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.338173 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:18:46.338546 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.339193 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:46.339425 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:18:46.339618 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:18:46.339958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.340189 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:18:46.340567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:18:46.340876 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:18:46.342032 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.342338 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:18:46.342547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.343319 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.344385 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.344625 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:18:46.345017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.345230 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.345435 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:18:46.345841 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.346541 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:46.346746 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:18:46.346933 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:18:46.347273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:46.347496 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:18:46.349244 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m00:18:46.353864 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:46.354194 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:18:46.354409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:46.355033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.355291 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:18:46.355505 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.368844 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m00:18:46.370779 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:18:46.372404 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:18:46.372897 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:18:46.374101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m00:18:46.375348 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:46.375580 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:18:46.375779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.376339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.376569 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:18:46.376769 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.379627 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:46.380721 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:18:46.381274 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:18:46.381523 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:18:46.381971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:18:46.383417 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:46.383722 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:18:46.383962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.384525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.384746 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:18:46.384945 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.387789 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:46.388893 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:18:46.389479 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:18:46.389706 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:18:46.390112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:18:46.391638 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:46.391904 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:18:46.392177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.393339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:46.393624 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:18:46.393851 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:18:46.396694 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:18:46.397730 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:18:46.398231 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:18:46.398460 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:18:46.399310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017323734600>]}
[0m00:18:46.399663 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.399881 [debug] [MainThread]: On master: BEGIN
[0m00:18:46.400068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:46.400535 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:46.400741 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.400924 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.401122 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.401488 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:46.401714 [debug] [MainThread]: On master: Close
[0m00:18:46.404083 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.404611 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:18:46.405528 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:18:46.405952 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.411981 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.413119 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.439804 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.441818 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.442309 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:18:46.442571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:46.443235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.443543 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.443787 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:18:46.444545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.449378 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.449689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:18:46.450269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.452579 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.452867 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:18:46.453518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.463650 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:46.464047 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.464309 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:18:46.468417 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:18:46.472347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:18:46.472748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:18:46.475670 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.477827 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:18:46.479913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173231ABF50>]}
[0m00:18:46.480460 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:18:46.481545 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:18:46.481938 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.482405 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:18:46.483228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:18:46.483541 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.485966 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.486829 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.489070 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.489929 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.490259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:18:46.490506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.491049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.491302 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.491531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:18:46.492271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.494567 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.494873 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:18:46.495459 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.497880 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.498259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:18:46.498918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.500254 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:46.500676 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.500990 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:18:46.504426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.506648 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:18:46.507136 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:18:46.510207 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.511422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:18:46.511890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173237A01B0>]}
[0m00:18:46.512386 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:18:46.513510 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:18:46.514024 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.514425 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:18:46.515223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:18:46.515535 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.517614 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.518405 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.521107 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.522087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.522477 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:18:46.522747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.523465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.523961 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.524268 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:18:46.525419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.527750 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.528056 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:18:46.529213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.531291 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.531594 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:18:46.532167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.533155 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:46.533497 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.533792 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:18:46.536591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:18:46.538693 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:18:46.539112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:18:46.541982 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:18:46.543659 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:18:46.544337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732378C0F0>]}
[0m00:18:46.544904 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:18:46.545768 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:18:46.546206 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.546529 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:18:46.547264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:18:46.547572 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.549458 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.550253 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.552899 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.553890 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.554251 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:18:46.554527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.555089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.555408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.555708 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:18:46.556609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.559887 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.560324 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:18:46.561063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.563186 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.563512 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:18:46.564123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.565098 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:46.565377 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.565619 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:18:46.568881 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.570966 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:18:46.571263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:18:46.574118 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:18:46.576428 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:18:46.576994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173235CB7D0>]}
[0m00:18:46.577538 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:18:46.578354 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:18:46.579124 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.579531 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:18:46.580268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:18:46.580546 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.582947 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.583874 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.586134 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.586933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.587258 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:18:46.587502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.588042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.588287 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.588647 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:18:46.590282 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.595525 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.595918 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:18:46.596625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.598778 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.599125 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:18:46.599701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:46.600673 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:46.600966 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.601213 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:18:46.604134 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.606116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:18:46.606498 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:18:46.609603 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:46.610764 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:18:46.611244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173237E4C20>]}
[0m00:18:46.611714 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:18:46.612478 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:18:46.613268 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.613675 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:18:46.614308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:18:46.614682 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.668839 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.669737 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.685170 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.686159 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.686549 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:18:46.686809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:46.687407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:18:46.687690 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:18:46.687987 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:46.698784 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impressions i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:18:46.699256 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:18:46.699632 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:18:46.704988 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:18:46.705358 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:18:46.708348 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Catalog Error: Table with name impressions does not exist!
  Did you mean "pg_description"?
  
  LINE 76:   from impressions i
                  ^
[0m00:18:46.708739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac0a56-746e-4a8f-8f7e-e87d65c84429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173237B8470>]}
[0m00:18:46.709235 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:18:46.710128 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:18:46.710641 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Catalog Error: Table with name impressions does not exist!
  Did you mean "pg_description"?
  
  LINE 76:   from impressions i
                  ^.
[0m00:18:46.712225 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.712535 [debug] [MainThread]: On master: BEGIN
[0m00:18:46.712782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:46.713413 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:18:46.713677 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.713884 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:46.714068 [debug] [MainThread]: On master: COMMIT
[0m00:18:46.714441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:46.714789 [debug] [MainThread]: On master: Close
[0m00:18:46.715201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:46.715432 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m00:18:46.715656 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m00:18:46.715900 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:18:46.716231 [info ] [MainThread]: 
[0m00:18:46.716875 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:18:46.718654 [debug] [MainThread]: Command end result
[0m00:18:46.740724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:18:46.743457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:18:46.749569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:18:46.749942 [info ] [MainThread]: 
[0m00:18:46.750646 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:46.751197 [info ] [MainThread]: 
[0m00:18:46.751802 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Catalog Error: Table with name impressions does not exist!
  Did you mean "pg_description"?
  
  LINE 76:   from impressions i
                  ^
[0m00:18:46.752409 [info ] [MainThread]: 
[0m00:18:46.752993 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:18:46.753938 [debug] [MainThread]: Command `dbt run` failed at 00:18:46.753828 after 1.24 seconds
[0m00:18:46.754246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017322F2A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173218924B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017322F406B0>]}
[0m00:18:46.754524 [debug] [MainThread]: Flushing usage events
[0m00:18:48.010299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:31.975911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA6F8A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7F17890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA8107ED0>]}


============================== 00:19:31.979411 | 5b393a79-e6c8-40dc-b7f6-738bffcb2662 ==============================
[0m00:19:31.979411 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:19:31.980801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:19:32.152675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA76410F0>]}
[0m00:19:32.209302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7FC7AC0>]}
[0m00:19:32.212869 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:19:32.381460 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:19:32.503844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:32.504195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:32.532722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA81D8850>]}
[0m00:19:32.586764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:19:32.589016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:19:32.608223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7F3F4D0>]}
[0m00:19:32.608698 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:19:32.609338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA96BCC90>]}
[0m00:19:32.610957 [info ] [MainThread]: 
[0m00:19:32.611577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:32.612061 [info ] [MainThread]: 
[0m00:19:32.612752 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:19:32.617574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:19:32.674998 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:19:32.675396 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:19:32.675678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:32.706772 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m00:19:32.708066 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:19:32.709763 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:19:32.710064 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:19:32.710300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.711213 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.712201 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:19:32.713913 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:19:32.714246 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:19:32.714720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.715653 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.716853 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:19:32.717633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m00:19:32.718074 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:19:32.724260 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.724643 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:19:32.724868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.725758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.727579 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.728089 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:19:32.728748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.729108 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.729446 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:19:32.730020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.730927 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:19:32.731196 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:19:32.731407 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:19:32.731807 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.732052 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:19:32.732508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m00:19:32.732863 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:19:32.734455 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.734733 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:19:32.735021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.735804 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.736848 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.737090 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:19:32.737513 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.737771 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.738015 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:19:32.738418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.739129 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:19:32.739369 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:19:32.739562 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:19:32.739911 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.740148 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:19:32.740579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m00:19:32.740905 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:19:32.742173 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.742417 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:19:32.742626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.743373 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.744463 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.744751 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:19:32.745132 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.745357 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.745613 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:19:32.746118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.746855 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:19:32.747122 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:19:32.747354 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:19:32.747859 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.748101 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:19:32.750139 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m00:19:32.755398 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:19:32.755757 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:19:32.756146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:32.756828 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.757200 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:19:32.757550 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.769884 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:19:32.770997 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:19:32.772000 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:19:32.772301 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:19:32.772703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m00:19:32.774124 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:19:32.774391 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:19:32.774602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.775061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.775299 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:19:32.775503 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.778370 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:19:32.779543 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:19:32.780150 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:19:32.780427 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:19:32.780927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:19:32.782569 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:19:32.782974 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:19:32.783230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.783722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:32.783975 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:19:32.784185 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.787102 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:19:32.788237 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:19:32.788736 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:19:32.788988 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:19:32.789397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m00:19:32.790972 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:19:32.791257 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:19:32.791493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:32.792671 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:32.792985 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:19:32.793219 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:19:32.797779 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:19:32.799104 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:19:32.799653 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:19:32.799891 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:19:32.800956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9AB4A10>]}
[0m00:19:32.801316 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:32.801522 [debug] [MainThread]: On master: BEGIN
[0m00:19:32.801704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:32.802148 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:32.802361 [debug] [MainThread]: On master: COMMIT
[0m00:19:32.802558 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:32.802744 [debug] [MainThread]: On master: COMMIT
[0m00:19:32.803116 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:32.803465 [debug] [MainThread]: On master: Close
[0m00:19:32.806201 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.806618 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:19:32.807501 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:19:32.807912 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.813835 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.814745 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.841739 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.842855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.843336 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:19:32.843684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:32.844534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.844915 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.845174 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:19:32.846126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.851912 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.852382 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:19:32.853237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.856765 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.857270 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:19:32.858173 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.872441 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:19:32.872955 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.873385 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:19:32.877971 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:19:32.883559 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:19:32.884025 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:19:32.887314 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.890140 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:19:32.892909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA95C7F50>]}
[0m00:19:32.893705 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.08s]
[0m00:19:32.894988 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:19:32.895777 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.896625 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:19:32.897447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:19:32.897957 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.902066 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.903629 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.906878 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.908116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.908482 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:19:32.908730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:32.909638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.909926 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.910179 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:19:32.910875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.912948 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.913304 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:19:32.913987 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.917051 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.917479 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:19:32.918167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.919258 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:19:32.919573 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.919816 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:19:32.922960 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.924837 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:19:32.925171 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:19:32.928021 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:19:32.929210 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:19:32.929670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9B201B0>]}
[0m00:19:32.930169 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:19:32.931075 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:19:32.931597 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.932208 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:19:32.933177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:19:32.933714 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.936241 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.937152 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.939761 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.940638 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.940981 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:19:32.941252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:32.941812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.942121 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.942370 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:19:32.943180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.945384 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.945677 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:19:32.946245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.949290 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.949810 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:19:32.950540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.951614 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:19:32.951908 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.952168 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:19:32.955458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.957612 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:19:32.957922 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:19:32.961134 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.962531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:19:32.963306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9B0C050>]}
[0m00:19:32.964270 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:19:32.965457 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:19:32.966019 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:19:32.966605 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:19:32.967387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:19:32.967693 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:19:32.970559 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.971552 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:19:32.974355 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.975244 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.975585 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:19:32.975844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:32.976434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.976701 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.976947 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:19:32.977714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.981028 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.981652 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:19:32.982682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:32.985633 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.985995 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:19:32.986642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:32.987660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:19:32.987947 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.988189 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:19:32.991193 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.993942 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:19:32.994446 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:19:32.997775 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:32.999291 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:19:32.999904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA994AC50>]}
[0m00:19:33.000556 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:19:33.001622 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:19:33.002568 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.002987 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:19:33.003651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:19:33.003970 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.006258 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.007299 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.009475 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.010310 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.010798 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:19:33.011388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:33.012154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:33.012443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.012713 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:19:33.014330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:33.019485 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.019862 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:19:33.020556 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:33.022503 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.022792 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:19:33.023438 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:33.024455 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:19:33.024771 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.025035 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:19:33.028235 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:33.030076 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:19:33.030450 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:19:33.033417 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:19:33.035031 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:19:33.035544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9B94C20>]}
[0m00:19:33.036056 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:19:33.036969 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:19:33.037890 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.038280 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:19:33.038962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:19:33.039311 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.118639 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.120077 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.144342 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.145904 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.146497 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:19:33.146857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:33.147493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:33.147808 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:19:33.148145 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:19:33.151538 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_timestamp)
),
click as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_timestamp)
),
conversions as (
  select
    campaign_id,
    date(interaction_timestamp) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_timestamp)
),
costs as (
  select 
    campaign_id, 
    date(interaction_timestamp) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_timestamp)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_timestamp) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_timestamp)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:19:33.152072 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:19:33.152529 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:19:33.158889 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:19:33.159350 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:19:33.164345 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 20:   group by campaign_id, date(interaction_timestamp)
                                        ^
[0m00:19:33.164959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b393a79-e6c8-40dc-b7f6-738bffcb2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9ABF650>]}
[0m00:19:33.165762 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.13s]
[0m00:19:33.166998 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:19:33.167679 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 20:   group by campaign_id, date(interaction_timestamp)
                                        ^.
[0m00:19:33.169843 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:33.170339 [debug] [MainThread]: On master: BEGIN
[0m00:19:33.170653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:33.171300 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:19:33.171743 [debug] [MainThread]: On master: COMMIT
[0m00:19:33.171998 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:33.172233 [debug] [MainThread]: On master: COMMIT
[0m00:19:33.172747 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:33.173053 [debug] [MainThread]: On master: Close
[0m00:19:33.173533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:33.173772 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:19:33.173971 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:19:33.174164 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:19:33.174480 [info ] [MainThread]: 
[0m00:19:33.175042 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:19:33.176691 [debug] [MainThread]: Command end result
[0m00:19:33.194417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:19:33.196886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:19:33.204007 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:19:33.204571 [info ] [MainThread]: 
[0m00:19:33.205007 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:19:33.205391 [info ] [MainThread]: 
[0m00:19:33.205789 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced column "interaction_timestamp" not found in FROM clause!
  Candidate bindings: "interaction_datetime", "interaction_id", "is_new_customer", "ad_cost", "customer_id"
  
  LINE 20:   group by campaign_id, date(interaction_timestamp)
                                        ^
[0m00:19:33.206146 [info ] [MainThread]: 
[0m00:19:33.206447 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:19:33.207125 [debug] [MainThread]: Command `dbt run` failed at 00:19:33.207022 after 1.38 seconds
[0m00:19:33.207442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA8010F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA7596750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA9BB8170>]}
[0m00:19:33.207739 [debug] [MainThread]: Flushing usage events
[0m00:19:34.674641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:18.151603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8DD6A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8ECF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EEE7ED0>]}


============================== 00:21:18.155217 | a1a00333-fab1-496b-a4a8-1c638967da6e ==============================
[0m00:21:18.155217 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:21:18.156501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:18.319678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8E4210F0>]}
[0m00:21:18.371844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EDA7AC0>]}
[0m00:21:18.374820 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:21:18.523247 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:21:18.620433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:18.620887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:18.647645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EFB8850>]}
[0m00:21:18.699590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:18.701977 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:18.721821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8ED1F4D0>]}
[0m00:21:18.722326 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:21:18.723321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA904D4C90>]}
[0m00:21:18.725139 [info ] [MainThread]: 
[0m00:21:18.725733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:18.726326 [info ] [MainThread]: 
[0m00:21:18.727027 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:21:18.731608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:21:18.787041 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:18.787444 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:18.787689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:18.806336 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:21:18.807611 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:18.809540 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:18.809905 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:18.810172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.811125 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.812214 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:18.813833 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:18.814288 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:18.814593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.815986 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.817845 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:18.818903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:21:18.819482 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:21:18.825284 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.825637 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:18.825959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.826821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.827946 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.828203 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:21:18.828610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.828839 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.829061 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:21:18.829467 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.830158 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:18.830405 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:18.830624 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:18.830982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.831207 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:21:18.831639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:21:18.832009 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:21:18.833702 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.834063 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:18.834315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.835519 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.836714 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.837016 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:21:18.837499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.837769 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.837990 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:21:18.838444 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.839172 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:18.839420 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:18.839619 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:18.840040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.840343 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:21:18.840788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:21:18.841179 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:21:18.842566 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.842850 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:18.843094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.843934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.845076 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.845331 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:21:18.845744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.845990 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.846217 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:21:18.846634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.847399 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:18.847614 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:18.847808 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:18.848218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.848512 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:21:18.850415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m00:21:18.855061 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:18.855363 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:21:18.855581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:18.856281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.856542 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:18.856759 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.868603 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:21:18.869844 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:21:18.870879 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:21:18.871145 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:21:18.871582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:21:18.873179 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:18.874442 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:21:18.874771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.875534 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:18.875944 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:18.876215 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.879455 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:18.880558 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:21:18.881096 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:21:18.881333 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:21:18.881739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m00:21:18.883347 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:18.883624 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:21:18.883861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.884358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.884575 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:18.884771 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.887753 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:18.888875 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:21:18.889378 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:21:18.889610 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:21:18.890022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m00:21:18.891599 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:18.891897 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:21:18.892150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:18.892650 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:18.893012 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:18.893250 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:18.896408 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:18.897624 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:21:18.898161 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:21:18.898405 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:21:18.899488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA908C0AE0>]}
[0m00:21:18.899907 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:18.900151 [debug] [MainThread]: On master: BEGIN
[0m00:21:18.900361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:21:18.900852 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:18.901100 [debug] [MainThread]: On master: COMMIT
[0m00:21:18.901458 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:18.901692 [debug] [MainThread]: On master: COMMIT
[0m00:21:18.902106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:18.902372 [debug] [MainThread]: On master: Close
[0m00:21:18.904522 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.905039 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:21:18.905772 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:21:18.906095 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.913060 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.914065 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.940957 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.942084 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.942466 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:21:18.942712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:18.943295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:18.943577 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.943824 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:21:18.944647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:18.950123 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.950481 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:21:18.951121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.953505 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.953851 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:21:18.954435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.963969 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:18.964335 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.964591 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:18.968826 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:21:18.972753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:18.973108 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:21:18.976435 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:18.978746 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:21:18.980835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA903D7F50>]}
[0m00:21:18.981397 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:21:18.982309 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:18.982622 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:18.982989 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:21:18.983664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:21:18.984018 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:21:18.986358 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.987185 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:21:18.989449 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.990679 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.991034 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:21:18.991296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:18.991848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:18.992116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.992364 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:21:18.993101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.995509 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:18.995942 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:21:18.996621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:18.999683 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:19.000039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:21:19.000660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.001678 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:19.001970 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:19.002214 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:19.005436 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.007367 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:19.007681 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:21:19.010509 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:21:19.011844 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:21:19.012405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9092C1B0>]}
[0m00:21:19.013039 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:21:19.013971 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:19.014443 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.014905 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:21:19.015668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:21:19.016039 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.017921 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.018752 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.021671 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.022672 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.023039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:21:19.023318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.023880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.024174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.024418 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:21:19.025127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.027256 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.027589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:21:19.028287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.031222 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.031655 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:21:19.032424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.033573 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:19.033899 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.034161 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:19.037624 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.039617 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:19.039926 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:21:19.042856 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.044362 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:21:19.044967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90918050>]}
[0m00:21:19.045587 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:21:19.046414 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:21:19.046817 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.047407 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:21:19.048283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:21:19.048716 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.050835 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.051600 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.054403 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.055337 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.055702 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:21:19.056005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.056553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.056830 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.057083 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:21:19.057841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.060696 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.061028 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:21:19.061732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.064402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.064866 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:21:19.065597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.066689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:19.067001 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.067248 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:19.070426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.072440 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:19.072741 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:21:19.075871 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.077139 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:21:19.077568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90756C50>]}
[0m00:21:19.078109 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:21:19.079043 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:19.080272 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.080952 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:21:19.081768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:21:19.082143 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.084674 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.085709 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.087929 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.088809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.089126 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:21:19.089369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.089927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.090205 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.090466 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:21:19.091757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.096347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.096857 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:21:19.097945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.100502 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.100898 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:21:19.101544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:19.102649 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:19.102979 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.103256 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:19.109918 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:21:19.112212 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:19.112827 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:21:19.115940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:19.117271 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:21:19.117745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90977770>]}
[0m00:21:19.118228 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.04s]
[0m00:21:19.119458 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:19.120385 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.120750 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:21:19.121451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:21:19.121788 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.175303 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.176258 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.192823 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.193984 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.194412 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:21:19.194736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:19.195352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:19.195652 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:19.195999 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:21:19.199883 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / nullif(cv.converted_customers, 0) as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:21:19.200270 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:21:19.200617 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m00:21:19.205805 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m00:21:19.206216 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:21:19.209273 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Values list "cv" does not have a column named "converted_customers"
  
  LINE 74:     co.total_cost / nullif(cv.converted_customers, 0) as cac,
                                      ^
[0m00:21:19.209690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a00333-fab1-496b-a4a8-1c638967da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA907FACF0>]}
[0m00:21:19.210180 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model mart.model_mart_campaign_performance ..... [[31mERROR[0m in 0.09s]
[0m00:21:19.211621 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:19.212248 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Values list "cv" does not have a column named "converted_customers"
  
  LINE 74:     co.total_cost / nullif(cv.converted_customers, 0) as cac,
                                      ^.
[0m00:21:19.214092 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:19.214370 [debug] [MainThread]: On master: BEGIN
[0m00:21:19.214578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:21:19.215057 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:19.215355 [debug] [MainThread]: On master: COMMIT
[0m00:21:19.215622 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:19.215852 [debug] [MainThread]: On master: COMMIT
[0m00:21:19.216269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:19.216514 [debug] [MainThread]: On master: Close
[0m00:21:19.216818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:19.217004 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:21:19.217178 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:21:19.217333 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:21:19.217604 [info ] [MainThread]: 
[0m00:21:19.218175 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:21:19.219744 [debug] [MainThread]: Command end result
[0m00:21:19.237146 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:19.239154 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:19.245121 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:21:19.245706 [info ] [MainThread]: 
[0m00:21:19.246731 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:21:19.247553 [info ] [MainThread]: 
[0m00:21:19.248389 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Values list "cv" does not have a column named "converted_customers"
  
  LINE 74:     co.total_cost / nullif(cv.converted_customers, 0) as cac,
                                      ^
[0m00:21:19.249553 [info ] [MainThread]: 
[0m00:21:19.250259 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:21:19.251105 [debug] [MainThread]: Command `dbt run` failed at 00:21:19.250980 after 1.27 seconds
[0m00:21:19.251392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9007E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9092FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9092F9B0>]}
[0m00:21:19.251657 [debug] [MainThread]: Flushing usage events
[0m00:21:20.671514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:37.672424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F935ACA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936A47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936C37ED0>]}


============================== 00:21:37.675740 | 0a09640d-18cb-4600-8cee-6e562bb8341a ==============================
[0m00:21:37.675740 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:21:37.676499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:37.837915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9361790F0>]}
[0m00:21:37.890375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936AF7AC0>]}
[0m00:21:37.893247 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:21:38.038526 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:21:38.142483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:38.143021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:38.173105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936D08850>]}
[0m00:21:38.228666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:38.230783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:38.248358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936A6F4D0>]}
[0m00:21:38.248846 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:21:38.249470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938260C90>]}
[0m00:21:38.251129 [info ] [MainThread]: 
[0m00:21:38.251625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:38.252163 [info ] [MainThread]: 
[0m00:21:38.252960 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:21:38.257707 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:21:38.313032 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:38.313480 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:38.313736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:38.343293 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m00:21:38.344620 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:38.346280 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:38.346588 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:38.346836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.347729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.348905 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:38.350565 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:21:38.350860 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:21:38.351176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.351966 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.352926 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:21:38.353727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:21:38.354126 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:21:38.360003 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.360328 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:38.360553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.361395 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.362434 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.362664 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:21:38.363149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.363447 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.363647 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:21:38.364040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.364726 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:38.364958 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:21:38.365162 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:21:38.365497 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.365724 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:21:38.366364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m00:21:38.366710 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:21:38.367884 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.368120 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:38.368334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.368980 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.369939 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.370189 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:21:38.370545 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.370771 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.370972 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:21:38.371338 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.371968 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:38.372203 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:21:38.372389 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:21:38.372712 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.373031 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:21:38.373479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m00:21:38.373820 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:21:38.375135 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.375369 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:21:38.375567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.376402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.377357 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.377584 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:21:38.377948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.378188 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.378371 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:21:38.378769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.379432 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:38.379672 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:21:38.380027 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:21:38.380426 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.380642 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:21:38.382473 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m00:21:38.387307 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:38.387679 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:21:38.387959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:38.388629 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.388890 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:21:38.389106 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.404556 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:21:38.405680 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:21:38.406842 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:21:38.407125 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:21:38.407618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m00:21:38.408899 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:38.409153 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:21:38.409370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.409874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.410081 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:21:38.410308 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.413179 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:21:38.414343 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:21:38.414842 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:21:38.415067 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:21:38.415451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m00:21:38.416783 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:38.417023 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:21:38.417223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.418281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:21:38.418526 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:21:38.418734 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.421339 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:21:38.422366 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:21:38.422924 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:21:38.423161 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:21:38.423855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m00:21:38.425414 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:38.425673 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:21:38.426007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:38.426483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:21:38.426692 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:21:38.426882 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:21:38.429542 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:21:38.430504 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:21:38.430963 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:21:38.431173 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:21:38.431953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938650940>]}
[0m00:21:38.432313 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.432523 [debug] [MainThread]: On master: BEGIN
[0m00:21:38.432717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:21:38.433130 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.433398 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.433639 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.433879 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.434242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.434489 [debug] [MainThread]: On master: Close
[0m00:21:38.437399 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.437822 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:21:38.438631 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:21:38.439013 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.445121 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.446297 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.472601 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.474038 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.474567 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:21:38.474901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:38.475529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.475853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.476281 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:21:38.477366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.482154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.482470 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:21:38.483089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.485450 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.485741 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:21:38.486388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.495942 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:38.496374 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.496640 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:21:38.501120 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:21:38.505087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:21:38.505426 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:21:38.508449 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.510486 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:21:38.512416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938167F50>]}
[0m00:21:38.512968 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:21:38.513771 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:21:38.514113 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.514486 [info ] [Thread-1 (]: 2 of 6 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:21:38.515174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:21:38.515523 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.517905 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.518744 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.521184 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.522089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.522434 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:21:38.522690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.523276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.523584 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.523817 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:21:38.524632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.527604 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.528112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:21:38.528774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.531166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.531449 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:21:38.532022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.533039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:38.533408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.533709 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:21:38.536786 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.538460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:21:38.538719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:21:38.541700 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.543432 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:21:38.544297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9386BC1B0>]}
[0m00:21:38.544819 [info ] [Thread-1 (]: 2 of 6 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:21:38.545664 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:21:38.546124 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.546537 [info ] [Thread-1 (]: 3 of 6 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:21:38.547234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:21:38.547573 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.549534 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.550421 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.553237 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.554175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.554529 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:21:38.554798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.555368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.555631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.555888 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:21:38.556622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.559026 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.559507 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:21:38.560353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.562757 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.563110 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:21:38.563844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.564831 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:38.565115 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.565355 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:21:38.568952 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.570911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:21:38.571190 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:21:38.573964 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:21:38.575278 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:21:38.575843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9386A80F0>]}
[0m00:21:38.576477 [info ] [Thread-1 (]: 3 of 6 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:21:38.577538 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:21:38.578029 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.578882 [info ] [Thread-1 (]: 4 of 6 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:21:38.579677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:21:38.579995 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.581941 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.582707 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.585173 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.586015 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.586375 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:21:38.586620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.587170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.587426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.587663 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:21:38.588408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.590493 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.590835 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:21:38.591596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.594370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.594736 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:21:38.595409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.596454 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:38.596744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.596980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:21:38.600190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.602255 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:21:38.602573 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:21:38.605674 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.606994 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:21:38.607447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9384E6C50>]}
[0m00:21:38.608038 [info ] [Thread-1 (]: 4 of 6 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:21:38.608930 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:21:38.609857 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.610486 [info ] [Thread-1 (]: 5 of 6 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:21:38.611562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:21:38.611973 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.614638 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.615613 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.617870 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.618883 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.619215 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:21:38.619452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.620036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.620301 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.620545 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:21:38.621824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.626446 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.626990 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:21:38.628061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.630559 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.630876 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:21:38.631489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.632453 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:38.632732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.632992 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:21:38.636219 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.637854 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:21:38.638145 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:21:38.641453 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:21:38.642915 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:21:38.643625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938700C20>]}
[0m00:21:38.644441 [info ] [Thread-1 (]: 5 of 6 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.03s]
[0m00:21:38.645537 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:21:38.646404 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.646800 [info ] [Thread-1 (]: 6 of 6 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:21:38.647504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:21:38.647832 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.699846 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.700768 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.717875 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.718859 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.719253 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:21:38.719526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:38.720077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:21:38.720464 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.720773 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:21:38.752200 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m00:21:38.754658 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.754992 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m00:21:38.756840 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:21:38.760677 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:21:38.760989 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.761237 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:21:38.766210 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:21:38.767976 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:21:38.768462 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m00:21:38.769255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:21:38.770399 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:21:38.770863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a09640d-18cb-4600-8cee-6e562bb8341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F937E4B350>]}
[0m00:21:38.771333 [info ] [Thread-1 (]: 6 of 6 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.12s]
[0m00:21:38.772110 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:21:38.773618 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.773999 [debug] [MainThread]: On master: BEGIN
[0m00:21:38.774265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:21:38.774776 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.775025 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.775228 [debug] [MainThread]: Using duckdb connection "master"
[0m00:21:38.775431 [debug] [MainThread]: On master: COMMIT
[0m00:21:38.775806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:21:38.776045 [debug] [MainThread]: On master: Close
[0m00:21:38.776352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:38.776532 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m00:21:38.776702 [debug] [MainThread]: Connection 'list_ae_exam_db_report' was properly closed.
[0m00:21:38.776855 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m00:21:38.777124 [info ] [MainThread]: 
[0m00:21:38.777705 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m00:21:38.779033 [debug] [MainThread]: Command end result
[0m00:21:38.796075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:21:38.798121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:21:38.803811 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:21:38.804212 [info ] [MainThread]: 
[0m00:21:38.804807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:21:38.805374 [info ] [MainThread]: 
[0m00:21:38.806046 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:21:38.806836 [debug] [MainThread]: Command `dbt run` succeeded at 00:21:38.806684 after 1.27 seconds
[0m00:21:38.807154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F936785A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93872BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93872B830>]}
[0m00:21:38.807572 [debug] [MainThread]: Flushing usage events
[0m00:21:41.692290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:49.013616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A548BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A55837890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A55A27ED0>]}


============================== 00:23:49.017011 | 48643ea4-b647-4c57-a05f-34233aa9502f ==============================
[0m00:23:49.017011 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:23:49.018280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:23:49.178266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A54F610F0>]}
[0m00:23:49.228719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A558E7AC0>]}
[0m00:23:49.231556 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:23:49.368284 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:23:49.464080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:49.464438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:49.491323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A55AF8850>]}
[0m00:23:49.549182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:23:49.551108 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:23:49.568692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5585F4D0>]}
[0m00:23:49.569304 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:23:49.569982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56FE4AD0>]}
[0m00:23:49.571731 [info ] [MainThread]: 
[0m00:23:49.572259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:49.572888 [info ] [MainThread]: 
[0m00:23:49.573698 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:23:49.578071 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:23:49.636450 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.636999 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.637373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:49.658968 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:23:49.660414 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.662243 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.662586 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.662875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.663772 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.664814 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.666323 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.666661 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.666994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.667938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.668886 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.671082 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:49.671425 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:49.671694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.672829 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.674226 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:49.675020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m00:23:49.675635 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m00:23:49.681236 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.681601 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.681846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.683035 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.685296 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.685594 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m00:23:49.686041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.686313 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.686538 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m00:23:49.687010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.687699 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:49.687936 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:49.688147 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:49.694276 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m00:23:49.694632 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m00:23:49.695174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_mart)
[0m00:23:49.695533 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:23:49.696716 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.696978 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.697190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.697893 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.698890 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.699513 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:23:49.700000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.700339 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.700586 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:23:49.700989 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.701660 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:49.701973 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:49.702185 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:49.702530 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.702757 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:23:49.703320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:23:49.703682 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:23:49.705187 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.705427 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.705639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.706324 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.707382 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.707616 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:23:49.708010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.708234 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.708445 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:23:49.708819 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.709469 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:49.709682 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:49.709955 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:49.710319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.710569 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:23:49.711015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m00:23:49.711331 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:23:49.712584 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.712831 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:49.713154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.713852 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.714805 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.715041 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:23:49.715391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.715628 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.715828 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:23:49.716198 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.716831 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:49.717050 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:49.717234 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:49.717563 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:49.717792 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:23:49.719470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:23:49.723934 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:49.724233 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:23:49.724461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:49.725023 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.725255 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:49.725473 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.736524 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m00:23:49.738029 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:23:49.739129 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:23:49.739397 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:23:49.739890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m00:23:49.741138 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:49.741386 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:23:49.741591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.742220 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.742448 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:49.742661 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.745411 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:49.746453 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:23:49.746951 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:23:49.747180 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:23:49.747562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:23:49.748738 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:49.749064 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:23:49.749256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.750005 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.750253 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:49.750462 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.753178 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:49.754228 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:23:49.754795 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:23:49.755010 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:23:49.755413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m00:23:49.757034 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:49.757314 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:23:49.757549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:49.758249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:49.758465 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:49.758676 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:49.761502 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:23:49.762715 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:23:49.763216 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:23:49.763445 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:23:49.765304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A573D8600>]}
[0m00:23:49.765687 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:49.765909 [debug] [MainThread]: On master: BEGIN
[0m00:23:49.766103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:49.766522 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:49.766747 [debug] [MainThread]: On master: COMMIT
[0m00:23:49.766946 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:49.767132 [debug] [MainThread]: On master: COMMIT
[0m00:23:49.767462 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:49.767690 [debug] [MainThread]: On master: Close
[0m00:23:49.770001 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.770546 [info ] [Thread-1 (]: 1 of 7 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:23:49.771257 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:23:49.771654 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.777139 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.777949 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.805516 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.806532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.806910 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:23:49.807160 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:23:49.807708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.807986 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.808228 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:23:49.809042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.813896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.814232 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:23:49.814840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.816980 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.817335 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:23:49.817997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.827771 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:49.828201 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.828475 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:49.832105 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.836300 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:49.836648 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:23:49.839732 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.841893 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:23:49.843899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56EE5B50>]}
[0m00:23:49.844572 [info ] [Thread-1 (]: 1 of 7 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:23:49.845841 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:49.846178 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.846708 [info ] [Thread-1 (]: 2 of 7 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:23:49.847431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:23:49.847715 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.849849 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.850799 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.853946 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.854902 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.855293 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:23:49.855547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.856114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.856384 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.856625 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:23:49.857377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.859454 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.859727 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:23:49.860328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.862307 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.862588 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:23:49.863119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.864432 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:49.864801 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.865079 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:49.868241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.870507 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:49.870854 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:23:49.873883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.875072 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:23:49.875497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57450050>]}
[0m00:23:49.875965 [info ] [Thread-1 (]: 2 of 7 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:23:49.876795 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:23:49.877123 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.877492 [info ] [Thread-1 (]: 3 of 7 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:23:49.878221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:23:49.878534 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.880713 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.881644 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.884456 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.885791 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.886279 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:23:49.886541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.887090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.887358 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.887610 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:23:49.888322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.890476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.890764 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:23:49.891296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.893289 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.893603 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:23:49.894151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.895124 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:23:49.895400 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.895698 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:23:49.898887 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.901171 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:23:49.901637 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:23:49.904898 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.906069 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:23:49.906476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57411590>]}
[0m00:23:49.906920 [info ] [Thread-1 (]: 3 of 7 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:23:49.907771 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:23:49.908100 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.908433 [info ] [Thread-1 (]: 4 of 7 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:23:49.909197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:23:49.909465 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.911483 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.912332 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.914548 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.915342 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.915657 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:23:49.915896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.916442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.916727 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.916974 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:23:49.917886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.921275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.921704 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:23:49.922430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.924548 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.924848 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:23:49.925448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:49.926555 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:23:49.927044 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.927320 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:23:49.930586 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:49.932402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:23:49.932686 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:23:49.935588 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:23:49.938695 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:23:49.939170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A572658D0>]}
[0m00:23:49.939670 [info ] [Thread-1 (]: 4 of 7 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:23:49.940541 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:23:49.941397 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:49.941925 [info ] [Thread-1 (]: 5 of 7 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:23:49.942546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:23:49.942874 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:49.945160 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.946080 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:49.948344 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.949269 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.949604 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:23:49.949849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:49.950456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:49.950786 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:49.951183 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:23:49.953561 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:23:50.005535 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.005930 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:23:50.006604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.008605 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.008889 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:23:50.009464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.010487 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:23:50.010771 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.011023 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:23:50.014508 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:50.016753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:23:50.017551 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:23:50.021031 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:50.022369 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:23:50.022831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57403E00>]}
[0m00:23:50.023355 [info ] [Thread-1 (]: 5 of 7 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.08s]
[0m00:23:50.024093 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:23:50.024731 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.025127 [info ] [Thread-1 (]: 6 of 7 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:23:50.025669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:23:50.026004 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.029561 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.030563 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.047103 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.048121 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.048478 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:23:50.048729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:50.049318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:50.049581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.049958 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:23:50.079572 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m00:23:50.082132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.082643 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m00:23:50.083451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.086261 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.086594 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m00:23:50.087238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:50.091137 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:23:50.091481 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.091732 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:23:50.097016 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:23:50.099237 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:23:50.099559 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m00:23:50.102576 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:50.103858 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:23:50.104312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56BED850>]}
[0m00:23:50.104783 [info ] [Thread-1 (]: 6 of 7 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.08s]
[0m00:23:50.105570 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:23:50.106288 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.106664 [info ] [Thread-1 (]: 7 of 7 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m00:23:50.107338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m00:23:50.107680 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.109806 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.111310 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.113767 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.115855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.116470 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m00:23:50.117148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:50.117866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:50.118235 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:23:50.118526 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc;
    );
  
  
[0m00:23:50.119341 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc;
    );
  
  
[0m00:23:50.119694 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:23:50.120201 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: ROLLBACK
[0m00:23:50.125516 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.report_campaign_effectiveness'
[0m00:23:50.125847 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m00:23:50.128728 [debug] [Thread-1 (]: Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Parser Error: syntax error at or near ";"
[0m00:23:50.129207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48643ea4-b647-4c57-a05f-34233aa9502f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A57451C70>]}
[0m00:23:50.129886 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model report.report_campaign_effectiveness ..... [[31mERROR[0m in 0.02s]
[0m00:23:50.130636 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m00:23:50.131119 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.report_campaign_effectiveness' to be skipped because of status 'error'.  Reason: Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Parser Error: syntax error at or near ";".
[0m00:23:50.132696 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:50.132948 [debug] [MainThread]: On master: BEGIN
[0m00:23:50.133161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:50.133700 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:50.133986 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.134276 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:50.134496 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.134933 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:50.135250 [debug] [MainThread]: On master: Close
[0m00:23:50.135713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:50.135942 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m00:23:50.136177 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m00:23:50.136359 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m00:23:50.136657 [info ] [MainThread]: 
[0m00:23:50.137256 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:23:50.139274 [debug] [MainThread]: Command end result
[0m00:23:50.158386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:23:50.160909 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:23:50.166338 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:23:50.166715 [info ] [MainThread]: 
[0m00:23:50.167397 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:23:50.167885 [info ] [MainThread]: 
[0m00:23:50.168478 [error] [MainThread]:   Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Parser Error: syntax error at or near ";"
[0m00:23:50.169008 [info ] [MainThread]: 
[0m00:23:50.169526 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m00:23:50.170529 [debug] [MainThread]: Command `dbt run` failed at 00:23:50.170374 after 1.30 seconds
[0m00:23:50.170923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A555D1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A54E42990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A56BECE90>]}
[0m00:23:50.171273 [debug] [MainThread]: Flushing usage events
[0m00:23:51.599632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:59.114350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E0A3A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E19C7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1BB7ED0>]}


============================== 00:23:59.117600 | 20335673-f2f7-4480-9c07-4164b857c457 ==============================
[0m00:23:59.117600 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:23:59.118838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:59.278879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E10F10F0>]}
[0m00:23:59.329569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1A73AC0>]}
[0m00:23:59.332472 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:23:59.481375 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:23:59.578293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:59.578639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:59.605251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1C88850>]}
[0m00:23:59.658395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:23:59.660504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:23:59.692206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E19EF4D0>]}
[0m00:23:59.692705 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m00:23:59.693228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E31A4AD0>]}
[0m00:23:59.694887 [info ] [MainThread]: 
[0m00:23:59.695516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:59.696072 [info ] [MainThread]: 
[0m00:23:59.696857 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:23:59.701353 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:23:59.757169 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.757708 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.758067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:59.789225 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m00:23:59.790559 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.792283 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.792563 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.792790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.793647 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.794596 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.795962 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.796213 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.796423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.797143 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.798054 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.800102 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:23:59.800463 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:23:59.800697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.801468 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.802591 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:23:59.803251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m00:23:59.803619 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m00:23:59.808353 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.808625 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.808913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.809685 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.810892 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.811123 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m00:23:59.811524 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.811883 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.812101 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m00:23:59.812492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.813365 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:59.813620 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:23:59.813824 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:23:59.814181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.814401 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m00:23:59.814812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m00:23:59.815177 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:23:59.816568 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.816815 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.817022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.817717 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.818670 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.818902 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:23:59.819304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.819516 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.819852 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:23:59.820250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.820972 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:59.821185 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:23:59.821379 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:23:59.821879 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.822141 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:23:59.822534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m00:23:59.822849 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:23:59.824421 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.824677 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.824904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.825585 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.826546 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.826776 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:23:59.827129 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.827353 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.827549 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:23:59.827897 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.828538 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:59.828762 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:23:59.828965 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:23:59.829619 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.829939 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:23:59.830468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m00:23:59.830869 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:23:59.832551 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.832932 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:23:59.833380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.834382 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.835544 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.835794 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:23:59.836189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.836412 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.836604 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:23:59.836975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.837634 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:59.837872 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:23:59.838085 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:23:59.838437 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.838686 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:23:59.841187 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m00:23:59.846258 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:59.846599 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:23:59.846823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:59.847379 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:23:59.847622 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:23:59.847831 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.859390 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m00:23:59.861152 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:23:59.862230 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:23:59.862502 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:23:59.862927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m00:23:59.864229 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:59.864477 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:23:59.864685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.865175 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.865394 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:23:59.865604 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.868257 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:59.869308 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:23:59.869853 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:23:59.870104 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:23:59.870520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m00:23:59.871714 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:59.872628 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:23:59.872865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.873310 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.873533 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:23:59.873728 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.876401 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:59.877447 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:23:59.877890 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:23:59.878126 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:23:59.878604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m00:23:59.880253 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:59.880940 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:23:59.881171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:59.881614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:59.882000 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:23:59.882205 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:23:59.884934 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:23:59.885978 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:23:59.886444 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:23:59.886668 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:23:59.887698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E3598600>]}
[0m00:23:59.888047 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:59.888254 [debug] [MainThread]: On master: BEGIN
[0m00:23:59.888435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:59.888833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:59.889048 [debug] [MainThread]: On master: COMMIT
[0m00:23:59.889291 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:59.889507 [debug] [MainThread]: On master: COMMIT
[0m00:23:59.889827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:59.890071 [debug] [MainThread]: On master: Close
[0m00:23:59.892975 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.893471 [info ] [Thread-1 (]: 1 of 7 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m00:23:59.894288 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:23:59.894624 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.900185 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.901064 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.930780 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.931749 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.932302 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:23:59.932649 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:23:59.933212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:59.933476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.933719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:23:59.934495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.939372 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.939706 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:23:59.940367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.942434 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.942718 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:23:59.943277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.953147 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:59.953607 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.953875 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:23:59.958320 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:23:59.962352 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:23:59.962693 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:23:59.965854 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:59.968288 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:23:59.970552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E300BC50>]}
[0m00:23:59.971190 [info ] [Thread-1 (]: 1 of 7 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.07s]
[0m00:23:59.972232 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:23:59.972551 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:23:59.972952 [info ] [Thread-1 (]: 2 of 7 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m00:23:59.973706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:23:59.974025 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:23:59.975996 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.976962 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:23:59.979531 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.980423 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.980777 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:23:59.981027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:59.981567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:23:59.981832 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.982106 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:23:59.982837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.984985 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.985317 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:23:59.986002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.988619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.989052 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:23:59.989967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:23:59.991493 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:59.991911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.992313 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:23:59.995460 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:23:59.997189 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:23:59.997464 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:24:00.000213 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:24:00.002692 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:24:00.003476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E3610050>]}
[0m00:24:00.004512 [info ] [Thread-1 (]: 2 of 7 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.03s]
[0m00:24:00.005719 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:24:00.006211 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.006920 [info ] [Thread-1 (]: 3 of 7 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m00:24:00.007964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:24:00.008372 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.010787 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.012135 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.015149 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.016444 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.017079 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:24:00.017641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.018588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.019083 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.019371 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:24:00.020187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.022517 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.022903 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:24:00.023601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.025816 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.026144 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:24:00.026765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.027797 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:24:00.028112 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.028360 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:24:00.031437 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.034895 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:24:00.035369 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:24:00.038476 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.039895 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:24:00.040443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E35DD4F0>]}
[0m00:24:00.040934 [info ] [Thread-1 (]: 3 of 7 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.03s]
[0m00:24:00.041862 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:24:00.042225 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.042564 [info ] [Thread-1 (]: 4 of 7 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m00:24:00.043280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m00:24:00.043598 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.045512 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.046282 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.048818 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.049952 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.050472 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:24:00.050830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.051477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.051928 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.052358 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:24:00.053246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.055905 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.056228 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:24:00.056852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.058848 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.059125 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:24:00.059678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.060738 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:24:00.061025 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.061266 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:24:00.064509 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.066430 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:24:00.066778 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:24:00.069771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.072665 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:24:00.073145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E3425750>]}
[0m00:24:00.073741 [info ] [Thread-1 (]: 4 of 7 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.03s]
[0m00:24:00.074601 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:24:00.075274 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.075666 [info ] [Thread-1 (]: 5 of 7 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m00:24:00.076466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m00:24:00.076864 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.079282 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.080191 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.082736 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.084090 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.084579 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m00:24:00.084907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.085681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.085971 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.086227 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m00:24:00.087473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.136976 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.137360 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m00:24:00.138001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.139992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.140305 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m00:24:00.140985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.142146 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:24:00.142443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.142693 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m00:24:00.146007 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.147726 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m00:24:00.148009 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m00:24:00.151035 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.152535 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m00:24:00.152969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E35A43D0>]}
[0m00:24:00.153542 [info ] [Thread-1 (]: 5 of 7 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.08s]
[0m00:24:00.154359 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m00:24:00.155178 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.155556 [info ] [Thread-1 (]: 6 of 7 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m00:24:00.156306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:24:00.156665 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.159887 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.160856 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.177433 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.178498 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.178913 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:24:00.179188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.179857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.180255 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.180573 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m00:24:00.208566 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m00:24:00.210896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.211216 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m00:24:00.211872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.213928 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.214227 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m00:24:00.214782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.219440 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:24:00.219925 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.220313 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:24:00.225593 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:24:00.227658 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:24:00.227942 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m00:24:00.230915 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.232282 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:24:00.232838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1DF0350>]}
[0m00:24:00.233437 [info ] [Thread-1 (]: 6 of 7 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.08s]
[0m00:24:00.234316 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:24:00.235231 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.235612 [info ] [Thread-1 (]: 7 of 7 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m00:24:00.236508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m00:24:00.237046 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.240179 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.241231 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.244600 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.245957 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.246549 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m00:24:00.247035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:00.248004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:24:00.248420 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.248717 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m00:24:00.252619 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.255515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.255914 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m00:24:00.256596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.257729 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m00:24:00.258050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.258328 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m00:24:00.262062 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:00.263885 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:24:00.264186 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m00:24:00.265093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:24:00.267095 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m00:24:00.267852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20335673-f2f7-4480-9c07-4164b857c457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E1D44050>]}
[0m00:24:00.268560 [info ] [Thread-1 (]: 7 of 7 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.03s]
[0m00:24:00.269503 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m00:24:00.270933 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:00.271297 [debug] [MainThread]: On master: BEGIN
[0m00:24:00.271542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:24:00.272188 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:24:00.272550 [debug] [MainThread]: On master: COMMIT
[0m00:24:00.272845 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:00.273104 [debug] [MainThread]: On master: COMMIT
[0m00:24:00.273602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:24:00.273881 [debug] [MainThread]: On master: Close
[0m00:24:00.274258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:00.274486 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m00:24:00.274706 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m00:24:00.274883 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m00:24:00.275218 [info ] [MainThread]: 
[0m00:24:00.275830 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m00:24:00.278067 [debug] [MainThread]: Command end result
[0m00:24:00.295099 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:24:00.296965 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:24:00.303617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:24:00.304015 [info ] [MainThread]: 
[0m00:24:00.304690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:24:00.305233 [info ] [MainThread]: 
[0m00:24:00.305760 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m00:24:00.306557 [debug] [MainThread]: Command `dbt run` succeeded at 00:24:00.306452 after 1.33 seconds
[0m00:24:00.306884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E2E58110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E175DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197E346B1D0>]}
[0m00:24:00.307218 [debug] [MainThread]: Flushing usage events
[0m00:24:01.566748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:38.674015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF9E0E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAD7F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAAD5310>]}


============================== 14:32:38.680523 | 652a9f27-15b1-4bb8-95ba-964c7306b826 ==============================
[0m14:32:38.680523 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:32:38.681414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:32:38.844852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '652a9f27-15b1-4bb8-95ba-964c7306b826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFA4ACFC0>]}
[0m14:32:38.893482 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:32:38.896279 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:32:38.897630 [debug] [MainThread]: Command `cli deps` succeeded at 14:32:38.897407 after 0.49 seconds
[0m14:32:38.898168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAE3AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAE3A250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DFAFE5750>]}
[0m14:32:38.898743 [debug] [MainThread]: Flushing usage events
[0m14:32:40.383676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:20.359299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029503E6A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504DF7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504FE7ED0>]}


============================== 15:02:20.365141 | 50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e ==============================
[0m15:02:20.365141 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:02:20.366503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:02:20.617319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295045210F0>]}
[0m15:02:20.694805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504EA7AC0>]}
[0m15:02:20.698750 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:02:21.118147 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:02:21.262136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:21.262651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:21.301328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295050B8850>]}
[0m15:02:21.380819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m15:02:21.407882 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m15:02:21.441917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504E1F4D0>]}
[0m15:02:21.442796 [info ] [MainThread]: Found 7 models, 4 sources, 429 macros
[0m15:02:21.444233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506694AD0>]}
[0m15:02:21.447671 [info ] [MainThread]: 
[0m15:02:21.448954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:21.449999 [info ] [MainThread]: 
[0m15:02:21.451463 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:02:21.467479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m15:02:21.564975 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.565506 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.565848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:21.596067 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m15:02:21.598551 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.600739 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.601118 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.601432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.602646 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.604219 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.606478 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.606881 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.607207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.608313 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.609533 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.612243 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:02:21.612664 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:02:21.613080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.614394 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.615881 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:02:21.617073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m15:02:21.617613 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m15:02:21.624022 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.624474 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.624811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.625850 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.627282 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.627685 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m15:02:21.628377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.628721 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.629042 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m15:02:21.630153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.631113 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m15:02:21.631491 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:02:21.631823 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m15:02:21.632386 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.632757 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m15:02:21.633524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m15:02:21.634206 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m15:02:21.635890 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.636250 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.636599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.637843 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.639330 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.639649 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m15:02:21.640160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.640437 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.640707 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m15:02:21.641296 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.642303 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m15:02:21.642657 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:02:21.642976 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m15:02:21.643465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.643794 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m15:02:21.644636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m15:02:21.645243 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m15:02:21.647523 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.647915 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.648218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.649298 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.650821 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.651128 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m15:02:21.651585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.651945 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.652366 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m15:02:21.653257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.654566 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m15:02:21.654968 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:02:21.655250 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m15:02:21.655749 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.656060 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m15:02:21.656625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m15:02:21.657179 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m15:02:21.658915 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.659233 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:02:21.659507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.660429 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.662047 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.662393 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m15:02:21.662922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.663220 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.663482 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m15:02:21.664102 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.665133 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m15:02:21.665497 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:02:21.665811 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m15:02:21.666351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:02:21.666698 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m15:02:21.669450 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m15:02:21.675568 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m15:02:21.676275 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m15:02:21.676753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:21.677463 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.677848 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m15:02:21.678209 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.697684 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:02:21.700048 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m15:02:21.701369 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m15:02:21.701773 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m15:02:21.702320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m15:02:21.704032 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m15:02:21.704373 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m15:02:21.704681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.705897 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.706446 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m15:02:21.706776 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.711052 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:02:21.712740 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m15:02:21.713493 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m15:02:21.713908 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m15:02:21.715925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m15:02:21.718525 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m15:02:21.719142 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m15:02:21.719623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.720529 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:02:21.721055 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m15:02:21.721540 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.726741 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:02:21.728620 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m15:02:21.729321 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m15:02:21.729679 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m15:02:21.730298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m15:02:21.732686 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m15:02:21.733047 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m15:02:21.733351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:21.734910 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:02:21.735300 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m15:02:21.735657 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:02:21.739457 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:02:21.740919 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m15:02:21.741601 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m15:02:21.741928 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m15:02:21.743538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506A88EF0>]}
[0m15:02:21.744637 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:21.745590 [debug] [MainThread]: On master: BEGIN
[0m15:02:21.745990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:21.747023 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:02:21.747482 [debug] [MainThread]: On master: COMMIT
[0m15:02:21.747848 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:21.748175 [debug] [MainThread]: On master: COMMIT
[0m15:02:21.748765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:02:21.749194 [debug] [MainThread]: On master: Close
[0m15:02:21.753512 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.754418 [info ] [Thread-1 (]: 1 of 7 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m15:02:21.755500 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m15:02:21.755992 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.765344 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.768312 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.815041 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.818105 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.818628 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m15:02:21.819093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:21.819962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.820414 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.820774 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m15:02:21.821980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.830855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.831464 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m15:02:21.833243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.836540 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.837020 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m15:02:21.837806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:21.854715 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m15:02:21.855346 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.855776 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m15:02:21.861381 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:02:21.868269 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:02:21.868864 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m15:02:21.872883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:21.876660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m15:02:21.881566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506ADC050>]}
[0m15:02:21.882515 [info ] [Thread-1 (]: 1 of 7 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.12s]
[0m15:02:21.884805 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m15:02:21.885470 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.886125 [info ] [Thread-1 (]: 2 of 7 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m15:02:21.887159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m15:02:21.887704 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.891142 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.893388 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.898405 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.899979 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.900661 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m15:02:21.901133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:21.901977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.902464 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.902898 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m15:02:21.904294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.909327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.910596 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m15:02:21.912205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.916553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.917266 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m15:02:21.918736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.923870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m15:02:21.924641 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.925115 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m15:02:21.929609 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:02:21.934904 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:02:21.936091 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m15:02:21.939768 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:21.941937 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m15:02:21.942781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506B00050>]}
[0m15:02:21.943633 [info ] [Thread-1 (]: 2 of 7 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.06s]
[0m15:02:21.945490 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m15:02:21.947001 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m15:02:21.947988 [info ] [Thread-1 (]: 3 of 7 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m15:02:21.949606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m15:02:21.950191 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m15:02:21.953760 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.954993 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m15:02:21.958838 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.960956 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.962078 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m15:02:21.963517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:21.964905 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:02:21.965754 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.966764 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m15:02:21.968796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.973739 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.974506 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m15:02:21.975855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:21.982828 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.983419 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m15:02:21.984440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:21.986048 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m15:02:21.986490 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.986841 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m15:02:21.990334 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:21.993229 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:02:21.994108 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m15:02:21.999122 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:02:22.002036 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m15:02:22.002797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506AC94F0>]}
[0m15:02:22.003657 [info ] [Thread-1 (]: 3 of 7 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.05s]
[0m15:02:22.005059 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m15:02:22.005570 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.006164 [info ] [Thread-1 (]: 4 of 7 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m15:02:22.007170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m15:02:22.007778 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.011402 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.015059 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.018482 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.019744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.020366 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m15:02:22.020819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.021740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.022275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.022703 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m15:02:22.023877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.029356 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.030530 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m15:02:22.031838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.035609 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.036203 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m15:02:22.037078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:22.038577 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m15:02:22.038981 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.039337 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m15:02:22.043412 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.049364 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:02:22.050036 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m15:02:22.053978 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.058656 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m15:02:22.059428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506915250>]}
[0m15:02:22.060890 [info ] [Thread-1 (]: 4 of 7 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.05s]
[0m15:02:22.063179 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m15:02:22.065407 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.066336 [info ] [Thread-1 (]: 5 of 7 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m15:02:22.067466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m15:02:22.068248 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.071823 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.073155 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.079858 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.082818 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.083468 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m15:02:22.084023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.084961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.085444 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.085939 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m15:02:22.088138 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:02:22.160943 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.161749 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m15:02:22.163005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.166668 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.167116 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m15:02:22.167963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:22.169368 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m15:02:22.169790 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.170150 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m15:02:22.173613 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.176314 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m15:02:22.176790 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m15:02:22.180973 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.182456 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m15:02:22.183200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506AB4A60>]}
[0m15:02:22.184909 [info ] [Thread-1 (]: 5 of 7 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.12s]
[0m15:02:22.186920 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m15:02:22.188171 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.188889 [info ] [Thread-1 (]: 6 of 7 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m15:02:22.190163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_mart_campaign_performance)
[0m15:02:22.190860 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.195708 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.196907 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.229502 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.232454 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.233423 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m15:02:22.234208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.235249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.235797 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.236348 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m15:02:22.286872 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m15:02:22.289994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.290433 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m15:02:22.291986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.295755 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.296295 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m15:02:22.297421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.302805 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m15:02:22.303251 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.303605 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m15:02:22.309443 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:02:22.312555 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:02:22.313013 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m15:02:22.316972 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:02:22.318837 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m15:02:22.319420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002950623C530>]}
[0m15:02:22.320063 [info ] [Thread-1 (]: 6 of 7 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.13s]
[0m15:02:22.322018 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m15:02:22.323292 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.324122 [info ] [Thread-1 (]: 7 of 7 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m15:02:22.325512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m15:02:22.327037 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.330336 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.332291 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.335917 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.337191 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.337795 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m15:02:22.338231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.338998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.339443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.339821 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m15:02:22.347098 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:02:22.351992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.353023 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m15:02:22.354419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:02:22.358610 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.359162 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m15:02:22.360151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:02:22.362345 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m15:02:22.363099 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.363723 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m15:02:22.369568 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:02:22.372058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:02:22.372687 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m15:02:22.379920 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:02:22.383563 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m15:02:22.384575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f3f2-1c39-4ba7-a8c6-ecbfd682f18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506278470>]}
[0m15:02:22.385489 [info ] [Thread-1 (]: 7 of 7 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.06s]
[0m15:02:22.386968 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m15:02:22.389242 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:22.389867 [debug] [MainThread]: On master: BEGIN
[0m15:02:22.390490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:22.392037 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:02:22.392729 [debug] [MainThread]: On master: COMMIT
[0m15:02:22.393221 [debug] [MainThread]: Using duckdb connection "master"
[0m15:02:22.394037 [debug] [MainThread]: On master: COMMIT
[0m15:02:22.395103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:02:22.395613 [debug] [MainThread]: On master: Close
[0m15:02:22.396240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:22.396668 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m15:02:22.397034 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m15:02:22.397446 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m15:02:22.398413 [info ] [MainThread]: 
[0m15:02:22.399408 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:02:22.402677 [debug] [MainThread]: Command end result
[0m15:02:22.452982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m15:02:22.455795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m15:02:22.466994 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m15:02:22.467700 [info ] [MainThread]: 
[0m15:02:22.468742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:22.469515 [info ] [MainThread]: 
[0m15:02:22.470305 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:02:22.471564 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:22.471364 after 2.32 seconds
[0m15:02:22.472025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504EEF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029504488350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029506B23AD0>]}
[0m15:02:22.472431 [debug] [MainThread]: Flushing usage events
[0m15:02:25.550095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:26.336136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C703AAA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704A27890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704C17ED0>]}


============================== 19:13:26.343667 | 502e799f-e176-4d6b-bb7a-232ce96ba40a ==============================
[0m19:13:26.343667 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:13:26.344989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:26.587241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7041510F0>]}
[0m19:13:26.652977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704AD3AC0>]}
[0m19:13:26.656805 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:13:27.004688 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:13:27.132274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:27.132670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:27.172607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704CE8850>]}
[0m19:13:27.257044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:13:27.272476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:13:27.298206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704A4F4D0>]}
[0m19:13:27.299038 [info ] [MainThread]: Found 8 models, 4 sources, 429 macros
[0m19:13:27.300384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7061F8AD0>]}
[0m19:13:27.304312 [info ] [MainThread]: 
[0m19:13:27.305076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:27.305691 [info ] [MainThread]: 
[0m19:13:27.306527 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:13:27.313326 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:13:27.411387 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.411902 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.412251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:27.441029 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m19:13:27.442974 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.445188 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.445576 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.446242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.447370 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.448698 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.450417 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.450740 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.451059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.452063 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.453320 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.455466 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:13:27.455939 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:13:27.456439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.457911 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.459414 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:13:27.460580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m19:13:27.461652 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m19:13:27.467881 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.468228 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.468579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.469548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.470863 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.471147 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m19:13:27.471637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.471999 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.472345 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m19:13:27.474908 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:13:27.476120 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:13:27.476652 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:13:27.477061 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:13:27.477735 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.478186 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m19:13:27.478893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m19:13:27.479455 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:13:27.481462 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.481881 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.482249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.483382 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.485065 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.485471 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:13:27.486751 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.487202 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.487572 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:13:27.488278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.489793 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:13:27.490255 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:13:27.490601 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:13:27.491257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.492026 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:13:27.493315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m19:13:27.493966 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m19:13:27.496659 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.497176 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.497585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.498827 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.500947 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.501407 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m19:13:27.502061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.502448 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.502786 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m19:13:27.503493 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.505840 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:13:27.506678 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:13:27.507313 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:13:27.508401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.509322 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m19:13:27.510537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m19:13:27.511128 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m19:13:27.512898 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.513223 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:13:27.513515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.514556 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.515935 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.516230 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m19:13:27.516702 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.517183 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.517776 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m19:13:27.519160 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.520108 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:13:27.520413 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:13:27.520657 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:13:27.521090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:13:27.521465 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m19:13:27.524176 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m19:13:27.530322 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:13:27.530701 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m19:13:27.530975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:27.532295 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.532705 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:13:27.533023 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.559980 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:13:27.563817 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m19:13:27.565947 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m19:13:27.566633 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m19:13:27.567701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m19:13:27.570582 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:13:27.571025 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:13:27.571398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.572701 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.573086 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:13:27.573377 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.577442 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:13:27.579947 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:13:27.580743 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:13:27.581074 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:13:27.581593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m19:13:27.583232 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:13:27.583540 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m19:13:27.583847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.585438 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:13:27.585808 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:13:27.586116 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.591158 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:13:27.593101 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m19:13:27.593908 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m19:13:27.594260 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m19:13:27.594841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m19:13:27.597150 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:13:27.597512 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m19:13:27.597823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:27.599030 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:13:27.599458 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:13:27.599777 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:13:27.603725 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:13:27.605253 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m19:13:27.605813 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m19:13:27.606098 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m19:13:27.607838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7065ECEF0>]}
[0m19:13:27.608383 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:27.608733 [debug] [MainThread]: On master: BEGIN
[0m19:13:27.609036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:27.610147 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:13:27.610543 [debug] [MainThread]: On master: COMMIT
[0m19:13:27.610885 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:27.611162 [debug] [MainThread]: On master: COMMIT
[0m19:13:27.611639 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:13:27.612013 [debug] [MainThread]: On master: Close
[0m19:13:27.617264 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.617912 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:13:27.619240 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:13:27.619883 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.627908 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.631087 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.672306 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.675015 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.675623 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:13:27.676362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:27.677353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.677799 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.678226 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m19:13:27.680028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.686661 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.687145 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:13:27.688873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.691971 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.692490 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:13:27.693752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.706305 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:13:27.706797 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.707243 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:13:27.714740 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:13:27.720409 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:13:27.720804 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:13:27.725415 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:13:27.728282 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:13:27.731094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C706644050>]}
[0m19:13:27.731921 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.11s]
[0m19:13:27.733153 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:13:27.733732 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.734706 [info ] [Thread-1 (]: 2 of 8 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m19:13:27.735642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m19:13:27.736066 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.738707 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.740091 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.744173 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.746042 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.746804 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m19:13:27.747406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.748796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.749634 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.750321 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m19:13:27.752149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.759402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.761150 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m19:13:27.763648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.770009 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.771094 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m19:13:27.772563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.775047 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:13:27.775619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.776263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:13:27.780294 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.783827 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:13:27.784259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m19:13:27.787435 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.790483 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m19:13:27.791604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C706660050>]}
[0m19:13:27.792893 [info ] [Thread-1 (]: 2 of 8 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.06s]
[0m19:13:27.794384 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m19:13:27.795017 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.796059 [info ] [Thread-1 (]: 3 of 8 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m19:13:27.796987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m19:13:27.797518 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.801013 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.802992 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.809529 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.812453 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.814238 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m19:13:27.815779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.817223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:13:27.817785 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.818223 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m19:13:27.819612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.824285 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.824795 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m19:13:27.825931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.833996 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.834973 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m19:13:27.836324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.838362 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:13:27.839007 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.839559 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:13:27.843436 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.848288 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:13:27.848808 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m19:13:27.852283 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.853864 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m19:13:27.854695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70662D590>]}
[0m19:13:27.855547 [info ] [Thread-1 (]: 3 of 8 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.06s]
[0m19:13:27.857071 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m19:13:27.857824 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.858392 [info ] [Thread-1 (]: 4 of 8 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m19:13:27.859571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m19:13:27.860478 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.864654 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.866001 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.869339 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.871315 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.872367 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m19:13:27.872859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.873670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.874092 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.874465 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m19:13:27.875608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.881030 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.882040 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m19:13:27.883449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.887018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.887390 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m19:13:27.888084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:27.890847 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:13:27.891327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.891700 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:13:27.895609 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.900288 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:13:27.901242 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m19:13:27.904961 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:27.910005 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m19:13:27.911497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70647E850>]}
[0m19:13:27.913075 [info ] [Thread-1 (]: 4 of 8 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.05s]
[0m19:13:27.914887 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m19:13:27.916373 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:27.916972 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m19:13:27.917883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m19:13:27.918440 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:27.922790 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.924204 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:27.929768 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.932635 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.933678 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m19:13:27.934231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:27.935209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:27.935718 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:27.936100 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m19:13:27.937874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.004645 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.005258 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m19:13:28.006223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.009482 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.010043 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m19:13:28.010958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.012938 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:13:28.013438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.013823 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:13:28.017361 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.019615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:13:28.019955 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m19:13:28.023774 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.025396 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m19:13:28.025974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C706640FA0>]}
[0m19:13:28.026769 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.11s]
[0m19:13:28.028673 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m19:13:28.030038 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.030658 [info ] [Thread-1 (]: 6 of 8 START sql view model intermediate.model_int_new_customer_converted ...... [RUN]
[0m19:13:28.031668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_new_customer_converted)
[0m19:13:28.032245 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.035024 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.036337 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.039533 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.041036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.041956 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m19:13:28.042683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:28.043693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.044235 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.044812 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m19:13:28.047579 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:13:28.053166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.053898 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m19:13:28.054945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.056449 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:13:28.056828 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.057146 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:13:28.061004 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.065778 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:13:28.066247 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m19:13:28.067069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.069077 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m19:13:28.069680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C70620F0B0>]}
[0m19:13:28.070260 [info ] [Thread-1 (]: 6 of 8 OK created sql view model intermediate.model_int_new_customer_converted . [[32mOK[0m in 0.04s]
[0m19:13:28.071942 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m19:13:28.072491 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.073068 [info ] [Thread-1 (]: 7 of 8 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m19:13:28.073982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m19:13:28.074498 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.081905 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.083649 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.109282 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.112163 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.113399 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m19:13:28.114512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:28.116076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.116724 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.117242 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
),
final as (
  select
    cn.campaign_name,
    i.date,
    i.impressions,
    cl.clicks,
    cv.conversions,
    cv.total_revenue,
    co.total_cost,
    co.total_cost / ncc.new_customers as cac,
    ROUND((cv.total_revenue/co.total_cost)*100,2) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m19:13:28.171008 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m19:13:28.173718 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.174100 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m19:13:28.175322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.178858 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.179251 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m19:13:28.179960 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.185062 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:13:28.185426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.185733 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:13:28.192771 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:13:28.195373 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:13:28.195778 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m19:13:28.199146 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.200792 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m19:13:28.201290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C705E53C50>]}
[0m19:13:28.201847 [info ] [Thread-1 (]: 7 of 8 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.13s]
[0m19:13:28.203065 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m19:13:28.204377 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.204944 [info ] [Thread-1 (]: 8 of 8 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m19:13:28.206004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m19:13:28.206592 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.210764 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.212625 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.218436 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.219708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.220313 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m19:13:28.220750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:28.221525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.221923 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.222276 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m19:13:28.232351 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m19:13:28.235167 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.235547 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m19:13:28.236258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:13:28.239966 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.240609 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m19:13:28.241864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:13:28.244152 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:13:28.245021 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.245654 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:13:28.251757 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:13:28.253788 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:13:28.254126 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m19:13:28.257348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:13:28.258923 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m19:13:28.259593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502e799f-e176-4d6b-bb7a-232ce96ba40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7065F2570>]}
[0m19:13:28.260501 [info ] [Thread-1 (]: 8 of 8 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.05s]
[0m19:13:28.262240 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m19:13:28.265189 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:28.265600 [debug] [MainThread]: On master: BEGIN
[0m19:13:28.265879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:28.266486 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:13:28.266762 [debug] [MainThread]: On master: COMMIT
[0m19:13:28.267016 [debug] [MainThread]: Using duckdb connection "master"
[0m19:13:28.267333 [debug] [MainThread]: On master: COMMIT
[0m19:13:28.267874 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:13:28.268223 [debug] [MainThread]: On master: Close
[0m19:13:28.268689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:28.268968 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m19:13:28.269213 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m19:13:28.269426 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m19:13:28.269758 [info ] [MainThread]: 
[0m19:13:28.270610 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m19:13:28.273652 [debug] [MainThread]: Command end result
[0m19:13:28.301248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:13:28.303955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:13:28.313296 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:13:28.314242 [info ] [MainThread]: 
[0m19:13:28.315803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:28.317313 [info ] [MainThread]: 
[0m19:13:28.318383 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:13:28.319743 [debug] [MainThread]: Command `dbt run` succeeded at 19:13:28.319566 after 2.33 seconds
[0m19:13:28.320211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704049BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C701D538F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C704C9BB90>]}
[0m19:13:28.320632 [debug] [MainThread]: Flushing usage events
[0m19:13:31.297731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:40.652083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69B76A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C6E7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C8D7ED0>]}


============================== 19:26:40.660263 | 38bda598-d3ce-4b3b-93b0-08e897a937e3 ==============================
[0m19:26:40.660263 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:26:40.662020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:26:40.955072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69BE110F0>]}
[0m19:26:41.035488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C793AC0>]}
[0m19:26:41.040026 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:26:41.240812 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:26:41.369557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:41.369947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:41.405208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C9A8850>]}
[0m19:26:41.507457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:26:41.525083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:26:41.569791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C70F4D0>]}
[0m19:26:41.571052 [info ] [MainThread]: Found 8 models, 4 sources, 429 macros
[0m19:26:41.572345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69DE98AD0>]}
[0m19:26:41.575698 [info ] [MainThread]: 
[0m19:26:41.576686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:41.577452 [info ] [MainThread]: 
[0m19:26:41.578942 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:26:41.591501 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m19:26:41.699056 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.699820 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.700392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:41.825698 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m19:26:41.828806 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.830847 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.831224 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.831546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.832927 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.834424 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.836327 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.837137 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.837517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.839303 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:26:41.840689 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.842914 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m19:26:41.843235 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m19:26:41.843517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.844520 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.845796 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m19:26:41.847471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m19:26:41.848312 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m19:26:41.858132 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.858698 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.859078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.860156 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.861542 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.861851 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m19:26:41.862399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.862786 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.863162 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m19:26:41.864923 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.866099 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:26:41.866610 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m19:26:41.867002 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m19:26:41.867871 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.868369 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m19:26:41.869217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m19:26:41.869875 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m19:26:41.871469 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.871775 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.872035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.873025 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.874438 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.874709 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m19:26:41.875174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.875474 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.875791 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m19:26:41.876355 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.877804 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:26:41.878469 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m19:26:41.878962 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m19:26:41.879627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.879984 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m19:26:41.880645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_report)
[0m19:26:41.881296 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m19:26:41.884886 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.885885 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.886467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.888008 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.890023 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.890629 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m19:26:41.891822 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.892744 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.893798 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m19:26:41.895225 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.896652 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:26:41.897041 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m19:26:41.897379 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m19:26:41.897916 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.898203 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m19:26:41.898855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m19:26:41.899488 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m19:26:41.902857 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.903594 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m19:26:41.904137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.905568 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.907567 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.908147 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m19:26:41.908884 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.909328 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.909668 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m19:26:41.910289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.911296 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:26:41.911682 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m19:26:41.911991 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m19:26:41.912495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:26:41.912803 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m19:26:41.915802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m19:26:41.924467 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:26:41.924935 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m19:26:41.925241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:41.925928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.926297 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m19:26:41.926619 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:41.961451 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m19:26:41.963957 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m19:26:41.966685 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m19:26:41.968062 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m19:26:41.970370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m19:26:41.975387 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:26:41.975888 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m19:26:41.976230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.976917 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.977240 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m19:26:41.977551 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:41.981972 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:26:41.984959 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m19:26:41.986425 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m19:26:41.987105 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m19:26:41.987865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m19:26:41.990383 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:26:41.991015 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m19:26:41.992256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:41.993089 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:41.993420 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m19:26:41.993723 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:41.997443 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:26:41.999117 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m19:26:42.000494 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m19:26:42.001161 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m19:26:42.002275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m19:26:42.005376 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:26:42.005745 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m19:26:42.005997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:42.006557 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:26:42.006933 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m19:26:42.007330 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m19:26:42.012499 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:26:42.014879 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m19:26:42.015957 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m19:26:42.016618 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m19:26:42.019044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E28CA10>]}
[0m19:26:42.019737 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.020070 [debug] [MainThread]: On master: BEGIN
[0m19:26:42.020344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:42.020946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:26:42.021295 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.021617 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.021902 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.022400 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:26:42.022717 [debug] [MainThread]: On master: Close
[0m19:26:42.028034 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.029198 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m19:26:42.030532 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m19:26:42.031108 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.042272 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.044090 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.092993 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.094366 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.095587 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m19:26:42.096419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:42.097618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.098171 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.098624 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m19:26:42.100090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.109494 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.110505 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m19:26:42.112587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.115751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.116315 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m19:26:42.117467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.134032 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:26:42.135050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.135644 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m19:26:42.141000 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:26:42.147182 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m19:26:42.147905 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m19:26:42.152125 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.155957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m19:26:42.160271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E2E8290>]}
[0m19:26:42.161620 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.13s]
[0m19:26:42.163264 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m19:26:42.164177 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.164874 [info ] [Thread-1 (]: 2 of 8 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m19:26:42.166726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m19:26:42.167373 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.170774 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.173044 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.180236 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.181619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.182275 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m19:26:42.182837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.183886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.184409 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.185023 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m19:26:42.186837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.191684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.192567 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m19:26:42.193932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.199231 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.200528 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m19:26:42.201934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.206206 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:26:42.207270 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.208090 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m19:26:42.212513 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.218030 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m19:26:42.219189 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m19:26:42.224455 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.226690 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m19:26:42.228415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E304050>]}
[0m19:26:42.230201 [info ] [Thread-1 (]: 2 of 8 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.06s]
[0m19:26:42.232406 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m19:26:42.234234 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.236088 [info ] [Thread-1 (]: 3 of 8 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m19:26:42.237447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m19:26:42.238378 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.242084 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.243705 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.247497 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.248578 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.249646 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m19:26:42.251580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.253681 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.254429 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.255258 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m19:26:42.257130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.261146 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.261936 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m19:26:42.263931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.269667 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.270507 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m19:26:42.271880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.274039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:26:42.274545 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.274942 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m19:26:42.278674 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.284938 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m19:26:42.285696 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m19:26:42.289881 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.292171 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m19:26:42.293126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E2D9590>]}
[0m19:26:42.294040 [info ] [Thread-1 (]: 3 of 8 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.06s]
[0m19:26:42.295716 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m19:26:42.296231 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.296975 [info ] [Thread-1 (]: 4 of 8 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m19:26:42.298113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m19:26:42.298887 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.303973 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.305404 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.311593 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.313568 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.314256 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m19:26:42.314656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.315437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.316421 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.317403 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m19:26:42.319031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.324463 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.325329 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m19:26:42.326926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.332955 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.334434 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m19:26:42.335729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.337810 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:26:42.338561 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.339135 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m19:26:42.343088 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.347520 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m19:26:42.348332 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m19:26:42.353038 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.359617 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m19:26:42.360885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E11DF50>]}
[0m19:26:42.363219 [info ] [Thread-1 (]: 4 of 8 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.06s]
[0m19:26:42.364822 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m19:26:42.366549 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.368053 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m19:26:42.369468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m19:26:42.370103 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.375190 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.378571 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.382700 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.385136 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.385925 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m19:26:42.386509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.388169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.389275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.390049 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m19:26:42.392244 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:26:42.467132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.467987 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m19:26:42.469218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.474108 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.474763 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m19:26:42.475796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.477446 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:26:42.477843 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.478196 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m19:26:42.482027 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.485535 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m19:26:42.486201 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m19:26:42.489689 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.493695 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m19:26:42.495029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E2E0750>]}
[0m19:26:42.496226 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.13s]
[0m19:26:42.497581 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m19:26:42.499100 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.499922 [info ] [Thread-1 (]: 6 of 8 START sql view model intermediate.model_int_new_customer_converted ...... [RUN]
[0m19:26:42.501635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_new_customer_converted)
[0m19:26:42.502535 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.507911 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.509625 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.512991 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.514141 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.514835 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m19:26:42.515373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.516691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.517253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.517918 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_customers_master" scm  
  on icc.customer_id = scm.customer_id
  where scm.customer_segment = 'new'
  group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m19:26:42.522969 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:26:42.527100 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.527627 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m19:26:42.528448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.531025 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.531375 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m19:26:42.532025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.534359 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:26:42.535274 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.536047 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m19:26:42.540566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.542819 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m19:26:42.543178 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m19:26:42.546250 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.547731 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m19:26:42.548266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C8F8DD0>]}
[0m19:26:42.548876 [info ] [Thread-1 (]: 6 of 8 OK created sql view model intermediate.model_int_new_customer_converted . [[32mOK[0m in 0.05s]
[0m19:26:42.550481 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m19:26:42.551923 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.553158 [info ] [Thread-1 (]: 7 of 8 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m19:26:42.554585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m19:26:42.555237 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.560331 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.561615 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.593930 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.595603 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.596507 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m19:26:42.597105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.598111 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.598733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.599659 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select *
  from "ae_exam_db"."intermediate"."model_int_new_customer_converted"
),
final as (
  select
    cn.campaign_name,
    i.date,
    coalesce(i.impressions,0) as impressions,
    coalesce(cl.clicks,0) as clicks,
    coalesce(cv.conversions,0) as conversions,
    coalesce(ROUND(cv.total_revenue,2),0) as total_revenue,
    coalesce(ROUND(co.total_cost,2),0) as total_cost,
    coalesce(ROUND((co.total_cost / ncc.new_customers),2),0) as cac,
    coalesce(ROUND((cv.total_revenue/co.total_cost)*100,2),0) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m19:26:42.675280 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m19:26:42.681463 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.682138 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m19:26:42.684027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.688691 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.689340 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m19:26:42.690515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.699685 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:26:42.700750 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.701708 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m19:26:42.709088 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:26:42.711876 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m19:26:42.712354 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m19:26:42.716200 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.718421 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m19:26:42.719156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69DA79910>]}
[0m19:26:42.719943 [info ] [Thread-1 (]: 7 of 8 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.16s]
[0m19:26:42.721136 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m19:26:42.722651 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.723431 [info ] [Thread-1 (]: 8 of 8 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m19:26:42.724785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m19:26:42.725924 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.732125 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.733978 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.739864 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.741508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.742308 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m19:26:42.742746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:42.743502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:26:42.744013 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.744433 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m19:26:42.752225 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:26:42.757293 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.758198 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m19:26:42.759115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.762290 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.762743 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m19:26:42.763980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:26:42.765988 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:26:42.766614 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.767307 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m19:26:42.772834 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:26:42.775809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m19:26:42.776445 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m19:26:42.780568 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:26:42.783046 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m19:26:42.784078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bda598-d3ce-4b3b-93b0-08e897a937e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C948E30>]}
[0m19:26:42.784989 [info ] [Thread-1 (]: 8 of 8 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.06s]
[0m19:26:42.786575 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m19:26:42.788770 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.789268 [debug] [MainThread]: On master: BEGIN
[0m19:26:42.789762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:26:42.790723 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:26:42.791224 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.791608 [debug] [MainThread]: Using duckdb connection "master"
[0m19:26:42.792025 [debug] [MainThread]: On master: COMMIT
[0m19:26:42.792818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:26:42.793270 [debug] [MainThread]: On master: Close
[0m19:26:42.793915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:42.794439 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m19:26:42.794861 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m19:26:42.795190 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m19:26:42.795817 [info ] [MainThread]: 
[0m19:26:42.796928 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m19:26:42.802474 [debug] [MainThread]: Command end result
[0m19:26:42.837535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m19:26:42.840503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m19:26:42.848247 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m19:26:42.848819 [info ] [MainThread]: 
[0m19:26:42.850427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:42.851659 [info ] [MainThread]: 
[0m19:26:42.852711 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:26:42.854086 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:42.853905 after 2.55 seconds
[0m19:26:42.854532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69C948E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69BD08E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69E30FA70>]}
[0m19:26:42.854936 [debug] [MainThread]: Flushing usage events
[0m19:26:45.798806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:27.139427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594B6EA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C667890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C857ED0>]}


============================== 20:56:27.145440 | fc464780-df03-4eca-abce-caf959451afb ==============================
[0m20:56:27.145440 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:56:27.147580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:27.479748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BD910F0>]}
[0m20:56:27.553976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C713AC0>]}
[0m20:56:27.557700 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m20:56:27.797505 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:56:27.925661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:27.926208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:27.966795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C928850>]}
[0m20:56:28.044075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m20:56:28.061922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m20:56:28.089502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594C68F4D0>]}
[0m20:56:28.090372 [info ] [MainThread]: Found 8 models, 4 sources, 429 macros
[0m20:56:28.091268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594DE18AD0>]}
[0m20:56:28.095360 [info ] [MainThread]: 
[0m20:56:28.096182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:28.096834 [info ] [MainThread]: 
[0m20:56:28.097660 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:56:28.103900 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m20:56:28.208441 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.208928 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.209266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:28.235399 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:56:28.238108 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.241290 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.241840 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.242273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.243677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.245550 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.247799 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.248236 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.248601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.250153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.252826 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.255956 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:56:28.256378 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:56:28.256694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.257845 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.259214 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:56:28.260726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m20:56:28.262284 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m20:56:28.268760 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.269122 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.269385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.270438 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.271954 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.272359 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m20:56:28.273510 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.274292 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.275014 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m20:56:28.277195 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:28.278634 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m20:56:28.279066 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:56:28.279365 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m20:56:28.279928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.280253 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m20:56:28.280852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m20:56:28.281331 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m20:56:28.284006 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.284501 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.284834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.285807 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.287184 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.287466 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m20:56:28.287925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.288297 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.288692 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m20:56:28.289288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.290280 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m20:56:28.290616 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:56:28.290881 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m20:56:28.291332 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.291586 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m20:56:28.292146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m20:56:28.292636 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m20:56:28.295527 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.295974 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.296292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.297238 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.298531 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.298846 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m20:56:28.299324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.299691 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.300047 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m20:56:28.300666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.301608 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m20:56:28.301899 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:56:28.302153 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m20:56:28.302585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.302914 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m20:56:28.303566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m20:56:28.304077 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m20:56:28.306136 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.306467 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:56:28.306745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.307504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.308696 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.308983 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m20:56:28.309419 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.309708 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.309974 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m20:56:28.310567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.311599 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m20:56:28.311980 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:56:28.312276 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m20:56:28.312792 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:56:28.313072 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m20:56:28.315819 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m20:56:28.321815 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m20:56:28.322155 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m20:56:28.322480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:28.323565 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.323984 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m20:56:28.324328 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.343330 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:56:28.345826 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m20:56:28.347166 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m20:56:28.347565 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m20:56:28.348110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m20:56:28.349708 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m20:56:28.350025 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m20:56:28.350287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.351896 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:28.352386 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m20:56:28.352743 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.356652 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:56:28.358061 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m20:56:28.358644 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m20:56:28.358917 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m20:56:28.359382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m20:56:28.361181 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m20:56:28.361663 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m20:56:28.362036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.363206 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.363710 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m20:56:28.364025 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.368922 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:56:28.370348 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m20:56:28.370926 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m20:56:28.371194 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m20:56:28.371681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m20:56:28.373684 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m20:56:28.373991 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m20:56:28.374274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:28.375610 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:28.376082 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m20:56:28.376628 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:56:28.381577 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:56:28.383348 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m20:56:28.384067 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m20:56:28.384445 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m20:56:28.386172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E20C6D0>]}
[0m20:56:28.386890 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:28.387291 [debug] [MainThread]: On master: BEGIN
[0m20:56:28.387649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:28.388405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:56:28.388735 [debug] [MainThread]: On master: COMMIT
[0m20:56:28.389044 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:28.389324 [debug] [MainThread]: On master: COMMIT
[0m20:56:28.389817 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:28.390187 [debug] [MainThread]: On master: Close
[0m20:56:28.395469 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.396118 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.model_stg_campaign_interactions ............ [RUN]
[0m20:56:28.397229 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m20:56:28.397823 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.404523 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.406220 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.451397 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.453742 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.454447 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m20:56:28.455344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:56:28.456523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.457008 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.457365 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m20:56:28.458443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.465828 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.466331 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m20:56:28.467981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.471411 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.471868 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m20:56:28.472618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.486668 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m20:56:28.487292 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.487608 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m20:56:28.492924 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:56:28.498088 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:56:28.498486 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m20:56:28.501775 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.504436 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m20:56:28.507262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E268290>]}
[0m20:56:28.508068 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.model_stg_campaign_interactions ....... [[32mOK[0m in 0.11s]
[0m20:56:28.510215 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m20:56:28.510941 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.512050 [info ] [Thread-1 (]: 2 of 8 START sql view model staging.model_stg_campaign_master .................. [RUN]
[0m20:56:28.513209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m20:56:28.513831 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.517070 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.518171 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.523236 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.525065 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.526199 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m20:56:28.526737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.528285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.529028 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.529557 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m20:56:28.531697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.537109 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.537680 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m20:56:28.538789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.541759 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.542098 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m20:56:28.542751 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.545076 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m20:56:28.546508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.547524 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m20:56:28.552336 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.555371 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:56:28.555766 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m20:56:28.559157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.561210 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m20:56:28.562177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E280050>]}
[0m20:56:28.564525 [info ] [Thread-1 (]: 2 of 8 OK created sql view model staging.model_stg_campaign_master ............. [[32mOK[0m in 0.05s]
[0m20:56:28.566614 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m20:56:28.567338 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.567997 [info ] [Thread-1 (]: 3 of 8 START sql view model staging.model_stg_customers_master ................. [RUN]
[0m20:56:28.569066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m20:56:28.569548 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.572792 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.574126 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.579339 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.581591 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.582254 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m20:56:28.582714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.583603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.584095 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.584507 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m20:56:28.585552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.590041 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.590644 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m20:56:28.591585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.598016 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.599314 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m20:56:28.600779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.602388 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m20:56:28.602767 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.603101 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m20:56:28.606838 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.609342 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:56:28.609692 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m20:56:28.613246 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.616069 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m20:56:28.616785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E24D590>]}
[0m20:56:28.617498 [info ] [Thread-1 (]: 3 of 8 OK created sql view model staging.model_stg_customers_master ............ [[32mOK[0m in 0.05s]
[0m20:56:28.619486 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m20:56:28.620086 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.620623 [info ] [Thread-1 (]: 4 of 8 START sql view model staging.model_stg_order_transactions ............... [RUN]
[0m20:56:28.621697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m20:56:28.622259 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.625314 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.626295 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.632306 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.633614 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.634217 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m20:56:28.634731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.635529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.635939 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.636293 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m20:56:28.637249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.641341 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.641805 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m20:56:28.642631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.648619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.649204 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m20:56:28.650169 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.652026 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m20:56:28.652695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.653270 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m20:56:28.656868 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.659383 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:56:28.659922 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m20:56:28.664144 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.669833 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m20:56:28.670838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E09A150>]}
[0m20:56:28.671609 [info ] [Thread-1 (]: 4 of 8 OK created sql view model staging.model_stg_order_transactions .......... [[32mOK[0m in 0.05s]
[0m20:56:28.673065 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m20:56:28.674659 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.675334 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.model_int_campaign_conversions ........ [RUN]
[0m20:56:28.676595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_conversions)
[0m20:56:28.677281 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.683424 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.685232 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.688284 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.689385 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.690087 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m20:56:28.690716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.691559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.691981 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.692375 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m20:56:28.694093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.764871 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.765463 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m20:56:28.766575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.769841 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.770251 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m20:56:28.770975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.772536 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m20:56:28.773135 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.773543 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m20:56:28.778898 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:56:28.781525 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:56:28.781988 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m20:56:28.785778 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.787455 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m20:56:28.788023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E23BD90>]}
[0m20:56:28.788752 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.model_int_campaign_conversions ... [[32mOK[0m in 0.11s]
[0m20:56:28.790668 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m20:56:28.792224 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.792857 [info ] [Thread-1 (]: 6 of 8 START sql view model intermediate.model_int_new_customer_converted ...... [RUN]
[0m20:56:28.794043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_new_customer_converted)
[0m20:56:28.794652 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.797676 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.798660 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.801736 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.802695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.803204 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m20:56:28.803651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.804472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.804987 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.805681 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m20:56:28.808862 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.814803 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.815877 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m20:56:28.817290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.820531 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.821027 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m20:56:28.821966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.823426 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m20:56:28.823792 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.824086 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m20:56:28.828372 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.832481 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:56:28.832994 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m20:56:28.837265 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:28.839358 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m20:56:28.839982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594B5FA9F0>]}
[0m20:56:28.840719 [info ] [Thread-1 (]: 6 of 8 OK created sql view model intermediate.model_int_new_customer_converted . [[32mOK[0m in 0.05s]
[0m20:56:28.842692 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m20:56:28.844108 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.844948 [info ] [Thread-1 (]: 7 of 8 START sql table model mart.model_mart_campaign_performance .............. [RUN]
[0m20:56:28.846286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m20:56:28.847268 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.852426 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.854249 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.885225 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.887618 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.888431 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m20:56:28.888896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.889689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.890065 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.890500 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select 
    campaign_id,
    date,
    count(distinct customer_id) as new_customers
  from "ae_exam_db"."intermediate"."model_int_new_customer_converted"
  group by campaign_id,date
),
final as (
  select
    cn.campaign_name,
    i.date,
    coalesce(i.impressions,0) as impressions,
    coalesce(cl.clicks,0) as clicks,
    coalesce(cv.conversions,0) as conversions,
    coalesce(ROUND(cv.total_revenue,2),0) as total_revenue,
    coalesce(ROUND(co.total_cost,2),0) as total_cost,
    coalesce(ROUND((co.total_cost / ncc.new_customers),2),0) as cac,
    coalesce(ROUND((cv.total_revenue/co.total_cost)*100,2),0) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m20:56:28.954364 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m20:56:28.957563 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.957988 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m20:56:28.959314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:28.963379 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.963779 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m20:56:28.964545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:28.969325 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m20:56:28.969696 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.970008 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m20:56:28.975955 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:56:28.978654 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:56:28.979097 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m20:56:28.982720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:56:28.984362 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m20:56:28.984930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594D9F9610>]}
[0m20:56:28.985505 [info ] [Thread-1 (]: 7 of 8 OK created sql table model mart.model_mart_campaign_performance ......... [[32mOK[0m in 0.14s]
[0m20:56:28.987630 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m20:56:28.988814 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:28.989448 [info ] [Thread-1 (]: 8 of 8 START sql table model report.report_campaign_effectiveness .............. [RUN]
[0m20:56:28.990468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m20:56:28.990969 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:28.996220 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:28.998201 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:29.002287 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.003633 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.004235 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m20:56:29.004709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:29.005475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:29.005898 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.006290 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m20:56:29.015138 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:56:29.018777 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.019500 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m20:56:29.020265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:56:29.024304 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.024834 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m20:56:29.026020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:29.028448 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m20:56:29.029224 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.030499 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m20:56:29.035827 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:29.039588 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:56:29.040215 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m20:56:29.045267 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:56:29.049842 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m20:56:29.050690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc464780-df03-4eca-abce-caf959451afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594D9F9E50>]}
[0m20:56:29.051409 [info ] [Thread-1 (]: 8 of 8 OK created sql table model report.report_campaign_effectiveness ......... [[32mOK[0m in 0.06s]
[0m20:56:29.052954 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m20:56:29.055113 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:29.055516 [debug] [MainThread]: On master: BEGIN
[0m20:56:29.055946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:29.056785 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:56:29.057190 [debug] [MainThread]: On master: COMMIT
[0m20:56:29.057552 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:29.057951 [debug] [MainThread]: On master: COMMIT
[0m20:56:29.058602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:29.059059 [debug] [MainThread]: On master: Close
[0m20:56:29.059538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:29.059833 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m20:56:29.060125 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m20:56:29.060398 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m20:56:29.061165 [info ] [MainThread]: 
[0m20:56:29.062348 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m20:56:29.066378 [debug] [MainThread]: Command end result
[0m20:56:29.104666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m20:56:29.110948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m20:56:29.126402 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m20:56:29.127351 [info ] [MainThread]: 
[0m20:56:29.129001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:29.130410 [info ] [MainThread]: 
[0m20:56:29.132658 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:56:29.134650 [debug] [MainThread]: Command `dbt run` succeeded at 20:56:29.134400 after 2.31 seconds
[0m20:56:29.135339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BCF2B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594B5F82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594E28BEF0>]}
[0m20:56:29.135867 [debug] [MainThread]: Flushing usage events
[0m20:56:32.149121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:50:03.686722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5907A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A007890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A1F7ED0>]}


============================== 22:50:03.693191 | e8c7a721-6bb2-4e27-ac92-ec34e766f4cc ==============================
[0m22:50:03.693191 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:50:03.694316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:50:04.003644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC597310F0>]}
[0m22:50:04.075126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A0B7AC0>]}
[0m22:50:04.111089 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:50:04.535468 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:50:04.679444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:50:04.679910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:50:04.722177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A2CB250>]}
[0m22:50:04.794899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m22:50:04.818844 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m22:50:04.872429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A02F4D0>]}
[0m22:50:04.873345 [info ] [MainThread]: Found 10 models, 4 sources, 429 macros
[0m22:50:04.874038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5B86CC90>]}
[0m22:50:04.877436 [info ] [MainThread]: 
[0m22:50:04.878222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:50:04.878856 [info ] [MainThread]: 
[0m22:50:04.879688 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:50:04.889741 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m22:50:10.343792 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:50:10.344248 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:50:10.344564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:10.394055 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m22:50:10.397570 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:50:10.399800 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:50:10.400165 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:50:10.400460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.401669 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.403193 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:50:10.405158 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:50:10.405526 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:50:10.405829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.406898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.408133 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:50:10.410283 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m22:50:10.410598 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m22:50:10.410880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.411926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.413257 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m22:50:10.414809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m22:50:10.415670 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m22:50:10.426376 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m22:50:10.426745 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:50:10.427009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.427891 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.429193 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m22:50:10.429605 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m22:50:10.430091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.430471 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m22:50:10.430855 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m22:50:10.433304 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:50:10.434351 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m22:50:10.434774 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m22:50:10.435103 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m22:50:10.435621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.436000 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m22:50:10.436600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_report)
[0m22:50:10.437052 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m22:50:10.438628 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m22:50:10.438970 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:50:10.439274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.440354 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.441721 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m22:50:10.441992 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m22:50:10.442457 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.442735 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m22:50:10.443048 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m22:50:10.443578 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.444629 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m22:50:10.445084 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m22:50:10.445400 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m22:50:10.445893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.446211 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m22:50:10.446828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m22:50:10.447396 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m22:50:10.449536 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m22:50:10.449858 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:50:10.450127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.451139 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.452634 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m22:50:10.452995 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m22:50:10.453471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.453755 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m22:50:10.454094 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m22:50:10.454658 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.455685 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m22:50:10.456034 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m22:50:10.456312 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m22:50:10.456761 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.457037 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m22:50:10.457552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m22:50:10.457983 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m22:50:10.459493 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:50:10.459796 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m22:50:10.460076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.460960 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.462276 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:50:10.462578 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m22:50:10.463054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.463325 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:50:10.463681 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m22:50:10.464351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.465490 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m22:50:10.466134 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m22:50:10.466639 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m22:50:10.467166 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:10.467505 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m22:50:10.470434 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m22:50:10.475816 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m22:50:10.476281 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m22:50:10.476655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:10.477605 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.478030 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m22:50:10.478342 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:50:10.498436 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m22:50:10.501098 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m22:50:10.529837 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m22:50:10.530337 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m22:50:10.531044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m22:50:10.532763 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m22:50:10.533104 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m22:50:10.533391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.534674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.535196 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m22:50:10.535513 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:50:10.539533 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:50:10.540968 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m22:50:10.541570 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m22:50:10.541845 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m22:50:10.542305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m22:50:10.543875 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m22:50:10.544180 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m22:50:10.544443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.545489 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.545901 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m22:50:10.546334 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:50:10.550520 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:50:10.551919 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m22:50:10.552485 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m22:50:10.552760 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m22:50:10.553233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m22:50:10.555221 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m22:50:10.555532 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m22:50:10.555784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:10.556985 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:10.557548 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m22:50:10.558100 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m22:50:10.562303 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:50:10.563888 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m22:50:10.564666 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m22:50:10.565043 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m22:50:10.568325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BC68460>]}
[0m22:50:10.568894 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:10.569237 [debug] [MainThread]: On master: BEGIN
[0m22:50:10.569505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:50:10.570088 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:50:10.570401 [debug] [MainThread]: On master: COMMIT
[0m22:50:10.570667 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:10.570922 [debug] [MainThread]: On master: COMMIT
[0m22:50:10.571396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:50:10.571697 [debug] [MainThread]: On master: Close
[0m22:50:10.576430 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m22:50:10.577018 [info ] [Thread-1 (]: 1 of 10 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m22:50:10.578796 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m22:50:10.579367 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m22:50:10.586458 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.588276 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m22:50:10.632040 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.633966 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.634585 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m22:50:10.635058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:10.635913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.636309 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.636681 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m22:50:10.638702 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:10.646071 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.646864 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m22:50:10.649769 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:10.653267 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.653687 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m22:50:10.654442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.668555 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m22:50:10.669080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.669451 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m22:50:10.675096 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:50:10.681281 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m22:50:10.681769 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m22:50:10.686017 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:50:10.688514 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m22:50:10.691551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BCBC350>]}
[0m22:50:10.692367 [info ] [Thread-1 (]: 1 of 10 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.11s]
[0m22:50:10.693791 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m22:50:10.694288 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m22:50:10.694886 [info ] [Thread-1 (]: 2 of 10 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m22:50:10.696189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m22:50:10.696772 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m22:50:10.699669 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.700764 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m22:50:10.706042 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.707967 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.709145 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m22:50:10.710284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:10.712386 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:10.713400 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.714206 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m22:50:10.717334 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:10.721056 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.721496 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m22:50:10.722321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.725848 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.726275 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m22:50:10.726990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.728768 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m22:50:10.729113 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.729422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m22:50:10.733733 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:50:10.736469 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m22:50:10.737081 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m22:50:10.740857 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:10.742822 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m22:50:10.743469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BCDC050>]}
[0m22:50:10.744158 [info ] [Thread-1 (]: 2 of 10 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m22:50:10.745215 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m22:50:10.745888 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m22:50:10.746688 [info ] [Thread-1 (]: 3 of 10 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m22:50:10.748408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m22:50:10.750042 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m22:50:10.754198 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.755524 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m22:50:10.759095 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.761060 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.761814 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m22:50:10.762330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:10.763084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.764036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.764887 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m22:50:10.766714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.770680 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.771714 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m22:50:10.773564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.776478 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.776827 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m22:50:10.777483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.778955 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m22:50:10.779320 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.779625 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m22:50:10.783596 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:10.787291 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m22:50:10.787807 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m22:50:10.791004 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:10.792473 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m22:50:10.792987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BCA1810>]}
[0m22:50:10.794036 [info ] [Thread-1 (]: 3 of 10 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m22:50:10.795482 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m22:50:10.796001 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m22:50:10.796974 [info ] [Thread-1 (]: 4 of 10 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m22:50:10.798798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_transactions)
[0m22:50:10.799582 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m22:50:10.802404 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.803382 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m22:50:10.806512 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.807544 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.808141 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m22:50:10.808752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:10.809877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.810416 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.810787 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m22:50:10.811823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.816971 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.817633 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m22:50:10.818698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.823779 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.824416 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m22:50:10.825319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.826869 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m22:50:10.827217 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.827523 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m22:50:10.831555 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:10.835861 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m22:50:10.836383 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m22:50:10.839744 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:10.843639 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m22:50:10.844244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BB3E550>]}
[0m22:50:10.844887 [info ] [Thread-1 (]: 4 of 10 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.05s]
[0m22:50:10.847561 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m22:50:10.848902 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_first_campaign_touch
[0m22:50:10.849768 [info ] [Thread-1 (]: 5 of 10 START sql view model intermediate.model_int_first_campaign_touch ....... [RUN]
[0m22:50:10.851120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_first_campaign_touch)
[0m22:50:10.851682 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_first_campaign_touch
[0m22:50:10.855670 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m22:50:10.858787 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_first_campaign_touch
[0m22:50:10.862612 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m22:50:10.865334 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m22:50:10.866367 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: BEGIN
[0m22:50:10.866937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:10.867881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.868424 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m22:50:10.868954 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */

  
  create view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" as (
    with first_interaction as (
  select
    customer_id,
    campaign_id,
    min(interaction_datetime) as first_interaction_time
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type in ('click', 'impression') and is_new_customer = TRUE
  group by customer_id, campaign_id
)

select * from first_interaction
  );

[0m22:50:10.873263 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:50:10.939501 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m22:50:10.940059 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" rename to "model_int_first_campaign_touch"
[0m22:50:10.940994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.942524 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m22:50:10.943031 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m22:50:10.943710 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m22:50:10.947970 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:50:10.950070 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m22:50:10.950399 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_backup" cascade
[0m22:50:10.951025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:10.952427 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: Close
[0m22:50:10.952938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BC96970>]}
[0m22:50:10.953478 [info ] [Thread-1 (]: 5 of 10 OK created sql view model intermediate.model_int_first_campaign_touch .. [[32mOK[0m in 0.10s]
[0m22:50:10.955209 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_first_campaign_touch
[0m22:50:10.955697 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m22:50:10.956202 [info ] [Thread-1 (]: 6 of 10 START sql view model intermediate.model_int_campaign_conversions ....... [RUN]
[0m22:50:10.957251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_first_campaign_touch, now model.ae_exam_project.model_int_campaign_conversions)
[0m22:50:10.957885 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m22:50:10.960522 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.961558 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m22:50:10.965432 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.966625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.967152 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m22:50:10.968120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:10.969602 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:10.970170 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.970665 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.order_datetime,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m22:50:10.973053 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:10.978116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.978871 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m22:50:10.980459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.986451 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.986966 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m22:50:10.988025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:10.989705 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m22:50:10.990193 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.990590 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m22:50:10.994496 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:10.997408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m22:50:10.998789 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m22:50:11.003173 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:11.005433 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m22:50:11.006734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BC5A8D0>]}
[0m22:50:11.007925 [info ] [Thread-1 (]: 6 of 10 OK created sql view model intermediate.model_int_campaign_conversions .. [[32mOK[0m in 0.05s]
[0m22:50:11.009737 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m22:50:11.011042 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m22:50:11.011712 [info ] [Thread-1 (]: 7 of 10 START sql view model intermediate.model_int_new_customer_converted ..... [RUN]
[0m22:50:11.012846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_new_customer_converted)
[0m22:50:11.013845 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m22:50:11.019828 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.021456 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m22:50:11.025810 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.026927 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.027452 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m22:50:11.027987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:11.028843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:11.029343 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.030415 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m22:50:11.034384 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:11.039913 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.040719 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m22:50:11.041765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:11.044854 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.045377 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m22:50:11.046831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:11.049497 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m22:50:11.050142 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.050592 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m22:50:11.054588 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:11.058608 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m22:50:11.059034 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m22:50:11.062444 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:11.065594 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m22:50:11.066910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC58F8A630>]}
[0m22:50:11.068448 [info ] [Thread-1 (]: 7 of 10 OK created sql view model intermediate.model_int_new_customer_converted  [[32mOK[0m in 0.05s]
[0m22:50:11.069952 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m22:50:11.071261 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m22:50:11.071882 [info ] [Thread-1 (]: 8 of 10 START sql table model mart.model_mart_campaign_performance ............. [RUN]
[0m22:50:11.072851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m22:50:11.073388 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m22:50:11.078154 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.079388 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m22:50:11.109769 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.111622 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.112321 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m22:50:11.112882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:11.114566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:11.115278 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.115882 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with impression as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as impressions
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'impression'
  group by campaign_id, date(interaction_datetime)
),
click as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(*) as clicks
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'click'
  group by campaign_id, date(interaction_datetime)
),
conversions as (
  select
    campaign_id,
    date(interaction_datetime) as date,
    count(order_id) as conversions,
    sum(total_amount) as total_revenue
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions"
  group by campaign_id, date(interaction_datetime)
),
costs as (
  select 
    campaign_id, 
    date(interaction_datetime) as date,
    sum(ad_cost) as total_cost
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  group by campaign_id, date(interaction_datetime)
),
campaign_name as (
  select 
    campaign_id, 
    campaign_name
  from "ae_exam_db"."staging"."model_stg_campaign_master"
),
new_customers_converted as (
  select 
    campaign_id,
    date,
    count(distinct customer_id) as new_customers
  from "ae_exam_db"."intermediate"."model_int_new_customer_converted"
  group by campaign_id,date
),
final as (
  select
    cn.campaign_name,
    i.date,
    coalesce(i.impressions,0) as impressions,
    coalesce(cl.clicks,0) as clicks,
    coalesce(cv.conversions,0) as conversions,
    coalesce(ROUND(cv.total_revenue,2),0) as total_revenue,
    coalesce(ROUND(co.total_cost,2),0) as total_cost,
    coalesce(ROUND((co.total_cost / ncc.new_customers),2),0) as cac,
    coalesce(ROUND((cv.total_revenue/co.total_cost)*100,2),0) as roas_percentage
  from impression i
  left join click cl on i.campaign_id = cl.campaign_id and i.date = cl.date
  left join conversions cv on i.campaign_id = cv.campaign_id and i.date = cv.date
  left join costs co on i.campaign_id = co.campaign_id and i.date = co.date
  left join campaign_name cn on i.campaign_id = cn.campaign_id
  left join new_customers_converted ncc on i.campaign_id = ncc.campaign_id and i.date = ncc.date
)
select * from final
    );
  
  
[0m22:50:11.208999 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m22:50:11.213394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.214164 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m22:50:11.217022 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:11.221089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.221625 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m22:50:11.222595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:11.228462 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m22:50:11.228906 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.229274 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m22:50:11.235519 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:50:11.239959 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m22:50:11.240828 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m22:50:11.244434 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:11.245971 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m22:50:11.246729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A478950>]}
[0m22:50:11.247733 [info ] [Thread-1 (]: 8 of 10 OK created sql table model mart.model_mart_campaign_performance ........ [[32mOK[0m in 0.17s]
[0m22:50:11.249126 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m22:50:11.249853 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m22:50:11.251203 [info ] [Thread-1 (]: 9 of 10 START sql Table model mart.model_mart_customer_acquisition ............. [RUN]
[0m22:50:11.253283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m22:50:11.254062 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m22:50:11.258926 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m22:50:11.260835 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m22:50:11.307931 [debug] [Thread-1 (]: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m22:50:11.309012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5BC582F0>]}
[0m22:50:11.310073 [error] [Thread-1 (]: 9 of 10 ERROR creating sql Table model mart.model_mart_customer_acquisition .... [[31mERROR[0m in 0.06s]
[0m22:50:11.312053 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m22:50:11.313516 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_customer_acquisition' to be skipped because of status 'error'.  Reason: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb').
[0m22:50:11.314051 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m22:50:11.316783 [info ] [Thread-1 (]: 10 of 10 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m22:50:11.318369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.report_campaign_effectiveness)
[0m22:50:11.320218 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m22:50:11.324890 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.326273 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m22:50:11.329392 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.331347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.332042 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m22:50:11.332591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:11.333547 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:11.334041 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.334565 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m22:50:11.341290 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:50:11.347271 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.348202 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m22:50:11.349709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:11.355021 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.356022 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m22:50:11.357273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:11.359654 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m22:50:11.360256 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.360761 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m22:50:11.366233 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:50:11.370892 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m22:50:11.371504 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m22:50:11.375433 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:11.377533 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m22:50:11.378112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c7a721-6bb2-4e27-ac92-ec34e766f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A4797F0>]}
[0m22:50:11.378737 [info ] [Thread-1 (]: 10 of 10 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.06s]
[0m22:50:11.380971 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m22:50:11.383691 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:11.384585 [debug] [MainThread]: On master: BEGIN
[0m22:50:11.385011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:50:11.385717 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:50:11.386054 [debug] [MainThread]: On master: COMMIT
[0m22:50:11.386371 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:11.386672 [debug] [MainThread]: On master: COMMIT
[0m22:50:11.387156 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:50:11.387466 [debug] [MainThread]: On master: Close
[0m22:50:11.387904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:11.388200 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m22:50:11.388443 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m22:50:11.388666 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m22:50:11.389001 [info ] [MainThread]: 
[0m22:50:11.389783 [info ] [MainThread]: Finished running 1 Table model, 2 table models, 7 view models in 0 hours 0 minutes and 6.51 seconds (6.51s).
[0m22:50:11.393028 [debug] [MainThread]: Command end result
[0m22:50:11.424921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m22:50:11.428779 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m22:50:11.441563 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m22:50:11.442383 [info ] [MainThread]: 
[0m22:50:11.443917 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:50:11.445275 [info ] [MainThread]: 
[0m22:50:11.446230 [error] [MainThread]:   Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m22:50:11.448127 [info ] [MainThread]: 
[0m22:50:11.449329 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m22:50:11.451332 [debug] [MainThread]: Command `dbt run` failed at 22:50:11.451022 after 8.00 seconds
[0m22:50:11.451858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5B8C48F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC57C25370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5A47BEF0>]}
[0m22:50:11.452280 [debug] [MainThread]: Flushing usage events
[0m22:50:14.879141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:06.563383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E685A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E77E7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E79DBED0>]}


============================== 11:44:06.570638 | 99826c2e-6d9b-422e-a63c-ed649826bbc9 ==============================
[0m11:44:06.570638 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:44:06.571839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:06.876918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99826c2e-6d9b-422e-a63c-ed649826bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E6F110F0>]}
[0m11:44:06.950797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99826c2e-6d9b-422e-a63c-ed649826bbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E7897AC0>]}
[0m11:44:06.955439 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:44:07.168146 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:44:07.311146 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m11:44:07.311758 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\mart\model_mart_capaign_performance_v2.sql
[0m11:44:07.312233 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\mart\model_mart_campaign_performance.sql
[0m11:44:07.521293 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.model_mart_campaign_performance' (models\mart\model_mart_campaign_performance.sql) depends on a node named 'int_campaign_customer_orders' which was not found
[0m11:44:07.523644 [debug] [MainThread]: Command `dbt run` failed at 11:44:07.523231 after 1.31 seconds
[0m11:44:07.524259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E7AAA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E7AAB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173E8FC9220>]}
[0m11:44:07.524792 [debug] [MainThread]: Flushing usage events
[0m11:44:09.071557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:39.145297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CADDA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CBD67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CBF57ED0>]}


============================== 11:44:39.149889 | c551e51f-6361-4a1f-9f6b-b8e4eca23774 ==============================
[0m11:44:39.149889 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:44:39.152152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:39.380287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c551e51f-6361-4a1f-9f6b-b8e4eca23774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CB4910F0>]}
[0m11:44:39.453822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c551e51f-6361-4a1f-9f6b-b8e4eca23774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CBE17AC0>]}
[0m11:44:39.457777 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:44:39.666064 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:44:39.807169 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m11:44:39.807666 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\mart\model_mart_capaign_performance_v2.sql
[0m11:44:39.808294 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\mart\model_mart_campaign_performance.sql
[0m11:44:40.017255 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.model_mart_campaign_performance' (models\mart\model_mart_campaign_performance.sql) depends on a node named 'int_campaign_customer_orders' which was not found
[0m11:44:40.019545 [debug] [MainThread]: Command `dbt run` failed at 11:44:40.019349 after 1.09 seconds
[0m11:44:40.020010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CC02A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CC02B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105CD569220>]}
[0m11:44:40.020408 [debug] [MainThread]: Flushing usage events
[0m11:44:41.012071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:57.667281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1456A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F154E7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F156D7ED0>]}


============================== 11:45:57.672136 | 9df08156-9f91-46f7-8e83-6aab4481c0c4 ==============================
[0m11:45:57.672136 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:45:57.673667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:45:57.902203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F14C110F0>]}
[0m11:45:57.970868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F15593AC0>]}
[0m11:45:57.975050 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:45:58.188439 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:45:58.316374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:58.316787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:58.353757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F157AB450>]}
[0m11:45:58.444605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m11:45:58.462037 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m11:45:58.515808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1550F4D0>]}
[0m11:45:58.516522 [info ] [MainThread]: Found 12 models, 5 sources, 429 macros
[0m11:45:58.517835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F16CB8E50>]}
[0m11:45:58.521529 [info ] [MainThread]: 
[0m11:45:58.522546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:58.523670 [info ] [MainThread]: 
[0m11:45:58.525061 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:45:58.532966 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m11:45:58.642461 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:45:58.642899 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:45:58.643198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:58.768397 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m11:45:58.770905 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:45:58.772927 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:45:58.773288 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:45:58.773662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.775007 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.776500 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:45:58.778593 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:45:58.779074 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:45:58.779486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.780682 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.781994 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:45:58.784284 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:45:58.784645 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:45:58.784966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.786042 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.787321 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:45:58.788968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m11:45:58.789835 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m11:45:58.799914 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:45:58.800472 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:45:58.800842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.802054 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.803580 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:45:58.803901 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m11:45:58.804372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.804648 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:45:58.804916 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m11:45:58.806426 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.807557 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m11:45:58.807966 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:45:58.808420 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m11:45:58.809046 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.809495 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m11:45:58.810170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_report)
[0m11:45:58.810691 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m11:45:58.812388 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:45:58.812715 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:45:58.812981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.813932 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.815312 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:45:58.815606 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m11:45:58.816053 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.816331 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:45:58.816581 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m11:45:58.817176 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.818423 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m11:45:58.818916 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:45:58.819336 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m11:45:58.819982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.820325 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m11:45:58.820933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_mart)
[0m11:45:58.821417 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m11:45:58.823543 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:45:58.824005 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:45:58.824383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.825495 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.826978 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:45:58.827264 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m11:45:58.827724 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.828038 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:45:58.828773 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m11:45:58.829854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.831501 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m11:45:58.831942 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:45:58.832316 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m11:45:58.833002 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.833415 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m11:45:58.834115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m11:45:58.834684 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m11:45:58.836539 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:45:58.836952 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:45:58.837313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.838488 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.841527 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:45:58.842233 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m11:45:58.843359 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.844129 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:45:58.844685 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m11:45:58.845541 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.846844 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m11:45:58.847472 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:45:58.847871 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m11:45:58.848522 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:58.849105 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m11:45:58.852788 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m11:45:58.862814 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m11:45:58.863260 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m11:45:58.863549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:58.864181 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.864513 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m11:45:58.864835 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:45:58.886497 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m11:45:58.888661 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m11:45:58.891148 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m11:45:58.891592 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m11:45:58.892190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m11:45:58.893880 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m11:45:58.894203 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m11:45:58.894487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.896008 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.896385 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m11:45:58.896699 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:45:58.901079 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:45:58.902625 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m11:45:58.903237 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m11:45:58.903531 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m11:45:58.903999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m11:45:58.905621 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m11:45:58.905929 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m11:45:58.906240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.907690 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.908090 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m11:45:58.908413 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:45:58.913044 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:45:58.914472 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m11:45:58.915046 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m11:45:58.915320 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m11:45:58.915791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m11:45:58.917807 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m11:45:58.918109 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m11:45:58.918371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:58.919434 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:58.920031 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m11:45:58.920416 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:45:58.924828 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:45:58.926399 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m11:45:58.926990 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m11:45:58.927272 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m11:45:58.929662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F170B8EF0>]}
[0m11:45:58.930539 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:58.931280 [debug] [MainThread]: On master: BEGIN
[0m11:45:58.931724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:58.932403 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:45:58.932726 [debug] [MainThread]: On master: COMMIT
[0m11:45:58.933039 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:58.933338 [debug] [MainThread]: On master: COMMIT
[0m11:45:58.933855 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:45:58.934168 [debug] [MainThread]: On master: Close
[0m11:45:58.938006 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m11:45:58.938666 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m11:45:58.940306 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m11:45:58.941352 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m11:45:58.950742 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:58.954923 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m11:45:58.999694 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:59.003094 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:59.003910 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m11:45:59.004362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:45:59.005088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.005492 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:59.005870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m11:45:59.007487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.015252 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:59.015686 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m11:45:59.017504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.020086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:59.020425 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m11:45:59.021099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:45:59.034348 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m11:45:59.034922 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:59.035499 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m11:45:59.040751 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:45:59.047037 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:45:59.047478 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m11:45:59.051909 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.054427 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m11:45:59.058520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F17110410>]}
[0m11:45:59.059511 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.12s]
[0m11:45:59.061061 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m11:45:59.061654 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m11:45:59.062342 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m11:45:59.063779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m11:45:59.064234 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m11:45:59.068862 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.070863 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m11:45:59.079205 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.081910 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.083050 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m11:45:59.083691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.084972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.085550 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.085909 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m11:45:59.087232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.092009 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.093831 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m11:45:59.095614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.100523 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.101428 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m11:45:59.102707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.105241 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m11:45:59.105891 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.106675 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m11:45:59.111816 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.114148 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:45:59.114520 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m11:45:59.118348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.119988 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m11:45:59.120501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F17128050>]}
[0m11:45:59.121062 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.06s]
[0m11:45:59.122482 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m11:45:59.123095 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m11:45:59.124148 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m11:45:59.125885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m11:45:59.126772 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m11:45:59.129907 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.131491 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m11:45:59.135705 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.137819 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.138433 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m11:45:59.138876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.139712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.140244 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.140712 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m11:45:59.143001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.150271 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.152062 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m11:45:59.153961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.160008 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.161261 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m11:45:59.162310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.163961 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m11:45:59.164472 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.164940 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m11:45:59.169085 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.171669 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:45:59.172016 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m11:45:59.175467 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.178903 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m11:45:59.180119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F17100CD0>]}
[0m11:45:59.181606 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m11:45:59.183670 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m11:45:59.185040 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:45:59.186365 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m11:45:59.187444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m11:45:59.187998 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:45:59.193246 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.196650 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:45:59.200253 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.201795 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.202515 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m11:45:59.203021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.203810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.204229 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.204589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m11:45:59.205466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.211379 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.212597 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.214023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.216698 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m11:45:59.217676 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.219304 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m11:45:59.224111 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.229138 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:45:59.230079 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m11:45:59.231390 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.235029 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m11:45:59.236203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1713ACD0>]}
[0m11:45:59.237033 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m11:45:59.238440 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:45:59.239049 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m11:45:59.239629 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m11:45:59.240705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m11:45:59.241612 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m11:45:59.247190 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.248862 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m11:45:59.256193 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.258398 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.259259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m11:45:59.259878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.261726 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:45:59.262684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.263349 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m11:45:59.265477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.272078 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.272746 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m11:45:59.274793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.347043 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.347563 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m11:45:59.348451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:45:59.350382 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m11:45:59.351113 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.351778 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m11:45:59.356293 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.358903 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:45:59.359308 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m11:45:59.362891 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.364506 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m11:45:59.365019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F17131DA0>]}
[0m11:45:59.365567 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.12s]
[0m11:45:59.367305 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m11:45:59.367794 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_first_campaign_touch
[0m11:45:59.368320 [info ] [Thread-1 (]: 6 of 12 START sql view model intermediate.model_int_first_campaign_touch ....... [RUN]
[0m11:45:59.369723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_first_campaign_touch)
[0m11:45:59.370194 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_first_campaign_touch
[0m11:45:59.375023 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.377493 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_first_campaign_touch
[0m11:45:59.385856 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.388998 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.390316 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: BEGIN
[0m11:45:59.390933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.392155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.392873 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.393960 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */

  
  create view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" as (
    with first_interaction as (
  select
    customer_id,
    campaign_id,
    min(interaction_datetime) as first_interaction_time
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type in ('click', 'impression') and is_new_customer = TRUE
  group by customer_id, campaign_id
)

select * from first_interaction
  );

[0m11:45:59.397472 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.400373 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.400739 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch" rename to "model_int_first_campaign_touch__dbt_backup"
[0m11:45:59.401419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:45:59.406427 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.407099 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" rename to "model_int_first_campaign_touch"
[0m11:45:59.408648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.411928 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m11:45:59.412654 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.413650 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m11:45:59.418762 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.422583 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:45:59.423922 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_backup" cascade
[0m11:45:59.428579 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.431030 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: Close
[0m11:45:59.431786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F15910650>]}
[0m11:45:59.432559 [info ] [Thread-1 (]: 6 of 12 OK created sql view model intermediate.model_int_first_campaign_touch .. [[32mOK[0m in 0.06s]
[0m11:45:59.434107 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_first_campaign_touch
[0m11:45:59.434807 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m11:45:59.435564 [info ] [Thread-1 (]: 7 of 12 START sql view model intermediate.model_int_campaign_conversions ....... [RUN]
[0m11:45:59.436584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_first_campaign_touch, now model.ae_exam_project.model_int_campaign_conversions)
[0m11:45:59.437181 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m11:45:59.441002 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.442765 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m11:45:59.447671 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.449944 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.450860 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m11:45:59.451456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.452439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.453017 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.454100 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select distinct
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select distinct
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.order_datetime,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m11:45:59.459359 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.469583 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.470294 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m11:45:59.471375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.477669 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.478674 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m11:45:59.480182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.482950 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m11:45:59.483977 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.484592 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m11:45:59.488944 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.494700 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:45:59.495398 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m11:45:59.498946 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.500459 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m11:45:59.501493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F14BF9490>]}
[0m11:45:59.502652 [info ] [Thread-1 (]: 7 of 12 OK created sql view model intermediate.model_int_campaign_conversions .. [[32mOK[0m in 0.06s]
[0m11:45:59.504160 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m11:45:59.504820 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:45:59.505427 [info ] [Thread-1 (]: 8 of 12 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m11:45:59.506815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m11:45:59.507828 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:45:59.513356 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:45:59.514571 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:45:59.518942 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:45:59.520996 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:45:59.521676 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m11:45:59.522109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.522884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.523476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:45:59.524273 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m11:45:59.530111 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.536558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:45:59.537117 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m11:45:59.538092 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:45:59.539842 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m11:45:59.541250 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:45:59.542192 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m11:45:59.546570 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.549312 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:45:59.549798 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m11:45:59.550569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:45:59.552184 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m11:45:59.552763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F15899010>]}
[0m11:45:59.553379 [info ] [Thread-1 (]: 8 of 12 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.05s]
[0m11:45:59.554697 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:45:59.555211 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m11:45:59.555804 [info ] [Thread-1 (]: 9 of 12 START sql Table model mart.model_mart_customer_acquisition ............. [RUN]
[0m11:45:59.557049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_mart_customer_acquisition)
[0m11:45:59.558183 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m11:45:59.568948 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m11:45:59.571274 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m11:45:59.580399 [debug] [Thread-1 (]: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m11:45:59.582390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F170BD370>]}
[0m11:45:59.584523 [error] [Thread-1 (]: 9 of 12 ERROR creating sql Table model mart.model_mart_customer_acquisition .... [[31mERROR[0m in 0.03s]
[0m11:45:59.586911 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m11:45:59.587768 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m11:45:59.590077 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_customer_acquisition' to be skipped because of status 'error'.  Reason: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb').
[0m11:45:59.588725 [info ] [Thread-1 (]: 10 of 12 START sql view model intermediate.model_int_new_customer_converted .... [RUN]
[0m11:45:59.593301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_int_new_customer_converted)
[0m11:45:59.594346 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m11:45:59.602007 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.605279 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m11:45:59.612721 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.615228 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.616004 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m11:45:59.616485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.617364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.617903 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.618662 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select distinct 
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m11:45:59.623882 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:45:59.630719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.631556 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m11:45:59.632845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.639452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.640373 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m11:45:59.641458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.644197 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m11:45:59.645081 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.645552 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m11:45:59.648894 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.651637 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:45:59.652034 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m11:45:59.655620 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:59.658004 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m11:45:59.658844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1709F410>]}
[0m11:45:59.659693 [info ] [Thread-1 (]: 10 of 12 OK created sql view model intermediate.model_int_new_customer_converted  [[32mOK[0m in 0.07s]
[0m11:45:59.661038 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m11:45:59.661767 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m11:45:59.662437 [info ] [Thread-1 (]: 11 of 12 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m11:45:59.663611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m11:45:59.664084 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m11:45:59.666994 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m11:45:59.669326 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m11:45:59.708816 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m11:45:59.711812 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:45:59.712680 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m11:45:59.713328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:59.714351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:45:59.714992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:45:59.715772 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(*) filter (where ci.event_type  = 'impression') as impression,
        count(*) filter (where ci.event_type  = 'click') as click,
        count(*) filter (where ci.event_type  = 'conversion' and order_id is not null and order_status = 'completed') as converted_customers,             
        count(distinct order_id)  filter (where order_id is not null and order_status = 'completed')  as total_orders,
        sum(ad_cost) as total_ad_cost,
        sum(revenue) as total_revenue,
        case 
            when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
            else null
        end as roas,
        case 
            when count(distinct customer_id) filter (where order_id is not null) > 0 
                then sum(ad_cost) / count(distinct customer_id) filter (where order_id is not null)
            else null
        end as cac
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m11:45:59.731215 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(*) filter (where ci.event_type  = 'impression') as impression,
        count(*) filter (where ci.event_type  = 'click') as click,
        count(*) filter (where ci.event_type  = 'conversion' and order_id is not null and order_status = 'completed') as converted_customers,             
        count(distinct order_id)  filter (where order_id is not null and order_status = 'completed')  as total_orders,
        sum(ad_cost) as total_ad_cost,
        sum(revenue) as total_revenue,
        case 
            when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
            else null
        end as roas,
        case 
            when count(distinct customer_id) filter (where order_id is not null) > 0 
                then sum(ad_cost) / count(distinct customer_id) filter (where order_id is not null)
            else null
        end as cac
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m11:45:59.732335 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:45:59.733145 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: ROLLBACK
[0m11:45:59.891054 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_campaign_performance'
[0m11:45:59.891853 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m11:45:59.899747 [debug] [Thread-1 (]: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced table "ci" not found!
  Candidate tables: "base"
  
  LINE 32:         count(*) filter (where ci.event_type  = 'impression') as impression,
                                          ^
[0m11:45:59.900470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df08156-9f91-46f7-8e83-6aab4481c0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F17176CF0>]}
[0m11:45:59.901249 [error] [Thread-1 (]: 11 of 12 ERROR creating sql table model mart.model_mart_campaign_performance ... [[31mERROR[0m in 0.24s]
[0m11:45:59.902605 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m11:45:59.903544 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_campaign_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced table "ci" not found!
  Candidate tables: "base"
  
  LINE 32:         count(*) filter (where ci.event_type  = 'impression') as impression,
                                          ^.
[0m11:45:59.904654 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m11:45:59.905985 [info ] [Thread-1 (]: 12 of 12 SKIP relation report.report_campaign_effectiveness .................... [[33mSKIP[0m]
[0m11:45:59.907231 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m11:45:59.909547 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:59.910020 [debug] [MainThread]: On master: BEGIN
[0m11:45:59.910446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:59.911452 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:45:59.912051 [debug] [MainThread]: On master: COMMIT
[0m11:45:59.912603 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:59.913145 [debug] [MainThread]: On master: COMMIT
[0m11:45:59.914036 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:45:59.914616 [debug] [MainThread]: On master: Close
[0m11:45:59.915252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:59.915681 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m11:45:59.916065 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m11:45:59.916432 [debug] [MainThread]: Connection 'model.ae_exam_project.model_mart_campaign_performance' was properly closed.
[0m11:45:59.916999 [info ] [MainThread]: 
[0m11:45:59.918028 [info ] [MainThread]: Finished running 1 Table model, 2 table models, 9 view models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m11:45:59.924347 [debug] [MainThread]: Command end result
[0m11:45:59.976001 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m11:45:59.980243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m11:45:59.994011 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m11:45:59.994857 [info ] [MainThread]: 
[0m11:45:59.995918 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:45:59.996776 [info ] [MainThread]: 
[0m11:45:59.997693 [error] [MainThread]:   Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m11:45:59.998907 [info ] [MainThread]: 
[0m11:46:00.000056 [error] [MainThread]:   Runtime Error in model model_mart_campaign_performance (models\mart\model_mart_campaign_performance.sql)
  Binder Error: Referenced table "ci" not found!
  Candidate tables: "base"
  
  LINE 32:         count(*) filter (where ci.event_type  = 'impression') as impression,
                                          ^
[0m11:46:00.001881 [info ] [MainThread]: 
[0m11:46:00.007208 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=1 TOTAL=12
[0m11:46:00.028335 [debug] [MainThread]: Command `dbt run` failed at 11:46:00.027748 after 2.59 seconds
[0m11:46:00.033086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F170BD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1280F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F171A78F0>]}
[0m11:46:00.034168 [debug] [MainThread]: Flushing usage events
[0m11:46:03.003218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:37.693116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001087FE2A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010800DD7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010800FC7ED0>]}


============================== 11:51:37.698502 | c9ef16bb-2a21-4faa-b3ea-237957a56ab9 ==============================
[0m11:51:37.698502 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:51:37.699824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:37.921482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108005010F0>]}
[0m11:51:37.990694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010800E83AC0>]}
[0m11:51:37.994014 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:51:38.195431 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:51:38.335973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:38.336372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:38.372996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001080109B450>]}
[0m11:51:38.452901 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m11:51:38.455813 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m11:51:38.481970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010800DFF4D0>]}
[0m11:51:38.482739 [info ] [MainThread]: Found 12 models, 5 sources, 429 macros
[0m11:51:38.483676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802638E50>]}
[0m11:51:38.486380 [info ] [MainThread]: 
[0m11:51:38.487958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:38.488846 [info ] [MainThread]: 
[0m11:51:38.490265 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:51:38.502709 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m11:51:38.595559 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:51:38.596120 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:51:38.596612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:38.619261 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:51:38.620792 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:51:38.624336 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:51:38.625091 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:51:38.625567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.627353 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:51:38.629641 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:51:38.633029 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:51:38.633544 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:51:38.633926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.635216 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.636797 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:51:38.640596 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:51:38.641149 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:51:38.641549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.642877 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.644866 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:51:38.647244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m11:51:38.648220 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m11:51:38.655564 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:51:38.656413 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:51:38.657006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.658401 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.659822 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:51:38.660163 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m11:51:38.660728 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.661372 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:51:38.661833 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m11:51:38.662843 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.663898 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m11:51:38.664209 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:51:38.664462 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m11:51:38.664914 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.665187 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m11:51:38.665791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m11:51:38.666504 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m11:51:38.668279 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:51:38.668586 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:51:38.668840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.669680 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.670952 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:51:38.671245 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m11:51:38.671708 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.672077 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:51:38.672427 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m11:51:38.673002 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.673982 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m11:51:38.674281 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:51:38.674527 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m11:51:38.674948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.675236 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m11:51:38.675821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m11:51:38.676870 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m11:51:38.679746 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:51:38.680210 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:51:38.680502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.681386 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.682818 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:51:38.683116 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m11:51:38.683585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.683865 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:51:38.684180 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m11:51:38.684767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.685711 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m11:51:38.686027 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:51:38.686277 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m11:51:38.686851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.687186 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m11:51:38.687775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m11:51:38.688232 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m11:51:38.689749 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:51:38.690073 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:51:38.690379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.691341 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.692630 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:51:38.692910 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m11:51:38.693343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.693677 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:51:38.694034 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m11:51:38.694581 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.695586 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m11:51:38.695992 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:51:38.696345 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m11:51:38.696987 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:38.697447 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m11:51:38.700650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m11:51:38.705932 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m11:51:38.706284 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m11:51:38.706535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:38.707390 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.707813 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m11:51:38.708133 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:51:38.724008 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:51:38.726231 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m11:51:38.727568 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m11:51:38.727996 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m11:51:38.728714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m11:51:38.730791 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m11:51:38.731202 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m11:51:38.731538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.732799 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.733284 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m11:51:38.733695 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:51:38.740695 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:51:38.743516 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m11:51:38.744430 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m11:51:38.744987 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m11:51:38.745636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m11:51:38.749261 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m11:51:38.749638 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m11:51:38.749910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.750459 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.750766 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m11:51:38.751056 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:51:38.754728 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:51:38.756552 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m11:51:38.757178 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m11:51:38.757464 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m11:51:38.757924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m11:51:38.759890 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m11:51:38.760189 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m11:51:38.760455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:38.762094 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:51:38.762527 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m11:51:38.762882 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:51:38.767109 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:51:38.768719 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m11:51:38.769298 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m11:51:38.769578 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m11:51:38.771609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A386D0>]}
[0m11:51:38.772175 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:38.772501 [debug] [MainThread]: On master: BEGIN
[0m11:51:38.772770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:51:38.773333 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:51:38.773680 [debug] [MainThread]: On master: COMMIT
[0m11:51:38.773996 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:38.774278 [debug] [MainThread]: On master: COMMIT
[0m11:51:38.774740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:51:38.775050 [debug] [MainThread]: On master: Close
[0m11:51:38.779095 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m11:51:38.779852 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m11:51:38.781839 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m11:51:38.782339 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m11:51:38.792211 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.795449 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m11:51:38.833733 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.835092 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.835665 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m11:51:38.836121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:38.836867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.837252 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.837600 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m11:51:38.838632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.846541 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.847112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m11:51:38.848058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:38.851117 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.851562 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m11:51:38.852343 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:38.866321 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m11:51:38.867031 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.867522 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m11:51:38.886127 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m11:51:38.892182 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:51:38.892603 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m11:51:38.896361 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:38.901341 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m11:51:38.905332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A681D0>]}
[0m11:51:38.906355 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.12s]
[0m11:51:38.908487 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m11:51:38.909242 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m11:51:38.909994 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m11:51:38.911730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m11:51:38.912302 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m11:51:38.916338 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.917366 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m11:51:38.922851 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.925526 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.926196 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m11:51:38.926574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:38.927378 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.927782 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.928167 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m11:51:38.929472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.935457 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.935973 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m11:51:38.936856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:38.940026 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.940495 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m11:51:38.941344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:38.943088 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m11:51:38.943443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.943768 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m11:51:38.947485 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:38.952608 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:51:38.953236 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m11:51:38.957308 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:38.958818 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m11:51:38.959338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802AA8050>]}
[0m11:51:38.959900 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m11:51:38.962034 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m11:51:38.962840 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m11:51:38.964462 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m11:51:38.966334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m11:51:38.967892 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m11:51:38.971503 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m11:51:38.972563 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m11:51:38.976603 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m11:51:38.978396 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:51:38.979606 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m11:51:38.980256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:38.981394 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.982011 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:51:38.982747 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m11:51:38.984734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.987948 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:51:38.988324 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m11:51:38.989085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:38.991787 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:51:38.992324 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m11:51:38.993490 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:38.996880 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m11:51:38.997730 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:51:38.998300 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m11:51:39.002533 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:51:39.005240 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:51:39.005664 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m11:51:39.008980 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.011903 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m11:51:39.013329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A81810>]}
[0m11:51:39.014408 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m11:51:39.016192 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m11:51:39.016989 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:51:39.017568 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m11:51:39.018599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m11:51:39.019150 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:51:39.021754 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.022699 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:51:39.027702 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.029703 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.030404 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m11:51:39.031024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.032278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.033364 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.034403 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m11:51:39.035788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.039460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.040058 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m11:51:39.041051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.043655 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.044162 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.045752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.048646 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m11:51:39.049541 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.050190 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m11:51:39.054706 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:51:39.056972 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:51:39.057346 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m11:51:39.061333 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.068793 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m11:51:39.069607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802ABB5D0>]}
[0m11:51:39.070230 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m11:51:39.072454 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:51:39.072970 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m11:51:39.073479 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m11:51:39.074717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m11:51:39.075398 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m11:51:39.080032 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.082351 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m11:51:39.086164 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.087228 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.087921 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m11:51:39.088348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.089043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.089446 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.089883 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m11:51:39.091992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.167407 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.167991 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m11:51:39.168925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.172018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.172393 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m11:51:39.173075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.174742 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m11:51:39.175159 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.175540 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m11:51:39.179366 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.182043 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:51:39.182411 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m11:51:39.185839 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.187765 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m11:51:39.188339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A8D1D0>]}
[0m11:51:39.189118 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.11s]
[0m11:51:39.190476 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m11:51:39.191008 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_first_campaign_touch
[0m11:51:39.191532 [info ] [Thread-1 (]: 6 of 12 START sql view model intermediate.model_int_first_campaign_touch ....... [RUN]
[0m11:51:39.192694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_first_campaign_touch)
[0m11:51:39.193317 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_first_campaign_touch
[0m11:51:39.196255 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.197482 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_first_campaign_touch
[0m11:51:39.202324 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.204294 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.205087 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: BEGIN
[0m11:51:39.205986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.207640 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:51:39.208259 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.208711 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */

  
  create view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" as (
    with first_interaction as (
  select
    customer_id,
    campaign_id,
    min(interaction_datetime) as first_interaction_time
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type in ('click', 'impression') and is_new_customer = TRUE
  group by customer_id, campaign_id
)

select * from first_interaction
  );

[0m11:51:39.210023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.215988 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.217075 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch" rename to "model_int_first_campaign_touch__dbt_backup"
[0m11:51:39.218132 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.221179 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.221580 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" rename to "model_int_first_campaign_touch"
[0m11:51:39.222498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.223980 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m11:51:39.224338 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.224627 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m11:51:39.228260 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.232494 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:51:39.233739 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_backup" cascade
[0m11:51:39.237710 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.239285 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: Close
[0m11:51:39.239831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A2BC50>]}
[0m11:51:39.240365 [info ] [Thread-1 (]: 6 of 12 OK created sql view model intermediate.model_int_first_campaign_touch .. [[32mOK[0m in 0.05s]
[0m11:51:39.242326 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_first_campaign_touch
[0m11:51:39.242840 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m11:51:39.243430 [info ] [Thread-1 (]: 7 of 12 START sql view model intermediate.model_int_campaign_conversions ....... [RUN]
[0m11:51:39.244846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_first_campaign_touch, now model.ae_exam_project.model_int_campaign_conversions)
[0m11:51:39.245500 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m11:51:39.251111 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.252710 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m11:51:39.256057 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.257252 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.257902 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m11:51:39.258352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.259233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.259697 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.260169 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select distinct
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select distinct
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.order_datetime,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m11:51:39.262694 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:51:39.268985 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.269647 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m11:51:39.270608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.273504 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.274168 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m11:51:39.275118 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.276619 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m11:51:39.277038 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.277445 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m11:51:39.282531 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:51:39.286776 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:51:39.287241 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m11:51:39.291203 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.292636 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m11:51:39.293425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A2ABD0>]}
[0m11:51:39.294196 [info ] [Thread-1 (]: 7 of 12 OK created sql view model intermediate.model_int_campaign_conversions .. [[32mOK[0m in 0.05s]
[0m11:51:39.295966 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m11:51:39.296589 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:51:39.297333 [info ] [Thread-1 (]: 8 of 12 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m11:51:39.298639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m11:51:39.299673 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:51:39.303992 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.305090 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:51:39.309276 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.311054 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.311801 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m11:51:39.312641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.313864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.314463 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.315395 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m11:51:39.320132 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.323616 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.324242 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m11:51:39.325129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.328260 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.328878 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m11:51:39.330169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.332748 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m11:51:39.333882 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.334576 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m11:51:39.338610 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.340794 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:51:39.341132 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m11:51:39.344439 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.346474 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m11:51:39.347558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001080290F470>]}
[0m11:51:39.348883 [info ] [Thread-1 (]: 8 of 12 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.05s]
[0m11:51:39.351030 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:51:39.351712 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m11:51:39.352273 [info ] [Thread-1 (]: 9 of 12 START sql Table model mart.model_mart_customer_acquisition ............. [RUN]
[0m11:51:39.353481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_mart_customer_acquisition)
[0m11:51:39.354013 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m11:51:39.357896 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m11:51:39.360439 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m11:51:39.369098 [debug] [Thread-1 (]: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m11:51:39.369965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A2ABD0>]}
[0m11:51:39.370644 [error] [Thread-1 (]: 9 of 12 ERROR creating sql Table model mart.model_mart_customer_acquisition .... [[31mERROR[0m in 0.02s]
[0m11:51:39.372201 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m11:51:39.372844 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m11:51:39.374428 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_customer_acquisition' to be skipped because of status 'error'.  Reason: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb').
[0m11:51:39.373586 [info ] [Thread-1 (]: 10 of 12 START sql view model intermediate.model_int_new_customer_converted .... [RUN]
[0m11:51:39.376394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_int_new_customer_converted)
[0m11:51:39.376834 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m11:51:39.382304 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.384547 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m11:51:39.388444 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.390097 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.390690 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m11:51:39.391116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.391888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.392283 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.392625 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select distinct 
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m11:51:39.394856 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:51:39.401684 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.402425 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m11:51:39.403571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.406950 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.407340 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m11:51:39.408051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.409515 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m11:51:39.409911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.410240 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m11:51:39.414495 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:51:39.419379 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:51:39.420014 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m11:51:39.423464 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.425006 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m11:51:39.425504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A2B890>]}
[0m11:51:39.426041 [info ] [Thread-1 (]: 10 of 12 OK created sql view model intermediate.model_int_new_customer_converted  [[32mOK[0m in 0.05s]
[0m11:51:39.428146 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m11:51:39.429274 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m11:51:39.430734 [info ] [Thread-1 (]: 11 of 12 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m11:51:39.432929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m11:51:39.433887 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m11:51:39.438080 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.439690 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m11:51:39.470742 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.471927 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.472484 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m11:51:39.472937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.473813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.474265 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.474698 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(*) filter (where event_type  = 'impression') as impression,
        count(*) filter (where event_type  = 'click') as click,
        count(*) filter (where event_type  = 'conversion' and order_id is not null and order_status = 'completed') as converted_customers,             
        count(distinct order_id)  filter (where order_id is not null and order_status = 'completed')  as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(case 
            when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
            else null
        end,2) as roas,
        round(case 
            when count(distinct customer_id) filter (where order_id is not null) > 0 
                then sum(ad_cost) / count(distinct customer_id) filter (where order_id is not null)
            else null
        end,2) as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m11:51:39.538928 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m11:51:39.542561 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.543060 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m11:51:39.544393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.547735 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.548139 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m11:51:39.548932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:39.554654 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m11:51:39.555080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.555397 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m11:51:39.561887 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:51:39.564935 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:51:39.565356 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m11:51:39.568679 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:39.570484 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m11:51:39.571110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A2B410>]}
[0m11:51:39.571747 [info ] [Thread-1 (]: 11 of 12 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.14s]
[0m11:51:39.573048 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m11:51:39.574253 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m11:51:39.574954 [info ] [Thread-1 (]: 12 of 12 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m11:51:39.575921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m11:51:39.576559 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m11:51:39.580263 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m11:51:39.582744 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m11:51:39.587703 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m11:51:39.589618 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:51:39.590304 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m11:51:39.590699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:39.591438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:39.591800 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:51:39.592167 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m11:51:39.593610 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by date asc
    );
  
  
[0m11:51:39.594035 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:51:39.594495 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: ROLLBACK
[0m11:51:39.606247 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.report_campaign_effectiveness'
[0m11:51:39.607162 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m11:51:39.612586 [debug] [Thread-1 (]: Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "total_revenue", "interaction_date", "cpa", "converted_customers", "roas"
  
  LINE 15: order by date asc
                    ^
[0m11:51:39.613364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ef16bb-2a21-4faa-b3ea-237957a56ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802B14110>]}
[0m11:51:39.614397 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model report.report_campaign_effectiveness ... [[31mERROR[0m in 0.04s]
[0m11:51:39.616888 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m11:51:39.655406 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.report_campaign_effectiveness' to be skipped because of status 'error'.  Reason: Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "total_revenue", "interaction_date", "cpa", "converted_customers", "roas"
  
  LINE 15: order by date asc
                    ^.
[0m11:51:39.658613 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:39.659489 [debug] [MainThread]: On master: BEGIN
[0m11:51:39.660219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:39.661678 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:51:39.662379 [debug] [MainThread]: On master: COMMIT
[0m11:51:39.663037 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:39.663721 [debug] [MainThread]: On master: COMMIT
[0m11:51:39.664909 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:51:39.666222 [debug] [MainThread]: On master: Close
[0m11:51:39.667440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:39.668045 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m11:51:39.668620 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m11:51:39.669123 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m11:51:39.669918 [info ] [MainThread]: 
[0m11:51:39.676235 [info ] [MainThread]: Finished running 1 Table model, 2 table models, 9 view models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m11:51:39.681368 [debug] [MainThread]: Command end result
[0m11:51:39.744129 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m11:51:39.748725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m11:51:39.766459 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m11:51:39.767495 [info ] [MainThread]: 
[0m11:51:39.779789 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:51:39.781576 [info ] [MainThread]: 
[0m11:51:39.783079 [error] [MainThread]:   Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m11:51:39.784262 [info ] [MainThread]: 
[0m11:51:39.785553 [error] [MainThread]:   Runtime Error in model report_campaign_effectiveness (models\report\report_campaign_effectiveness.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "total_revenue", "interaction_date", "cpa", "converted_customers", "roas"
  
  LINE 15: order by date asc
                    ^
[0m11:51:39.786466 [info ] [MainThread]: 
[0m11:51:39.787357 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m11:51:39.789122 [debug] [MainThread]: Command `dbt run` failed at 11:51:39.788874 after 2.29 seconds
[0m11:51:39.790046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108021D1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001087FF8CBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010802A28650>]}
[0m11:51:39.791067 [debug] [MainThread]: Flushing usage events
[0m11:51:41.356983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:30.828949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824E88A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824F817890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824FA07ED0>]}


============================== 11:52:30.833967 | 459c3cd7-5c73-4254-86bf-873797ffa1b0 ==============================
[0m11:52:30.833967 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:52:30.836060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:31.065354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824EF410F0>]}
[0m11:52:31.136243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824F8C7AC0>]}
[0m11:52:31.140076 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:52:31.351115 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:52:31.489386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:52:31.489772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:52:31.524637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824FADB450>]}
[0m11:52:31.609544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m11:52:31.612358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m11:52:31.642717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824F83F4D0>]}
[0m11:52:31.643652 [info ] [MainThread]: Found 12 models, 5 sources, 429 macros
[0m11:52:31.644515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282510B8E50>]}
[0m11:52:31.647292 [info ] [MainThread]: 
[0m11:52:31.648275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:31.649165 [info ] [MainThread]: 
[0m11:52:31.650247 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:52:31.661300 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m11:52:31.759952 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:52:31.760451 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:52:31.760815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:31.802063 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m11:52:31.804371 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:52:31.807375 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:52:31.807875 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:52:31.808240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.809402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.811106 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:52:31.813287 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:52:31.813703 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:52:31.814220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.816055 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:52:31.819251 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:52:31.822409 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m11:52:31.822893 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m11:52:31.823234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.824395 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.825747 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m11:52:31.826854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m11:52:31.827427 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m11:52:31.834995 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:52:31.835365 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:52:31.835724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.837007 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.838831 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:52:31.839232 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m11:52:31.839830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.840130 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:52:31.840432 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m11:52:31.840968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.841920 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m11:52:31.842240 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m11:52:31.842516 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m11:52:31.842965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.843270 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m11:52:31.843916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m11:52:31.844414 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m11:52:31.846234 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:52:31.846559 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:52:31.846826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.848037 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.849661 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:52:31.850040 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m11:52:31.850570 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.850852 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:52:31.851112 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m11:52:31.851624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.852748 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m11:52:31.853184 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m11:52:31.853513 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m11:52:31.854082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.854445 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m11:52:31.855123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m11:52:31.855580 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m11:52:31.857655 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:52:31.857968 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:52:31.858260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.860518 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:52:31.862023 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:52:31.862365 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m11:52:31.862891 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.863182 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:52:31.863512 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m11:52:31.864108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.865078 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m11:52:31.865430 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m11:52:31.865725 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m11:52:31.866245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.866625 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m11:52:31.867294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m11:52:31.867804 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m11:52:31.870076 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:52:31.870553 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m11:52:31.870978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.872125 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.873794 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:52:31.874207 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m11:52:31.874903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.875266 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:52:31.875582 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m11:52:31.876108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.877097 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m11:52:31.877439 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m11:52:31.877720 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m11:52:31.878188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:31.878549 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m11:52:31.881791 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m11:52:31.888279 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m11:52:31.888797 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m11:52:31.889150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:31.890361 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.890841 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m11:52:31.891169 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:52:31.906293 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:52:31.908400 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m11:52:31.909533 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m11:52:31.909911 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m11:52:31.910555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m11:52:31.912331 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m11:52:31.912687 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m11:52:31.912971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.914099 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.914442 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m11:52:31.914734 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:52:31.918726 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:52:31.920360 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m11:52:31.921090 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m11:52:31.921415 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m11:52:31.921909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m11:52:31.923554 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m11:52:31.923863 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m11:52:31.924133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.925952 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:52:31.927366 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m11:52:31.927940 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:52:31.931699 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:52:31.933094 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m11:52:31.933663 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m11:52:31.933936 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m11:52:31.934409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m11:52:31.937568 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m11:52:31.938134 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m11:52:31.938544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:31.939377 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:31.939784 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m11:52:31.940122 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m11:52:31.943811 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:52:31.945293 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m11:52:31.945846 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m11:52:31.946136 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m11:52:31.949040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282514B8460>]}
[0m11:52:31.949778 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:31.950217 [debug] [MainThread]: On master: BEGIN
[0m11:52:31.950682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:31.951568 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:52:31.951986 [debug] [MainThread]: On master: COMMIT
[0m11:52:31.952467 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:31.952832 [debug] [MainThread]: On master: COMMIT
[0m11:52:31.953526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:31.953905 [debug] [MainThread]: On master: Close
[0m11:52:31.957889 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m11:52:31.958524 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m11:52:31.960303 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m11:52:31.960809 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m11:52:31.970525 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:31.971875 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m11:52:32.014315 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:32.015515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:32.016275 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m11:52:32.017013 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:52:32.018043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.018667 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:32.019422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m11:52:32.021187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.030006 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:32.030592 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m11:52:32.031840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.035954 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:32.036766 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m11:52:32.037757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.053047 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m11:52:32.053667 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:32.054061 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m11:52:32.059194 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:52:32.064813 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m11:52:32.065319 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m11:52:32.068494 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.071591 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m11:52:32.074392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282514E81D0>]}
[0m11:52:32.075355 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.11s]
[0m11:52:32.076913 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m11:52:32.077584 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m11:52:32.078172 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m11:52:32.079798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m11:52:32.080319 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m11:52:32.082779 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.084177 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m11:52:32.089687 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.091264 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.091911 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m11:52:32.092334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.093103 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.093524 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.093890 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m11:52:32.094982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.097939 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.098341 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m11:52:32.099083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.102370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.102897 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m11:52:32.103926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.107746 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m11:52:32.108438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.108930 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m11:52:32.113762 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:52:32.117174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m11:52:32.117703 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m11:52:32.121665 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.124912 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m11:52:32.125711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028251528100>]}
[0m11:52:32.126315 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m11:52:32.128404 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m11:52:32.128958 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m11:52:32.129487 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m11:52:32.130754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m11:52:32.131335 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m11:52:32.133985 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.134907 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m11:52:32.140575 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.141733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.142237 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m11:52:32.142769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.143905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.144842 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.145589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m11:52:32.148542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.151607 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.152100 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m11:52:32.153041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.157483 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.157894 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m11:52:32.158624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.160054 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m11:52:32.160790 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.161433 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m11:52:32.165173 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.168334 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m11:52:32.168852 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m11:52:32.172912 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.175333 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m11:52:32.176045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028251501630>]}
[0m11:52:32.176731 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m11:52:32.178997 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m11:52:32.179624 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:52:32.180657 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m11:52:32.181978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m11:52:32.182490 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:52:32.184873 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.186134 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:52:32.191547 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.192826 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.193649 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m11:52:32.194492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.195696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.196169 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.196557 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m11:52:32.197478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.200476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.200833 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m11:52:32.201500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.206195 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.206764 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.207675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.209152 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m11:52:32.209549 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.209989 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m11:52:32.218286 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:52:32.222564 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m11:52:32.223563 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m11:52:32.227669 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.233349 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m11:52:32.233952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825153B5D0>]}
[0m11:52:32.234595 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m11:52:32.237194 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m11:52:32.238121 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m11:52:32.239434 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m11:52:32.240881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m11:52:32.241517 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m11:52:32.245324 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.246999 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m11:52:32.251074 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.252183 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.253082 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m11:52:32.253983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.255231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.255793 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.256217 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m11:52:32.257250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.324742 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.325405 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m11:52:32.326368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.330172 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.330768 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m11:52:32.332133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.334971 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m11:52:32.335861 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.336748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m11:52:32.340181 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.342639 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m11:52:32.343026 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m11:52:32.347183 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.349309 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m11:52:32.349939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282514B55C0>]}
[0m11:52:32.350597 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.11s]
[0m11:52:32.352978 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m11:52:32.353553 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_first_campaign_touch
[0m11:52:32.354152 [info ] [Thread-1 (]: 6 of 12 START sql view model intermediate.model_int_first_campaign_touch ....... [RUN]
[0m11:52:32.355726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_first_campaign_touch)
[0m11:52:32.356383 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_first_campaign_touch
[0m11:52:32.359204 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.360212 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_first_campaign_touch
[0m11:52:32.364960 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.366403 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.367030 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: BEGIN
[0m11:52:32.367444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.368176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.368530 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.368902 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */

  
  create view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" as (
    with first_interaction as (
  select
    customer_id,
    campaign_id,
    min(interaction_datetime) as first_interaction_time
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type in ('click', 'impression') and is_new_customer = TRUE
  group by customer_id, campaign_id
)

select * from first_interaction
  );

[0m11:52:32.370687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.376829 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.377386 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch" rename to "model_int_first_campaign_touch__dbt_backup"
[0m11:52:32.378248 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.381443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.381803 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" rename to "model_int_first_campaign_touch"
[0m11:52:32.382488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.384032 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m11:52:32.384406 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.384711 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m11:52:32.388377 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.393696 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m11:52:32.394290 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_backup" cascade
[0m11:52:32.397793 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.399310 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: Close
[0m11:52:32.399813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282514AAB70>]}
[0m11:52:32.400622 [info ] [Thread-1 (]: 6 of 12 OK created sql view model intermediate.model_int_first_campaign_touch .. [[32mOK[0m in 0.04s]
[0m11:52:32.402060 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_first_campaign_touch
[0m11:52:32.402913 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m11:52:32.403900 [info ] [Thread-1 (]: 7 of 12 START sql view model intermediate.model_int_campaign_conversions ....... [RUN]
[0m11:52:32.405162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_first_campaign_touch, now model.ae_exam_project.model_int_campaign_conversions)
[0m11:52:32.405855 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m11:52:32.409817 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.411702 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m11:52:32.416608 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.417994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.418637 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m11:52:32.419360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.420423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.421075 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.421628 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select distinct
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select distinct
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.order_datetime,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m11:52:32.424754 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:52:32.429087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.429618 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m11:52:32.430457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.434221 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.434668 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m11:52:32.435425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.437409 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m11:52:32.438072 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.438604 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m11:52:32.443085 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:52:32.446236 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m11:52:32.446649 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m11:52:32.451260 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.454312 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m11:52:32.455469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282514ABDD0>]}
[0m11:52:32.457029 [info ] [Thread-1 (]: 7 of 12 OK created sql view model intermediate.model_int_campaign_conversions .. [[32mOK[0m in 0.05s]
[0m11:52:32.458538 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m11:52:32.459072 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:52:32.459685 [info ] [Thread-1 (]: 8 of 12 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m11:52:32.461577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m11:52:32.462152 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:52:32.466859 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.468421 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:52:32.474364 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.476041 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.476706 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m11:52:32.477436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.478460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.479076 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.479502 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m11:52:32.481918 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:52:32.485860 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.486431 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m11:52:32.487630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.493368 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.494195 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m11:52:32.495364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.497247 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m11:52:32.497713 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.498065 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m11:52:32.501737 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.506420 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m11:52:32.507783 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m11:52:32.512370 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:52:32.514178 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m11:52:32.514748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282514AB470>]}
[0m11:52:32.515309 [info ] [Thread-1 (]: 8 of 12 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.05s]
[0m11:52:32.516966 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m11:52:32.517522 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m11:52:32.518100 [info ] [Thread-1 (]: 9 of 12 START sql Table model mart.model_mart_customer_acquisition ............. [RUN]
[0m11:52:32.519684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_mart_customer_acquisition)
[0m11:52:32.520501 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m11:52:32.525968 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m11:52:32.527189 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m11:52:32.532425 [debug] [Thread-1 (]: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m11:52:32.533458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028250CBE390>]}
[0m11:52:32.534230 [error] [Thread-1 (]: 9 of 12 ERROR creating sql Table model mart.model_mart_customer_acquisition .... [[31mERROR[0m in 0.01s]
[0m11:52:32.535385 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m11:52:32.536294 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m11:52:32.538256 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_customer_acquisition' to be skipped because of status 'error'.  Reason: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb').
[0m11:52:32.537162 [info ] [Thread-1 (]: 10 of 12 START sql view model intermediate.model_int_new_customer_converted .... [RUN]
[0m11:52:32.541458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_int_new_customer_converted)
[0m11:52:32.542112 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m11:52:32.546190 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.547717 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m11:52:32.550742 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.551751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.552507 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m11:52:32.553353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.554586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.555631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.556225 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select distinct 
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m11:52:32.560213 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.564417 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.564809 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m11:52:32.565558 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.571225 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.572149 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m11:52:32.573386 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.576314 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m11:52:32.577168 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.577837 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m11:52:32.581696 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.585004 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m11:52:32.585537 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m11:52:32.589805 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.591921 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m11:52:32.592667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282514D7410>]}
[0m11:52:32.593427 [info ] [Thread-1 (]: 10 of 12 OK created sql view model intermediate.model_int_new_customer_converted  [[32mOK[0m in 0.05s]
[0m11:52:32.595380 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m11:52:32.596004 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m11:52:32.596580 [info ] [Thread-1 (]: 11 of 12 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m11:52:32.597814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m11:52:32.598334 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m11:52:32.601291 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.602512 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m11:52:32.631545 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.632744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.633351 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m11:52:32.633817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.634649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.635061 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.635693 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(*) filter (where event_type  = 'impression') as impression,
        count(*) filter (where event_type  = 'click') as click,
        count(*) filter (where event_type  = 'conversion' and order_id is not null and order_status = 'completed') as converted_customers,             
        count(distinct order_id)  filter (where order_id is not null and order_status = 'completed')  as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(case 
            when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
            else null
        end,2) as roas,
        round(case 
            when count(distinct customer_id) filter (where order_id is not null) > 0 
                then sum(ad_cost) / count(distinct customer_id) filter (where order_id is not null)
            else null
        end,2) as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m11:52:32.700792 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m11:52:32.704326 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.704834 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m11:52:32.705828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.708763 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.709154 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m11:52:32.709842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.716326 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m11:52:32.716808 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.717171 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m11:52:32.724975 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:52:32.727713 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m11:52:32.728085 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m11:52:32.731315 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.733267 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m11:52:32.734136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028250CBE390>]}
[0m11:52:32.734907 [info ] [Thread-1 (]: 11 of 12 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.14s]
[0m11:52:32.736723 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m11:52:32.738236 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m11:52:32.738948 [info ] [Thread-1 (]: 12 of 12 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m11:52:32.740089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m11:52:32.740619 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m11:52:32.743392 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.745149 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m11:52:32.750158 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.752237 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.753309 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m11:52:32.754127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.755715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.756303 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.756754 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m11:52:32.768127 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:52:32.775058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.775568 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m11:52:32.776452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:52:32.779407 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.779834 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m11:52:32.781319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:52:32.783824 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m11:52:32.784620 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.785888 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m11:52:32.794494 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:52:32.797587 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m11:52:32.798209 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m11:52:32.801767 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:52:32.804170 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m11:52:32.804923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459c3cd7-5c73-4254-86bf-873797ffa1b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028250CBF110>]}
[0m11:52:32.805727 [info ] [Thread-1 (]: 12 of 12 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.06s]
[0m11:52:32.806843 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m11:52:32.808862 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:32.809325 [debug] [MainThread]: On master: BEGIN
[0m11:52:32.809684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:32.810451 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:52:32.810868 [debug] [MainThread]: On master: COMMIT
[0m11:52:32.811257 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:32.811645 [debug] [MainThread]: On master: COMMIT
[0m11:52:32.812287 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:32.812731 [debug] [MainThread]: On master: Close
[0m11:52:32.813750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:32.814291 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m11:52:32.814765 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m11:52:32.815230 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m11:52:32.815961 [info ] [MainThread]: 
[0m11:52:32.816920 [info ] [MainThread]: Finished running 1 Table model, 2 table models, 9 view models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m11:52:32.822059 [debug] [MainThread]: Command end result
[0m11:52:32.858676 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m11:52:32.862676 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m11:52:32.877699 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m11:52:32.878712 [info ] [MainThread]: 
[0m11:52:32.880183 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:52:32.881412 [info ] [MainThread]: 
[0m11:52:32.883314 [error] [MainThread]:   Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m11:52:32.884733 [info ] [MainThread]: 
[0m11:52:32.886426 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m11:52:32.888220 [debug] [MainThread]: Command `dbt run` failed at 11:52:32.887927 after 2.29 seconds
[0m11:52:32.889011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824FA89D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824F913050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002824EB2E9F0>]}
[0m11:52:32.889755 [debug] [MainThread]: Flushing usage events
[0m11:52:34.105450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:14.453216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021534EDA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021535E57890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021536047ED0>]}


============================== 12:30:14.459691 | 12c8d19a-f254-4a85-a570-ba5061f2ce96 ==============================
[0m12:30:14.459691 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:30:14.461655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:30:14.688789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215355810F0>]}
[0m12:30:14.762405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021535F03AC0>]}
[0m12:30:14.766249 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:30:15.131278 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:30:15.287510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:15.288006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:15.330504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153611F450>]}
[0m12:30:15.422398 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m12:30:15.473839 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m12:30:15.506831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021535E7F4D0>]}
[0m12:30:15.507787 [info ] [MainThread]: Found 12 models, 5 sources, 429 macros
[0m12:30:15.508892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153769CE50>]}
[0m12:30:15.512967 [info ] [MainThread]: 
[0m12:30:15.514132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:15.515171 [info ] [MainThread]: 
[0m12:30:15.517101 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:30:15.531524 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m12:30:15.620281 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m12:30:15.620804 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m12:30:15.621267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:15.651811 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m12:30:15.654042 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m12:30:15.656458 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m12:30:15.656924 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m12:30:15.657318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.658840 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.661883 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m12:30:15.665289 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m12:30:15.665816 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m12:30:15.666195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.667464 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.668836 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m12:30:15.671271 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m12:30:15.671660 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m12:30:15.671974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.673198 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.674574 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m12:30:15.676011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m12:30:15.677375 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m12:30:15.684216 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m12:30:15.684654 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m12:30:15.684977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.686025 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.687382 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m12:30:15.687678 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m12:30:15.688203 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.688471 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m12:30:15.688772 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m12:30:15.691227 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:30:15.692129 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m12:30:15.692464 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m12:30:15.692743 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m12:30:15.693215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.693551 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m12:30:15.694280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m12:30:15.695111 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m12:30:15.696971 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m12:30:15.697320 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m12:30:15.697621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.698606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.700180 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m12:30:15.700521 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m12:30:15.701017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.701343 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m12:30:15.701677 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m12:30:15.702259 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.703162 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m12:30:15.703788 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m12:30:15.704240 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m12:30:15.704900 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.705335 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m12:30:15.705983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m12:30:15.706454 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m12:30:15.708440 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m12:30:15.708762 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m12:30:15.709044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.710024 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.711815 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m12:30:15.712229 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m12:30:15.712928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.713331 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m12:30:15.713722 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m12:30:15.714361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.715365 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m12:30:15.715681 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m12:30:15.715949 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m12:30:15.716390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.716661 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m12:30:15.717229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_report)
[0m12:30:15.717715 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m12:30:15.719571 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m12:30:15.719981 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m12:30:15.720278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.721300 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.722555 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m12:30:15.722871 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m12:30:15.723316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.723597 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m12:30:15.723888 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m12:30:15.724496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.725462 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m12:30:15.725756 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m12:30:15.726040 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m12:30:15.726483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:30:15.726757 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m12:30:15.730294 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m12:30:15.736340 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m12:30:15.736738 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m12:30:15.737058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:15.737882 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.738232 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m12:30:15.738555 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m12:30:15.762969 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:30:15.766113 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m12:30:15.767992 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m12:30:15.768485 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m12:30:15.769079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m12:30:15.770724 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m12:30:15.771072 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m12:30:15.771344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.772446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:30:15.772869 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m12:30:15.773209 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m12:30:15.777655 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:30:15.779383 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m12:30:15.780069 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m12:30:15.780373 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m12:30:15.780900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m12:30:15.782685 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m12:30:15.783049 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m12:30:15.783353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.785085 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:30:15.785548 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m12:30:15.785857 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m12:30:15.789687 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:30:15.791070 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m12:30:15.791618 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m12:30:15.791890 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m12:30:15.792356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m12:30:15.795248 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m12:30:15.795758 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m12:30:15.796111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:15.797916 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:30:15.798320 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m12:30:15.798649 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m12:30:15.802341 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:30:15.803839 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m12:30:15.804510 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m12:30:15.804845 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m12:30:15.806611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537A98EF0>]}
[0m12:30:15.807172 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:15.807494 [debug] [MainThread]: On master: BEGIN
[0m12:30:15.807763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:15.808330 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:30:15.808625 [debug] [MainThread]: On master: COMMIT
[0m12:30:15.808912 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:15.809162 [debug] [MainThread]: On master: COMMIT
[0m12:30:15.809645 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:30:15.810012 [debug] [MainThread]: On master: Close
[0m12:30:15.814719 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m12:30:15.815365 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m12:30:15.817095 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m12:30:15.817626 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m12:30:15.825447 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.826699 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m12:30:15.868906 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.870623 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.871336 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m12:30:15.871752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:30:15.872494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:15.872878 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.873249 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m12:30:15.875161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:15.883536 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.884117 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m12:30:15.886131 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:30:15.889375 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.889783 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m12:30:15.890503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:15.904386 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m12:30:15.904902 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.905250 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m12:30:15.910776 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:30:15.916403 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m12:30:15.916806 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m12:30:15.920631 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:15.923912 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m12:30:15.927172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537AC81D0>]}
[0m12:30:15.928360 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.11s]
[0m12:30:15.930016 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m12:30:15.930604 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m12:30:15.931374 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m12:30:15.932612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m12:30:15.933252 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m12:30:15.936622 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.938358 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m12:30:15.944170 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.947309 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.948438 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m12:30:15.949128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:15.949941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:15.950408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.950815 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m12:30:15.951726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:15.955724 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.956185 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m12:30:15.956995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:15.960497 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.961599 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m12:30:15.963104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:15.966791 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m12:30:15.967352 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.967758 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m12:30:15.971241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:15.973693 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m12:30:15.974204 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m12:30:15.977893 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:15.980349 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m12:30:15.981486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537B08100>]}
[0m12:30:15.983040 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m12:30:15.984581 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m12:30:15.985444 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m12:30:15.986651 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m12:30:15.988164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m12:30:15.989239 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m12:30:15.992583 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m12:30:15.995457 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m12:30:15.999272 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m12:30:16.000585 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m12:30:16.001500 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m12:30:16.002053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.002970 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.003552 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m12:30:16.004121 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m12:30:16.005761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.011289 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m12:30:16.012179 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m12:30:16.013606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.018896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m12:30:16.019416 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m12:30:16.020339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.021898 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m12:30:16.022290 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m12:30:16.022650 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m12:30:16.026363 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.030317 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m12:30:16.031099 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m12:30:16.035852 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:30:16.037288 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m12:30:16.037797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537AE14F0>]}
[0m12:30:16.038329 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m12:30:16.040539 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m12:30:16.041007 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m12:30:16.041512 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m12:30:16.042588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m12:30:16.043614 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m12:30:16.048617 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.050175 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m12:30:16.053537 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.054917 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.055777 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m12:30:16.056330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.057184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.057602 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.058028 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m12:30:16.059004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.065265 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.066307 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m12:30:16.067389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.070278 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.070689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.071434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.072737 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m12:30:16.073124 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.073448 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m12:30:16.077635 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:30:16.082462 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m12:30:16.083018 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m12:30:16.087137 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.091841 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m12:30:16.092693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537B1AA50>]}
[0m12:30:16.094826 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m12:30:16.096565 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m12:30:16.097267 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m12:30:16.098454 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m12:30:16.100373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m12:30:16.101268 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m12:30:16.104040 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.105230 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m12:30:16.108350 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.109480 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.111404 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m12:30:16.112221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.113559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.114658 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.115167 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m12:30:16.116368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.186353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.186910 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m12:30:16.187808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.191131 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.191522 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m12:30:16.192204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.193644 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m12:30:16.194208 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.194751 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m12:30:16.198886 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:30:16.201091 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m12:30:16.201477 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m12:30:16.204790 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.207338 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m12:30:16.207986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215376AE200>]}
[0m12:30:16.208645 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.11s]
[0m12:30:16.210894 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m12:30:16.211469 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_first_campaign_touch
[0m12:30:16.212059 [info ] [Thread-1 (]: 6 of 12 START sql view model intermediate.model_int_first_campaign_touch ....... [RUN]
[0m12:30:16.213289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_first_campaign_touch)
[0m12:30:16.213879 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_first_campaign_touch
[0m12:30:16.216548 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.217569 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_first_campaign_touch
[0m12:30:16.221593 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.223496 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.224333 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: BEGIN
[0m12:30:16.225712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.227796 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:30:16.229180 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.233221 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */

  
  create view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" as (
    with first_interaction as (
  select
    customer_id,
    campaign_id,
    min(interaction_datetime) as first_interaction_time
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type in ('click', 'impression') and is_new_customer = TRUE
  group by customer_id, campaign_id
)

select * from first_interaction
  );

[0m12:30:16.259851 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m12:30:16.271698 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.272752 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch" rename to "model_int_first_campaign_touch__dbt_backup"
[0m12:30:16.274925 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.284352 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.285423 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" rename to "model_int_first_campaign_touch"
[0m12:30:16.287151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.290286 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m12:30:16.291261 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.292099 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m12:30:16.297245 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:30:16.302224 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m12:30:16.303235 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_backup" cascade
[0m12:30:16.307461 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.309577 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: Close
[0m12:30:16.310927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537947110>]}
[0m12:30:16.312245 [info ] [Thread-1 (]: 6 of 12 OK created sql view model intermediate.model_int_first_campaign_touch .. [[32mOK[0m in 0.10s]
[0m12:30:16.313859 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_first_campaign_touch
[0m12:30:16.314809 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m12:30:16.316048 [info ] [Thread-1 (]: 7 of 12 START sql view model intermediate.model_int_campaign_conversions ....... [RUN]
[0m12:30:16.317791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_first_campaign_touch, now model.ae_exam_project.model_int_campaign_conversions)
[0m12:30:16.318455 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m12:30:16.325191 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.327695 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m12:30:16.335424 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.337455 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.338108 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m12:30:16.338566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.339375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.339884 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.340291 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select distinct
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select distinct
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.order_datetime,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m12:30:16.342591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:30:16.348312 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.349220 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m12:30:16.350459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.353980 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.354442 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m12:30:16.355235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.356676 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m12:30:16.357063 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.357403 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m12:30:16.360996 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.365147 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m12:30:16.366077 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m12:30:16.369814 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.371788 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m12:30:16.372556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537A7C8F0>]}
[0m12:30:16.373346 [info ] [Thread-1 (]: 7 of 12 OK created sql view model intermediate.model_int_campaign_conversions .. [[32mOK[0m in 0.05s]
[0m12:30:16.374465 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m12:30:16.375006 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m12:30:16.376008 [info ] [Thread-1 (]: 8 of 12 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m12:30:16.377445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m12:30:16.378335 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m12:30:16.384059 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.385482 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m12:30:16.388749 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.390036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.390752 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m12:30:16.391345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.392827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.393788 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.394939 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m12:30:16.400857 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:30:16.404635 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.405172 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m12:30:16.406048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.410518 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.411383 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m12:30:16.412675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.415910 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m12:30:16.416683 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.417144 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m12:30:16.420426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.422727 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m12:30:16.423643 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m12:30:16.427149 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.430358 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m12:30:16.431457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537A7F470>]}
[0m12:30:16.432287 [info ] [Thread-1 (]: 8 of 12 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.05s]
[0m12:30:16.433263 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m12:30:16.433896 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m12:30:16.434643 [info ] [Thread-1 (]: 9 of 12 START sql Table model mart.model_mart_customer_acquisition ............. [RUN]
[0m12:30:16.435778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_mart_customer_acquisition)
[0m12:30:16.436312 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m12:30:16.444429 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m12:30:16.447074 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m12:30:16.505167 [debug] [Thread-1 (]: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m12:30:16.506024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537947770>]}
[0m12:30:16.507138 [error] [Thread-1 (]: 9 of 12 ERROR creating sql Table model mart.model_mart_customer_acquisition .... [[31mERROR[0m in 0.07s]
[0m12:30:16.508712 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m12:30:16.509244 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m12:30:16.510071 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_customer_acquisition' to be skipped because of status 'error'.  Reason: Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb').
[0m12:30:16.510871 [info ] [Thread-1 (]: 10 of 12 START sql view model intermediate.model_int_new_customer_converted .... [RUN]
[0m12:30:16.513022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_int_new_customer_converted)
[0m12:30:16.513510 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m12:30:16.517514 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.519772 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m12:30:16.524062 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.525419 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.526030 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m12:30:16.526537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.527900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.528692 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.529367 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select distinct 
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m12:30:16.533865 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.537714 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.538199 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m12:30:16.538986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.541783 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.542223 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m12:30:16.543172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.547286 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m12:30:16.548553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.549448 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m12:30:16.555981 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:30:16.558979 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m12:30:16.559481 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m12:30:16.563015 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.566524 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m12:30:16.567489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537A7F830>]}
[0m12:30:16.568345 [info ] [Thread-1 (]: 10 of 12 OK created sql view model intermediate.model_int_new_customer_converted  [[32mOK[0m in 0.05s]
[0m12:30:16.569655 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m12:30:16.570198 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m12:30:16.570759 [info ] [Thread-1 (]: 11 of 12 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m12:30:16.571715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m12:30:16.572211 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m12:30:16.575954 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.577835 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m12:30:16.610342 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.612487 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.613342 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m12:30:16.615121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.617016 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:30:16.617930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.618811 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m12:30:16.681061 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m12:30:16.685744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.686429 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m12:30:16.688151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.691428 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.691896 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m12:30:16.692727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:16.700083 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m12:30:16.700733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.701201 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m12:30:16.709928 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:30:16.715273 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m12:30:16.716526 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m12:30:16.721761 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:30:16.724113 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m12:30:16.725076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021537AA0E30>]}
[0m12:30:16.726078 [info ] [Thread-1 (]: 11 of 12 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.15s]
[0m12:30:16.727504 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m12:30:16.728910 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m12:30:16.729804 [info ] [Thread-1 (]: 12 of 12 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m12:30:16.731024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m12:30:16.731924 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m12:30:16.738144 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.740180 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m12:30:16.745505 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.748053 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.749056 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m12:30:16.749655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:16.750644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.751215 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.751804 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m12:30:16.764210 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:30:16.773067 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.773649 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m12:30:16.774853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.778848 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.779604 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m12:30:16.780888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:16.783844 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m12:30:16.784394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.784787 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m12:30:16.790609 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:30:16.793022 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m12:30:16.793874 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m12:30:16.797987 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:30:16.799934 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m12:30:16.800630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c8d19a-f254-4a85-a570-ba5061f2ce96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153767F770>]}
[0m12:30:16.801409 [info ] [Thread-1 (]: 12 of 12 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.07s]
[0m12:30:16.802434 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m12:30:16.804477 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:16.804951 [debug] [MainThread]: On master: BEGIN
[0m12:30:16.805306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:16.806044 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:30:16.806404 [debug] [MainThread]: On master: COMMIT
[0m12:30:16.806788 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:16.807155 [debug] [MainThread]: On master: COMMIT
[0m12:30:16.807744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:30:16.808133 [debug] [MainThread]: On master: Close
[0m12:30:16.808620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:16.808956 [debug] [MainThread]: Connection 'create_ae_exam_db_report' was properly closed.
[0m12:30:16.809272 [debug] [MainThread]: Connection 'list_ae_exam_db_report' was properly closed.
[0m12:30:16.810065 [debug] [MainThread]: Connection 'model.ae_exam_project.report_campaign_effectiveness' was properly closed.
[0m12:30:16.811093 [info ] [MainThread]: 
[0m12:30:16.812025 [info ] [MainThread]: Finished running 1 Table model, 2 table models, 9 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m12:30:16.817208 [debug] [MainThread]: Command end result
[0m12:30:16.852217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m12:30:16.856427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m12:30:16.875996 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m12:30:16.876951 [info ] [MainThread]: 
[0m12:30:16.879022 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:30:16.880225 [info ] [MainThread]: 
[0m12:30:16.881234 [error] [MainThread]:   Compilation Error in model model_mart_customer_acquisition (models\mart\model_mart_customer_acquisition.sql)
  No materialization 'Table' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m12:30:16.882301 [info ] [MainThread]: 
[0m12:30:16.883216 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m12:30:16.884870 [debug] [MainThread]: Command `dbt run` failed at 12:30:16.884521 after 2.66 seconds
[0m12:30:16.885606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215360CA090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021535478E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215361CCEF0>]}
[0m12:30:16.886198 [debug] [MainThread]: Flushing usage events
[0m12:30:20.187423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:23.502072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1626A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC171E7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC173D7ED0>]}


============================== 20:21:23.511500 | ddee21ca-8896-4cc3-be44-c9ced50da9eb ==============================
[0m20:21:23.511500 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:21:23.513301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:21:23.837134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddee21ca-8896-4cc3-be44-c9ced50da9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC169110F0>]}
[0m20:21:23.918660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddee21ca-8896-4cc3-be44-c9ced50da9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17297AC0>]}
[0m20:21:23.924248 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m20:21:24.546959 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:21:24.813610 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 0 files changed.
[0m20:21:24.814878 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\mart\marketing\model_mart_campaign_performance.sql
[0m20:21:24.815660 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\mart\marketing\model_mart_customer_acquisition.sql
[0m20:21:24.816299 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\mart\model_mart_customer_acquisition.sql
[0m20:21:24.817173 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\mart\test.sql
[0m20:21:24.817929 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\mart\model_mart_campaign_performance.sql
[0m20:21:25.200969 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m20:21:25.202257 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m20:21:25.203431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ddee21ca-8896-4cc3-be44-c9ced50da9eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC174A6450>]}
[0m20:21:25.227063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddee21ca-8896-4cc3-be44-c9ced50da9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC172FDD60>]}
[0m20:21:25.352269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m20:21:25.411265 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m20:21:25.453753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddee21ca-8896-4cc3-be44-c9ced50da9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC173EA350>]}
[0m20:21:25.454591 [info ] [MainThread]: Found 14 models, 5 sources, 429 macros
[0m20:21:25.455470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddee21ca-8896-4cc3-be44-c9ced50da9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC18BB58B0>]}
[0m20:21:25.458699 [info ] [MainThread]: 
[0m20:21:25.459366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:25.460235 [info ] [MainThread]: 
[0m20:21:25.461229 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:21:25.473442 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m20:21:25.648387 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:25.649076 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:25.649606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:25.819689 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:25.820222 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:21:25.822482 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:25.822836 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:25.823171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:25.946669 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:25.948028 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:21:25.950638 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:25.951033 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:25.951333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:26.080694 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:26.081360 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:21:26.086724 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:26.087231 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:26.087599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:26.228276 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:26.228993 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:21:26.244367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:26.244944 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m20:21:26.245397 [info ] [MainThread]: 
[0m20:21:26.246445 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m20:21:26.248481 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 23808)
[0m20:21:26.250783 [debug] [MainThread]: Command `dbt run` failed at 20:21:26.250503 after 3.26 seconds
[0m20:21:26.251350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17282D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC18BAAE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC18EE0730>]}
[0m20:21:26.251799 [debug] [MainThread]: Flushing usage events
[0m20:21:28.015731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:35.478248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35E28A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35F207890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35F3F7ED0>]}


============================== 20:21:35.484695 | 63c7d842-25d4-4b63-aafb-a98729551f81 ==============================
[0m20:21:35.484695 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:21:35.486234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:21:35.726093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35E9390F0>]}
[0m20:21:35.798167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35F2B3AC0>]}
[0m20:21:35.802124 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m20:21:36.006678 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:21:36.218139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:21:36.219275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:21:36.220534 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m20:21:36.221882 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m20:21:36.223048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35F4C8850>]}
[0m20:21:36.312261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3607BA5D0>]}
[0m20:21:36.415160 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m20:21:36.417973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m20:21:36.446785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3609C11D0>]}
[0m20:21:36.447561 [info ] [MainThread]: Found 14 models, 5 sources, 429 macros
[0m20:21:36.448701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36099C1F0>]}
[0m20:21:36.451607 [info ] [MainThread]: 
[0m20:21:36.452723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:36.453388 [info ] [MainThread]: 
[0m20:21:36.454717 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:21:36.466953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m20:21:36.571707 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:36.572570 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:36.573150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:36.722624 [debug] [ThreadPool]: SQL status: OK in 0.149 seconds
[0m20:21:36.726787 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:21:36.731689 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:36.732873 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:36.733611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.735964 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:21:36.737951 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:21:36.740852 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:36.741536 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:36.741997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.743524 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.745911 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:21:36.750249 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m20:21:36.750980 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m20:21:36.751462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.753260 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:21:36.755442 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m20:21:36.756902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m20:21:36.758689 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m20:21:36.772397 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:21:36.773128 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:21:36.773549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.774959 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.777092 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:21:36.777694 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m20:21:36.779293 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.780322 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:21:36.781556 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m20:21:36.783848 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.786246 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m20:21:36.787052 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m20:21:36.787766 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m20:21:36.788906 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.789697 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m20:21:36.790944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m20:21:36.792030 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m20:21:36.796814 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:21:36.797454 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:21:36.797876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.799063 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.801001 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:21:36.801453 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m20:21:36.802047 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.802390 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:21:36.802734 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m20:21:36.803361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.804557 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m20:21:36.804985 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m20:21:36.805332 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m20:21:36.805918 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.806284 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m20:21:36.806973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_report)
[0m20:21:36.807876 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m20:21:36.810730 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:21:36.811271 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:21:36.811777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.813473 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.815989 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:21:36.816443 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m20:21:36.817074 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.817520 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:21:36.817903 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m20:21:36.818529 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.819786 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m20:21:36.820210 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m20:21:36.820594 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m20:21:36.821274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.821678 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m20:21:36.822383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_mart)
[0m20:21:36.822969 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m20:21:36.825083 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:21:36.825576 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m20:21:36.825921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.826947 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.828807 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:21:36.829407 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m20:21:36.830204 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.830653 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:21:36.831135 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m20:21:36.831893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.833163 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m20:21:36.833534 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m20:21:36.833865 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m20:21:36.834387 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:36.834792 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m20:21:36.837708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m20:21:36.844477 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m20:21:36.844879 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m20:21:36.845146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:36.845926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.846330 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m20:21:36.846652 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:21:36.869247 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:21:36.872095 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m20:21:36.874802 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m20:21:36.875276 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m20:21:36.876062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m20:21:36.880522 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m20:21:36.881150 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m20:21:36.881596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.882519 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.883064 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m20:21:36.883511 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:21:36.888810 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:21:36.891581 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m20:21:36.892780 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m20:21:36.893379 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m20:21:36.894236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m20:21:36.898096 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m20:21:36.898715 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m20:21:36.899654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.901150 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.901690 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m20:21:36.902169 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:21:36.906958 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:21:36.909016 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m20:21:36.910207 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m20:21:36.910686 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m20:21:36.912030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_mart)
[0m20:21:36.914740 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m20:21:36.915100 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m20:21:36.915364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:36.916018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:36.916403 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m20:21:36.916805 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m20:21:36.925562 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:21:36.927859 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m20:21:36.928919 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m20:21:36.929483 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m20:21:36.931276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3608B9310>]}
[0m20:21:36.932213 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:36.932644 [debug] [MainThread]: On master: BEGIN
[0m20:21:36.933016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:36.933791 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:21:36.934203 [debug] [MainThread]: On master: COMMIT
[0m20:21:36.934579 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:36.934930 [debug] [MainThread]: On master: COMMIT
[0m20:21:36.935530 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:36.935912 [debug] [MainThread]: On master: Close
[0m20:21:36.940343 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m20:21:36.941114 [info ] [Thread-1 (]: 1 of 14 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m20:21:36.943029 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m20:21:36.943509 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m20:21:36.953167 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:36.955603 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m20:21:37.008349 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:37.011639 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:37.012496 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m20:21:37.013045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:21:37.014076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.014788 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:37.015435 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m20:21:37.017250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.024647 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:37.025107 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m20:21:37.026585 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.030117 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:37.030698 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m20:21:37.031542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.045816 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m20:21:37.046460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:37.046839 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m20:21:37.051862 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:21:37.057753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m20:21:37.058192 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m20:21:37.062204 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.065243 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m20:21:37.068456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36096BE30>]}
[0m20:21:37.069440 [info ] [Thread-1 (]: 1 of 14 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.12s]
[0m20:21:37.070883 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m20:21:37.071420 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m20:21:37.071976 [info ] [Thread-1 (]: 2 of 14 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m20:21:37.073328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m20:21:37.073847 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m20:21:37.076394 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.078260 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m20:21:37.082448 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.084332 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.085015 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m20:21:37.085498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.086488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.086983 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.087413 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m20:21:37.088952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.093068 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.094140 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m20:21:37.096380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.102043 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.102744 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m20:21:37.104058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.108562 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m20:21:37.109749 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.110380 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m20:21:37.114706 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:21:37.118334 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m20:21:37.118743 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m20:21:37.122210 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.123712 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m20:21:37.124508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360DF80F0>]}
[0m20:21:37.125233 [info ] [Thread-1 (]: 2 of 14 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m20:21:37.127474 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m20:21:37.127936 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m20:21:37.128909 [info ] [Thread-1 (]: 3 of 14 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m20:21:37.130699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m20:21:37.131581 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m20:21:37.134339 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.135854 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m20:21:37.139732 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.142678 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.143631 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m20:21:37.144375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.145873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.146700 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.147310 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m20:21:37.148842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.155314 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.156065 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m20:21:37.157027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.160098 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.160713 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m20:21:37.161676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.165077 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m20:21:37.166057 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.166661 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m20:21:37.170769 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.174587 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m20:21:37.175283 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m20:21:37.179226 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.182525 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m20:21:37.183311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360CBD350>]}
[0m20:21:37.184060 [info ] [Thread-1 (]: 3 of 14 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m20:21:37.185796 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m20:21:37.186403 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m20:21:37.186938 [info ] [Thread-1 (]: 4 of 14 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m20:21:37.188564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m20:21:37.189046 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m20:21:37.192070 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.193092 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m20:21:37.197857 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.200366 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.201075 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m20:21:37.201551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.202385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.202779 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.203185 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m20:21:37.204205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.207984 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.208368 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m20:21:37.209081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.211881 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.212423 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.213859 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.216586 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m20:21:37.217154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.217589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m20:21:37.221949 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:21:37.227281 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m20:21:37.228106 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m20:21:37.232431 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:21:37.237823 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m20:21:37.239372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360E95B70>]}
[0m20:21:37.241020 [info ] [Thread-1 (]: 4 of 14 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m20:21:37.242447 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m20:21:37.243014 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m20:21:37.243665 [info ] [Thread-1 (]: 5 of 14 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m20:21:37.245034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m20:21:37.246101 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m20:21:37.252738 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.254068 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m20:21:37.257650 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.259005 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.259523 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m20:21:37.260030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.260879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.261318 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.261779 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m20:21:37.263215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.338756 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.339559 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m20:21:37.341032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.345906 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.346632 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m20:21:37.347800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.349503 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m20:21:37.349979 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.350336 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m20:21:37.354359 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:21:37.357386 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m20:21:37.358141 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m20:21:37.361880 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.364674 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m20:21:37.365324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35DDA4770>]}
[0m20:21:37.365966 [info ] [Thread-1 (]: 5 of 14 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.12s]
[0m20:21:37.368272 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m20:21:37.368855 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_first_campaign_touch
[0m20:21:37.369420 [info ] [Thread-1 (]: 6 of 14 START sql view model intermediate.model_int_first_campaign_touch ....... [RUN]
[0m20:21:37.371036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_first_campaign_touch)
[0m20:21:37.371525 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_first_campaign_touch
[0m20:21:37.375499 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.377730 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_first_campaign_touch
[0m20:21:37.384659 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.387119 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.387625 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: BEGIN
[0m20:21:37.388082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.388890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.389339 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.389696 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */

  
  create view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" as (
    with first_interaction as (
  select
    customer_id,
    campaign_id,
    min(interaction_datetime) as first_interaction_time
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type in ('click', 'impression') and is_new_customer = TRUE
  group by customer_id, campaign_id
)

select * from first_interaction
  );

[0m20:21:37.392652 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:37.398534 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.399245 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch" rename to "model_int_first_campaign_touch__dbt_backup"
[0m20:21:37.400332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.405867 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.406588 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
alter view "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_tmp" rename to "model_int_first_campaign_touch"
[0m20:21:37.407560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.409812 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m20:21:37.410783 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.411677 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: COMMIT
[0m20:21:37.416526 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:21:37.420286 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_first_campaign_touch"
[0m20:21:37.421125 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_first_campaign_touch"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_first_campaign_touch__dbt_backup" cascade
[0m20:21:37.425214 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.426864 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_first_campaign_touch: Close
[0m20:21:37.427515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360C27530>]}
[0m20:21:37.428274 [info ] [Thread-1 (]: 6 of 14 OK created sql view model intermediate.model_int_first_campaign_touch .. [[32mOK[0m in 0.06s]
[0m20:21:37.429887 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_first_campaign_touch
[0m20:21:37.430537 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_conversions
[0m20:21:37.431211 [info ] [Thread-1 (]: 7 of 14 START sql view model intermediate.model_int_campaign_conversions ....... [RUN]
[0m20:21:37.432459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_first_campaign_touch, now model.ae_exam_project.model_int_campaign_conversions)
[0m20:21:37.433100 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_conversions
[0m20:21:37.440141 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.442685 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_conversions
[0m20:21:37.448605 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.449988 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.450572 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: BEGIN
[0m20:21:37.451033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.451746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.452113 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.452492 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" as (
    with interactions as (
  select distinct
    interaction_datetime,
    campaign_id,
    customer_id,
    order_id,
    revenue
  from "ae_exam_db"."staging"."model_stg_campaign_interactions"
  where event_type = 'conversion'
),
orders as (
  select * from "ae_exam_db"."staging"."model_stg_order_transactions"
),
joined as (
  select distinct
    i.interaction_datetime,
    i.campaign_id,
    i.customer_id,
    i.order_id,
    i.revenue,
    o.order_datetime,
    o.total_amount
  from interactions i
  left join orders o on i.order_id = o.order_id
  where o.order_status = 'completed'
          
)

select * from joined
  );

[0m20:21:37.454979 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:37.458754 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.459210 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions" rename to "model_int_campaign_conversions__dbt_backup"
[0m20:21:37.460098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.465382 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.466047 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_tmp" rename to "model_int_campaign_conversions"
[0m20:21:37.467050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.470270 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m20:21:37.471888 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.472702 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: COMMIT
[0m20:21:37.476505 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.480590 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_conversions"
[0m20:21:37.481412 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_conversions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_conversions__dbt_backup" cascade
[0m20:21:37.485938 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:21:37.487502 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_conversions: Close
[0m20:21:37.488046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360CF58B0>]}
[0m20:21:37.488623 [info ] [Thread-1 (]: 7 of 14 OK created sql view model intermediate.model_int_campaign_conversions .. [[32mOK[0m in 0.06s]
[0m20:21:37.489991 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_conversions
[0m20:21:37.490537 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m20:21:37.491243 [info ] [Thread-1 (]: 8 of 14 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m20:21:37.492390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_conversions, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m20:21:37.492841 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m20:21:37.497102 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.498401 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m20:21:37.501918 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.503286 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.503870 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m20:21:37.504331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.505138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.505527 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.505925 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m20:21:37.513101 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:21:37.519717 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.521319 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m20:21:37.523188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.527504 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.528000 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m20:21:37.529516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.533121 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m20:21:37.533709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.534158 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m20:21:37.538077 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.541003 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m20:21:37.541552 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m20:21:37.545595 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.548039 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m20:21:37.548900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3605BF410>]}
[0m20:21:37.549850 [info ] [Thread-1 (]: 8 of 14 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.06s]
[0m20:21:37.551481 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m20:21:37.552386 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m20:21:37.553486 [info ] [Thread-1 (]: 9 of 14 START sql view model intermediate.model_int_customer_sessions .......... [RUN]
[0m20:21:37.555097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m20:21:37.555976 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m20:21:37.560187 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m20:21:37.562406 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m20:21:37.569392 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m20:21:37.571136 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m20:21:37.571934 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m20:21:37.572375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.573120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.573520 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m20:21:37.573972 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m20:21:37.576115 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:37.581571 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m20:21:37.582775 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m20:21:37.584834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.586969 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m20:21:37.587535 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m20:21:37.588099 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m20:21:37.591982 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.595153 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m20:21:37.596089 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m20:21:37.597249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.599398 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m20:21:37.600289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360564050>]}
[0m20:21:37.601164 [info ] [Thread-1 (]: 9 of 14 OK created sql view model intermediate.model_int_customer_sessions ..... [[32mOK[0m in 0.05s]
[0m20:21:37.602752 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m20:21:37.603690 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_new_customer_converted
[0m20:21:37.604577 [info ] [Thread-1 (]: 10 of 14 START sql view model intermediate.model_int_new_customer_converted .... [RUN]
[0m20:21:37.605953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_new_customer_converted)
[0m20:21:37.606854 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_new_customer_converted
[0m20:21:37.612949 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.616262 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_new_customer_converted
[0m20:21:37.622637 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.624904 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.625714 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: BEGIN
[0m20:21:37.626417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.627269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.627770 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.628423 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */

  
  create view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" as (
    with new_customers_converted as (
  select distinct 
    icc.campaign_id,
    date(icc.interaction_datetime) as date,
    icc.customer_id
    --count(icc.customer_id) as new_customers,
  from "ae_exam_db"."intermediate"."model_int_campaign_conversions" icc
  inner join "ae_exam_db"."staging"."model_stg_campaign_interactions" sci 
  on icc.customer_id = sci.customer_id
  where sci.is_new_customer = TRUE
  --group by icc.campaign_id, date(icc.interaction_datetime)
)

select * from new_customers_converted
  );

[0m20:21:37.632305 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.636612 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.637542 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted" rename to "model_int_new_customer_converted__dbt_backup"
[0m20:21:37.638972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.643368 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.643801 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
alter view "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_tmp" rename to "model_int_new_customer_converted"
[0m20:21:37.644624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.646714 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m20:21:37.648088 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.650422 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: COMMIT
[0m20:21:37.655727 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:21:37.661715 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_new_customer_converted"
[0m20:21:37.662941 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_new_customer_converted"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_new_customer_converted__dbt_backup" cascade
[0m20:21:37.667461 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.670127 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_new_customer_converted: Close
[0m20:21:37.671085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3605BC6B0>]}
[0m20:21:37.672214 [info ] [Thread-1 (]: 10 of 14 OK created sql view model intermediate.model_int_new_customer_converted  [[32mOK[0m in 0.07s]
[0m20:21:37.673649 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_new_customer_converted
[0m20:21:37.674278 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m20:21:37.675149 [info ] [Thread-1 (]: 11 of 14 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m20:21:37.676355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_new_customer_converted, now model.ae_exam_project.model_mart_campaign_performance)
[0m20:21:37.677150 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m20:21:37.684037 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.686565 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m20:21:37.728655 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.731937 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.732929 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m20:21:37.733608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.734735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.735378 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.736120 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m20:21:37.813969 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m20:21:37.818180 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.818606 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m20:21:37.820322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.823758 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.824276 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m20:21:37.825206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:37.832733 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m20:21:37.833314 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.833711 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m20:21:37.841683 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:21:37.845975 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m20:21:37.847069 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m20:21:37.851030 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:37.852587 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m20:21:37.853161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360CF7F50>]}
[0m20:21:37.853747 [info ] [Thread-1 (]: 11 of 14 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.18s]
[0m20:21:37.854879 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m20:21:37.855393 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m20:21:37.855911 [info ] [Thread-1 (]: 12 of 14 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m20:21:37.856890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m20:21:37.857569 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m20:21:37.867086 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m20:21:37.868917 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m20:21:37.873867 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m20:21:37.875734 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m20:21:37.876348 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m20:21:37.876842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:37.877625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:37.878102 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m20:21:37.879184 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m20:21:38.143311 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m20:21:38.146562 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m20:21:38.147038 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m20:21:38.147947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:38.149858 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m20:21:38.150295 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m20:21:38.150760 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m20:21:38.158191 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:21:38.160619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m20:21:38.161103 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m20:21:38.161906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:38.163743 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m20:21:38.164350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360613E90>]}
[0m20:21:38.164972 [info ] [Thread-1 (]: 12 of 14 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.31s]
[0m20:21:38.167051 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m20:21:38.167605 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m20:21:38.168117 [info ] [Thread-1 (]: 13 of 14 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m20:21:38.169713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.report_campaign_effectiveness)
[0m20:21:38.170188 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m20:21:38.173047 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.174889 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m20:21:38.179805 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.181848 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.182768 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m20:21:38.183988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:38.185534 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:38.186058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.186466 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m20:21:38.194766 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:21:38.199733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.200360 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m20:21:38.201408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:38.204453 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.204857 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m20:21:38.205557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:38.208261 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m20:21:38.209045 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.209661 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m20:21:38.216665 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:21:38.220516 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m20:21:38.221069 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m20:21:38.224619 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:38.226132 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m20:21:38.226621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360613E90>]}
[0m20:21:38.227196 [info ] [Thread-1 (]: 13 of 14 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.06s]
[0m20:21:38.228814 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m20:21:38.229861 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m20:21:38.231419 [info ] [Thread-1 (]: 14 of 14 START sql table model report.report_customer _acquisition ............. [RUN]
[0m20:21:38.233310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m20:21:38.234124 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m20:21:38.237539 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m20:21:38.238725 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m20:21:38.244807 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m20:21:38.247427 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m20:21:38.249251 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m20:21:38.250481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:38.251804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:38.252344 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m20:21:38.252789 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m20:21:38.264362 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:21:38.270480 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m20:21:38.271111 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m20:21:38.272246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:38.274501 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m20:21:38.275222 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m20:21:38.275729 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m20:21:38.289677 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:21:38.293579 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m20:21:38.294266 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m20:21:38.295923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:38.300862 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m20:21:38.301887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7d842-25d4-4b63-aafb-a98729551f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360566930>]}
[0m20:21:38.303077 [info ] [Thread-1 (]: 14 of 14 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.07s]
[0m20:21:38.304617 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m20:21:38.307332 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:38.308218 [debug] [MainThread]: On master: BEGIN
[0m20:21:38.308951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:38.310004 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:21:38.310502 [debug] [MainThread]: On master: COMMIT
[0m20:21:38.310945 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:38.312115 [debug] [MainThread]: On master: COMMIT
[0m20:21:38.313442 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:38.314865 [debug] [MainThread]: On master: Close
[0m20:21:38.316425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:38.317116 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m20:21:38.317676 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m20:21:38.318184 [debug] [MainThread]: Connection 'model.ae_exam_project.report_customer _acquisition' was properly closed.
[0m20:21:38.318914 [info ] [MainThread]: 
[0m20:21:38.320261 [info ] [MainThread]: Finished running 4 table models, 10 view models in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m20:21:38.324643 [debug] [MainThread]: Command end result
[0m20:21:38.370164 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m20:21:38.373187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m20:21:38.385836 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m20:21:38.386569 [info ] [MainThread]: 
[0m20:21:38.387573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:21:38.388547 [info ] [MainThread]: 
[0m20:21:38.389452 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m20:21:38.391373 [debug] [MainThread]: Command `dbt run` succeeded at 20:21:38.391003 after 3.13 seconds
[0m20:21:38.392260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35C5817F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360613AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E360C27650>]}
[0m20:21:38.392806 [debug] [MainThread]: Flushing usage events
[0m20:21:39.654730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:07.616553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720813A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272090B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272092A7ED0>]}


============================== 23:20:07.623104 | fce368da-f383-4746-b9c0-2131237392ef ==============================
[0m23:20:07.623104 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:20:07.624379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:07.906941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272087E10F0>]}
[0m23:20:07.983685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027209167AC0>]}
[0m23:20:07.987884 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:20:08.213065 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:20:08.355397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:20:08.356001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:20:08.356561 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m23:20:08.358156 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m23:20:08.359353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027209378850>]}
[0m23:20:08.423538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720A6DA5D0>]}
[0m23:20:08.514434 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:20:08.519079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:20:08.549389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720A8E0C90>]}
[0m23:20:08.550104 [info ] [MainThread]: Found 12 models, 5 sources, 429 macros
[0m23:20:08.550894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720A8C01F0>]}
[0m23:20:08.554162 [info ] [MainThread]: 
[0m23:20:08.555115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:20:08.555805 [info ] [MainThread]: 
[0m23:20:08.556938 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:20:08.568426 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m23:20:08.679769 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:20:08.680408 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:20:08.680819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:08.721991 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m23:20:08.724335 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:20:08.727730 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:20:08.728398 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:20:08.728807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.730563 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:20:08.732068 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:20:08.734762 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:20:08.735213 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:20:08.735549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.736777 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:20:08.738176 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:20:08.740988 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:20:08.741433 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:20:08.741801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.742988 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:20:08.744345 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:20:08.745570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m23:20:08.746793 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m23:20:08.754036 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:20:08.754447 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:20:08.754775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.756009 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:20:08.757480 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:20:08.757802 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m23:20:08.758318 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.758637 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:20:08.758943 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m23:20:08.761316 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:20:08.762607 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:20:08.763237 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:20:08.763651 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:20:08.764394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.764787 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m23:20:08.765406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m23:20:08.765916 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m23:20:08.767863 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:20:08.768291 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:20:08.768688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.769952 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:20:08.771703 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:20:08.772112 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m23:20:08.772719 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.773095 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:20:08.773575 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m23:20:08.774220 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.775318 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m23:20:08.775737 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:20:08.776090 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m23:20:08.776657 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.777037 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m23:20:08.777768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m23:20:08.778355 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m23:20:08.781074 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:20:08.781576 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:20:08.782002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.783259 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:20:08.784922 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:20:08.785303 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m23:20:08.785938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.786292 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:20:08.787023 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m23:20:08.787826 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.788970 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:20:08.789333 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:20:08.789647 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:20:08.790200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.790559 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m23:20:08.791305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m23:20:08.791934 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m23:20:08.794241 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:20:08.794659 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:20:08.795036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.796258 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:20:08.798061 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:20:08.798485 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m23:20:08.799089 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.799416 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:20:08.799779 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m23:20:08.800564 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.801722 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m23:20:08.802595 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:20:08.803392 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m23:20:08.804538 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:20:08.804968 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m23:20:08.808580 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m23:20:08.815044 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:20:08.815475 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m23:20:08.815780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:08.817258 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:20:08.817637 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:20:08.818061 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:20:08.842697 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m23:20:08.844785 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m23:20:08.846181 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m23:20:08.846677 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m23:20:08.847374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m23:20:08.849082 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:20:08.849592 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m23:20:08.849966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.851709 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:20:08.852150 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:20:08.852486 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:20:08.856515 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:20:08.858095 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m23:20:08.858829 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m23:20:08.859105 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m23:20:08.859595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m23:20:08.861313 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:20:08.861666 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m23:20:08.862062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.863673 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:20:08.864114 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:20:08.864432 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:20:08.868375 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:20:08.869795 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m23:20:08.870383 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m23:20:08.870656 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m23:20:08.871140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m23:20:08.873368 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:20:08.873732 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m23:20:08.874058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:08.875844 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:20:08.876218 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:20:08.876559 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:20:08.880949 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:20:08.882823 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m23:20:08.883614 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m23:20:08.883939 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m23:20:08.886382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720A7C1A90>]}
[0m23:20:08.887262 [debug] [MainThread]: Using duckdb connection "master"
[0m23:20:08.887867 [debug] [MainThread]: On master: BEGIN
[0m23:20:08.888387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:08.889437 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:20:08.890002 [debug] [MainThread]: On master: COMMIT
[0m23:20:08.890252 [debug] [MainThread]: Using duckdb connection "master"
[0m23:20:08.890479 [debug] [MainThread]: On master: COMMIT
[0m23:20:08.891024 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:20:08.891346 [debug] [MainThread]: On master: Close
[0m23:20:08.896670 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:20:08.897487 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m23:20:08.899136 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m23:20:08.899582 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m23:20:08.907482 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:08.911448 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m23:20:08.958197 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:08.961383 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:08.961983 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m23:20:08.962578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:20:08.963995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:08.964542 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:08.964967 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m23:20:08.966489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:08.973207 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:08.973960 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m23:20:08.976608 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:20:08.980734 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:08.981345 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m23:20:08.982439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:08.999562 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:20:09.000087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:09.000459 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:20:09.006283 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:20:09.011941 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:20:09.012426 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m23:20:09.017108 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:20:09.019862 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m23:20:09.022761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720A8A7E30>]}
[0m23:20:09.023708 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.12s]
[0m23:20:09.025729 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:20:09.026239 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m23:20:09.026804 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m23:20:09.028037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m23:20:09.028554 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m23:20:09.031933 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.033686 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m23:20:09.038462 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.040241 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.040983 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m23:20:09.041460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.042280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.042749 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.043169 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m23:20:09.044416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.050009 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.050562 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m23:20:09.051476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.055556 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.055979 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m23:20:09.056788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.058854 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:20:09.059346 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.059766 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:20:09.064184 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.068349 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:20:09.068996 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m23:20:09.072796 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.074614 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m23:20:09.075240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720AD220D0>]}
[0m23:20:09.075896 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m23:20:09.077389 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m23:20:09.077944 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m23:20:09.078545 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m23:20:09.079814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m23:20:09.081346 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m23:20:09.085698 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.087303 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m23:20:09.091280 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.093213 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.093883 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m23:20:09.094284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.095061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.095478 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.096040 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m23:20:09.098407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.102723 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.103474 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m23:20:09.104640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.107307 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.107690 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m23:20:09.108522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.109940 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m23:20:09.110350 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.110666 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m23:20:09.114702 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.119078 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:20:09.119493 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m23:20:09.122850 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.124744 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m23:20:09.125367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720ABB3DD0>]}
[0m23:20:09.126031 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m23:20:09.127094 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m23:20:09.127674 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:20:09.128272 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m23:20:09.129763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m23:20:09.131677 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:20:09.135779 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.137949 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:20:09.141549 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.143005 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.143651 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m23:20:09.144139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.144927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.145405 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.145824 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m23:20:09.149011 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:20:09.154104 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.154587 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m23:20:09.155393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.158612 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.158994 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.159858 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.161367 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m23:20:09.162049 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.163116 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m23:20:09.167719 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:20:09.171170 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:20:09.171914 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m23:20:09.175373 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.181210 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m23:20:09.183367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720AD858D0>]}
[0m23:20:09.184551 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m23:20:09.186498 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:20:09.187036 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m23:20:09.187559 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m23:20:09.188597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m23:20:09.189108 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m23:20:09.191718 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.193511 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m23:20:09.199819 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.201884 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.202634 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m23:20:09.203124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.204000 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.204501 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.204996 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m23:20:09.206812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.284511 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.285136 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m23:20:09.286096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.289133 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.289539 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m23:20:09.290995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.292675 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:20:09.293181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.293646 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:20:09.297011 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.299412 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:20:09.299825 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m23:20:09.303636 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.305717 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m23:20:09.306348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720ACC3350>]}
[0m23:20:09.306974 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.12s]
[0m23:20:09.308277 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m23:20:09.309656 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:20:09.310290 [info ] [Thread-1 (]: 6 of 12 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m23:20:09.311464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m23:20:09.311951 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:20:09.316395 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.318580 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:20:09.322349 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.324986 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.325626 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m23:20:09.326095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.326946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.327416 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.327905 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m23:20:09.334155 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:20:09.339630 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.340288 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m23:20:09.341370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.344934 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.345435 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m23:20:09.346807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.350493 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m23:20:09.351118 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.351803 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m23:20:09.356228 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.359210 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:20:09.359716 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m23:20:09.363081 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.367519 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m23:20:09.368750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720AB47950>]}
[0m23:20:09.369761 [info ] [Thread-1 (]: 6 of 12 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.06s]
[0m23:20:09.371291 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:20:09.372192 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m23:20:09.373282 [info ] [Thread-1 (]: 7 of 12 START sql view model intermediate.model_int_customer_sessions .......... [RUN]
[0m23:20:09.374648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m23:20:09.375199 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m23:20:09.379726 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.381691 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m23:20:09.387866 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.389780 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.390798 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m23:20:09.391528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.392680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.393169 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.393700 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m23:20:09.397197 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.402542 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.403555 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m23:20:09.405505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.409104 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.409532 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m23:20:09.410485 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.412501 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m23:20:09.413655 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.414386 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m23:20:09.418735 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:20:09.422910 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:20:09.423811 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m23:20:09.427845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:09.430561 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m23:20:09.431616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720ACC3410>]}
[0m23:20:09.433128 [info ] [Thread-1 (]: 7 of 12 OK created sql view model intermediate.model_int_customer_sessions ..... [[32mOK[0m in 0.06s]
[0m23:20:09.435076 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m23:20:09.435604 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m23:20:09.436198 [info ] [Thread-1 (]: 8 of 12 START sql table model mart.model_mart_campaign_performance ............. [RUN]
[0m23:20:09.437176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_mart_campaign_performance)
[0m23:20:09.437642 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m23:20:09.440966 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.443351 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m23:20:09.479994 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.483309 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.484787 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m23:20:09.485271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.486076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.486546 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.487049 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m23:20:09.553270 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m23:20:09.556102 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.556473 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m23:20:09.558851 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:20:09.562551 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.563204 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m23:20:09.564831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.570834 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m23:20:09.571334 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.571728 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m23:20:09.580867 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:20:09.584287 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:20:09.585020 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m23:20:09.589292 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:20:09.592036 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m23:20:09.593016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027209319EB0>]}
[0m23:20:09.593845 [info ] [Thread-1 (]: 8 of 12 OK created sql table model mart.model_mart_campaign_performance ........ [[32mOK[0m in 0.16s]
[0m23:20:09.595929 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m23:20:09.596668 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m23:20:09.597296 [info ] [Thread-1 (]: 9 of 12 START sql table model mart.model_mart_customer_acquisition ............. [RUN]
[0m23:20:09.598836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m23:20:09.599420 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m23:20:09.605803 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.608035 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m23:20:09.613966 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.618831 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.619869 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m23:20:09.620518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:09.621513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:09.622089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.622690 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m23:20:09.972785 [debug] [Thread-1 (]: SQL status: OK in 0.349 seconds
[0m23:20:09.975942 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.976393 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m23:20:09.977191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.980528 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.981085 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m23:20:09.981978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:20:09.984910 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m23:20:09.985503 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.985988 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m23:20:09.993567 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m23:20:09.996046 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:20:09.996608 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m23:20:10.000103 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:10.001597 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m23:20:10.002214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720A4DD4F0>]}
[0m23:20:10.002907 [info ] [Thread-1 (]: 9 of 12 OK created sql table model mart.model_mart_customer_acquisition ........ [[32mOK[0m in 0.40s]
[0m23:20:10.004207 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m23:20:10.004779 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m23:20:10.005372 [info ] [Thread-1 (]: 10 of 12 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m23:20:10.006447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m23:20:10.007096 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m23:20:10.011527 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:20:10.013807 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m23:20:10.019557 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:20:10.021550 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:20:10.022161 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m23:20:10.022605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:10.023589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:10.024142 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:20:10.024807 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,า
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m23:20:10.035544 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,า
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m23:20:10.036773 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:20:10.037784 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: ROLLBACK
[0m23:20:10.290471 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_retargeting _performance'
[0m23:20:10.290952 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m23:20:10.295018 [debug] [Thread-1 (]: Runtime Error in model model_mart_retargeting _performance (models\mart\marketing\model_mart_retargeting _performance.sql)
  Parser Error: syntax error at or near "("
[0m23:20:10.295548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720ACE27B0>]}
[0m23:20:10.296339 [error] [Thread-1 (]: 10 of 12 ERROR creating sql table model mart.model_mart_retargeting _performance  [[31mERROR[0m in 0.29s]
[0m23:20:10.298293 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m23:20:10.299198 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m23:20:10.300940 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_retargeting _performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_retargeting _performance (models\mart\marketing\model_mart_retargeting _performance.sql)
  Parser Error: syntax error at or near "(".
[0m23:20:10.299947 [info ] [Thread-1 (]: 11 of 12 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m23:20:10.303214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m23:20:10.303767 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m23:20:10.306967 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.308889 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m23:20:10.313192 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.315431 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.316133 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m23:20:10.316574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:10.317418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:10.318007 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.318646 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m23:20:10.336155 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m23:20:10.340422 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.340995 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m23:20:10.342040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:10.346364 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.347191 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m23:20:10.348698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:10.352128 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m23:20:10.352754 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.353262 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m23:20:10.362726 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:20:10.367842 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:20:10.368571 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m23:20:10.372108 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:10.373918 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m23:20:10.374465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720ADBAE70>]}
[0m23:20:10.375007 [info ] [Thread-1 (]: 11 of 12 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.07s]
[0m23:20:10.375955 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m23:20:10.376511 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m23:20:10.377085 [info ] [Thread-1 (]: 12 of 12 START sql table model report.report_customer _acquisition ............. [RUN]
[0m23:20:10.378778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m23:20:10.379483 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m23:20:10.383118 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.384404 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m23:20:10.387509 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.388621 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.389079 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m23:20:10.389504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:10.390258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:10.390623 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.390949 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m23:20:10.400537 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:20:10.410391 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.411041 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m23:20:10.412552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:10.418714 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.419300 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m23:20:10.420391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:20:10.423033 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m23:20:10.423722 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.424153 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m23:20:10.449343 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m23:20:10.452985 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:20:10.453491 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m23:20:10.457518 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:20:10.459654 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m23:20:10.460236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce368da-f383-4746-b9c0-2131237392ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027209319EB0>]}
[0m23:20:10.460875 [info ] [Thread-1 (]: 12 of 12 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.08s]
[0m23:20:10.462299 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m23:20:10.464817 [debug] [MainThread]: Using duckdb connection "master"
[0m23:20:10.465267 [debug] [MainThread]: On master: BEGIN
[0m23:20:10.465610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:10.466322 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:20:10.466697 [debug] [MainThread]: On master: COMMIT
[0m23:20:10.467015 [debug] [MainThread]: Using duckdb connection "master"
[0m23:20:10.467300 [debug] [MainThread]: On master: COMMIT
[0m23:20:10.467803 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:20:10.468145 [debug] [MainThread]: On master: Close
[0m23:20:10.468584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:10.468896 [debug] [MainThread]: Connection 'create_ae_exam_db_report' was properly closed.
[0m23:20:10.469155 [debug] [MainThread]: Connection 'list_ae_exam_db_report' was properly closed.
[0m23:20:10.469414 [debug] [MainThread]: Connection 'model.ae_exam_project.report_customer _acquisition' was properly closed.
[0m23:20:10.469812 [info ] [MainThread]: 
[0m23:20:10.470787 [info ] [MainThread]: Finished running 5 table models, 7 view models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m23:20:10.474606 [debug] [MainThread]: Command end result
[0m23:20:10.508643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:20:10.513229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:20:10.525412 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m23:20:10.526045 [info ] [MainThread]: 
[0m23:20:10.527022 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:20:10.528584 [info ] [MainThread]: 
[0m23:20:10.530081 [error] [MainThread]:   Runtime Error in model model_mart_retargeting _performance (models\mart\marketing\model_mart_retargeting _performance.sql)
  Parser Error: syntax error at or near "("
[0m23:20:10.531341 [info ] [MainThread]: 
[0m23:20:10.532448 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m23:20:10.534757 [debug] [MainThread]: Command `dbt run` failed at 23:20:10.534536 after 3.30 seconds
[0m23:20:10.535267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027208794530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720ACE0EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002720ADE7AD0>]}
[0m23:20:10.535742 [debug] [MainThread]: Flushing usage events
[0m23:20:13.750167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:59.360818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5AF28A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B0207890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B03F7ED0>]}


============================== 23:36:59.365897 | 35c12903-12e7-410f-9059-67d79e695fde ==============================
[0m23:36:59.365897 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:36:59.366885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:36:59.611780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5AF9310F0>]}
[0m23:36:59.684062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B02B7AC0>]}
[0m23:36:59.687978 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:36:59.910566 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:37:00.069912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:00.070404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:00.070940 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m23:37:00.072711 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m23:37:00.074356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B04CC850>]}
[0m23:37:00.126633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B183A5D0>]}
[0m23:37:00.211419 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:37:00.214726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:37:00.241166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1A34F30>]}
[0m23:37:00.241943 [info ] [MainThread]: Found 13 models, 5 sources, 429 macros
[0m23:37:00.242856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1A1C1F0>]}
[0m23:37:00.246003 [info ] [MainThread]: 
[0m23:37:00.247058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:00.247992 [info ] [MainThread]: 
[0m23:37:00.249445 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:37:00.257945 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m23:37:00.364438 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:37:00.365106 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:37:00.365440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:00.396987 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m23:37:00.399487 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:37:00.401857 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:37:00.402328 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:37:00.402726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.404006 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.405315 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:37:00.407209 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:37:00.407801 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:37:00.408353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.410107 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:37:00.411501 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:37:00.414395 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m23:37:00.415100 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m23:37:00.415797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.417510 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:37:00.418976 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m23:37:00.420275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m23:37:00.420823 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m23:37:00.428033 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:37:00.428599 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:37:00.429036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.430060 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.431749 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:37:00.432100 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m23:37:00.432647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.432918 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:37:00.433248 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m23:37:00.433936 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.435066 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m23:37:00.435398 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m23:37:00.435664 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m23:37:00.436156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.436475 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m23:37:00.437184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m23:37:00.437699 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m23:37:00.439725 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:37:00.440342 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:37:00.440709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.441658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.443027 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:37:00.443413 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m23:37:00.444503 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.444917 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:37:00.445220 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m23:37:00.445796 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.446944 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:37:00.447470 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m23:37:00.447887 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m23:37:00.449131 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.449724 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m23:37:00.450364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m23:37:00.450870 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m23:37:00.452849 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:37:00.453171 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:37:00.453474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.454643 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.456183 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:37:00.456544 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m23:37:00.457145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.457524 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:37:00.457880 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m23:37:00.458471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.459770 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:37:00.460135 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m23:37:00.460435 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m23:37:00.460932 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.461304 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m23:37:00.461965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m23:37:00.462464 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m23:37:00.464489 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:37:00.464939 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m23:37:00.465246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.466310 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.467937 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:37:00.468367 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m23:37:00.468968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.469275 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:37:00.469604 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m23:37:00.470183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.471135 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m23:37:00.471831 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m23:37:00.472286 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m23:37:00.472850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:00.473205 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m23:37:00.476443 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m23:37:00.482671 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:37:00.483076 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m23:37:00.483378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:00.484446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.484939 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m23:37:00.485305 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:37:00.508212 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m23:37:00.511485 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m23:37:00.512976 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m23:37:00.513720 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m23:37:00.514617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m23:37:00.516450 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:37:00.516851 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m23:37:00.517249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.518796 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:37:00.519165 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m23:37:00.519472 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:37:00.523119 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:37:00.524519 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m23:37:00.525134 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m23:37:00.525410 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m23:37:00.525877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m23:37:00.527835 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:37:00.528273 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m23:37:00.528629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.529902 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:00.530368 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m23:37:00.530761 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:37:00.535548 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:37:00.537418 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m23:37:00.538122 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m23:37:00.538453 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m23:37:00.538996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m23:37:00.541215 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:37:00.541580 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m23:37:00.541900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:00.543655 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:37:00.544084 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m23:37:00.544432 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m23:37:00.549312 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:37:00.551223 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m23:37:00.551916 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m23:37:00.552236 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m23:37:00.553797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B191D850>]}
[0m23:37:00.554329 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:00.554675 [debug] [MainThread]: On master: BEGIN
[0m23:37:00.554957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:00.555550 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:37:00.555836 [debug] [MainThread]: On master: COMMIT
[0m23:37:00.556143 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:00.556436 [debug] [MainThread]: On master: COMMIT
[0m23:37:00.556930 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:00.557285 [debug] [MainThread]: On master: Close
[0m23:37:00.561062 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:37:00.561702 [info ] [Thread-1 (]: 1 of 13 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m23:37:00.563244 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m23:37:00.563812 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m23:37:00.571930 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.573028 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m23:37:00.617549 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.618931 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.619574 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m23:37:00.620028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:00.620823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.621236 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.621733 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m23:37:00.623062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.630105 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.630821 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m23:37:00.631880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.634959 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.635359 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m23:37:00.636098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:00.651030 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:37:00.651577 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.651966 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m23:37:00.657452 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:37:00.663432 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m23:37:00.664028 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m23:37:00.671058 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:37:00.674098 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m23:37:00.676920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1A03B70>]}
[0m23:37:00.677848 [info ] [Thread-1 (]: 1 of 13 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.11s]
[0m23:37:00.679583 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m23:37:00.680138 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m23:37:00.680757 [info ] [Thread-1 (]: 2 of 13 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m23:37:00.682065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m23:37:00.682603 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m23:37:00.686234 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.688637 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m23:37:00.693917 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.696255 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.697895 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m23:37:00.699045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:00.700205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.701251 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.702636 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m23:37:00.704244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.707252 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.707793 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m23:37:00.708764 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:00.712554 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.712986 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m23:37:00.713756 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:00.715966 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:37:00.716408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.716927 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m23:37:00.721176 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:37:00.725438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m23:37:00.726228 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m23:37:00.730567 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:37:00.734267 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m23:37:00.735285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1E840F0>]}
[0m23:37:00.736002 [info ] [Thread-1 (]: 2 of 13 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m23:37:00.737323 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m23:37:00.737977 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m23:37:00.738516 [info ] [Thread-1 (]: 3 of 13 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m23:37:00.739503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m23:37:00.740024 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m23:37:00.742819 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.744487 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m23:37:00.750127 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.751761 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.752402 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m23:37:00.752866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:00.753704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.754155 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.754600 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m23:37:00.755903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.761187 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.761983 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m23:37:00.763282 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.770114 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.770812 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m23:37:00.771940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.773995 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m23:37:00.774460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.774849 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m23:37:00.778462 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:00.783410 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m23:37:00.784518 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m23:37:00.788742 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:00.791054 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m23:37:00.792021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1D3A150>]}
[0m23:37:00.793543 [info ] [Thread-1 (]: 3 of 13 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m23:37:00.795695 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m23:37:00.796484 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:37:00.798021 [info ] [Thread-1 (]: 4 of 13 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m23:37:00.799301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m23:37:00.800029 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:37:00.804104 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.805414 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:37:00.809405 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.811183 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.812020 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m23:37:00.813002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:00.814894 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:37:00.815679 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.816257 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m23:37:00.817652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.822513 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.823673 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m23:37:00.825089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.829914 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.830637 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.831846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.834669 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m23:37:00.836170 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.836974 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m23:37:00.841339 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:37:00.843501 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m23:37:00.844081 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m23:37:00.848393 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:00.853572 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m23:37:00.854167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1EE5B70>]}
[0m23:37:00.854773 [info ] [Thread-1 (]: 4 of 13 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.06s]
[0m23:37:00.856045 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m23:37:00.856649 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m23:37:00.857524 [info ] [Thread-1 (]: 5 of 13 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m23:37:00.858443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m23:37:00.858948 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m23:37:00.862996 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.864463 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m23:37:00.867910 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.869208 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.869784 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m23:37:00.870260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:00.871065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.871521 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.871908 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m23:37:00.873166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.940323 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.940885 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m23:37:00.942003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:00.945143 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.945535 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m23:37:00.946235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:00.948173 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:37:00.948644 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.949004 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m23:37:00.952975 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:00.955891 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m23:37:00.956511 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m23:37:00.960008 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:00.962613 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m23:37:00.963321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1E23710>]}
[0m23:37:00.964110 [info ] [Thread-1 (]: 5 of 13 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.10s]
[0m23:37:00.965962 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m23:37:00.967802 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:37:00.968468 [info ] [Thread-1 (]: 6 of 13 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m23:37:00.969469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m23:37:00.969986 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:37:00.974711 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:00.976478 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:37:00.982347 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:00.984806 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:00.985617 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m23:37:00.986052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:00.986979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:00.987710 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:00.988267 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m23:37:00.990898 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:37:00.994994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:00.995520 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m23:37:00.996367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:01.000060 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:01.000509 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m23:37:01.001393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:01.003643 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m23:37:01.004667 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:01.005902 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m23:37:01.010460 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:01.013264 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m23:37:01.014215 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m23:37:01.019175 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:37:01.021392 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m23:37:01.022003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5AD3EC590>]}
[0m23:37:01.022708 [info ] [Thread-1 (]: 6 of 13 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.05s]
[0m23:37:01.024925 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m23:37:01.025388 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m23:37:01.025916 [info ] [Thread-1 (]: 7 of 13 START sql view model intermediate.model_int_customer_sessions .......... [RUN]
[0m23:37:01.027599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m23:37:01.028498 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m23:37:01.034514 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.036135 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m23:37:01.039461 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.040676 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.041292 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m23:37:01.041782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:01.042562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:01.042976 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.043473 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m23:37:01.045949 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:37:01.050878 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.051476 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m23:37:01.052587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:01.056883 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.057785 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m23:37:01.059190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:01.060879 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m23:37:01.061484 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.062021 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m23:37:01.065931 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:01.069913 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m23:37:01.070644 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m23:37:01.074437 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:01.075936 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m23:37:01.076460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B1CF77D0>]}
[0m23:37:01.077166 [info ] [Thread-1 (]: 7 of 13 OK created sql view model intermediate.model_int_customer_sessions ..... [[32mOK[0m in 0.05s]
[0m23:37:01.078994 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m23:37:01.079441 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m23:37:01.080215 [info ] [Thread-1 (]: 8 of 13 START sql table model mart.model_mart_campaign_performance ............. [RUN]
[0m23:37:01.081414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_mart_campaign_performance)
[0m23:37:01.082160 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m23:37:01.087807 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.089062 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m23:37:01.122109 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.123452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.124091 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m23:37:01.124614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:01.125485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:01.125992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.126505 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m23:37:01.188035 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m23:37:01.191519 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.191989 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m23:37:01.194098 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:37:01.198399 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.198936 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m23:37:01.199856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:01.205308 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m23:37:01.205750 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.206095 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m23:37:01.214556 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m23:37:01.217130 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m23:37:01.217675 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m23:37:01.221438 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:01.223103 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m23:37:01.223768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B05BB830>]}
[0m23:37:01.224489 [info ] [Thread-1 (]: 8 of 13 OK created sql table model mart.model_mart_campaign_performance ........ [[32mOK[0m in 0.14s]
[0m23:37:01.225754 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m23:37:01.226445 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m23:37:01.227236 [info ] [Thread-1 (]: 9 of 13 START sql table model mart.model_mart_customer_acquisition ............. [RUN]
[0m23:37:01.228441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m23:37:01.228956 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m23:37:01.233466 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.234730 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m23:37:01.238205 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.239460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.240035 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m23:37:01.240491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:01.241257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:01.241707 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.242817 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m23:37:01.668515 [debug] [Thread-1 (]: SQL status: OK in 0.424 seconds
[0m23:37:01.673439 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.674186 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m23:37:01.675505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:01.681623 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.682302 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m23:37:01.683296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:01.685057 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m23:37:01.685537 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.685955 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m23:37:01.693352 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m23:37:01.696064 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m23:37:01.696676 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m23:37:01.700188 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:01.701940 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m23:37:01.702580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B05B8F50>]}
[0m23:37:01.703221 [info ] [Thread-1 (]: 9 of 13 OK created sql table model mart.model_mart_customer_acquisition ........ [[32mOK[0m in 0.47s]
[0m23:37:01.704388 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m23:37:01.704939 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m23:37:01.705565 [info ] [Thread-1 (]: 10 of 13 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m23:37:01.706597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m23:37:01.707215 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m23:37:01.712630 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:37:01.714547 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m23:37:01.723107 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:37:01.725081 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:37:01.725767 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m23:37:01.726355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:01.727626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:01.728569 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:37:01.729269 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m23:37:02.246126 [debug] [Thread-1 (]: SQL status: OK in 0.516 seconds
[0m23:37:02.254458 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:37:02.255715 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m23:37:02.257037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:02.259159 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m23:37:02.259759 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:37:02.260267 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m23:37:02.265013 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:37:02.269799 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m23:37:02.270541 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m23:37:02.271576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:02.273442 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m23:37:02.274222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B057E5D0>]}
[0m23:37:02.275024 [info ] [Thread-1 (]: 10 of 13 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.57s]
[0m23:37:02.276380 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m23:37:02.277040 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m23:37:02.277851 [info ] [Thread-1 (]: 11 of 13 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m23:37:02.278727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m23:37:02.279244 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m23:37:02.285410 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.287651 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m23:37:02.295085 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.297161 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.298905 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m23:37:02.300104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:02.301819 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:37:02.302753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.303657 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m23:37:02.317212 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m23:37:02.321960 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.323173 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m23:37:02.325173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:02.329824 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.331133 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m23:37:02.334198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:02.337830 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m23:37:02.338436 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.338904 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m23:37:02.345103 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:37:02.348447 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m23:37:02.349443 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m23:37:02.353058 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:02.354854 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m23:37:02.355491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B05BBE90>]}
[0m23:37:02.356199 [info ] [Thread-1 (]: 11 of 13 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.08s]
[0m23:37:02.357417 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m23:37:02.358131 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m23:37:02.358960 [info ] [Thread-1 (]: 12 of 13 START sql table model report.report_customer _acquisition ............. [RUN]
[0m23:37:02.360273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m23:37:02.360786 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m23:37:02.368515 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.369915 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m23:37:02.373323 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.374666 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.375907 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m23:37:02.376634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:02.377802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:02.378303 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.378777 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m23:37:02.391174 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m23:37:02.394708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.395234 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m23:37:02.396147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:02.402354 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.402981 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m23:37:02.404117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:02.407425 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m23:37:02.408864 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.409640 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m23:37:02.416432 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:37:02.420341 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m23:37:02.420839 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m23:37:02.424423 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:02.426265 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m23:37:02.426974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B057E090>]}
[0m23:37:02.427835 [info ] [Thread-1 (]: 12 of 13 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.07s]
[0m23:37:02.429005 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m23:37:02.429639 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m23:37:02.430419 [info ] [Thread-1 (]: 13 of 13 START sql table model report.report_retargeting_performance ........... [RUN]
[0m23:37:02.431677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m23:37:02.432417 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m23:37:02.435748 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m23:37:02.437521 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m23:37:02.444791 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m23:37:02.448514 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m23:37:02.449733 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m23:37:02.450960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:02.452196 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:02.452983 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m23:37:02.453619 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m23:37:02.457533 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:02.461236 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m23:37:02.461850 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m23:37:02.463285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:02.466856 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m23:37:02.467669 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m23:37:02.468407 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m23:37:02.472390 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:02.476692 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m23:37:02.477207 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m23:37:02.478156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:37:02.479960 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m23:37:02.480868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c12903-12e7-410f-9059-67d79e695fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B057C110>]}
[0m23:37:02.482007 [info ] [Thread-1 (]: 13 of 13 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.05s]
[0m23:37:02.484420 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m23:37:02.487035 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:02.487687 [debug] [MainThread]: On master: BEGIN
[0m23:37:02.488077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:02.488984 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:37:02.489430 [debug] [MainThread]: On master: COMMIT
[0m23:37:02.489778 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:02.490077 [debug] [MainThread]: On master: COMMIT
[0m23:37:02.490624 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:02.490978 [debug] [MainThread]: On master: Close
[0m23:37:02.491505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:02.491807 [debug] [MainThread]: Connection 'create_ae_exam_db_report' was properly closed.
[0m23:37:02.492073 [debug] [MainThread]: Connection 'list_ae_exam_db_report' was properly closed.
[0m23:37:02.492352 [debug] [MainThread]: Connection 'model.ae_exam_project.report_retargeting_performance' was properly closed.
[0m23:37:02.492746 [info ] [MainThread]: 
[0m23:37:02.493330 [info ] [MainThread]: Finished running 6 table models, 7 view models in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m23:37:02.496869 [debug] [MainThread]: Command end result
[0m23:37:02.531007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m23:37:02.535457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m23:37:02.545096 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m23:37:02.546085 [info ] [MainThread]: 
[0m23:37:02.547394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:37:02.548695 [info ] [MainThread]: 
[0m23:37:02.549814 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m23:37:02.552122 [debug] [MainThread]: Command `dbt run` succeeded at 23:37:02.551841 after 3.53 seconds
[0m23:37:02.552854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B041A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5AFFB5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5B057C110>]}
[0m23:37:02.553432 [debug] [MainThread]: Flushing usage events
[0m23:37:05.753483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:28.968872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7EE9A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7FE17890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F000E7ED0>]}


============================== 00:03:28.987523 | ecd880e7-61bc-4414-825a-6a47666b8b2c ==============================
[0m00:03:28.987523 [info ] [MainThread]: Running with dbt=1.9.0
[0m00:03:28.989082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:03:29.315874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7F5490F0>]}
[0m00:03:29.389269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7FEC3AC0>]}
[0m00:03:29.393213 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:03:29.615177 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m00:03:29.755082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:03:29.755586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:03:29.756272 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m00:03:29.757513 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m00:03:29.758387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F001BC850>]}
[0m00:03:29.824303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F0154AA80>]}
[0m00:03:29.916813 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:03:29.921321 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:03:29.953555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01781010>]}
[0m00:03:29.954333 [info ] [MainThread]: Found 15 models, 11 sources, 429 macros
[0m00:03:29.955412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F0173C120>]}
[0m00:03:29.958939 [info ] [MainThread]: 
[0m00:03:29.959661 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:29.960261 [info ] [MainThread]: 
[0m00:03:29.961332 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:03:29.982129 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m00:03:30.193543 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:03:30.194156 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:03:30.194467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:30.295983 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m00:03:30.298427 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:03:30.300477 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:03:30.300831 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:03:30.301123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.302464 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.304007 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:03:30.307575 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:03:30.308224 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:03:30.308709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.310130 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.311517 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:03:30.313672 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m00:03:30.314000 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m00:03:30.314280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.315542 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.317068 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m00:03:30.318243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_staging)
[0m00:03:30.318869 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m00:03:30.324879 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:03:30.325444 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:03:30.325836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.326983 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.328469 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:03:30.328768 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m00:03:30.329242 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.329614 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:03:30.330074 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m00:03:30.331509 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.332720 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:03:30.333060 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m00:03:30.333344 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m00:03:30.333779 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.334170 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m00:03:30.335567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m00:03:30.336259 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m00:03:30.338017 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:03:30.338349 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:03:30.338620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.339636 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.341048 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:03:30.341338 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m00:03:30.341803 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.342065 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:03:30.342333 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m00:03:30.342860 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.343858 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:03:30.344187 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m00:03:30.344489 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m00:03:30.345057 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.345513 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m00:03:30.346283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m00:03:30.346803 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m00:03:30.348662 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:03:30.348957 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:03:30.349246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.350060 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.351388 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:03:30.351751 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m00:03:30.352410 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.352787 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:03:30.353127 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m00:03:30.353805 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.355114 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:03:30.355497 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m00:03:30.355801 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m00:03:30.356345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.356717 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m00:03:30.357277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m00:03:30.357760 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m00:03:30.359345 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:03:30.359645 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m00:03:30.359961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.360928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.362253 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:03:30.362550 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m00:03:30.363017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.363302 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:03:30.363627 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m00:03:30.364197 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.365862 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:03:30.366416 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m00:03:30.366852 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m00:03:30.367634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:30.368061 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m00:03:30.372331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_staging'
[0m00:03:30.379194 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:03:30.379589 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m00:03:30.379901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:30.380956 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.381610 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m00:03:30.381945 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:03:30.403365 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:03:30.406050 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m00:03:30.408379 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m00:03:30.408765 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m00:03:30.409311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m00:03:30.410955 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:03:30.411273 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m00:03:30.411596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.413470 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:03:30.413868 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m00:03:30.414179 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:03:30.418722 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:03:30.420335 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m00:03:30.420961 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m00:03:30.421245 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m00:03:30.421732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m00:03:30.423410 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:03:30.423720 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m00:03:30.424098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.426272 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:03:30.426698 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m00:03:30.427048 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:03:30.431603 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:03:30.433557 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m00:03:30.434303 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m00:03:30.434656 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m00:03:30.436236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m00:03:30.439453 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:03:30.439798 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m00:03:30.440057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:30.440623 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:30.440901 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m00:03:30.441208 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m00:03:30.445281 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:03:30.447015 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m00:03:30.447587 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m00:03:30.447872 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m00:03:30.450063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01749FD0>]}
[0m00:03:30.450591 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:30.450897 [debug] [MainThread]: On master: BEGIN
[0m00:03:30.451146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:30.451700 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:30.452090 [debug] [MainThread]: On master: COMMIT
[0m00:03:30.452456 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:30.452818 [debug] [MainThread]: On master: COMMIT
[0m00:03:30.453411 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:30.453846 [debug] [MainThread]: On master: Close
[0m00:03:30.458465 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:03:30.459130 [info ] [Thread-1 (]: 1 of 15 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m00:03:30.460350 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m00:03:30.460973 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m00:03:30.468904 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.471691 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m00:03:30.515818 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.519458 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.520176 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m00:03:30.520605 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:03:30.521409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.521823 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.522234 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m00:03:30.523725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.530732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.531214 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m00:03:30.532568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.535704 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.536358 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m00:03:30.537181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:30.550863 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:03:30.551348 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.551709 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m00:03:30.556693 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:03:30.561508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m00:03:30.561940 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m00:03:30.565551 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.568579 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m00:03:30.572116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01B901B0>]}
[0m00:03:30.572967 [info ] [Thread-1 (]: 1 of 15 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.11s]
[0m00:03:30.574717 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m00:03:30.575333 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m00:03:30.576160 [info ] [Thread-1 (]: 2 of 15 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m00:03:30.577240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m00:03:30.577754 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m00:03:30.580177 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.582592 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m00:03:30.588742 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.591967 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.593269 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m00:03:30.594055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:30.595176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.595719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.596165 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m00:03:30.597313 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.600153 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.600537 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m00:03:30.601746 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:30.607036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.607497 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m00:03:30.608248 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:30.610609 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:03:30.611046 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.611396 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m00:03:30.615375 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.617812 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m00:03:30.618191 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m00:03:30.622299 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.624166 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m00:03:30.625058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01BA4410>]}
[0m00:03:30.626300 [info ] [Thread-1 (]: 2 of 15 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m00:03:30.628317 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m00:03:30.629218 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m00:03:30.629910 [info ] [Thread-1 (]: 3 of 15 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m00:03:30.631110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m00:03:30.631658 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m00:03:30.634407 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.636953 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m00:03:30.643522 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.646032 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.646691 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m00:03:30.647114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:30.647825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.648215 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.648550 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m00:03:30.649405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.653181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.653829 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m00:03:30.655025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.659048 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.659757 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m00:03:30.662466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.664590 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:03:30.665091 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.665508 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m00:03:30.669274 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.672710 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m00:03:30.673195 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m00:03:30.677391 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.679858 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m00:03:30.680531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01A50AD0>]}
[0m00:03:30.681170 [info ] [Thread-1 (]: 3 of 15 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m00:03:30.683508 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m00:03:30.683968 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m00:03:30.684541 [info ] [Thread-1 (]: 4 of 15 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m00:03:30.685721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m00:03:30.686387 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m00:03:30.691083 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m00:03:30.692472 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m00:03:30.696062 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m00:03:30.697546 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m00:03:30.698119 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m00:03:30.699010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:30.700438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.701011 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m00:03:30.701623 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m00:03:30.703341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.708070 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m00:03:30.708702 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m00:03:30.709922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.713088 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m00:03:30.713795 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m00:03:30.714191 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m00:03:30.717967 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.721514 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m00:03:30.722057 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m00:03:30.722974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:30.724969 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m00:03:30.726187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01BE4750>]}
[0m00:03:30.727747 [info ] [Thread-1 (]: 4 of 15 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.04s]
[0m00:03:30.729686 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m00:03:30.730327 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m00:03:30.730932 [info ] [Thread-1 (]: 5 of 15 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m00:03:30.732028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m00:03:30.732606 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m00:03:30.735822 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.738941 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m00:03:30.747160 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.748649 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.749266 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m00:03:30.749690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:30.750445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.750802 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.751181 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m00:03:30.752492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.759214 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.760205 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m00:03:30.762154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.832639 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.833311 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.834255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:30.836190 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m00:03:30.836881 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.837321 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m00:03:30.841588 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:03:30.844789 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m00:03:30.845440 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m00:03:30.848864 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.850573 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m00:03:30.851228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01779AF0>]}
[0m00:03:30.852051 [info ] [Thread-1 (]: 5 of 15 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.12s]
[0m00:03:30.853218 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m00:03:30.853703 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m00:03:30.854209 [info ] [Thread-1 (]: 6 of 15 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m00:03:30.855302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_transactions)
[0m00:03:30.855799 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m00:03:30.858350 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.860033 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m00:03:30.863719 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.864808 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.865279 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m00:03:30.865818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:30.866780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.867461 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.868293 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m00:03:30.870123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.873962 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.874451 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m00:03:30.875869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.880831 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.881318 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m00:03:30.882158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:30.884534 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:03:30.885103 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.885661 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m00:03:30.889640 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.893889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m00:03:30.895915 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m00:03:30.900495 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.902905 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m00:03:30.904101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01ABC890>]}
[0m00:03:30.905892 [info ] [Thread-1 (]: 6 of 15 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.05s]
[0m00:03:30.907795 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m00:03:30.908346 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m00:03:30.908909 [info ] [Thread-1 (]: 7 of 15 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m00:03:30.910028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m00:03:30.910626 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m00:03:30.913900 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m00:03:30.915481 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m00:03:30.921133 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m00:03:30.923386 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m00:03:30.924339 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m00:03:30.925033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:30.926441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.927203 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m00:03:30.927779 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m00:03:30.929958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.934489 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m00:03:30.935091 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m00:03:30.936622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.939495 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m00:03:30.940032 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m00:03:30.940410 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m00:03:30.944086 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:30.947366 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m00:03:30.947911 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m00:03:30.948760 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:30.951730 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m00:03:30.953022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01ABD610>]}
[0m00:03:30.954206 [info ] [Thread-1 (]: 7 of 15 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.04s]
[0m00:03:30.955760 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m00:03:30.956517 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m00:03:30.957438 [info ] [Thread-1 (]: 8 of 15 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m00:03:30.958620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m00:03:30.959393 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m00:03:30.965470 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:30.968549 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m00:03:30.972771 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:30.975337 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:30.976533 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m00:03:30.977364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:30.979084 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:30.979789 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:30.980321 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m00:03:30.983501 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:30.991355 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:30.992037 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m00:03:30.993121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:30.997108 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:30.997719 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m00:03:30.998802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:31.001186 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m00:03:31.002160 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:31.002803 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m00:03:31.006591 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:31.010025 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m00:03:31.011391 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m00:03:31.015047 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:31.017418 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m00:03:31.018541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01ABC290>]}
[0m00:03:31.019692 [info ] [Thread-1 (]: 8 of 15 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.06s]
[0m00:03:31.021447 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m00:03:31.022338 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m00:03:31.023042 [info ] [Thread-1 (]: 9 of 15 START sql view model intermediate.model_int_customer_sessions .......... [RUN]
[0m00:03:31.024160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m00:03:31.024742 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m00:03:31.029139 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.030922 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m00:03:31.036530 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.038199 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.038874 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m00:03:31.039406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:31.040366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:31.040892 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.041433 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m00:03:31.045767 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:03:31.049263 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.049849 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m00:03:31.051213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:31.056910 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.057498 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m00:03:31.058388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:31.059982 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m00:03:31.060387 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.060732 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m00:03:31.064101 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:31.067419 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m00:03:31.068137 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m00:03:31.071542 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:31.073180 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m00:03:31.073738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F0132A7B0>]}
[0m00:03:31.074438 [info ] [Thread-1 (]: 9 of 15 OK created sql view model intermediate.model_int_customer_sessions ..... [[32mOK[0m in 0.05s]
[0m00:03:31.075758 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m00:03:31.076287 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m00:03:31.076851 [info ] [Thread-1 (]: 10 of 15 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m00:03:31.077802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_mart_campaign_performance)
[0m00:03:31.078283 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m00:03:31.081690 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.083993 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m00:03:31.110506 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.115869 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.116827 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m00:03:31.117260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:31.118104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:31.118846 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.119522 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m00:03:31.202775 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m00:03:31.209348 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.210331 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m00:03:31.212351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:31.218127 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.218980 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m00:03:31.220179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:31.227223 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:03:31.227851 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.228300 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m00:03:31.235599 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:03:31.239503 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m00:03:31.240250 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m00:03:31.244168 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:31.248236 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m00:03:31.249161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F0132B5F0>]}
[0m00:03:31.250060 [info ] [Thread-1 (]: 10 of 15 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.17s]
[0m00:03:31.251553 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m00:03:31.252518 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m00:03:31.253732 [info ] [Thread-1 (]: 11 of 15 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m00:03:31.254930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m00:03:31.255650 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m00:03:31.263384 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.265709 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m00:03:31.272483 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.274897 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.275898 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m00:03:31.276812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:31.279140 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:31.280381 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.281956 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m00:03:31.588943 [debug] [Thread-1 (]: SQL status: OK in 0.306 seconds
[0m00:03:31.591588 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.591967 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m00:03:31.592808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:31.595647 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.596066 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m00:03:31.596931 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:31.598463 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m00:03:31.598834 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.599135 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m00:03:31.606748 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:03:31.609239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m00:03:31.609585 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m00:03:31.612978 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:31.614448 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m00:03:31.615067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01ABC830>]}
[0m00:03:31.615731 [info ] [Thread-1 (]: 11 of 15 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.36s]
[0m00:03:31.617182 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m00:03:31.617720 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m00:03:31.618768 [info ] [Thread-1 (]: 12 of 15 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m00:03:31.620213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m00:03:31.620796 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m00:03:31.624730 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:31.626097 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m00:03:31.633386 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:31.635373 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:31.636241 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m00:03:31.636791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:31.638046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:31.638669 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:31.639295 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m00:03:32.231352 [debug] [Thread-1 (]: SQL status: OK in 0.591 seconds
[0m00:03:32.236998 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:32.237855 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m00:03:32.239650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.244300 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:32.245051 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m00:03:32.246043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:32.247927 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m00:03:32.248473 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:32.249134 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m00:03:32.268738 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:03:32.274232 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m00:03:32.275109 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m00:03:32.281184 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:03:32.284095 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m00:03:32.285271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7D42B4D0>]}
[0m00:03:32.286141 [info ] [Thread-1 (]: 12 of 15 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.67s]
[0m00:03:32.287597 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m00:03:32.288123 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m00:03:32.288609 [info ] [Thread-1 (]: 13 of 15 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m00:03:32.289957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m00:03:32.290491 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m00:03:32.293598 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.296644 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m00:03:32.299481 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.301896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.302822 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m00:03:32.303372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:32.304312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.304898 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.305374 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m00:03:32.315761 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m00:03:32.320790 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.321730 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m00:03:32.322945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.327510 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.328764 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m00:03:32.330125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.331744 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m00:03:32.332098 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.332383 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m00:03:32.338297 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:03:32.342102 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m00:03:32.342493 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m00:03:32.345995 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:32.347811 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m00:03:32.348439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01328A70>]}
[0m00:03:32.349047 [info ] [Thread-1 (]: 13 of 15 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.06s]
[0m00:03:32.350540 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m00:03:32.351096 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m00:03:32.352070 [info ] [Thread-1 (]: 14 of 15 START sql table model report.report_customer _acquisition ............. [RUN]
[0m00:03:32.353764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m00:03:32.354574 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m00:03:32.358486 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.359644 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m00:03:32.362665 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.364155 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.364931 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m00:03:32.365444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:32.366560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.367082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.367666 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m00:03:32.379002 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m00:03:32.382829 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.383438 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m00:03:32.384631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.391389 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.391938 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m00:03:32.392916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.395585 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m00:03:32.396202 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.396690 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m00:03:32.403512 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:03:32.407659 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m00:03:32.408104 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m00:03:32.411669 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:32.413493 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m00:03:32.414160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01ABDD90>]}
[0m00:03:32.414857 [info ] [Thread-1 (]: 14 of 15 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.06s]
[0m00:03:32.416891 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m00:03:32.417319 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m00:03:32.418398 [info ] [Thread-1 (]: 15 of 15 START sql table model report.report_retargeting_performance ........... [RUN]
[0m00:03:32.420214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m00:03:32.421199 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m00:03:32.424717 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.426052 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m00:03:32.429714 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.431321 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.431954 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m00:03:32.432387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:32.433160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.433496 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.433825 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m00:03:32.437797 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:32.441567 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.442193 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m00:03:32.443701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.448889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.449470 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m00:03:32.450599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:32.455666 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m00:03:32.456645 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.457167 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m00:03:32.461742 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:03:32.465631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m00:03:32.466232 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m00:03:32.470197 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:03:32.473138 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m00:03:32.474056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd880e7-61bc-4414-825a-6a47666b8b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F01ABCE30>]}
[0m00:03:32.474848 [info ] [Thread-1 (]: 15 of 15 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.05s]
[0m00:03:32.476812 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m00:03:32.479618 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:32.480010 [debug] [MainThread]: On master: BEGIN
[0m00:03:32.480304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:32.480937 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:32.481215 [debug] [MainThread]: On master: COMMIT
[0m00:03:32.481505 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:32.481845 [debug] [MainThread]: On master: COMMIT
[0m00:03:32.482495 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:32.482992 [debug] [MainThread]: On master: Close
[0m00:03:32.483513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:32.483796 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m00:03:32.484018 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m00:03:32.484228 [debug] [MainThread]: Connection 'model.ae_exam_project.report_retargeting_performance' was properly closed.
[0m00:03:32.484628 [info ] [MainThread]: 
[0m00:03:32.485539 [info ] [MainThread]: Finished running 6 table models, 9 view models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m00:03:32.490691 [debug] [MainThread]: Command end result
[0m00:03:32.525768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m00:03:32.528917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m00:03:32.540054 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m00:03:32.540956 [info ] [MainThread]: 
[0m00:03:32.542161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:32.543107 [info ] [MainThread]: 
[0m00:03:32.544431 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m00:03:32.546351 [debug] [MainThread]: Command `dbt run` succeeded at 00:03:32.546128 after 3.92 seconds
[0m00:03:32.546827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7FF10B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7EE30350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F0016BDD0>]}
[0m00:03:32.547273 [debug] [MainThread]: Flushing usage events
[0m00:03:35.737916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:14.766116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4667A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B475F7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B477E7ED0>]}


============================== 01:16:14.775396 | 316cb22a-7d96-4b6c-af0a-04303d7a2157 ==============================
[0m01:16:14.775396 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:16:14.777071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:16:15.246340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '316cb22a-7d96-4b6c-af0a-04303d7a2157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B46D210F0>]}
[0m01:16:15.356656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '316cb22a-7d96-4b6c-af0a-04303d7a2157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B476A7AC0>]}
[0m01:16:15.399934 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m01:16:16.791076 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:16:17.002739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m01:16:17.003368 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\report\report_driver_perfornance.sql
[0m01:16:17.003786 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\intermediate\model_int_driver_task_summary.sql
[0m01:16:17.004145 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\mart\feet\model_mart_driver_performance.sql
[0m01:16:17.265897 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.model_int_driver_task_summary' (models\intermediate\model_int_driver_task_summary.sql) depends on a node named 'order_log_incentive_sessions_driver_incentive_logs' which was not found
[0m01:16:17.267948 [debug] [MainThread]: Command `dbt run` failed at 01:16:17.267716 after 3.05 seconds
[0m01:16:17.268458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B478BB550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B478BB450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B48C5B5C0>]}
[0m01:16:17.268961 [debug] [MainThread]: Flushing usage events
[0m01:16:19.050807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:23.946844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8DB4A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8EAC7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8ECB7ED0>]}


============================== 01:16:23.953237 | cc2dde7a-3cd7-475c-9856-321bb4b4030e ==============================
[0m01:16:23.953237 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:16:23.954388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:16:24.153401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc2dde7a-3cd7-475c-9856-321bb4b4030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8E1F10F0>]}
[0m01:16:24.211432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc2dde7a-3cd7-475c-9856-321bb4b4030e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8EB73AC0>]}
[0m01:16:24.215993 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m01:16:24.406856 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:16:24.552171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m01:16:24.553448 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\report\report_driver_perfornance.sql
[0m01:16:24.554298 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\intermediate\model_int_driver_task_summary.sql
[0m01:16:24.555005 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\mart\feet\model_mart_driver_performance.sql
[0m01:16:24.763985 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.model_int_driver_task_summary' (models\intermediate\model_int_driver_task_summary.sql) depends on a node named 'order_log_incentive_sessions_driver_incentive_logs' which was not found
[0m01:16:24.765316 [debug] [MainThread]: Command `dbt run` failed at 01:16:24.765177 after 1.02 seconds
[0m01:16:24.765675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8ED8F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8ED8F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B9013B5C0>]}
[0m01:16:24.765997 [debug] [MainThread]: Flushing usage events
[0m01:16:26.055075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:26.154839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB61FA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB7177890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB7367ED0>]}


============================== 01:17:26.160537 | 37664727-aa85-4d94-9b49-0fe70327d803 ==============================
[0m01:17:26.160537 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:17:26.161944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:17:26.375680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37664727-aa85-4d94-9b49-0fe70327d803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB68A10F0>]}
[0m01:17:26.430230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37664727-aa85-4d94-9b49-0fe70327d803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB7227AC0>]}
[0m01:17:26.434344 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m01:17:26.596496 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:17:26.706972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m01:17:26.707487 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\report\report_driver_perfornance.sql
[0m01:17:26.707822 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\intermediate\model_int_driver_task_summary.sql
[0m01:17:26.708113 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\mart\feet\model_mart_driver_performance.sql
[0m01:17:26.884741 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.model_mart_driver_performance' (models\mart\feet\model_mart_driver_performance.sql) depends on a node named 'stg_drivers_master' which was not found
[0m01:17:26.885947 [debug] [MainThread]: Command `dbt run` failed at 01:17:26.885752 after 0.93 seconds
[0m01:17:26.886408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB743A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB743B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB874B5C0>]}
[0m01:17:26.886827 [debug] [MainThread]: Flushing usage events
[0m01:17:28.148798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:18.329281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576356A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157644F7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157646E7ED0>]}


============================== 01:18:18.335072 | 7f154fd4-a04d-4a33-83cd-eb123848458f ==============================
[0m01:18:18.335072 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:18:18.337185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:18:18.530326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015763C210F0>]}
[0m01:18:18.587432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157645A7AC0>]}
[0m01:18:18.591184 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m01:18:18.753552 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:18:18.863686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:18.864075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:18.864561 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m01:18:18.865306 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:18:18.866094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157647B8850>]}
[0m01:18:18.908232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015765B3AA80>]}
[0m01:18:18.974173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:18:19.017746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:18:19.098434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015765D6D010>]}
[0m01:18:19.099014 [info ] [MainThread]: Found 19 models, 11 sources, 429 macros
[0m01:18:19.100078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015765D2C120>]}
[0m01:18:19.103283 [info ] [MainThread]: 
[0m01:18:19.103967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:19.104513 [info ] [MainThread]: 
[0m01:18:19.105292 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:18:19.110956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m01:18:22.556968 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:18:22.557374 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:18:22.557693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:22.684001 [debug] [ThreadPool]: SQL status: OK in 0.126 seconds
[0m01:18:22.686137 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:18:22.687991 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:18:22.688401 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:18:22.688702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.689745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.690871 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:18:22.692577 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:18:22.692920 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:18:22.693185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.694161 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.695269 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:18:22.698100 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:18:22.698516 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:18:22.698791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.699746 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.700852 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:18:22.701725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m01:18:22.702702 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m01:18:22.708362 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:18:22.708881 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:18:22.709168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.710143 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.711391 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:18:22.711653 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m01:18:22.712141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.712377 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:18:22.712598 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m01:18:22.714108 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.714981 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:18:22.715251 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:18:22.715483 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:18:22.715914 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.716179 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m01:18:22.716729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_report)
[0m01:18:22.717200 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m01:18:22.718551 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:18:22.718824 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:18:22.719085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.719870 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.720960 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:18:22.721207 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m01:18:22.721606 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.721851 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:18:22.722067 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m01:18:22.722501 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.723297 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:18:22.723638 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:18:22.723870 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:18:22.724330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.724625 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m01:18:22.725182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m01:18:22.725625 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m01:18:22.727283 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:18:22.727534 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:18:22.727759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.728618 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.729779 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:18:22.730022 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m01:18:22.730382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.730609 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:18:22.730817 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m01:18:22.731267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.731981 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:18:22.732251 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:18:22.732523 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:18:22.732961 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.733324 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m01:18:22.733802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m01:18:22.734201 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m01:18:22.735444 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:18:22.735694 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:18:22.735921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.736677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.737727 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:18:22.737970 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m01:18:22.738328 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.738551 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:18:22.738762 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m01:18:22.739183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.739874 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:18:22.740118 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:18:22.740315 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:18:22.740665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.740989 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m01:18:22.744842 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m01:18:22.749226 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:18:22.749511 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m01:18:22.749743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:22.750743 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.751102 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:18:22.751354 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:18:22.769755 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m01:18:22.771471 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m01:18:22.794813 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m01:18:22.795166 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m01:18:22.795623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m01:18:22.797794 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:18:22.798318 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m01:18:22.798605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.799798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:18:22.800087 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:18:22.800328 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:18:22.803872 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:18:22.805274 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m01:18:22.805797 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m01:18:22.806025 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m01:18:22.806497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m01:18:22.809522 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:18:22.809874 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m01:18:22.810107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.810624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:22.810882 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:18:22.811125 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:18:22.814660 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:18:22.815853 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m01:18:22.816407 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m01:18:22.816663 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m01:18:22.817181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m01:18:22.819039 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:18:22.819292 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m01:18:22.819529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:22.821125 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:18:22.821391 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:18:22.821621 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:18:22.825130 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:18:22.826478 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m01:18:22.827063 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m01:18:22.827345 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m01:18:22.828957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015765D33C50>]}
[0m01:18:22.829393 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:22.829630 [debug] [MainThread]: On master: BEGIN
[0m01:18:22.829829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:22.830270 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:22.830528 [debug] [MainThread]: On master: COMMIT
[0m01:18:22.830768 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:22.830999 [debug] [MainThread]: On master: COMMIT
[0m01:18:22.831375 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:22.831625 [debug] [MainThread]: On master: Close
[0m01:18:22.836019 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:18:22.836658 [info ] [Thread-1 (]: 1 of 19 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m01:18:22.837596 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m01:18:22.838065 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m01:18:22.845060 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.848229 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m01:18:22.888920 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.893428 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.893980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m01:18:22.894332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:22.894971 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:22.895319 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.895649 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m01:18:22.896577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:22.902069 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.902488 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m01:18:22.903817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:22.906329 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.906700 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m01:18:22.907353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:22.918827 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:18:22.919267 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.919569 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:18:22.923961 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:18:22.929343 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:18:22.929691 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m01:18:22.933182 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:22.935481 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m01:18:22.938041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766184260>]}
[0m01:18:22.938668 [info ] [Thread-1 (]: 1 of 19 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.10s]
[0m01:18:22.939778 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:18:22.940171 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m01:18:22.940596 [info ] [Thread-1 (]: 2 of 19 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m01:18:22.941410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m01:18:22.941856 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m01:18:22.944370 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.945680 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m01:18:22.949473 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.951842 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.952450 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m01:18:22.952904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:22.953804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:22.954372 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.955388 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m01:18:22.957466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:22.963080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.963729 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m01:18:22.964733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:22.967108 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.967422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m01:18:22.968008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:22.969730 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:18:22.970127 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.970475 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:18:22.973803 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:22.976620 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:18:22.977422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m01:18:22.981050 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:22.984878 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m01:18:22.985858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766190730>]}
[0m01:18:22.986746 [info ] [Thread-1 (]: 2 of 19 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.04s]
[0m01:18:22.987801 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m01:18:22.988259 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m01:18:22.988703 [info ] [Thread-1 (]: 3 of 19 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m01:18:22.989375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m01:18:22.989701 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m01:18:22.992166 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m01:18:22.994432 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m01:18:22.997802 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m01:18:22.999959 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:18:23.001080 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m01:18:23.001652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.002308 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.002657 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:18:23.002964 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m01:18:23.003837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.006060 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:18:23.006339 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m01:18:23.006870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.010139 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:18:23.010852 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m01:18:23.011956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.013877 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:18:23.015213 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:18:23.016111 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:18:23.020136 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.022431 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:18:23.022765 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m01:18:23.026394 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.028353 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m01:18:23.028939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766021150>]}
[0m01:18:23.029481 [info ] [Thread-1 (]: 3 of 19 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m01:18:23.030569 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m01:18:23.031048 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m01:18:23.032312 [info ] [Thread-1 (]: 4 of 19 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m01:18:23.033431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m01:18:23.033880 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m01:18:23.036007 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.036972 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m01:18:23.039426 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.040489 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.040841 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m01:18:23.041334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.042500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.043515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.044221 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m01:18:23.045733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.052289 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.053305 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m01:18:23.054662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.058033 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.058697 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m01:18:23.059773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.061748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:18:23.062316 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.062775 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:18:23.066849 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.070265 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:18:23.070670 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m01:18:23.073666 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.078173 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m01:18:23.078754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766206C80>]}
[0m01:18:23.079316 [info ] [Thread-1 (]: 4 of 19 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.05s]
[0m01:18:23.080180 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m01:18:23.080620 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:18:23.081244 [info ] [Thread-1 (]: 5 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m01:18:23.082417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m01:18:23.082876 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:18:23.085320 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.087249 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:18:23.090117 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.091082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.091840 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m01:18:23.092363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.093311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.093940 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.094367 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m01:18:23.095571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.163438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.163977 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m01:18:23.165245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.168046 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.168482 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.169714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.170968 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:18:23.171274 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.171531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:18:23.175189 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.177683 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:18:23.177999 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m01:18:23.181582 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.183432 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m01:18:23.183929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766163950>]}
[0m01:18:23.184508 [info ] [Thread-1 (]: 5 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.10s]
[0m01:18:23.185473 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:18:23.185901 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:18:23.186397 [info ] [Thread-1 (]: 6 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m01:18:23.187245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m01:18:23.187588 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:18:23.189764 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.190942 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:18:23.194560 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.195679 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.196046 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m01:18:23.196374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.197258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.197563 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.197863 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m01:18:23.198688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.201161 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.201468 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.202052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.203845 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:18:23.204379 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.204712 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:18:23.208242 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.212548 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:18:23.213583 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m01:18:23.214830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.216867 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m01:18:23.217599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157617185F0>]}
[0m01:18:23.218274 [info ] [Thread-1 (]: 6 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.03s]
[0m01:18:23.219518 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:18:23.219897 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m01:18:23.220308 [info ] [Thread-1 (]: 7 of 19 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m01:18:23.221005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m01:18:23.221293 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m01:18:23.223615 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.225428 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m01:18:23.230647 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.232343 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.232956 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m01:18:23.233358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.234106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.234446 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.234730 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m01:18:23.235573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.238023 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.238559 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m01:18:23.239539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.242956 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.243589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m01:18:23.244418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.246178 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:18:23.246518 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.246798 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:18:23.250222 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.252223 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:18:23.252589 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m01:18:23.256710 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:18:23.259263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m01:18:23.260316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766162630>]}
[0m01:18:23.261230 [info ] [Thread-1 (]: 7 of 19 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.04s]
[0m01:18:23.262804 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m01:18:23.264272 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m01:18:23.265811 [info ] [Thread-1 (]: 8 of 19 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m01:18:23.267661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m01:18:23.268139 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m01:18:23.270188 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.271026 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m01:18:23.275913 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.277956 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.278872 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m01:18:23.279360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.280143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.280774 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.281145 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m01:18:23.284096 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:18:23.287669 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.288169 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m01:18:23.288957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.293080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.294107 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m01:18:23.295573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.298493 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:18:23.299223 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.299676 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:18:23.303519 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.306370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:18:23.306718 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m01:18:23.309758 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.311431 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m01:18:23.311919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015765919370>]}
[0m01:18:23.312436 [info ] [Thread-1 (]: 8 of 19 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.04s]
[0m01:18:23.313789 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m01:18:23.314223 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:18:23.314942 [info ] [Thread-1 (]: 9 of 19 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m01:18:23.316704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m01:18:23.317306 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:18:23.321334 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.323402 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:18:23.327598 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.329993 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.330834 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m01:18:23.331603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.333119 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:18:23.333741 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.334255 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m01:18:23.337412 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.340369 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.340677 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m01:18:23.341531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.345048 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.345406 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m01:18:23.346085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.347289 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:18:23.347753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.348205 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:18:23.352373 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.354594 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:18:23.354910 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m01:18:23.357981 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.361313 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m01:18:23.362037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576470A750>]}
[0m01:18:23.362760 [info ] [Thread-1 (]: 9 of 19 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.05s]
[0m01:18:23.364033 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:18:23.364502 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m01:18:23.366054 [info ] [Thread-1 (]: 10 of 19 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m01:18:23.367430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m01:18:23.367883 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m01:18:23.371778 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.373203 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m01:18:23.377657 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.378970 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.379418 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m01:18:23.379732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.380396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.380754 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.381193 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m01:18:23.384526 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:18:23.387733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.388106 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m01:18:23.388831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:23.391229 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.391996 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m01:18:23.393624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.395205 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:18:23.395588 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.395879 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:18:23.399604 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.402254 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:18:23.402848 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m01:18:23.406416 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.407684 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m01:18:23.408370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766161E50>]}
[0m01:18:23.409437 [info ] [Thread-1 (]: 10 of 19 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.04s]
[0m01:18:23.410868 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m01:18:23.411330 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m01:18:23.411757 [info ] [Thread-1 (]: 11 of 19 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m01:18:23.412606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m01:18:23.413043 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m01:18:23.417209 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:18:23.418484 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m01:18:23.421834 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:18:23.423470 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:18:23.423955 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m01:18:23.424308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.425140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.425999 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:18:23.426734 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by driver_id
)

select * from summary
  );

[0m01:18:23.436583 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by driver_id
)

select * from summary
  );

[0m01:18:23.437246 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:18:23.437709 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: ROLLBACK
[0m01:18:23.774113 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_driver_task_summary'
[0m01:18:23.774741 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m01:18:23.778246 [debug] [Thread-1 (]: Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Parser Error: syntax error at or near "avg"
[0m01:18:23.778669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766221E50>]}
[0m01:18:23.779218 [error] [Thread-1 (]: 11 of 19 ERROR creating sql view model intermediate.model_int_driver_task_summary  [[31mERROR[0m in 0.37s]
[0m01:18:23.779992 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m01:18:23.780499 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m01:18:23.781548 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_driver_task_summary' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Parser Error: syntax error at or near "avg".
[0m01:18:23.780955 [info ] [Thread-1 (]: 12 of 19 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m01:18:23.783264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m01:18:23.783686 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m01:18:23.787683 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.790268 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m01:18:23.809126 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.811651 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.812218 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m01:18:23.812676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.813621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.814098 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.814517 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m01:18:23.881201 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m01:18:23.884000 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.884521 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m01:18:23.885548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.890167 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.890615 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m01:18:23.891781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.896965 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:18:23.897353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.897664 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:18:23.904896 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:18:23.907152 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:18:23.907599 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m01:18:23.910995 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:23.913235 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m01:18:23.914119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766248290>]}
[0m01:18:23.914972 [info ] [Thread-1 (]: 12 of 19 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.13s]
[0m01:18:23.916295 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m01:18:23.916754 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:18:23.917203 [info ] [Thread-1 (]: 13 of 19 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m01:18:23.918028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m01:18:23.918428 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m01:18:23.922217 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:23.923329 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m01:18:23.927829 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:23.929609 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:23.930252 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m01:18:23.930649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.931515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:23.931930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:23.932384 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m01:18:24.157744 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m01:18:24.161266 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:24.161624 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m01:18:24.162276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.165543 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:24.165958 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m01:18:24.166635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.167847 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:18:24.168201 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:24.168481 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:18:24.175202 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:18:24.178053 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:18:24.178356 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m01:18:24.182215 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:24.183764 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m01:18:24.184251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157647596D0>]}
[0m01:18:24.184713 [info ] [Thread-1 (]: 13 of 19 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.27s]
[0m01:18:24.185573 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:18:24.185940 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:18:24.186395 [info ] [Thread-1 (]: 14 of 19 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m01:18:24.187393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m01:18:24.187757 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m01:18:24.190675 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.191795 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m01:18:24.195356 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.196471 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.196914 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m01:18:24.197239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:24.197898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:24.198630 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.199136 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m01:18:24.615787 [debug] [Thread-1 (]: SQL status: OK in 0.416 seconds
[0m01:18:24.618971 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.619373 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m01:18:24.620135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.622798 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.623304 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m01:18:24.624130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.626437 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:18:24.626975 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.627429 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:18:24.632192 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:18:24.635395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:18:24.635898 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m01:18:24.639353 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:24.641418 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m01:18:24.642435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766221E50>]}
[0m01:18:24.643400 [info ] [Thread-1 (]: 14 of 19 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.46s]
[0m01:18:24.644604 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:18:24.645075 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m01:18:24.645437 [info ] [Thread-1 (]: 15 of 19 SKIP relation mart.model_mart_driver_performance ...................... [[33mSKIP[0m]
[0m01:18:24.646351 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m01:18:24.646798 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m01:18:24.647296 [info ] [Thread-1 (]: 16 of 19 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m01:18:24.648651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m01:18:24.649214 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m01:18:24.653221 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.655589 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m01:18:24.660192 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.662599 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.663558 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m01:18:24.664319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:24.665392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:24.665976 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.666707 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m01:18:24.678707 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m01:18:24.682695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.683275 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m01:18:24.684208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.686554 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.686865 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m01:18:24.687503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.688741 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:18:24.689042 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.689303 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:18:24.695146 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:18:24.698116 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:18:24.698790 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m01:18:24.702721 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:24.704273 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m01:18:24.704758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157661637D0>]}
[0m01:18:24.705243 [info ] [Thread-1 (]: 16 of 19 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.06s]
[0m01:18:24.706461 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m01:18:24.706876 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m01:18:24.707605 [info ] [Thread-1 (]: 17 of 19 START sql table model report.report_customer _acquisition ............. [RUN]
[0m01:18:24.708761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m01:18:24.709276 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m01:18:24.712365 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.713276 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m01:18:24.716547 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.717542 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.718044 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m01:18:24.718335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:24.719190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:24.719788 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.720174 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m01:18:24.726742 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:18:24.729822 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.730471 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m01:18:24.731629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:24.735153 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.735523 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m01:18:24.736178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.737439 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:18:24.737742 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.737982 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:18:24.743544 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:18:24.746157 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:18:24.746480 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m01:18:24.749997 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:24.751451 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m01:18:24.751912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576622B890>]}
[0m01:18:24.752430 [info ] [Thread-1 (]: 17 of 19 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.04s]
[0m01:18:24.753816 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m01:18:24.754238 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m01:18:24.754635 [info ] [Thread-1 (]: 18 of 19 START sql table model report.report_retargeting_performance ........... [RUN]
[0m01:18:24.755282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m01:18:24.755639 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m01:18:24.758565 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.759832 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m01:18:24.762707 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.764169 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.764787 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m01:18:24.765309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:24.766400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:24.767000 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.767407 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m01:18:24.770461 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:24.772934 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.773306 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m01:18:24.774543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:18:24.778844 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.779255 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m01:18:24.779961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:18:24.781944 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:18:24.782550 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.782963 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:18:24.786511 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:24.788238 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:18:24.788514 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m01:18:24.792035 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:18:24.794208 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m01:18:24.794811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f154fd4-a04d-4a33-83cd-eb123848458f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157658DCD70>]}
[0m01:18:24.795442 [info ] [Thread-1 (]: 18 of 19 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.04s]
[0m01:18:24.796668 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m01:18:24.797365 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m01:18:24.798049 [info ] [Thread-1 (]: 19 of 19 SKIP relation report.report_driver_perfornance ........................ [[33mSKIP[0m]
[0m01:18:24.799288 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m01:18:24.802214 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:24.802630 [debug] [MainThread]: On master: BEGIN
[0m01:18:24.802959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:24.803554 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:18:24.803840 [debug] [MainThread]: On master: COMMIT
[0m01:18:24.804069 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:24.804278 [debug] [MainThread]: On master: COMMIT
[0m01:18:24.804914 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:24.805276 [debug] [MainThread]: On master: Close
[0m01:18:24.805687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:24.805954 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m01:18:24.806174 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m01:18:24.806378 [debug] [MainThread]: Connection 'model.ae_exam_project.report_retargeting_performance' was properly closed.
[0m01:18:24.806751 [info ] [MainThread]: 
[0m01:18:24.807425 [info ] [MainThread]: Finished running 8 table models, 11 view models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m01:18:24.811038 [debug] [MainThread]: Command end result
[0m01:18:24.840314 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:18:24.843497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:18:24.853473 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m01:18:24.854122 [info ] [MainThread]: 
[0m01:18:24.854876 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:18:24.855767 [info ] [MainThread]: 
[0m01:18:24.856769 [error] [MainThread]:   Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Parser Error: syntax error at or near "avg"
[0m01:18:24.857542 [info ] [MainThread]: 
[0m01:18:24.858477 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=2 TOTAL=19
[0m01:18:24.859941 [debug] [MainThread]: Command `dbt run` failed at 01:18:24.859786 after 6.69 seconds
[0m01:18:24.860383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015765D29670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766257EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015766257E90>]}
[0m01:18:24.861241 [debug] [MainThread]: Flushing usage events
[0m01:18:26.620181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:49.057721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC220A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC3197890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC3387ED0>]}


============================== 01:19:49.061876 | 1928b30a-d2ab-4e99-8ee1-8c41ad4ff449 ==============================
[0m01:19:49.061876 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:19:49.063609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:49.248992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC28C10F0>]}
[0m01:19:49.308763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC3243AC0>]}
[0m01:19:49.313509 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m01:19:49.476213 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:19:49.587277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:49.587648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:49.588083 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m01:19:49.589661 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:19:49.590352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC3458850>]}
[0m01:19:49.630271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC474AA80>]}
[0m01:19:49.708744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:19:49.711909 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:19:49.733855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4975010>]}
[0m01:19:49.734468 [info ] [MainThread]: Found 19 models, 11 sources, 429 macros
[0m01:19:49.735376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC493C120>]}
[0m01:19:49.737700 [info ] [MainThread]: 
[0m01:19:49.738508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:49.739057 [info ] [MainThread]: 
[0m01:19:49.739749 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:19:49.749298 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m01:19:49.830290 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:19:49.831127 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:19:49.831774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:49.854806 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m01:19:49.856044 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:19:49.857609 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:19:49.857972 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:19:49.858250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.859483 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.861067 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:19:49.862869 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:19:49.863157 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:19:49.863414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.864373 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.865389 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:19:49.867186 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:19:49.867433 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:19:49.867648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.868475 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.869511 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:19:49.870604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m01:19:49.871208 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m01:19:49.880978 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:19:49.881554 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:19:49.881886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.883009 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.884309 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:19:49.884600 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m01:19:49.885053 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.885335 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:19:49.885602 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m01:19:49.886110 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.887096 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:19:49.887641 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:19:49.888039 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:19:49.888797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.889250 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m01:19:49.890334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m01:19:49.891322 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m01:19:49.893817 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:19:49.894229 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:19:49.894491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.895345 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.896476 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:19:49.896730 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m01:19:49.897155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.897427 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:19:49.897688 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m01:19:49.898155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.898926 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:19:49.899168 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:19:49.899375 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:19:49.899742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.900032 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m01:19:49.900807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m01:19:49.901321 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m01:19:49.903107 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:19:49.903377 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:19:49.903575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.904342 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.905407 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:19:49.905651 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m01:19:49.906039 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.906299 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:19:49.906558 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m01:19:49.907034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.907889 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:19:49.908150 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:19:49.908371 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:19:49.908986 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.909307 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m01:19:49.909897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m01:19:49.911162 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m01:19:49.912957 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:19:49.913250 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:19:49.913500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.914341 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.915541 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:19:49.915788 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m01:19:49.916195 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.916417 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:19:49.916676 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m01:19:49.917141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.917915 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:19:49.918191 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:19:49.918414 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:19:49.918789 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:49.919025 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m01:19:49.922646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m01:19:49.927342 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:19:49.927674 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m01:19:49.927902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:49.929087 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.929508 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:19:49.929746 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:19:49.943660 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m01:19:49.945486 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m01:19:49.946634 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m01:19:49.946958 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m01:19:49.947416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m01:19:49.948885 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:19:49.949184 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m01:19:49.949406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.950754 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.951212 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:19:49.951470 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:19:49.955107 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:19:49.956512 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m01:19:49.957090 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m01:19:49.957338 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m01:19:49.957740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m01:19:49.959175 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:19:49.959492 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m01:19:49.959740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.961202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.961872 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:19:49.962128 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:19:49.965447 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:19:49.966596 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m01:19:49.967081 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m01:19:49.967303 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m01:19:49.967671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m01:19:49.970308 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:19:49.970652 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m01:19:49.971011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:49.971633 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:49.971984 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:19:49.972230 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:19:49.975670 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:19:49.977149 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m01:19:49.977718 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m01:19:49.977960 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m01:19:49.981182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4942390>]}
[0m01:19:49.981893 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:49.982251 [debug] [MainThread]: On master: BEGIN
[0m01:19:49.982490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:49.983032 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:19:49.983284 [debug] [MainThread]: On master: COMMIT
[0m01:19:49.983519 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:49.983729 [debug] [MainThread]: On master: COMMIT
[0m01:19:49.984076 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:19:49.984319 [debug] [MainThread]: On master: Close
[0m01:19:49.987809 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:19:49.988282 [info ] [Thread-1 (]: 1 of 19 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m01:19:49.990038 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m01:19:49.990391 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m01:19:49.996773 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:49.997739 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m01:19:50.053098 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:50.054154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:50.054653 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m01:19:50.054974 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:19:50.055609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.055952 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:50.056259 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m01:19:50.057155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.064545 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:50.064943 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m01:19:50.065732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.068154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:50.068441 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m01:19:50.068993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.081801 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:19:50.082344 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:50.082673 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:19:50.087487 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:19:50.091719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:19:50.092339 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m01:19:50.096062 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.098392 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m01:19:50.101454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4D94680>]}
[0m01:19:50.102254 [info ] [Thread-1 (]: 1 of 19 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.11s]
[0m01:19:50.103245 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:19:50.103689 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m01:19:50.104138 [info ] [Thread-1 (]: 2 of 19 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m01:19:50.105606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m01:19:50.105917 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m01:19:50.108036 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.109053 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m01:19:50.112986 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.114287 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.117011 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m01:19:50.117731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.118453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.118940 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.119279 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m01:19:50.120077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.122660 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.123003 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m01:19:50.123789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.126795 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.127308 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m01:19:50.128164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.129840 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:19:50.131520 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.132897 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:19:50.137394 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.140481 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:19:50.140878 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m01:19:50.144231 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.145893 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m01:19:50.146710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4DA4870>]}
[0m01:19:50.147443 [info ] [Thread-1 (]: 2 of 19 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.04s]
[0m01:19:50.149598 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m01:19:50.150379 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m01:19:50.151514 [info ] [Thread-1 (]: 3 of 19 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m01:19:50.152603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m01:19:50.153078 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m01:19:50.155377 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.156181 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m01:19:50.159455 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.161312 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.161896 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m01:19:50.162271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.163131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.163477 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.163777 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m01:19:50.164518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.168067 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.168393 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m01:19:50.168992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.172208 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.172644 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m01:19:50.173363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.174501 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:19:50.174803 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.175076 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:19:50.178377 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.181016 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:19:50.182549 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m01:19:50.186381 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.187906 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m01:19:50.188644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4C31CD0>]}
[0m01:19:50.189460 [info ] [Thread-1 (]: 3 of 19 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m01:19:50.190711 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m01:19:50.191268 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m01:19:50.191865 [info ] [Thread-1 (]: 4 of 19 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m01:19:50.192910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m01:19:50.193770 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m01:19:50.196424 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.197571 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m01:19:50.203695 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.204857 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.205335 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m01:19:50.205700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.206558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.206891 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.207224 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m01:19:50.208104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.211965 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.212450 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m01:19:50.213278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.218553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.219216 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m01:19:50.220084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.221679 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:19:50.222076 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.222388 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:19:50.226060 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.228586 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:19:50.229036 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m01:19:50.232650 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.237713 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m01:19:50.238257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4E46CF0>]}
[0m01:19:50.238758 [info ] [Thread-1 (]: 4 of 19 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.05s]
[0m01:19:50.241352 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m01:19:50.241787 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:19:50.242477 [info ] [Thread-1 (]: 5 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m01:19:50.243532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m01:19:50.244108 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:19:50.247063 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.247965 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:19:50.252319 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.253461 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.253927 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m01:19:50.254290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.254917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.255229 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.255497 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m01:19:50.256278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.318898 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.319438 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m01:19:50.320718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.330234 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.330618 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.331533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.332979 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:19:50.333316 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.333596 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:19:50.337151 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.339038 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:19:50.339335 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m01:19:50.342279 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.344490 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m01:19:50.344987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC03685F0>]}
[0m01:19:50.345495 [info ] [Thread-1 (]: 5 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.10s]
[0m01:19:50.347483 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:19:50.347810 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:19:50.348192 [info ] [Thread-1 (]: 6 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m01:19:50.349413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m01:19:50.349802 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:19:50.352260 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.353228 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:19:50.355611 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.356424 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.356786 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m01:19:50.357127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.357733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.358023 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.358297 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m01:19:50.359299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.362809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.363344 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m01:19:50.364318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.366972 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.367587 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.368825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.371139 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:19:50.371645 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.371978 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:19:50.375568 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.378261 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:19:50.378788 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m01:19:50.382066 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.385334 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m01:19:50.386186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC2119490>]}
[0m01:19:50.386789 [info ] [Thread-1 (]: 6 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.04s]
[0m01:19:50.387812 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:19:50.388257 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m01:19:50.388691 [info ] [Thread-1 (]: 7 of 19 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m01:19:50.389512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m01:19:50.389994 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m01:19:50.392896 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.394359 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m01:19:50.398136 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.399618 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.400094 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m01:19:50.400396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.401011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.401309 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.401625 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m01:19:50.402703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.404937 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.405220 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m01:19:50.405757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.408110 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.408394 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m01:19:50.409176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.411095 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:19:50.411590 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.412017 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:19:50.415435 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.418604 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:19:50.419161 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m01:19:50.422517 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.424140 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m01:19:50.424752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC44F4CB0>]}
[0m01:19:50.425431 [info ] [Thread-1 (]: 7 of 19 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.04s]
[0m01:19:50.426795 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m01:19:50.427385 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m01:19:50.427911 [info ] [Thread-1 (]: 8 of 19 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m01:19:50.429036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m01:19:50.429439 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m01:19:50.433807 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.435159 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m01:19:50.437773 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.438693 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.439077 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m01:19:50.439462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.440253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.440565 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.440824 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m01:19:50.441826 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.445009 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.445435 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m01:19:50.446191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.450898 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.451525 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m01:19:50.452499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.453764 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:19:50.454115 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.454565 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:19:50.457968 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.460882 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:19:50.461403 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m01:19:50.464152 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:19:50.466199 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m01:19:50.466910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC44F4110>]}
[0m01:19:50.467944 [info ] [Thread-1 (]: 8 of 19 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.04s]
[0m01:19:50.469315 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m01:19:50.469794 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:19:50.470226 [info ] [Thread-1 (]: 9 of 19 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m01:19:50.471429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m01:19:50.471741 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:19:50.474263 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.475144 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:19:50.479780 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.481579 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.482265 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m01:19:50.482681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.483340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.483685 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.484027 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m01:19:50.486169 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:19:50.488930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.489280 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m01:19:50.489926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.492614 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.493102 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m01:19:50.494014 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.495822 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:19:50.496360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.496759 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:19:50.500642 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.503132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:19:50.503490 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m01:19:50.506443 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.507753 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m01:19:50.508211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4D71F70>]}
[0m01:19:50.508757 [info ] [Thread-1 (]: 9 of 19 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.04s]
[0m01:19:50.510056 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:19:50.510597 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m01:19:50.511466 [info ] [Thread-1 (]: 10 of 19 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m01:19:50.512694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m01:19:50.513135 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m01:19:50.516662 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.518540 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m01:19:50.522085 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.523740 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.524154 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m01:19:50.524445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.525063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.525468 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.525876 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m01:19:50.530095 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:19:50.534196 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.534814 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m01:19:50.535906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.539044 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.539515 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m01:19:50.540437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.543543 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:19:50.544577 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.545523 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:19:50.549257 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.553257 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:19:50.554003 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m01:19:50.557494 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.559752 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m01:19:50.560822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4D730B0>]}
[0m01:19:50.561658 [info ] [Thread-1 (]: 10 of 19 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.05s]
[0m01:19:50.562911 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m01:19:50.563658 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m01:19:50.564633 [info ] [Thread-1 (]: 11 of 19 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m01:19:50.565886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m01:19:50.566565 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m01:19:50.571921 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:19:50.573087 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m01:19:50.577107 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:19:50.578912 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:19:50.579607 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m01:19:50.580160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.581318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.582149 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:19:50.584100 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by driver_id
)

select * from summary
  );

[0m01:19:50.591265 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by driver_id
)

select * from summary
  );

[0m01:19:50.592035 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:19:50.592795 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: ROLLBACK
[0m01:19:50.602946 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_driver_task_summary'
[0m01:19:50.603639 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m01:19:50.608268 [debug] [Thread-1 (]: Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Binder Error: Ambiguous reference to column name "driver_id" (use: "ot.driver_id" or "st.driver_id")
[0m01:19:50.609312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4E71F10>]}
[0m01:19:50.610504 [error] [Thread-1 (]: 11 of 19 ERROR creating sql view model intermediate.model_int_driver_task_summary  [[31mERROR[0m in 0.04s]
[0m01:19:50.612056 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m01:19:50.612909 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m01:19:50.613835 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_driver_task_summary' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Binder Error: Ambiguous reference to column name "driver_id" (use: "ot.driver_id" or "st.driver_id").
[0m01:19:50.614635 [info ] [Thread-1 (]: 12 of 19 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m01:19:50.616993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m01:19:50.617609 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m01:19:50.621349 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.622549 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m01:19:50.652966 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.654768 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.655539 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m01:19:50.656198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.657445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.658184 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.659377 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m01:19:50.709720 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m01:19:50.712506 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.712889 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m01:19:50.713580 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.715740 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.716066 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m01:19:50.716629 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.721018 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:19:50.721591 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.721924 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:19:50.728654 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:19:50.731208 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:19:50.731668 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m01:19:50.734651 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:50.736002 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m01:19:50.736621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC1E0FC50>]}
[0m01:19:50.737258 [info ] [Thread-1 (]: 12 of 19 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.12s]
[0m01:19:50.738650 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m01:19:50.739269 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:19:50.739968 [info ] [Thread-1 (]: 13 of 19 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m01:19:50.741174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m01:19:50.741609 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m01:19:50.745322 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:50.746924 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m01:19:50.750512 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:50.751739 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:50.752221 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m01:19:50.752536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:50.753398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:50.754266 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:50.755309 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m01:19:50.990479 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m01:19:50.994947 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:50.995561 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m01:19:50.996516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:50.999487 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:50.999915 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m01:19:51.000722 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.002215 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:19:51.002591 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:51.002891 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:19:51.008902 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:19:51.012125 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:19:51.012637 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m01:19:51.015620 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:51.017049 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m01:19:51.017550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC45A05F0>]}
[0m01:19:51.018083 [info ] [Thread-1 (]: 13 of 19 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.28s]
[0m01:19:51.019746 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:19:51.020597 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:19:51.021133 [info ] [Thread-1 (]: 14 of 19 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m01:19:51.021918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m01:19:51.022385 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m01:19:51.027673 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.029726 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m01:19:51.032763 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.033944 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.034425 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m01:19:51.034766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:51.035502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:51.035887 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.036305 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m01:19:51.418696 [debug] [Thread-1 (]: SQL status: OK in 0.382 seconds
[0m01:19:51.421311 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.421734 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m01:19:51.422458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.425234 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.425740 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m01:19:51.426590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.427987 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:19:51.428351 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.428644 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:19:51.432569 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:19:51.434617 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:19:51.434965 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m01:19:51.437974 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:51.439453 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m01:19:51.440031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4D71730>]}
[0m01:19:51.440676 [info ] [Thread-1 (]: 14 of 19 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.42s]
[0m01:19:51.441663 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:19:51.442153 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m01:19:51.442681 [info ] [Thread-1 (]: 15 of 19 SKIP relation mart.model_mart_driver_performance ...................... [[33mSKIP[0m]
[0m01:19:51.443261 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m01:19:51.443630 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m01:19:51.444227 [info ] [Thread-1 (]: 16 of 19 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m01:19:51.444785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m01:19:51.445121 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m01:19:51.448060 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.449052 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m01:19:51.453216 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.454232 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.454635 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m01:19:51.454976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:51.455600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:51.455900 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.456169 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m01:19:51.462493 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:19:51.465697 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.466324 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m01:19:51.467232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.469911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.470258 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m01:19:51.470868 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.472194 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:19:51.472582 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.472935 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:19:51.478453 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:19:51.481765 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:19:51.483015 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m01:19:51.487365 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:51.488877 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m01:19:51.489556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC44F6990>]}
[0m01:19:51.490162 [info ] [Thread-1 (]: 16 of 19 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.04s]
[0m01:19:51.491538 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m01:19:51.492125 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m01:19:51.492832 [info ] [Thread-1 (]: 17 of 19 START sql table model report.report_customer _acquisition ............. [RUN]
[0m01:19:51.493627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m01:19:51.494072 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m01:19:51.497434 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.498836 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m01:19:51.503235 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.504439 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.504968 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m01:19:51.505330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:51.506062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:51.506453 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.506804 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m01:19:51.513812 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:19:51.517786 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.518411 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m01:19:51.519325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.521850 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.522198 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m01:19:51.522817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.523920 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:19:51.524191 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.524419 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:19:51.530961 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:19:51.534003 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:19:51.534500 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m01:19:51.537984 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:51.539257 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m01:19:51.539686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4C4B410>]}
[0m01:19:51.540170 [info ] [Thread-1 (]: 17 of 19 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.05s]
[0m01:19:51.542150 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m01:19:51.543216 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m01:19:51.544043 [info ] [Thread-1 (]: 18 of 19 START sql table model report.report_retargeting_performance ........... [RUN]
[0m01:19:51.545193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m01:19:51.545866 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m01:19:51.548639 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.549791 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m01:19:51.553453 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.554457 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.554841 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m01:19:51.555154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:51.555809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:51.556129 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.556414 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m01:19:51.557743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:19:51.562251 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.562906 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m01:19:51.563801 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.567027 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.567506 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m01:19:51.568445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:19:51.569753 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:19:51.570075 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.570333 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:19:51.573770 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:51.576622 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:19:51.577121 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m01:19:51.580297 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:19:51.583198 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m01:19:51.584343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1928b30a-d2ab-4e99-8ee1-8c41ad4ff449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC44F4410>]}
[0m01:19:51.585336 [info ] [Thread-1 (]: 18 of 19 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.04s]
[0m01:19:51.586408 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m01:19:51.586883 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m01:19:51.587254 [info ] [Thread-1 (]: 19 of 19 SKIP relation report.report_driver_perfornance ........................ [[33mSKIP[0m]
[0m01:19:51.587990 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m01:19:51.590110 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:51.590531 [debug] [MainThread]: On master: BEGIN
[0m01:19:51.590941 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:51.592693 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:19:51.593137 [debug] [MainThread]: On master: COMMIT
[0m01:19:51.593458 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:51.593730 [debug] [MainThread]: On master: COMMIT
[0m01:19:51.594330 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:19:51.594678 [debug] [MainThread]: On master: Close
[0m01:19:51.595048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:51.595288 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m01:19:51.595550 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m01:19:51.595784 [debug] [MainThread]: Connection 'model.ae_exam_project.report_retargeting_performance' was properly closed.
[0m01:19:51.596147 [info ] [MainThread]: 
[0m01:19:51.596758 [info ] [MainThread]: Finished running 8 table models, 11 view models in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m01:19:51.601414 [debug] [MainThread]: Command end result
[0m01:19:51.637317 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:19:51.639542 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:19:51.649625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m01:19:51.650408 [info ] [MainThread]: 
[0m01:19:51.651163 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:19:51.651879 [info ] [MainThread]: 
[0m01:19:51.652773 [error] [MainThread]:   Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Binder Error: Ambiguous reference to column name "driver_id" (use: "ot.driver_id" or "st.driver_id")
[0m01:19:51.653607 [info ] [MainThread]: 
[0m01:19:51.654419 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=2 TOTAL=19
[0m01:19:51.655458 [debug] [MainThread]: Command `dbt run` failed at 01:19:51.655334 after 2.77 seconds
[0m01:19:51.655797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC44F40B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC44F4EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC4EA7EF0>]}
[0m01:19:51.656107 [debug] [MainThread]: Flushing usage events
[0m01:19:54.920198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:18.641767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC5BBA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC6B47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC6D37ED0>]}


============================== 01:20:18.645406 | 885c4dd4-197f-4796-90aa-bc409ec12f39 ==============================
[0m01:20:18.645406 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:20:18.646501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:20:18.849523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC62710F0>]}
[0m01:20:18.904516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC6BF3AC0>]}
[0m01:20:18.907694 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m01:20:19.069634 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:20:19.181265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:20:19.181881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:20:19.182409 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m01:20:19.183135 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:20:19.183907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC6E08850>]}
[0m01:20:19.225162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC814EA80>]}
[0m01:20:19.298758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:20:19.302073 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:20:19.328068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC837D010>]}
[0m01:20:19.328754 [info ] [MainThread]: Found 19 models, 11 sources, 429 macros
[0m01:20:19.329546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC8340120>]}
[0m01:20:19.332163 [info ] [MainThread]: 
[0m01:20:19.333117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:19.333799 [info ] [MainThread]: 
[0m01:20:19.335009 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:20:19.343187 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m01:20:19.424834 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:19.425237 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:19.425582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:19.465121 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m01:20:19.466410 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:19.468035 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:19.468326 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:19.468584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.469472 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.471035 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:19.472861 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:19.473178 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:19.473451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.474388 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.475444 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:19.477346 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:19.477630 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:19.477866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.478731 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.479726 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:19.480751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m01:20:19.481416 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m01:20:19.486518 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:19.486910 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:19.487235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.488624 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.490241 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:19.490565 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m01:20:19.491041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.491425 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:19.491718 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m01:20:19.492241 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.493018 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:20:19.493282 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:19.493506 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:20:19.493876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.494107 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m01:20:19.494588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m01:20:19.494975 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m01:20:19.496293 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:19.496552 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:19.496825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.497612 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.498684 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:19.498928 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m01:20:19.499289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.499520 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:19.499742 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m01:20:19.500170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.500923 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:20:19.501210 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:19.501466 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:20:19.501913 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.502165 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m01:20:19.502619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m01:20:19.502979 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m01:20:19.505195 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:19.505519 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:19.505784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.506646 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.508557 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:19.509245 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m01:20:19.510277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.510930 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:19.511362 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m01:20:19.512127 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.513464 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:20:19.513936 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:19.514312 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:20:19.515054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.515630 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m01:20:19.516375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m01:20:19.516958 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m01:20:19.519377 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:19.519823 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:19.520438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.521620 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.522989 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:19.523369 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m01:20:19.524121 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.524590 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:19.525002 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m01:20:19.525823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.527048 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:20:19.527606 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:19.527988 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:20:19.528627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:19.528960 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m01:20:19.533286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m01:20:19.543692 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:20:19.544429 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m01:20:19.544956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:19.546047 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.546622 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:20:19.547041 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:19.571220 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m01:20:19.574709 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m01:20:19.576767 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m01:20:19.577472 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m01:20:19.578468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m01:20:19.582327 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:20:19.582783 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m01:20:19.583175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.584176 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.584710 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:20:19.585228 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:19.591999 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:20:19.594698 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m01:20:19.595912 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m01:20:19.596510 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m01:20:19.597335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m01:20:19.600626 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:20:19.602830 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m01:20:19.603426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.604527 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.605082 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:20:19.605593 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:19.612147 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:20:19.614704 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m01:20:19.615801 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m01:20:19.616413 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m01:20:19.617268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m01:20:19.621951 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:20:19.622687 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m01:20:19.623187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.624108 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:19.624701 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:20:19.625206 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:19.630334 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:20:19.632046 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m01:20:19.632768 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m01:20:19.633129 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m01:20:19.634565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC834A810>]}
[0m01:20:19.635117 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:19.635488 [debug] [MainThread]: On master: BEGIN
[0m01:20:19.635823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:19.636665 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:20:19.637065 [debug] [MainThread]: On master: COMMIT
[0m01:20:19.637450 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:19.637980 [debug] [MainThread]: On master: COMMIT
[0m01:20:19.638551 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:20:19.638967 [debug] [MainThread]: On master: Close
[0m01:20:19.641980 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:19.642961 [info ] [Thread-1 (]: 1 of 19 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m01:20:19.644107 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m01:20:19.644766 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:19.655201 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.656953 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:19.691365 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.692624 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.693082 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m01:20:19.693456 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:19.694132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.694507 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.694836 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m01:20:19.695884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.702852 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.703452 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m01:20:19.704435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.707353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.707769 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m01:20:19.708576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.720237 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:20:19.720821 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.721221 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:20:19.725226 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:19.729836 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:19.730288 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m01:20:19.733312 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:20:19.735633 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m01:20:19.738150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC8790680>]}
[0m01:20:19.738954 [info ] [Thread-1 (]: 1 of 19 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.09s]
[0m01:20:19.740532 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:19.740911 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m01:20:19.741396 [info ] [Thread-1 (]: 2 of 19 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m01:20:19.742097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m01:20:19.742570 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m01:20:19.745059 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.745966 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m01:20:19.748806 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.749607 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.749921 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m01:20:19.750250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:19.750907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.751267 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.751558 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m01:20:19.752379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.756184 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.756750 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m01:20:19.757650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.760843 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.761482 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m01:20:19.762760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.764926 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:20:19.765394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.765705 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:20:19.769145 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:19.772561 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:19.773252 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m01:20:19.776999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:19.778847 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m01:20:19.779367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC87A45F0>]}
[0m01:20:19.779879 [info ] [Thread-1 (]: 2 of 19 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.04s]
[0m01:20:19.781876 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m01:20:19.782447 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m01:20:19.783017 [info ] [Thread-1 (]: 3 of 19 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m01:20:19.784293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m01:20:19.784616 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m01:20:19.787024 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.788432 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m01:20:19.792609 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.794112 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.794891 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m01:20:19.795696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:19.796673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.797086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.797418 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m01:20:19.798591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.801488 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.801982 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m01:20:19.802706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.806012 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.806464 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m01:20:19.807305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.808689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:20:19.809167 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.809628 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:20:19.813398 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:19.816666 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:19.817168 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m01:20:19.820689 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:19.822649 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m01:20:19.823264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC86317D0>]}
[0m01:20:19.823857 [info ] [Thread-1 (]: 3 of 19 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m01:20:19.825213 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m01:20:19.825956 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m01:20:19.827212 [info ] [Thread-1 (]: 4 of 19 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m01:20:19.828711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m01:20:19.829314 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m01:20:19.832195 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.833674 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m01:20:19.836235 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.838108 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.838843 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m01:20:19.839435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:19.840738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.841396 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.841818 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m01:20:19.842720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.846023 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.846470 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m01:20:19.847158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.850233 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.850585 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m01:20:19.851315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.852473 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:20:19.852770 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.853023 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:20:19.856659 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:19.858940 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:19.859413 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m01:20:19.863228 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:19.864837 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m01:20:19.866204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC876A190>]}
[0m01:20:19.867159 [info ] [Thread-1 (]: 4 of 19 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.04s]
[0m01:20:19.868488 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m01:20:19.868959 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:19.869423 [info ] [Thread-1 (]: 5 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m01:20:19.870723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m01:20:19.871712 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:19.877991 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.879748 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:19.883244 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.884277 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.884676 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m01:20:19.885013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:19.885633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.885933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.886224 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m01:20:19.887129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.949515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.950054 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m01:20:19.950881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.953194 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.953531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.954429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.955776 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:20:19.956103 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.956401 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:20:19.960372 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:19.962357 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:19.962655 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m01:20:19.966029 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:19.967476 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m01:20:19.967946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC7F4FE90>]}
[0m01:20:19.968440 [info ] [Thread-1 (]: 5 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.10s]
[0m01:20:19.970637 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:19.971245 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:19.971772 [info ] [Thread-1 (]: 6 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m01:20:19.972735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m01:20:19.973162 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:19.975335 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.976169 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:19.978791 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.979639 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.980043 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m01:20:19.980463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:19.981210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.981669 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.982062 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m01:20:19.983020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:19.985553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.985850 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m01:20:19.986415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.990458 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.991134 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.991956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:19.993609 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:20:19.994272 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:19.994877 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:20:19.999060 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.001160 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:20.001591 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m01:20:20.004825 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.006595 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m01:20:20.007211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC86493D0>]}
[0m01:20:20.007854 [info ] [Thread-1 (]: 6 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.03s]
[0m01:20:20.009341 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:20.010163 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m01:20:20.010894 [info ] [Thread-1 (]: 7 of 19 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m01:20:20.011975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m01:20:20.012731 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m01:20:20.016472 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.017627 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m01:20:20.020472 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.022217 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.023228 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m01:20:20.024559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.025604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.026112 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.026531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m01:20:20.027646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.030115 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.030454 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m01:20:20.031137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.034050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.034352 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m01:20:20.034947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.036081 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:20:20.036399 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.036702 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:20:20.040331 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.042902 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:20.043409 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m01:20:20.046967 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.048487 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m01:20:20.049017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC86497F0>]}
[0m01:20:20.049521 [info ] [Thread-1 (]: 7 of 19 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.04s]
[0m01:20:20.051087 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m01:20:20.051578 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m01:20:20.052086 [info ] [Thread-1 (]: 8 of 19 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m01:20:20.053049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m01:20:20.053789 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m01:20:20.058041 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.059180 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m01:20:20.064009 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.065218 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.065721 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m01:20:20.066074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.066713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.067026 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.067295 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m01:20:20.068142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.071765 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.072641 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m01:20:20.074130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.077403 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.077810 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m01:20:20.078637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.079783 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:20:20.080082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.080356 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:20:20.083534 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.085313 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:20.085600 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m01:20:20.088538 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.090157 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m01:20:20.090740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC7F4CA10>]}
[0m01:20:20.091461 [info ] [Thread-1 (]: 8 of 19 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.04s]
[0m01:20:20.092553 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m01:20:20.093148 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:20.094808 [info ] [Thread-1 (]: 9 of 19 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m01:20:20.096211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m01:20:20.096763 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:20.099967 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.101157 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:20.104548 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.105853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.106356 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m01:20:20.106692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.107374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.107719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.108067 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m01:20:20.113945 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:20:20.116899 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.117297 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m01:20:20.118040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.122014 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.122808 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m01:20:20.124335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.125731 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:20:20.126385 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.127113 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:20:20.131355 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.133932 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:20.134451 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m01:20:20.137753 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.139409 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m01:20:20.139986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC7F98050>]}
[0m01:20:20.140623 [info ] [Thread-1 (]: 9 of 19 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.04s]
[0m01:20:20.141905 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:20.142570 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m01:20:20.143515 [info ] [Thread-1 (]: 10 of 19 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m01:20:20.144735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m01:20:20.145544 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m01:20:20.148950 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.149823 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m01:20:20.152708 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.153801 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.154775 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m01:20:20.155709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.156937 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.157520 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.157996 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m01:20:20.159965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.162887 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.163306 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m01:20:20.164108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.166436 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.166737 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m01:20:20.167317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.168311 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:20:20.168590 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.168836 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:20:20.172304 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.175431 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:20.176267 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m01:20:20.180581 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.183515 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m01:20:20.184838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC7F4D430>]}
[0m01:20:20.186068 [info ] [Thread-1 (]: 10 of 19 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.04s]
[0m01:20:20.187822 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m01:20:20.188718 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:20.189706 [info ] [Thread-1 (]: 11 of 19 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m01:20:20.190803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m01:20:20.191385 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:20.197415 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:20.199264 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:20.204462 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:20.206320 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:20.207105 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m01:20:20.207765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.208924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.209544 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:20.210163 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id
)

select * from summary
  );

[0m01:20:20.216575 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id
)

select * from summary
  );

[0m01:20:20.217667 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:20:20.218594 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: ROLLBACK
[0m01:20:20.231025 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_driver_task_summary'
[0m01:20:20.231893 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m01:20:20.236528 [debug] [Thread-1 (]: Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Binder Error: column "delivery_zone" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(delivery_zone)" if the exact value of "delivery_zone" is not important.
  
  LINE 8:     ot.delivery_zone,
              ^
[0m01:20:20.237263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC884B9B0>]}
[0m01:20:20.238255 [error] [Thread-1 (]: 11 of 19 ERROR creating sql view model intermediate.model_int_driver_task_summary  [[31mERROR[0m in 0.05s]
[0m01:20:20.239582 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:20.240313 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:20.241322 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_driver_task_summary' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Binder Error: column "delivery_zone" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(delivery_zone)" if the exact value of "delivery_zone" is not important.
  
  LINE 8:     ot.delivery_zone,
              ^.
[0m01:20:20.242324 [info ] [Thread-1 (]: 12 of 19 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m01:20:20.244559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m01:20:20.245432 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:20.251811 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.253165 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:20.292979 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.295794 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.297951 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m01:20:20.298658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.299696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.300468 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.301082 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m01:20:20.368551 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m01:20:20.375054 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.375582 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m01:20:20.376512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.379505 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.379928 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m01:20:20.380804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.386388 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:20:20.386994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.387399 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:20:20.393925 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:20:20.396334 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:20.396751 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m01:20:20.399991 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:20.401643 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m01:20:20.402421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC62622D0>]}
[0m01:20:20.403059 [info ] [Thread-1 (]: 12 of 19 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.16s]
[0m01:20:20.404050 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:20.404518 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:20.405017 [info ] [Thread-1 (]: 13 of 19 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m01:20:20.405826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m01:20:20.406224 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:20.410097 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.411191 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:20.413896 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.415553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.416129 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m01:20:20.416582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.417550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.418052 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.418495 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m01:20:20.668462 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m01:20:20.672792 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.673684 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m01:20:20.674692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.677866 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.678215 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m01:20:20.678842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:20.680188 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:20:20.680532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.680852 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:20:20.687463 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:20:20.690910 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:20.691561 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m01:20:20.696028 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:20.697808 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m01:20:20.698513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC7EF63F0>]}
[0m01:20:20.699185 [info ] [Thread-1 (]: 13 of 19 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.29s]
[0m01:20:20.700400 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:20.700866 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:20.701648 [info ] [Thread-1 (]: 14 of 19 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m01:20:20.702824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m01:20:20.703624 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:20.707832 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:20.708788 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:20.712121 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:20.712982 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:20.713351 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m01:20:20.713648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:20.714280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:20.714592 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:20.714976 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m01:20:21.090644 [debug] [Thread-1 (]: SQL status: OK in 0.375 seconds
[0m01:20:21.093151 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:21.093481 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m01:20:21.094109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.096421 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:21.096720 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m01:20:21.097858 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.099173 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:20:21.099498 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:21.099858 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:20:21.116963 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m01:20:21.119010 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:21.119449 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m01:20:21.135129 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m01:20:21.138752 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m01:20:21.140002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC884BA10>]}
[0m01:20:21.141320 [info ] [Thread-1 (]: 14 of 19 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.44s]
[0m01:20:21.143059 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:21.143887 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m01:20:21.144645 [info ] [Thread-1 (]: 15 of 19 SKIP relation mart.model_mart_driver_performance ...................... [[33mSKIP[0m]
[0m01:20:21.145978 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m01:20:21.146750 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:21.147878 [info ] [Thread-1 (]: 16 of 19 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m01:20:21.149068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m01:20:21.149800 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:21.154056 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.155560 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:21.160125 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.162040 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.163128 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m01:20:21.163786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:21.164656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:21.165082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.165396 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m01:20:21.172689 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:20:21.176368 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.176840 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m01:20:21.177669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.180381 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.180727 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m01:20:21.181469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.182770 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:20:21.183059 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.183290 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:20:21.189032 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:20:21.191921 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:21.192569 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m01:20:21.196440 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:21.197936 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m01:20:21.198469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC7EF60F0>]}
[0m01:20:21.198993 [info ] [Thread-1 (]: 16 of 19 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.05s]
[0m01:20:21.200170 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:21.200593 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m01:20:21.201032 [info ] [Thread-1 (]: 17 of 19 START sql table model report.report_customer _acquisition ............. [RUN]
[0m01:20:21.201857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m01:20:21.202275 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m01:20:21.205313 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.206801 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m01:20:21.210158 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.211190 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.211583 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m01:20:21.211873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:21.212492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:21.212822 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.213114 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m01:20:21.219560 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:20:21.224090 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.225052 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m01:20:21.226311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.229189 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.229521 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m01:20:21.230099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.231675 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:20:21.232100 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.232380 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:20:21.238032 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:20:21.240628 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:21.241071 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m01:20:21.245398 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:21.247325 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m01:20:21.247932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC833CDD0>]}
[0m01:20:21.248486 [info ] [Thread-1 (]: 17 of 19 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.05s]
[0m01:20:21.249553 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m01:20:21.249988 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m01:20:21.250451 [info ] [Thread-1 (]: 18 of 19 START sql table model report.report_retargeting_performance ........... [RUN]
[0m01:20:21.251496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m01:20:21.251926 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m01:20:21.255276 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.256834 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m01:20:21.260226 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.261249 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.261719 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m01:20:21.262041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:21.262700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:21.263037 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.263377 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m01:20:21.265083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:21.267524 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.267811 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m01:20:21.268345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.271027 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.271811 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m01:20:21.272778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:21.274446 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:20:21.274915 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.275337 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:20:21.279384 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:21.282423 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:21.282809 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m01:20:21.286805 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:21.289303 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m01:20:21.290220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885c4dd4-197f-4796-90aa-bc409ec12f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC8770E30>]}
[0m01:20:21.291160 [info ] [Thread-1 (]: 18 of 19 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.04s]
[0m01:20:21.292767 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m01:20:21.293756 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m01:20:21.294789 [info ] [Thread-1 (]: 19 of 19 SKIP relation report.report_driver_perfornance ........................ [[33mSKIP[0m]
[0m01:20:21.295957 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m01:20:21.298193 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:21.298652 [debug] [MainThread]: On master: BEGIN
[0m01:20:21.299003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:21.299709 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:20:21.300072 [debug] [MainThread]: On master: COMMIT
[0m01:20:21.300405 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:21.300665 [debug] [MainThread]: On master: COMMIT
[0m01:20:21.301116 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:20:21.301468 [debug] [MainThread]: On master: Close
[0m01:20:21.301855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:21.302097 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m01:20:21.302304 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m01:20:21.302493 [debug] [MainThread]: Connection 'model.ae_exam_project.report_retargeting_performance' was properly closed.
[0m01:20:21.302835 [info ] [MainThread]: 
[0m01:20:21.303361 [info ] [MainThread]: Finished running 8 table models, 11 view models in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m01:20:21.307824 [debug] [MainThread]: Command end result
[0m01:20:21.343692 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:20:21.347473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:20:21.357868 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m01:20:21.358536 [info ] [MainThread]: 
[0m01:20:21.359421 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:20:21.359981 [info ] [MainThread]: 
[0m01:20:21.361048 [error] [MainThread]:   Runtime Error in model model_int_driver_task_summary (models\intermediate\model_int_driver_task_summary.sql)
  Binder Error: column "delivery_zone" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(delivery_zone)" if the exact value of "delivery_zone" is not important.
  
  LINE 8:     ot.delivery_zone,
              ^
[0m01:20:21.362026 [info ] [MainThread]: 
[0m01:20:21.363146 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=2 TOTAL=19
[0m01:20:21.364469 [debug] [MainThread]: Command `dbt run` failed at 01:20:21.364320 after 2.89 seconds
[0m01:20:21.365315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC88045F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC5E5E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BC887BEF0>]}
[0m01:20:21.365896 [debug] [MainThread]: Flushing usage events
[0m01:20:22.916175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:44.615133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE83BA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE9347890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE9537ED0>]}


============================== 01:20:44.619331 | 8323e0b0-3035-447e-8894-44c7066d21fe ==============================
[0m01:20:44.619331 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:20:44.620826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:20:44.802689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE8A710F0>]}
[0m01:20:44.859795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE93EFAC0>]}
[0m01:20:44.863532 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m01:20:45.021945 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:20:45.134726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:20:45.135135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:20:45.135596 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m01:20:45.136561 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:20:45.137649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE9608850>]}
[0m01:20:45.177150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA8FAA80>]}
[0m01:20:45.243292 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:20:45.245682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:20:45.285431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAB35010>]}
[0m01:20:45.286185 [info ] [MainThread]: Found 19 models, 11 sources, 429 macros
[0m01:20:45.286922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAAF0120>]}
[0m01:20:45.289813 [info ] [MainThread]: 
[0m01:20:45.290510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:45.291233 [info ] [MainThread]: 
[0m01:20:45.292098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:20:45.301776 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m01:20:45.384790 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:45.385190 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:45.385459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:45.419628 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:20:45.421146 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:45.423794 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:45.424366 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:45.424899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.426367 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:45.428072 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:45.429858 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:45.430184 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:45.430557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.432191 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:20:45.433662 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:45.436673 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m01:20:45.437113 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m01:20:45.437710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.439266 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:20:45.440739 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m01:20:45.441810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m01:20:45.442544 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m01:20:45.448126 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:45.448531 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:45.448781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.450014 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:45.452002 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:45.452346 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m01:20:45.452809 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.453084 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:45.453332 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m01:20:45.453841 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.454613 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:20:45.454891 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m01:20:45.455116 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m01:20:45.455536 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.455767 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m01:20:45.456219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m01:20:45.456629 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m01:20:45.458086 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:45.458361 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:45.458599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.459448 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:45.461303 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:45.461619 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m01:20:45.462123 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.462383 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:45.462627 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m01:20:45.463116 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.464769 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:20:45.465280 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m01:20:45.465590 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m01:20:45.466246 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.466606 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m01:20:45.467551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m01:20:45.468470 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m01:20:45.470332 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:45.470658 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:45.470964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.471898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:45.473023 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:45.473283 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m01:20:45.473721 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.473961 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:45.474187 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m01:20:45.474662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.475416 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:20:45.475751 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m01:20:45.476032 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m01:20:45.476473 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.476778 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m01:20:45.477316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m01:20:45.477707 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m01:20:45.479104 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:45.479378 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m01:20:45.479616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.480439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:45.481801 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:45.482152 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m01:20:45.482737 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.483021 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:45.483260 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m01:20:45.483735 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.484520 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:20:45.484782 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m01:20:45.485001 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m01:20:45.485345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.485654 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m01:20:45.488572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m01:20:45.493698 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:20:45.494010 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m01:20:45.494227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:45.494703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.494992 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m01:20:45.495255 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:45.507686 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m01:20:45.509376 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m01:20:45.510446 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m01:20:45.510775 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m01:20:45.511320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m01:20:45.512714 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:20:45.514141 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m01:20:45.514601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.515400 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:45.515690 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m01:20:45.515976 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:45.519296 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:20:45.520572 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m01:20:45.521180 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m01:20:45.521487 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m01:20:45.521999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m01:20:45.523477 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:20:45.525485 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m01:20:45.525768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.526258 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:45.526504 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m01:20:45.526751 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:45.529992 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:20:45.531203 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m01:20:45.531780 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m01:20:45.532067 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m01:20:45.532605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m01:20:45.534642 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:20:45.534940 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m01:20:45.535184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:45.536473 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:20:45.537026 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m01:20:45.537235 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m01:20:45.540251 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:20:45.541779 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m01:20:45.542372 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m01:20:45.542604 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m01:20:45.544306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAAF7C50>]}
[0m01:20:45.544926 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:45.545237 [debug] [MainThread]: On master: BEGIN
[0m01:20:45.545484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:45.546010 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:20:45.546240 [debug] [MainThread]: On master: COMMIT
[0m01:20:45.546466 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:45.546677 [debug] [MainThread]: On master: COMMIT
[0m01:20:45.547067 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:20:45.547302 [debug] [MainThread]: On master: Close
[0m01:20:45.550794 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:45.551419 [info ] [Thread-1 (]: 1 of 19 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m01:20:45.552624 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m01:20:45.553028 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:45.559354 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.560230 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:45.597702 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.599266 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.600306 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m01:20:45.601636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:45.602546 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.602891 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.603210 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m01:20:45.604214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.609655 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.609957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m01:20:45.610570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.612878 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.613202 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m01:20:45.613807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.625020 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:20:45.625457 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.625760 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m01:20:45.630813 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:20:45.635697 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m01:20:45.636063 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m01:20:45.639541 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.642078 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m01:20:45.644756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAF44680>]}
[0m01:20:45.645686 [info ] [Thread-1 (]: 1 of 19 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.09s]
[0m01:20:45.646972 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m01:20:45.647423 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m01:20:45.647888 [info ] [Thread-1 (]: 2 of 19 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m01:20:45.649060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m01:20:45.649865 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m01:20:45.652488 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.653403 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m01:20:45.656529 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.657454 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.657880 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m01:20:45.658230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:45.658892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.659281 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.659707 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m01:20:45.660763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.663704 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.664095 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m01:20:45.664922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.669552 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.670185 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m01:20:45.671309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.673036 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:20:45.673361 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.673623 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m01:20:45.676912 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.678712 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m01:20:45.678989 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m01:20:45.682556 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.685571 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m01:20:45.686351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAF54730>]}
[0m01:20:45.686945 [info ] [Thread-1 (]: 2 of 19 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.04s]
[0m01:20:45.688151 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m01:20:45.688580 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m01:20:45.689016 [info ] [Thread-1 (]: 3 of 19 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m01:20:45.689767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m01:20:45.690081 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m01:20:45.692541 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.693869 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m01:20:45.697271 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.698755 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.699551 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m01:20:45.701060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:45.702560 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:20:45.703205 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.703696 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m01:20:45.705183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.709119 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.709745 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m01:20:45.710448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.712955 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.713270 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m01:20:45.713863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.715907 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:20:45.717264 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.718545 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m01:20:45.722496 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.724601 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m01:20:45.724869 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m01:20:45.727709 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:20:45.729047 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m01:20:45.729475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEADE17D0>]}
[0m01:20:45.729932 [info ] [Thread-1 (]: 3 of 19 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m01:20:45.732624 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m01:20:45.733278 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m01:20:45.734354 [info ] [Thread-1 (]: 4 of 19 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m01:20:45.735483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m01:20:45.735911 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m01:20:45.738468 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.739322 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m01:20:45.742200 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.743330 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.743879 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m01:20:45.744210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:45.744839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.745139 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.745420 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m01:20:45.746176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.749940 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.750728 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m01:20:45.752068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.754625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.754932 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m01:20:45.755531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.756669 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:20:45.756978 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.757220 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m01:20:45.760481 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.762884 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m01:20:45.763229 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m01:20:45.766323 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.771319 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m01:20:45.772216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAFF6CF0>]}
[0m01:20:45.773193 [info ] [Thread-1 (]: 4 of 19 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.04s]
[0m01:20:45.774381 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m01:20:45.774862 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:45.775305 [info ] [Thread-1 (]: 5 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m01:20:45.776451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m01:20:45.776898 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:45.778915 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.779747 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:45.785028 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.786460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.787009 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m01:20:45.787350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:45.787938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.788241 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.788546 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m01:20:45.789418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.849272 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.850041 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m01:20:45.851169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.854058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.854384 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.854998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.856130 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:20:45.856437 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.856696 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m01:20:45.860502 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.862754 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m01:20:45.863063 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m01:20:45.866570 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.868290 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m01:20:45.868829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE9433530>]}
[0m01:20:45.869365 [info ] [Thread-1 (]: 5 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.09s]
[0m01:20:45.870867 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m01:20:45.871299 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:45.871780 [info ] [Thread-1 (]: 6 of 19 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m01:20:45.872782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m01:20:45.873163 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:45.875248 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.877062 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:45.881351 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.883354 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.884248 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m01:20:45.885344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:45.886354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.886698 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.887006 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m01:20:45.887835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.890353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.890690 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m01:20:45.891378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.893494 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.893779 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.894295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.895837 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:20:45.896244 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.896624 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m01:20:45.900202 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.902334 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m01:20:45.902689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m01:20:45.905606 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.906934 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m01:20:45.907383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA6D8D10>]}
[0m01:20:45.907864 [info ] [Thread-1 (]: 6 of 19 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.03s]
[0m01:20:45.909118 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m01:20:45.909509 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m01:20:45.910058 [info ] [Thread-1 (]: 7 of 19 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m01:20:45.911256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m01:20:45.911795 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m01:20:45.915441 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.917624 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m01:20:45.921197 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.922581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.922994 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m01:20:45.923292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:45.923877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.924169 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.924447 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m01:20:45.925219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.927469 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.927748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m01:20:45.928262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.932347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.933292 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m01:20:45.934614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.936267 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:20:45.936621 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.936910 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m01:20:45.940841 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:45.942864 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m01:20:45.943173 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m01:20:45.946538 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.948226 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m01:20:45.949077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA69E990>]}
[0m01:20:45.950143 [info ] [Thread-1 (]: 7 of 19 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.04s]
[0m01:20:45.951811 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m01:20:45.952391 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m01:20:45.952965 [info ] [Thread-1 (]: 8 of 19 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m01:20:45.954181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m01:20:45.954551 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m01:20:45.956831 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.957639 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m01:20:45.960974 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.962187 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.962669 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m01:20:45.963007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:45.963709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.964027 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.964319 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m01:20:45.965251 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:45.969582 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.970025 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m01:20:45.970805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.974221 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.974552 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m01:20:45.975188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:45.976832 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:20:45.977185 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.977444 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m01:20:45.981355 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:45.985149 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m01:20:45.985711 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m01:20:45.989108 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:45.990941 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m01:20:45.991642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA69D4F0>]}
[0m01:20:45.992184 [info ] [Thread-1 (]: 8 of 19 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.04s]
[0m01:20:45.993394 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m01:20:45.993791 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:45.994209 [info ] [Thread-1 (]: 9 of 19 START sql view model intermediate.model_int_campaign_customer_orders ... [RUN]
[0m01:20:45.995095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m01:20:45.995536 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:45.998336 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.001529 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:46.005508 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.006733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.007184 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m01:20:46.007534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:46.008214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.008581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.008928 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m01:20:46.011616 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:20:46.013930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.014217 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m01:20:46.014788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.020227 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.020757 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m01:20:46.021594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.023263 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:20:46.023605 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.023877 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m01:20:46.027337 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.029091 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m01:20:46.029383 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m01:20:46.032439 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.035601 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m01:20:46.036650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAF21610>]}
[0m01:20:46.037374 [info ] [Thread-1 (]: 9 of 19 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.04s]
[0m01:20:46.038746 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m01:20:46.039326 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m01:20:46.039902 [info ] [Thread-1 (]: 10 of 19 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m01:20:46.040803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m01:20:46.041263 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m01:20:46.044292 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.045752 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m01:20:46.048965 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.050453 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.051507 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m01:20:46.052046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:46.053097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.053542 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.053909 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m01:20:46.055545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.057776 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.058057 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m01:20:46.058595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.061397 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.061828 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m01:20:46.062686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.063801 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:20:46.064112 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.064381 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m01:20:46.068037 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.071678 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m01:20:46.072308 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m01:20:46.075822 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.077322 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m01:20:46.077811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAF22210>]}
[0m01:20:46.078305 [info ] [Thread-1 (]: 10 of 19 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.04s]
[0m01:20:46.079866 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m01:20:46.080271 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:46.080683 [info ] [Thread-1 (]: 11 of 19 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m01:20:46.081807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m01:20:46.082233 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:46.086494 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:46.087667 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:46.090188 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:46.091584 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:46.092113 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m01:20:46.092431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:46.093108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.093426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:46.094163 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m01:20:46.096121 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:20:46.098926 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:46.099628 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m01:20:46.101206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.103442 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m01:20:46.103939 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:46.104268 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m01:20:46.108031 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.110164 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m01:20:46.110545 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m01:20:46.111261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.112440 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m01:20:46.112887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAF228D0>]}
[0m01:20:46.113348 [info ] [Thread-1 (]: 11 of 19 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.03s]
[0m01:20:46.115536 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m01:20:46.116343 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:46.117586 [info ] [Thread-1 (]: 12 of 19 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m01:20:46.119157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m01:20:46.120056 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:46.124939 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.126083 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:46.146862 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.147886 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.148330 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m01:20:46.149105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:46.150113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.150830 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.151638 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m01:20:46.196431 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m01:20:46.199969 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.200482 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m01:20:46.201452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.204681 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.205133 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m01:20:46.205903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.210379 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:20:46.210818 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.211100 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m01:20:46.218316 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:20:46.220188 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m01:20:46.220522 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m01:20:46.223868 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.225245 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m01:20:46.225813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE95A3E30>]}
[0m01:20:46.226546 [info ] [Thread-1 (]: 12 of 19 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.11s]
[0m01:20:46.227479 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m01:20:46.227953 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:46.228383 [info ] [Thread-1 (]: 13 of 19 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m01:20:46.229260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m01:20:46.229682 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:46.233373 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.234530 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:46.241058 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.244070 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.244887 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m01:20:46.245364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:46.246215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.246673 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.247293 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m01:20:46.481989 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m01:20:46.485272 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.485694 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m01:20:46.486522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.490072 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.490527 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m01:20:46.491321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.492827 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:20:46.493323 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.493783 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m01:20:46.501368 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:20:46.503927 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m01:20:46.504351 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m01:20:46.507680 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.509951 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m01:20:46.510931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAF21D30>]}
[0m01:20:46.511839 [info ] [Thread-1 (]: 13 of 19 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.28s]
[0m01:20:46.512991 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m01:20:46.513550 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:46.514217 [info ] [Thread-1 (]: 14 of 19 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m01:20:46.515262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m01:20:46.515728 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:46.520443 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.522742 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:46.527363 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.528737 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.529405 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m01:20:46.529858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:46.530692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:46.531124 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.531859 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m01:20:46.969779 [debug] [Thread-1 (]: SQL status: OK in 0.437 seconds
[0m01:20:46.972382 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.972754 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m01:20:46.973391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.975759 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.976067 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m01:20:46.976600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:46.977779 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:20:46.978091 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.978350 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m01:20:46.982301 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:46.985350 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m01:20:46.985775 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m01:20:46.988842 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:46.990214 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m01:20:46.990747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEAF23530>]}
[0m01:20:46.991249 [info ] [Thread-1 (]: 14 of 19 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.48s]
[0m01:20:46.992676 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m01:20:46.993027 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m01:20:46.993548 [info ] [Thread-1 (]: 15 of 19 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m01:20:46.994371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_mart_driver_performance)
[0m01:20:46.994796 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m01:20:46.997941 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m01:20:47.000599 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m01:20:47.004048 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m01:20:47.005949 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m01:20:47.006387 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m01:20:47.006715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:47.007351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:47.007747 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m01:20:47.008082 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    dts.driver_id,
    dm.vehicle_type,
    dts.delivery_zone,
    dts.total_target,
    dts.total_actual_deliveries,
    dts.total_tasks,
    dts.completed_tasks,
    round(dts.avg_response_time_mins, 2) as avg_response_time_mins,
    round(dts.avg_delivery_time_mins, 2) as avg_delivery_time_mins,
    dts.late_deliveries,
    dts.avg_feedback_score,
    dts.total_feedbacks
from "ae_exam_db"."intermediate"."model_int_driver_task_summary" dts
left join "ae_exam_db"."staging"."model_stg_drivers_master" dm on dts.driver_id = dm.driver_id
    );
  
  
[0m01:20:47.076904 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m01:20:47.079880 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m01:20:47.080323 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m01:20:47.081353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:47.083969 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m01:20:47.084530 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m01:20:47.084882 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m01:20:47.089207 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:47.091532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m01:20:47.091966 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m01:20:47.092640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.093873 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m01:20:47.094331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA69C230>]}
[0m01:20:47.094827 [info ] [Thread-1 (]: 15 of 19 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.10s]
[0m01:20:47.095795 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m01:20:47.096291 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:47.096695 [info ] [Thread-1 (]: 16 of 19 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m01:20:47.097543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m01:20:47.097903 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:47.102319 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.103360 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:47.106632 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.107610 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.108141 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m01:20:47.108546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:47.109250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:47.109637 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.109968 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m01:20:47.117331 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:20:47.120919 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.121382 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m01:20:47.122192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.125217 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.125615 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m01:20:47.126361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.127701 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:20:47.128014 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.128282 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m01:20:47.135812 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:20:47.138318 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m01:20:47.138771 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m01:20:47.142404 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:47.144155 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m01:20:47.144719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA69CFB0>]}
[0m01:20:47.145331 [info ] [Thread-1 (]: 16 of 19 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.05s]
[0m01:20:47.146307 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m01:20:47.146724 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m01:20:47.147188 [info ] [Thread-1 (]: 17 of 19 START sql table model report.report_customer _acquisition ............. [RUN]
[0m01:20:47.148035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m01:20:47.148583 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m01:20:47.153042 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.154050 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m01:20:47.157092 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.157974 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.158381 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m01:20:47.158716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:47.159438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:47.159803 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.160134 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m01:20:47.168484 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:20:47.172597 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.173037 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m01:20:47.173916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.176687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.177128 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m01:20:47.177846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.179076 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:20:47.179383 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.179632 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m01:20:47.185694 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:20:47.189262 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m01:20:47.189647 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m01:20:47.193339 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:47.194690 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m01:20:47.195172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA6D9BB0>]}
[0m01:20:47.195701 [info ] [Thread-1 (]: 17 of 19 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.05s]
[0m01:20:47.197009 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m01:20:47.197490 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m01:20:47.198204 [info ] [Thread-1 (]: 18 of 19 START sql table model report.report_retargeting_performance ........... [RUN]
[0m01:20:47.199704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m01:20:47.200926 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m01:20:47.205410 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.207306 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m01:20:47.211676 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.212837 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.213408 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m01:20:47.213887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:47.214607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:47.215111 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.215750 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m01:20:47.219083 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:20:47.223395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.224088 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m01:20:47.225046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.227634 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.228002 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m01:20:47.228799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.230238 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:20:47.230651 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.231178 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m01:20:47.235603 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:20:47.238420 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m01:20:47.238810 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m01:20:47.242178 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:47.245917 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m01:20:47.246552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEADFAD50>]}
[0m01:20:47.247174 [info ] [Thread-1 (]: 18 of 19 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.05s]
[0m01:20:47.248823 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m01:20:47.249815 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m01:20:47.250667 [info ] [Thread-1 (]: 19 of 19 START sql table model report.report_driver_perfornance ................ [RUN]
[0m01:20:47.252360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_perfornance)
[0m01:20:47.252908 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m01:20:47.255465 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m01:20:47.256351 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m01:20:47.258918 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m01:20:47.260022 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m01:20:47.260455 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m01:20:47.260791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:47.261477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:20:47.261776 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m01:20:47.262044 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m01:20:47.264224 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:20:47.269142 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m01:20:47.269719 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m01:20:47.270572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.271937 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m01:20:47.272280 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m01:20:47.272565 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m01:20:47.275854 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:20:47.277687 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m01:20:47.278007 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m01:20:47.278540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:20:47.280553 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m01:20:47.281181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8323e0b0-3035-447e-8894-44c7066d21fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEA6DA870>]}
[0m01:20:47.282280 [info ] [Thread-1 (]: 19 of 19 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.03s]
[0m01:20:47.284131 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m01:20:47.286895 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:47.287355 [debug] [MainThread]: On master: BEGIN
[0m01:20:47.287644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:47.288263 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:20:47.288591 [debug] [MainThread]: On master: COMMIT
[0m01:20:47.288874 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:47.289122 [debug] [MainThread]: On master: COMMIT
[0m01:20:47.289554 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:20:47.289864 [debug] [MainThread]: On master: Close
[0m01:20:47.290310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:47.290569 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m01:20:47.290798 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m01:20:47.291038 [debug] [MainThread]: Connection 'model.ae_exam_project.report_driver_perfornance' was properly closed.
[0m01:20:47.291423 [info ] [MainThread]: 
[0m01:20:47.292219 [info ] [MainThread]: Finished running 8 table models, 11 view models in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m01:20:47.295812 [debug] [MainThread]: Command end result
[0m01:20:47.326136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m01:20:47.328723 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m01:20:47.338853 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m01:20:47.339422 [info ] [MainThread]: 
[0m01:20:47.340252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:47.341141 [info ] [MainThread]: 
[0m01:20:47.341957 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m01:20:47.343177 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:47.343032 after 2.91 seconds
[0m01:20:47.343577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AE9430DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEB01BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AEB01B950>]}
[0m01:20:47.343938 [debug] [MainThread]: Flushing usage events
[0m01:20:48.762729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:22.302549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9135A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF922D7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF924C7ED0>]}


============================== 13:32:22.310599 | 7cb2b882-bade-49d9-a6a0-ac38e7b863f5 ==============================
[0m13:32:22.310599 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:22.312722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:32:22.653087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb2b882-bade-49d9-a6a0-ac38e7b863f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF91A010F0>]}
[0m13:32:22.718355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb2b882-bade-49d9-a6a0-ac38e7b863f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF92383AC0>]}
[0m13:32:22.748775 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:32:23.237567 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:23.352778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:32:23.353337 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\intermediate\model_int_driver_profile_active.sql
[0m13:32:23.353646 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\intermediate\model_int_zone_delivery_aggregates.sql
[0m13:32:23.540569 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.model_int_zone_delivery_aggregates' (models\intermediate\model_int_zone_delivery_aggregates.sql) depends on a node named 'model_int_order_delivery_summary' which was not found
[0m13:32:23.542420 [debug] [MainThread]: Command `dbt run` failed at 13:32:23.542279 after 1.68 seconds
[0m13:32:23.542757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9259B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9259B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9392B6B0>]}
[0m13:32:23.543068 [debug] [MainThread]: Flushing usage events
[0m13:32:25.325131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:35.995525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F44BDA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F45B67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F45D57ED0>]}


============================== 13:51:36.002100 | 322414ab-733a-47fa-9f9d-2bfbe22bb261 ==============================
[0m13:51:36.002100 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:51:36.003833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:36.296120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F452910F0>]}
[0m13:51:36.383878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F45C13AC0>]}
[0m13:51:36.388257 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:51:36.905041 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:51:37.055061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:37.055579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:37.056232 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m13:51:37.057583 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m13:51:37.058616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F45E28850>]}
[0m13:51:37.103411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F471BAC60>]}
[0m13:51:37.198935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m13:51:37.239603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m13:51:37.269622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F473FD010>]}
[0m13:51:37.270312 [info ] [MainThread]: Found 22 models, 11 sources, 429 macros
[0m13:51:37.271591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F473B8050>]}
[0m13:51:37.275474 [info ] [MainThread]: 
[0m13:51:37.276466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:37.277331 [info ] [MainThread]: 
[0m13:51:37.278515 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:51:37.292941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m13:51:37.426009 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:51:37.427176 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:51:37.427865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:37.469481 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m13:51:37.471909 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:51:37.474675 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:51:37.475278 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:51:37.475718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.477068 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.479007 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:51:37.481473 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:51:37.482010 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:51:37.482417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.483673 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.485272 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:51:37.488687 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:51:37.489345 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:51:37.489754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.491047 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.492681 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:51:37.493727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m13:51:37.494934 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m13:51:37.510872 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:51:37.511421 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:51:37.511832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.513216 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.515074 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:51:37.515511 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m13:51:37.516152 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.516605 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:51:37.516980 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m13:51:37.519479 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:51:37.520672 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m13:51:37.521098 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:51:37.521460 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m13:51:37.522045 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.522433 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m13:51:37.523220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_report)
[0m13:51:37.523855 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m13:51:37.525932 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:51:37.526366 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:51:37.526757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.527866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.529674 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:51:37.530126 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m13:51:37.530782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.531181 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:51:37.531540 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m13:51:37.532160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.533349 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m13:51:37.533789 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:51:37.534151 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m13:51:37.534740 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.535130 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m13:51:37.535824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m13:51:37.536421 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m13:51:37.539157 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:51:37.539619 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:51:37.540051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.541621 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:51:37.543327 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:51:37.543732 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m13:51:37.544331 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.544745 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:51:37.545117 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m13:51:37.545740 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.546885 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m13:51:37.547358 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:51:37.547750 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m13:51:37.548363 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.548755 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m13:51:37.549466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m13:51:37.550044 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m13:51:37.552315 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:51:37.552782 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:51:37.553192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.554356 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.556052 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:51:37.556487 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m13:51:37.557097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.557476 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:51:37.557814 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m13:51:37.558584 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.559794 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m13:51:37.560237 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:51:37.560609 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m13:51:37.561217 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:37.561638 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m13:51:37.565699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m13:51:37.572780 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m13:51:37.573292 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m13:51:37.573652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:37.574579 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.575001 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m13:51:37.575368 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:51:37.606054 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m13:51:37.608569 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m13:51:37.610083 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m13:51:37.610521 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m13:51:37.612451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m13:51:37.614623 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m13:51:37.615048 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m13:51:37.615402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.616105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.616558 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m13:51:37.616938 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:51:37.621809 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:51:37.623645 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m13:51:37.625742 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m13:51:37.626159 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m13:51:37.626798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m13:51:37.628829 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m13:51:37.629254 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m13:51:37.630966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.631729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.632117 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m13:51:37.632468 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:51:37.637374 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:51:37.639140 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m13:51:37.639885 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m13:51:37.640282 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m13:51:37.641763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m13:51:37.644226 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m13:51:37.644634 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m13:51:37.644972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:37.645638 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:37.646003 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m13:51:37.646432 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:51:37.651470 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m13:51:37.653364 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m13:51:37.654127 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m13:51:37.654527 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m13:51:37.657498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F473C6450>]}
[0m13:51:37.658196 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:37.658878 [debug] [MainThread]: On master: BEGIN
[0m13:51:37.659345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:37.660150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:51:37.660557 [debug] [MainThread]: On master: COMMIT
[0m13:51:37.660920 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:37.661256 [debug] [MainThread]: On master: COMMIT
[0m13:51:37.661882 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:51:37.662296 [debug] [MainThread]: On master: Close
[0m13:51:37.666442 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m13:51:37.667220 [info ] [Thread-1 (]: 1 of 22 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m13:51:37.668515 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m13:51:37.669025 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m13:51:37.678709 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.682553 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m13:51:37.725180 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.728054 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.728613 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m13:51:37.729051 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:37.729968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.730458 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.730870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m13:51:37.732663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.740879 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.741472 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m13:51:37.743124 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.746841 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.747546 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m13:51:37.748543 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:37.766697 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m13:51:37.767425 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.767898 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m13:51:37.773476 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:51:37.780586 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:51:37.781218 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m13:51:37.785392 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:37.788675 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m13:51:37.792141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F478043C0>]}
[0m13:51:37.793104 [info ] [Thread-1 (]: 1 of 22 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.12s]
[0m13:51:37.794731 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m13:51:37.795305 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m13:51:37.796189 [info ] [Thread-1 (]: 2 of 22 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m13:51:37.797423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m13:51:37.797913 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m13:51:37.801094 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.802685 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m13:51:37.807172 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.808731 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.809361 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m13:51:37.809832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:37.810650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.811096 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.811524 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m13:51:37.813462 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.817711 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.818254 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m13:51:37.819170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:37.822421 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.822919 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m13:51:37.823775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:37.825897 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m13:51:37.826384 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.826815 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m13:51:37.830137 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:37.834570 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:51:37.835180 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m13:51:37.840321 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:51:37.842159 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m13:51:37.842881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F47818B90>]}
[0m13:51:37.843656 [info ] [Thread-1 (]: 2 of 22 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m13:51:37.844827 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m13:51:37.845348 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m13:51:37.845935 [info ] [Thread-1 (]: 3 of 22 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m13:51:37.847001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m13:51:37.847663 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m13:51:37.851359 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.853197 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m13:51:37.857404 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.859287 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.859894 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m13:51:37.860368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:37.861203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.861677 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.862111 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m13:51:37.863294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.868158 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.868796 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m13:51:37.869831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:37.873435 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.874573 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m13:51:37.875814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:37.877642 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m13:51:37.878189 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.878641 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m13:51:37.882342 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:37.887738 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:51:37.888379 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m13:51:37.892360 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:37.894258 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m13:51:37.894953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F476A6850>]}
[0m13:51:37.895755 [info ] [Thread-1 (]: 3 of 22 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.05s]
[0m13:51:37.897104 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m13:51:37.897963 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m13:51:37.898713 [info ] [Thread-1 (]: 4 of 22 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m13:51:37.899680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m13:51:37.900210 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m13:51:37.903599 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.904917 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m13:51:37.909820 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.911692 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.912279 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m13:51:37.912709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:37.913739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.914506 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.915041 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m13:51:37.916285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.921014 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.921608 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m13:51:37.922588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:37.925992 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.926498 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m13:51:37.927341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:37.930217 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m13:51:37.931358 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.932173 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m13:51:37.936589 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:37.939443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:51:37.939986 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m13:51:37.943550 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:37.949130 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m13:51:37.949933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F4788F620>]}
[0m13:51:37.950922 [info ] [Thread-1 (]: 4 of 22 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.05s]
[0m13:51:37.952169 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m13:51:37.952790 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:51:37.953426 [info ] [Thread-1 (]: 5 of 22 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m13:51:37.954467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m13:51:37.954953 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:51:37.958339 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:37.960061 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:51:37.964286 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:37.966159 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:37.966842 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m13:51:37.967412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:37.968304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:37.968818 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:37.969302 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m13:51:37.970658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.037754 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:38.038465 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m13:51:38.039511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:38.043161 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:38.043707 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:38.044665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:38.046420 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m13:51:38.047155 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:38.047867 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m13:51:38.051779 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.054625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:51:38.055142 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m13:51:38.058571 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.061126 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m13:51:38.061879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F476BE570>]}
[0m13:51:38.062770 [info ] [Thread-1 (]: 5 of 22 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.11s]
[0m13:51:38.064361 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:51:38.064943 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:51:38.065596 [info ] [Thread-1 (]: 6 of 22 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m13:51:38.066549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m13:51:38.067073 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:51:38.070434 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.072350 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:51:38.076173 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.077558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.078135 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m13:51:38.078707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.080126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.080777 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.081276 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m13:51:38.082671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.087244 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.088149 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m13:51:38.089399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.093071 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.093623 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.094632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:38.096474 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m13:51:38.097126 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.097804 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m13:51:38.101860 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.104846 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:51:38.105464 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m13:51:38.108973 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.110943 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m13:51:38.111655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F477E6750>]}
[0m13:51:38.112472 [info ] [Thread-1 (]: 6 of 22 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.05s]
[0m13:51:38.113962 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:51:38.114788 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m13:51:38.115741 [info ] [Thread-1 (]: 7 of 22 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m13:51:38.116837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m13:51:38.117391 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m13:51:38.121338 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.123106 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m13:51:38.127039 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.128808 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.129346 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m13:51:38.129873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.131026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.131799 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.132337 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m13:51:38.133812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.137558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.138123 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m13:51:38.139134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:38.143141 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.143670 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m13:51:38.144614 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:38.146612 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m13:51:38.148297 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.149078 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m13:51:38.152960 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.156061 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:51:38.156683 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m13:51:38.160241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.162403 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m13:51:38.163544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F476BF530>]}
[0m13:51:38.165079 [info ] [Thread-1 (]: 7 of 22 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.05s]
[0m13:51:38.166602 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m13:51:38.167240 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m13:51:38.167911 [info ] [Thread-1 (]: 8 of 22 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m13:51:38.169071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m13:51:38.170110 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m13:51:38.174670 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.176128 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m13:51:38.180653 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.182936 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.183898 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m13:51:38.184440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.185429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.185980 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.186504 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m13:51:38.188183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.193131 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.193843 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m13:51:38.195118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.202149 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.202989 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m13:51:38.204291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.206628 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m13:51:38.207303 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.207938 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m13:51:38.212169 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.217117 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:51:38.217947 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m13:51:38.221621 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.224140 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m13:51:38.225107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F477E6C30>]}
[0m13:51:38.226353 [info ] [Thread-1 (]: 8 of 22 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.06s]
[0m13:51:38.228199 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m13:51:38.229248 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m13:51:38.230635 [info ] [Thread-1 (]: 9 of 22 START sql view model intermediate.model_int_driver_profile_active ...... [RUN]
[0m13:51:38.232062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m13:51:38.232748 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m13:51:38.236934 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m13:51:38.239553 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m13:51:38.245320 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m13:51:38.248621 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:51:38.249664 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m13:51:38.250450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.252151 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:51:38.252949 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:51:38.253617 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m13:51:38.255332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.260645 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:51:38.261430 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m13:51:38.262618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.265809 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m13:51:38.266673 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:51:38.267328 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m13:51:38.271113 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.275531 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:51:38.276254 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m13:51:38.277877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.280723 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m13:51:38.282079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F46F99610>]}
[0m13:51:38.283286 [info ] [Thread-1 (]: 9 of 22 OK created sql view model intermediate.model_int_driver_profile_active . [[32mOK[0m in 0.05s]
[0m13:51:38.284902 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m13:51:38.285599 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:51:38.286397 [info ] [Thread-1 (]: 10 of 22 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m13:51:38.287549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m13:51:38.288301 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:51:38.293901 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.295810 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:51:38.302667 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.304630 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.305433 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m13:51:38.306048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.307119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.307723 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.308383 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m13:51:38.312698 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:38.321486 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.322684 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m13:51:38.324655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.330221 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.331378 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m13:51:38.333330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.337113 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m13:51:38.338202 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.338879 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m13:51:38.343484 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:38.347809 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:51:38.348852 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m13:51:38.353154 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.355766 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m13:51:38.356783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F46F5DE50>]}
[0m13:51:38.358069 [info ] [Thread-1 (]: 10 of 22 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.07s]
[0m13:51:38.360005 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:51:38.361219 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m13:51:38.362498 [info ] [Thread-1 (]: 11 of 22 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m13:51:38.364772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m13:51:38.365744 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m13:51:38.373107 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.376165 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m13:51:38.384000 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.386075 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.387071 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m13:51:38.387749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.388862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.389546 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.390318 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m13:51:38.395146 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:38.402988 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.403878 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m13:51:38.405461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.411241 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.412047 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m13:51:38.413572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.417356 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m13:51:38.418631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.419752 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m13:51:38.424737 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:38.428797 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:51:38.429615 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m13:51:38.433879 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.436484 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m13:51:38.437510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F46F5E870>]}
[0m13:51:38.438643 [info ] [Thread-1 (]: 11 of 22 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.07s]
[0m13:51:38.440283 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m13:51:38.441048 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m13:51:38.442487 [info ] [Thread-1 (]: 12 of 22 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m13:51:38.443915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m13:51:38.445139 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m13:51:38.460725 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.463249 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m13:51:38.470885 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.473880 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.475376 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m13:51:38.476147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.477392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.478062 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.478753 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m13:51:38.484807 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:51:38.490844 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.491675 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m13:51:38.492978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.499234 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.500053 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m13:51:38.501451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.503866 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m13:51:38.504580 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.505190 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m13:51:38.509534 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:38.513856 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:51:38.515172 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m13:51:38.520356 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:38.523744 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m13:51:38.525021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F46F5E150>]}
[0m13:51:38.526467 [info ] [Thread-1 (]: 12 of 22 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.08s]
[0m13:51:38.528667 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m13:51:38.530076 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m13:51:38.531606 [info ] [Thread-1 (]: 13 of 22 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m13:51:38.533194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m13:51:38.534438 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m13:51:38.544363 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:51:38.548363 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m13:51:38.555574 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:51:38.558135 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:51:38.560308 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m13:51:38.561555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.564048 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:51:38.565376 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:51:38.566688 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
select
    ot.order_id,
    ot.driver_id,
    ot.delivery_zone,
    ot.order_datetime,
    ot.pickup_datetime,
    ot.delivery_datetime,
    ot.is_late_delivery,
    case when (ot.order_status  = 'completed') then 1 end as is_completed,
    extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
    extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
    case when ot.is_late_delivery = true then 1 end as late_deliveries,
    ld.bonus_amount,
    extract(epoch from ot.delivery_datetime - ot.order_datetime)/60.0 as delivery_duration_mins,
    st.csat_score,
    st.ticket_id,
    ld.delivery_target,
    ld.actual_deliveries
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m13:51:38.571430 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.577573 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:51:38.578455 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m13:51:38.580307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.583331 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m13:51:38.584443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:51:38.585206 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m13:51:38.589659 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:38.593746 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:51:38.594802 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m13:51:38.596213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.599064 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m13:51:38.600251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F4479A450>]}
[0m13:51:38.601620 [info ] [Thread-1 (]: 13 of 22 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.07s]
[0m13:51:38.603426 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m13:51:38.604286 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m13:51:38.605211 [info ] [Thread-1 (]: 14 of 22 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m13:51:38.606794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m13:51:38.607607 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m13:51:38.614147 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.617774 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m13:51:38.667579 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.671175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.672063 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m13:51:38.672750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.673994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.674712 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.675471 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m13:51:38.778542 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m13:51:38.784502 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.785330 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m13:51:38.787264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.792615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.793489 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m13:51:38.795126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.805206 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m13:51:38.806121 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.806799 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m13:51:38.816513 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:51:38.820837 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:51:38.821642 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m13:51:38.825854 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:38.828726 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m13:51:38.829870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F476BFDD0>]}
[0m13:51:38.831065 [info ] [Thread-1 (]: 14 of 22 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.22s]
[0m13:51:38.832876 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m13:51:38.833744 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m13:51:38.834727 [info ] [Thread-1 (]: 15 of 22 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m13:51:38.836155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m13:51:38.836890 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m13:51:38.844952 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:38.847310 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m13:51:38.853152 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:38.856107 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:38.857087 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m13:51:38.857932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.859134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:38.859828 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:38.860672 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m13:51:39.361920 [debug] [Thread-1 (]: SQL status: OK in 0.500 seconds
[0m13:51:39.370959 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:39.372019 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m13:51:39.373906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:39.381045 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:39.382502 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m13:51:39.384130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:39.387292 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m13:51:39.388771 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:39.389738 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m13:51:39.399820 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:51:39.404527 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:51:39.405524 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m13:51:39.410092 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:39.413867 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m13:51:39.415512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F45DD8E90>]}
[0m13:51:39.417000 [info ] [Thread-1 (]: 15 of 22 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.58s]
[0m13:51:39.419399 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m13:51:39.421062 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m13:51:39.422957 [info ] [Thread-1 (]: 16 of 22 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m13:51:39.425042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m13:51:39.426160 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m13:51:39.436380 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:39.439180 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m13:51:39.446223 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:39.449700 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:39.451303 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m13:51:39.452387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:39.453783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:39.454613 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:39.455588 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m13:51:40.211408 [debug] [Thread-1 (]: SQL status: OK in 0.755 seconds
[0m13:51:40.216941 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:40.217784 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m13:51:40.219353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.225239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:40.226068 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m13:51:40.227454 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.230405 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m13:51:40.231218 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:40.231904 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m13:51:40.237849 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:51:40.242201 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:51:40.243072 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m13:51:40.259774 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m13:51:40.263226 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m13:51:40.264408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F477E7470>]}
[0m13:51:40.265814 [info ] [Thread-1 (]: 16 of 22 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.84s]
[0m13:51:40.267891 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m13:51:40.268745 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:51:40.269650 [info ] [Thread-1 (]: 17 of 22 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m13:51:40.270936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m13:51:40.271776 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:51:40.277364 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:51:40.280069 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:51:40.287075 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:51:40.289937 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:51:40.290785 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m13:51:40.291472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:40.292634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.293382 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:51:40.294060 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    --sum(is_unassigned) as no_driver_orders,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m13:51:40.298961 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:40.304495 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:51:40.305363 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m13:51:40.306962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.309524 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m13:51:40.310313 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:51:40.310989 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m13:51:40.314999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:40.320060 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:51:40.320920 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m13:51:40.322209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.324972 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m13:51:40.326063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F478508F0>]}
[0m13:51:40.327286 [info ] [Thread-1 (]: 17 of 22 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.06s]
[0m13:51:40.329183 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:51:40.330205 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m13:51:40.331211 [info ] [Thread-1 (]: 18 of 22 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m13:51:40.332629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_performance)
[0m13:51:40.333401 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m13:51:40.339950 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m13:51:40.342733 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m13:51:40.348630 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m13:51:40.351321 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:51:40.352144 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m13:51:40.352802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:40.354036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.355015 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:51:40.355994 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driv er_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    avg(ods.csat_score) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driv er_id,
    dp.vehicle_type,
    dp.region
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m13:51:40.360682 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driv er_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    avg(ods.csat_score) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driv er_id,
    dp.vehicle_type,
    dp.region
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m13:51:40.361650 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:51:40.362592 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: ROLLBACK
[0m13:51:40.642701 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_driver_performance'
[0m13:51:40.643445 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m13:51:40.651479 [debug] [Thread-1 (]: Runtime Error in model model_mart_driver_performance (models\mart\feet\model_mart_driver_performance.sql)
  Parser Error: syntax error at or near "er_id"
[0m13:51:40.652342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F47891F70>]}
[0m13:51:40.653424 [error] [Thread-1 (]: 18 of 22 ERROR creating sql table model mart.model_mart_driver_performance ..... [[31mERROR[0m in 0.32s]
[0m13:51:40.654884 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m13:51:40.655550 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m13:51:40.657218 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_driver_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_driver_performance (models\mart\feet\model_mart_driver_performance.sql)
  Parser Error: syntax error at or near "er_id".
[0m13:51:40.656308 [info ] [Thread-1 (]: 19 of 22 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m13:51:40.659389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m13:51:40.660051 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m13:51:40.665489 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.668162 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m13:51:40.672393 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.674650 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.675284 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m13:51:40.675819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:40.676772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.677316 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.677848 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m13:51:40.687104 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:51:40.691563 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.692201 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m13:51:40.693267 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:40.701631 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.702309 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m13:51:40.703428 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.705874 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m13:51:40.706518 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.707027 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m13:51:40.713709 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:51:40.717219 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:51:40.717837 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m13:51:40.721697 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:40.723828 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m13:51:40.724581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F478F5FD0>]}
[0m13:51:40.725479 [info ] [Thread-1 (]: 19 of 22 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.07s]
[0m13:51:40.726791 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m13:51:40.727363 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m13:51:40.728032 [info ] [Thread-1 (]: 20 of 22 START sql table model report.report_customer _acquisition ............. [RUN]
[0m13:51:40.729086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m13:51:40.729708 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m13:51:40.733473 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.734887 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m13:51:40.739400 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.740932 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.741717 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m13:51:40.742243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:40.743157 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.743667 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.744143 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m13:51:40.755707 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m13:51:40.760493 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.761264 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m13:51:40.762674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.767780 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.768503 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m13:51:40.769652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.772455 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m13:51:40.773065 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.773588 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m13:51:40.780728 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:51:40.784232 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:51:40.784872 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m13:51:40.788806 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:40.791049 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m13:51:40.791867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F477E5AF0>]}
[0m13:51:40.792775 [info ] [Thread-1 (]: 20 of 22 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.06s]
[0m13:51:40.794853 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m13:51:40.795473 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m13:51:40.796359 [info ] [Thread-1 (]: 21 of 22 START sql table model report.report_retargeting_performance ........... [RUN]
[0m13:51:40.797569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m13:51:40.798226 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m13:51:40.802619 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.804097 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m13:51:40.809162 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.810759 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.811410 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m13:51:40.811939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:40.813113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.813713 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.814229 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m13:51:40.818548 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:40.823280 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.823948 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m13:51:40.825045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.829265 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.830012 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m13:51:40.831190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:40.833726 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m13:51:40.834438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.835110 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m13:51:40.838789 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:40.842452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:51:40.843036 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m13:51:40.846917 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:51:40.849215 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m13:51:40.850075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322414ab-733a-47fa-9f9d-2bfbe22bb261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F47906AB0>]}
[0m13:51:40.850997 [info ] [Thread-1 (]: 21 of 22 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.05s]
[0m13:51:40.852305 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m13:51:40.852875 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m13:51:40.853452 [info ] [Thread-1 (]: 22 of 22 SKIP relation report.report_driver_perfornance ........................ [[33mSKIP[0m]
[0m13:51:40.854460 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m13:51:40.856574 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:40.857072 [debug] [MainThread]: On master: BEGIN
[0m13:51:40.857473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:40.858530 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:51:40.859201 [debug] [MainThread]: On master: COMMIT
[0m13:51:40.859700 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:40.860116 [debug] [MainThread]: On master: COMMIT
[0m13:51:40.860803 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:51:40.861246 [debug] [MainThread]: On master: Close
[0m13:51:40.861821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:40.862211 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m13:51:40.862563 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m13:51:40.862918 [debug] [MainThread]: Connection 'model.ae_exam_project.report_retargeting_performance' was properly closed.
[0m13:51:40.863524 [info ] [MainThread]: 
[0m13:51:40.864486 [info ] [MainThread]: Finished running 8 table models, 14 view models in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m13:51:40.870316 [debug] [MainThread]: Command end result
[0m13:51:40.911203 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m13:51:40.915287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m13:51:40.926475 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m13:51:40.927318 [info ] [MainThread]: 
[0m13:51:40.928226 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:51:40.929103 [info ] [MainThread]: 
[0m13:51:40.930190 [error] [MainThread]:   Runtime Error in model model_mart_driver_performance (models\mart\feet\model_mart_driver_performance.sql)
  Parser Error: syntax error at or near "er_id"
[0m13:51:40.931107 [info ] [MainThread]: 
[0m13:51:40.931923 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=1 TOTAL=22
[0m13:51:40.933280 [debug] [MainThread]: Command `dbt run` failed at 13:51:40.933083 after 5.16 seconds
[0m13:51:40.933834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F44B26CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F47917950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F47917DD0>]}
[0m13:51:44.291878 [debug] [MainThread]: An error was encountered while trying to send an event
[0m13:51:44.294209 [debug] [MainThread]: Flushing usage events
[0m13:54:26.876261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969A13A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969B0B7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969B2A7ED0>]}


============================== 13:54:26.879811 | f4e9ec55-6aa3-4622-8836-a19d96d4648e ==============================
[0m13:54:26.879811 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:54:26.880657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:54:27.046055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969A7E10F0>]}
[0m13:54:27.100062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969B163AC0>]}
[0m13:54:27.102837 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:54:27.256366 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:54:27.362578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:27.362920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:27.363330 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m13:54:27.364014 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m13:54:27.364594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969B374850>]}
[0m13:54:27.395985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C72AC60>]}
[0m13:54:27.456781 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m13:54:27.458812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m13:54:27.478133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C96D010>]}
[0m13:54:27.479035 [info ] [MainThread]: Found 22 models, 11 sources, 429 macros
[0m13:54:27.479768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C928050>]}
[0m13:54:27.482562 [info ] [MainThread]: 
[0m13:54:27.483480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:27.484713 [info ] [MainThread]: 
[0m13:54:27.485384 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:27.490913 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m13:54:27.550742 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:54:27.551233 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:54:27.551526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:27.573499 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:54:27.574700 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:54:27.576676 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:54:27.577136 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:54:27.577444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.578419 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.579676 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:54:27.581292 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:54:27.581625 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:54:27.581955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.583022 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.584697 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:54:27.586891 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m13:54:27.587301 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m13:54:27.587558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.588502 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.589545 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m13:54:27.590301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m13:54:27.590675 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m13:54:27.596805 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:54:27.597199 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:54:27.597468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.598408 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.600810 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:54:27.601173 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m13:54:27.601733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.602007 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:54:27.602237 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m13:54:27.602753 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.603502 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m13:54:27.603759 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m13:54:27.603970 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m13:54:27.604371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.604630 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m13:54:27.605076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m13:54:27.605440 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m13:54:27.606724 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:54:27.607003 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:54:27.607251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.608058 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.609188 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:54:27.609486 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m13:54:27.609904 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.610137 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:54:27.610333 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m13:54:27.610730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.611397 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m13:54:27.611632 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m13:54:27.611834 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m13:54:27.612182 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.612401 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m13:54:27.612818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_mart)
[0m13:54:27.613348 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m13:54:27.615386 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:54:27.615670 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:54:27.615911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.616781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.617828 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:54:27.618059 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m13:54:27.618438 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.618679 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:54:27.618931 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m13:54:27.619324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.619972 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m13:54:27.620208 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m13:54:27.620414 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m13:54:27.620746 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.620976 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m13:54:27.621371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m13:54:27.621696 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m13:54:27.622858 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:54:27.623101 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m13:54:27.623300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.624202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.625242 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:54:27.625566 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m13:54:27.625949 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.626175 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:54:27.626365 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m13:54:27.626730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.627376 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m13:54:27.627597 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m13:54:27.627783 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m13:54:27.628108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.628341 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m13:54:27.630774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m13:54:27.635527 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m13:54:27.635858 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m13:54:27.636079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:27.636679 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.636924 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m13:54:27.637144 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:54:27.648646 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:54:27.650438 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m13:54:27.651428 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m13:54:27.651689 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m13:54:27.652093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m13:54:27.653236 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m13:54:27.653466 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m13:54:27.653661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.654779 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.655032 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m13:54:27.655254 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:54:27.658337 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:54:27.659483 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m13:54:27.660046 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m13:54:27.660287 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m13:54:27.660688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_mart)
[0m13:54:27.661886 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m13:54:27.662126 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m13:54:27.662318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.663566 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:27.663794 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m13:54:27.664008 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:54:27.667270 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:54:27.668352 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m13:54:27.668945 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m13:54:27.669177 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m13:54:27.669559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m13:54:27.671871 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m13:54:27.672145 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m13:54:27.672357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:27.672815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:27.673045 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m13:54:27.673245 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m13:54:27.676241 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:54:27.677301 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m13:54:27.677759 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m13:54:27.677972 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m13:54:27.679802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C936510>]}
[0m13:54:27.680214 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:27.680451 [debug] [MainThread]: On master: BEGIN
[0m13:54:27.680640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:27.681082 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:54:27.681299 [debug] [MainThread]: On master: COMMIT
[0m13:54:27.681503 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:27.681687 [debug] [MainThread]: On master: COMMIT
[0m13:54:27.682031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:54:27.682283 [debug] [MainThread]: On master: Close
[0m13:54:27.685008 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m13:54:27.685445 [info ] [Thread-1 (]: 1 of 22 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m13:54:27.686218 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m13:54:27.686575 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m13:54:27.692359 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.693498 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m13:54:27.720358 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.721386 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.721737 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m13:54:27.721985 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:54:27.722521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.722781 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.723017 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m13:54:27.723877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.728527 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.728862 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m13:54:27.729500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.731741 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.732020 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m13:54:27.732656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.742342 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m13:54:27.742710 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.742965 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m13:54:27.747503 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:27.752252 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m13:54:27.752600 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m13:54:27.755727 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.757904 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m13:54:27.760205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CD74890>]}
[0m13:54:27.761003 [info ] [Thread-1 (]: 1 of 22 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.07s]
[0m13:54:27.761832 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m13:54:27.762230 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m13:54:27.762579 [info ] [Thread-1 (]: 2 of 22 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m13:54:27.763333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m13:54:27.763930 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m13:54:27.766384 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.767297 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m13:54:27.769569 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.770338 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.770735 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m13:54:27.771103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:27.771763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.772105 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.772354 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m13:54:27.773309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.776139 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.776674 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m13:54:27.778069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.781123 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.781471 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m13:54:27.782139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.783329 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m13:54:27.783710 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.783980 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m13:54:27.787531 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.790468 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m13:54:27.790961 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m13:54:27.794044 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.795263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m13:54:27.795704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CDC6210>]}
[0m13:54:27.796164 [info ] [Thread-1 (]: 2 of 22 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.03s]
[0m13:54:27.796903 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m13:54:27.797227 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m13:54:27.797586 [info ] [Thread-1 (]: 3 of 22 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m13:54:27.798349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m13:54:27.798757 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m13:54:27.801394 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.802694 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m13:54:27.805261 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.806086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.806471 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m13:54:27.806717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:27.807241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.807492 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.807726 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m13:54:27.808608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.810881 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.811178 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m13:54:27.811779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.813708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.813995 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m13:54:27.814581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.816058 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m13:54:27.816596 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.817066 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m13:54:27.820504 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.823649 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m13:54:27.824033 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m13:54:27.827144 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.828296 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m13:54:27.828699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CBDB650>]}
[0m13:54:27.829223 [info ] [Thread-1 (]: 3 of 22 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.03s]
[0m13:54:27.830029 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m13:54:27.830401 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m13:54:27.830729 [info ] [Thread-1 (]: 4 of 22 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m13:54:27.831389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m13:54:27.831826 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m13:54:27.835800 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.837100 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m13:54:27.839876 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.840768 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.841118 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m13:54:27.841364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:27.841903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.842174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.842422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m13:54:27.843086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.845096 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.845364 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m13:54:27.845884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.848531 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.849024 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m13:54:27.849798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.851218 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m13:54:27.851656 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.851957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m13:54:27.855062 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.859269 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m13:54:27.859654 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m13:54:27.862695 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.863851 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m13:54:27.864271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CE1AF90>]}
[0m13:54:27.864865 [info ] [Thread-1 (]: 4 of 22 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.03s]
[0m13:54:27.865808 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m13:54:27.866275 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:54:27.866800 [info ] [Thread-1 (]: 5 of 22 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m13:54:27.867550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m13:54:27.867956 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:54:27.870129 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.871373 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:54:27.874503 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.875509 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.875895 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m13:54:27.876146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:27.876701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.876968 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.877214 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m13:54:27.877980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.930599 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.930981 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m13:54:27.931630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.933900 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.934232 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.934837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.935841 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m13:54:27.936135 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.936394 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m13:54:27.939698 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.941706 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m13:54:27.942024 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m13:54:27.945040 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.946281 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m13:54:27.946723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CC2A330>]}
[0m13:54:27.947183 [info ] [Thread-1 (]: 5 of 22 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.08s]
[0m13:54:27.948018 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m13:54:27.948366 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:54:27.948956 [info ] [Thread-1 (]: 6 of 22 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m13:54:27.949711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m13:54:27.950072 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:54:27.952007 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.952800 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:54:27.954903 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.955709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.956034 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m13:54:27.956293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:27.956837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.957109 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.957361 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m13:54:27.958111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.960643 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.960954 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m13:54:27.961545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.963436 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.963711 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.964228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.965719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m13:54:27.966207 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.966532 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m13:54:27.969525 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.971206 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m13:54:27.971522 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m13:54:27.974504 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:27.975735 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m13:54:27.976157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CD56C90>]}
[0m13:54:27.976619 [info ] [Thread-1 (]: 6 of 22 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.03s]
[0m13:54:27.977742 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m13:54:27.978129 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m13:54:27.978539 [info ] [Thread-1 (]: 7 of 22 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m13:54:27.979244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m13:54:27.979585 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m13:54:27.982019 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:27.983304 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m13:54:27.986884 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:27.988076 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:27.988460 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m13:54:27.988921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:27.989900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.990691 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:27.991072 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m13:54:27.991924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:27.993990 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:27.994530 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m13:54:27.995108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.997181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:27.997476 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m13:54:27.998047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:27.999210 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m13:54:27.999575 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:27.999903 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m13:54:28.003123 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.006062 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m13:54:28.006478 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m13:54:28.009410 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.010584 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m13:54:28.010998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CC2B290>]}
[0m13:54:28.011449 [info ] [Thread-1 (]: 7 of 22 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.03s]
[0m13:54:28.012821 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m13:54:28.013102 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m13:54:28.013420 [info ] [Thread-1 (]: 8 of 22 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m13:54:28.014093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m13:54:28.014388 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m13:54:28.017373 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.018656 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m13:54:28.020880 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.021668 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.022021 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m13:54:28.022281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.022815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.023074 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.023310 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m13:54:28.024072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.026099 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.026385 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m13:54:28.026922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.029653 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.029991 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m13:54:28.030603 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.031591 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m13:54:28.031917 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.032222 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m13:54:28.035478 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.037411 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m13:54:28.037879 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m13:54:28.041587 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.042884 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m13:54:28.043835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CD570B0>]}
[0m13:54:28.044784 [info ] [Thread-1 (]: 8 of 22 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.03s]
[0m13:54:28.045827 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m13:54:28.046425 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m13:54:28.047198 [info ] [Thread-1 (]: 9 of 22 START sql view model intermediate.model_int_driver_profile_active ...... [RUN]
[0m13:54:28.048195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m13:54:28.048615 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m13:54:28.051514 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.052602 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m13:54:28.055801 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.057641 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.058713 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m13:54:28.059241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.059922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.060261 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.060572 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m13:54:28.061477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.063653 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.063966 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m13:54:28.064582 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.067383 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.067798 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m13:54:28.068517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.070009 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m13:54:28.070321 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.070568 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m13:54:28.073743 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.075611 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m13:54:28.075940 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m13:54:28.078976 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.080510 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m13:54:28.081090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C52CB90>]}
[0m13:54:28.081685 [info ] [Thread-1 (]: 9 of 22 OK created sql view model intermediate.model_int_driver_profile_active . [[32mOK[0m in 0.03s]
[0m13:54:28.083295 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m13:54:28.083797 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:54:28.085241 [info ] [Thread-1 (]: 10 of 22 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m13:54:28.086602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m13:54:28.087329 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:54:28.090708 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.091914 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:54:28.095525 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.096807 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.097285 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m13:54:28.097651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.098267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.098674 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.099271 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m13:54:28.103460 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:28.106881 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.107313 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m13:54:28.108206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.110643 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.110999 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m13:54:28.111684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.112666 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m13:54:28.113097 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.113527 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m13:54:28.117111 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.119995 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m13:54:28.120395 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m13:54:28.123561 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.124913 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m13:54:28.125357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CD55C70>]}
[0m13:54:28.125834 [info ] [Thread-1 (]: 10 of 22 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.04s]
[0m13:54:28.126939 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m13:54:28.127243 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m13:54:28.127570 [info ] [Thread-1 (]: 11 of 22 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m13:54:28.128323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m13:54:28.128657 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m13:54:28.131164 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.132332 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m13:54:28.135890 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.137250 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.137783 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m13:54:28.138237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.138969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.139275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.139574 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m13:54:28.141161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.143518 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.143816 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m13:54:28.144407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.146319 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.146598 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m13:54:28.147126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.148149 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m13:54:28.148600 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.149055 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m13:54:28.152882 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.157512 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m13:54:28.157914 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m13:54:28.161180 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.162339 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m13:54:28.162771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C4CDE50>]}
[0m13:54:28.163273 [info ] [Thread-1 (]: 11 of 22 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.03s]
[0m13:54:28.164075 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m13:54:28.164434 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m13:54:28.164949 [info ] [Thread-1 (]: 12 of 22 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m13:54:28.165767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m13:54:28.166279 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m13:54:28.169889 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.171017 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m13:54:28.173901 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.174975 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.175348 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m13:54:28.175594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.176148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.176484 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.176792 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m13:54:28.178630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.181119 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.181413 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m13:54:28.182059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.185850 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.186385 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m13:54:28.187191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.188364 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m13:54:28.188685 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.189015 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m13:54:28.192117 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.193884 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m13:54:28.194193 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m13:54:28.197179 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.198648 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m13:54:28.199534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C52CF50>]}
[0m13:54:28.200633 [info ] [Thread-1 (]: 12 of 22 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.03s]
[0m13:54:28.201616 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m13:54:28.202006 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m13:54:28.202411 [info ] [Thread-1 (]: 13 of 22 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m13:54:28.203007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m13:54:28.203309 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m13:54:28.206903 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.207929 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m13:54:28.210201 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.211079 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.211416 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m13:54:28.211658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.212182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.212437 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.212707 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
select
    ot.order_id,
    ot.driver_id,
    ot.delivery_zone,
    ot.order_datetime,
    ot.pickup_datetime,
    ot.delivery_datetime,
    ot.is_late_delivery,
    case when (ot.order_status  = 'completed') then 1 end as is_completed,
    extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
    extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
    case when ot.is_late_delivery = true then 1 end as late_deliveries,
    ld.bonus_amount,
    extract(epoch from ot.delivery_datetime - ot.order_datetime)/60.0 as delivery_duration_mins,
    st.csat_score,
    st.ticket_id,
    ld.delivery_target,
    ld.actual_deliveries
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m13:54:28.214288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.217613 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.218205 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary" rename to "model_int_order_delivery_summary__dbt_backup"
[0m13:54:28.218990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.221461 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.221760 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m13:54:28.222405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.223428 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m13:54:28.223749 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.224006 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m13:54:28.227241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.228973 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m13:54:28.229263 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m13:54:28.232094 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:28.234400 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m13:54:28.234999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C4CC350>]}
[0m13:54:28.235562 [info ] [Thread-1 (]: 13 of 22 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.03s]
[0m13:54:28.236398 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m13:54:28.236908 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m13:54:28.237436 [info ] [Thread-1 (]: 14 of 22 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m13:54:28.238338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m13:54:28.238690 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m13:54:28.241171 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.242051 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m13:54:28.259683 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.260674 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.261083 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m13:54:28.261323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.261864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.262126 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.262394 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m13:54:28.299290 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:54:28.302446 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.302804 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m13:54:28.303502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.305715 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.305998 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m13:54:28.306552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.311339 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m13:54:28.311721 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.311991 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m13:54:28.319542 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:54:28.321186 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m13:54:28.321447 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m13:54:28.324757 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.326016 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m13:54:28.326438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969C4CD130>]}
[0m13:54:28.326883 [info ] [Thread-1 (]: 14 of 22 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.09s]
[0m13:54:28.328209 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m13:54:28.328541 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m13:54:28.329094 [info ] [Thread-1 (]: 15 of 22 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m13:54:28.329744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m13:54:28.330075 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m13:54:28.333036 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.334389 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m13:54:28.337904 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.338899 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.339244 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m13:54:28.339475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.340023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.340354 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.340697 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m13:54:28.515018 [debug] [Thread-1 (]: SQL status: OK in 0.174 seconds
[0m13:54:28.517993 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.518537 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m13:54:28.519257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.521298 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.521583 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m13:54:28.522167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.523513 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m13:54:28.523794 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.524042 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m13:54:28.530197 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:54:28.531935 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m13:54:28.532289 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m13:54:28.535271 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.536472 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m13:54:28.537081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969ADBAAB0>]}
[0m13:54:28.537581 [info ] [Thread-1 (]: 15 of 22 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.21s]
[0m13:54:28.538481 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m13:54:28.538841 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m13:54:28.539241 [info ] [Thread-1 (]: 16 of 22 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m13:54:28.539972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m13:54:28.540273 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m13:54:28.543169 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.544012 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m13:54:28.546459 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.547659 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.548148 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m13:54:28.548488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.549372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.549741 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.550094 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m13:54:28.835979 [debug] [Thread-1 (]: SQL status: OK in 0.285 seconds
[0m13:54:28.838097 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.838402 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m13:54:28.839043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.840910 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.841188 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m13:54:28.841710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.842649 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m13:54:28.842924 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.843228 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m13:54:28.860403 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m13:54:28.862780 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m13:54:28.863140 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m13:54:28.866212 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.867688 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m13:54:28.868170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CC2B830>]}
[0m13:54:28.868648 [info ] [Thread-1 (]: 16 of 22 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.33s]
[0m13:54:28.869402 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m13:54:28.869736 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:54:28.870087 [info ] [Thread-1 (]: 17 of 22 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m13:54:28.870762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m13:54:28.871045 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:54:28.872885 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.873647 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:54:28.875673 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.876672 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.877149 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m13:54:28.877492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.878061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.878312 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.878561 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    --sum(is_unassigned) as no_driver_orders,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m13:54:28.880438 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:28.883248 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.883673 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates" rename to "model_int_zone_delivery_aggregates__dbt_backup"
[0m13:54:28.884381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.886737 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.887245 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m13:54:28.888165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.889583 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m13:54:28.889955 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.890255 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m13:54:28.894059 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.896229 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m13:54:28.896728 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m13:54:28.899799 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:28.902593 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m13:54:28.903519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CD562D0>]}
[0m13:54:28.904110 [info ] [Thread-1 (]: 17 of 22 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.03s]
[0m13:54:28.905039 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m13:54:28.905590 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m13:54:28.906217 [info ] [Thread-1 (]: 18 of 22 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m13:54:28.906983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_performance)
[0m13:54:28.907453 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m13:54:28.910816 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:28.912596 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m13:54:28.915852 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:28.917896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:28.918309 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m13:54:28.918724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:28.919373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:28.919683 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:28.919998 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    round(avg(ods.csat_score),2) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m13:54:28.986952 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m13:54:28.991002 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:28.991354 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance" rename to "model_mart_driver_performance__dbt_backup"
[0m13:54:28.992030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.994080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:28.994366 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m13:54:28.994909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:28.995885 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m13:54:28.996155 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:28.996390 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m13:54:29.002410 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:54:29.004123 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m13:54:29.004405 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m13:54:29.007248 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:29.008785 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m13:54:29.009403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CC2B9B0>]}
[0m13:54:29.010210 [info ] [Thread-1 (]: 18 of 22 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.10s]
[0m13:54:29.011104 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m13:54:29.011450 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m13:54:29.011803 [info ] [Thread-1 (]: 19 of 22 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m13:54:29.012412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m13:54:29.012716 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m13:54:29.015048 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.016124 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m13:54:29.019156 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.020058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.020389 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m13:54:29.020618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:29.021145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.021395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.021631 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m13:54:29.026013 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:29.028085 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.028382 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m13:54:29.028993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.031107 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.031378 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m13:54:29.031897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.033452 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m13:54:29.033907 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.034236 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m13:54:29.039674 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:29.041427 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m13:54:29.041723 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m13:54:29.044755 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:29.045920 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m13:54:29.046340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CD56A50>]}
[0m13:54:29.046770 [info ] [Thread-1 (]: 19 of 22 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.03s]
[0m13:54:29.047546 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m13:54:29.047975 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m13:54:29.048665 [info ] [Thread-1 (]: 20 of 22 START sql table model report.report_customer _acquisition ............. [RUN]
[0m13:54:29.049641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m13:54:29.050052 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m13:54:29.052316 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.053198 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m13:54:29.056624 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.057562 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.057957 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m13:54:29.058220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:29.058770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:29.059094 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.059326 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m13:54:29.064276 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:29.067399 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.067792 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m13:54:29.068449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.070772 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.071182 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m13:54:29.071922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.073503 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m13:54:29.073842 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.074084 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m13:54:29.079510 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:29.081878 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m13:54:29.082595 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m13:54:29.085822 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:29.087371 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m13:54:29.088026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296983D5670>]}
[0m13:54:29.089015 [info ] [Thread-1 (]: 20 of 22 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.04s]
[0m13:54:29.090224 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m13:54:29.090641 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m13:54:29.090998 [info ] [Thread-1 (]: 21 of 22 START sql table model report.report_retargeting_performance ........... [RUN]
[0m13:54:29.091694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m13:54:29.092014 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m13:54:29.093995 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.094739 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m13:54:29.097054 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.097837 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.098299 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m13:54:29.098743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:29.099727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:29.100104 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.100438 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m13:54:29.102029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:29.104404 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.104813 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m13:54:29.105850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:29.108531 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.108931 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m13:54:29.109583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.110592 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m13:54:29.110866 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.111099 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m13:54:29.114234 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:29.116889 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m13:54:29.117326 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m13:54:29.120752 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:29.123189 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m13:54:29.124290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296983D5670>]}
[0m13:54:29.124816 [info ] [Thread-1 (]: 21 of 22 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.03s]
[0m13:54:29.125647 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m13:54:29.125994 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m13:54:29.126362 [info ] [Thread-1 (]: 22 of 22 START sql table model report.report_driver_perfornance ................ [RUN]
[0m13:54:29.127013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_perfornance)
[0m13:54:29.127297 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m13:54:29.129511 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.130321 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m13:54:29.132852 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.134181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.134643 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m13:54:29.134944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:29.135802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:29.136141 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.136377 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m13:54:29.141416 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:29.143845 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.144174 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance" rename to "report_driver_perfornance__dbt_backup"
[0m13:54:29.144780 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.146621 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.146894 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m13:54:29.147437 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:29.148970 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m13:54:29.149573 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.150108 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m13:54:29.155469 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:29.158844 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m13:54:29.159301 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m13:54:29.162234 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:29.163585 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m13:54:29.164098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4e9ec55-6aa3-4622-8836-a19d96d4648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CC2A7B0>]}
[0m13:54:30.492462 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m13:54:30.494373 [info ] [Thread-1 (]: 22 of 22 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.04s]
[0m13:54:30.496251 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m13:54:30.499925 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:30.500884 [debug] [MainThread]: On master: BEGIN
[0m13:54:30.501600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:30.502828 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:54:30.503471 [debug] [MainThread]: On master: COMMIT
[0m13:54:30.504045 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:30.504633 [debug] [MainThread]: On master: COMMIT
[0m13:54:30.505551 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:54:30.506149 [debug] [MainThread]: On master: Close
[0m13:54:30.506893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:30.507404 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m13:54:30.508077 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m13:54:30.508575 [debug] [MainThread]: Connection 'model.ae_exam_project.report_driver_perfornance' was properly closed.
[0m13:54:30.509340 [info ] [MainThread]: 
[0m13:54:30.510257 [info ] [MainThread]: Finished running 8 table models, 14 view models in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m13:54:30.514715 [debug] [MainThread]: Command end result
[0m13:54:30.535789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m13:54:30.537803 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m13:54:30.544595 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m13:54:30.545109 [info ] [MainThread]: 
[0m13:54:30.545665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:30.546154 [info ] [MainThread]: 
[0m13:54:30.546664 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m13:54:30.547554 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:30.547426 after 3.85 seconds
[0m13:54:30.547845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969A0034D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CDAFEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002969CDADC10>]}
[0m13:54:30.548157 [debug] [MainThread]: Flushing usage events
[0m13:54:31.544165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:10.449599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F294A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F38D7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F3AC7ED0>]}


============================== 14:58:10.456772 | 5aaf0b90-cc6b-4134-b40b-47c9c6c26aaa ==============================
[0m14:58:10.456772 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:58:10.458360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:10.887298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aaf0b90-cc6b-4134-b40b-47c9c6c26aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F30010F0>]}
[0m14:58:10.981254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aaf0b90-cc6b-4134-b40b-47c9c6c26aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F3987AC0>]}
[0m14:58:10.987329 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:58:11.407240 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:58:11.640256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m14:58:11.641233 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\report\report_driver_zone_heatmap.sql
[0m14:58:11.641929 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\mart\feet\model_mart_driver_zone_heatmap.sql
[0m14:58:11.642678 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\intermediate\model_int_order_delivery_summary.sql
[0m14:58:11.991369 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.model_mart_driver_zone_heatmap' (models\mart\feet\model_mart_driver_zone_heatmap.sql) depends on a node named 'int_driver_profile_active' which was not found
[0m14:58:11.993688 [debug] [MainThread]: Command `dbt run` failed at 14:58:11.993453 after 2.06 seconds
[0m14:58:11.994280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F3B9A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F3B9B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9F50963F0>]}
[0m14:58:11.994832 [debug] [MainThread]: Flushing usage events
[0m14:58:13.358346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:42.377499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28A6FA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B677890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B867ED0>]}


============================== 14:58:42.382445 | 8b765442-c608-43ba-bbd3-7286f299a4e8 ==============================
[0m14:58:42.382445 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:58:42.383565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:42.583431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28ADA10F0>]}
[0m14:58:42.651279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B723AC0>]}
[0m14:58:42.654841 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:58:42.857354 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:58:43.005641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:43.006170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:43.006991 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m14:58:43.007858 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m14:58:43.008600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B938850>]}
[0m14:58:43.052566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28CC5AC60>]}
[0m14:58:43.160476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m14:58:43.164669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m14:58:43.223738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28CEB5010>]}
[0m14:58:43.224573 [info ] [MainThread]: Found 24 models, 11 sources, 429 macros
[0m14:58:43.225296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28CE5C050>]}
[0m14:58:43.229564 [info ] [MainThread]: 
[0m14:58:43.230480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:43.231351 [info ] [MainThread]: 
[0m14:58:43.232423 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:58:43.243662 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m14:58:43.454836 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m14:58:43.455482 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m14:58:43.455972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:43.572560 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m14:58:43.576079 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m14:58:43.579801 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m14:58:43.580790 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m14:58:43.581627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.583703 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.586697 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m14:58:43.589789 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m14:58:43.590525 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m14:58:43.591034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.592621 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.594813 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m14:58:43.598531 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m14:58:43.599183 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m14:58:43.599689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.601166 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:43.603169 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m14:58:43.604616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m14:58:43.605955 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m14:58:43.619193 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m14:58:43.620247 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m14:58:43.621135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.622753 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.625738 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m14:58:43.626402 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m14:58:43.627608 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.628279 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m14:58:43.628812 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m14:58:43.631996 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.633737 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m14:58:43.634728 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m14:58:43.635294 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m14:58:43.636256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.636988 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m14:58:43.638497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_staging)
[0m14:58:43.640849 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m14:58:43.644286 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m14:58:43.644969 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m14:58:43.645510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.647389 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.650366 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m14:58:43.651012 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m14:58:43.652148 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.652803 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m14:58:43.653305 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m14:58:43.654279 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.656236 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m14:58:43.656823 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m14:58:43.657378 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m14:58:43.658567 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:43.659169 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m14:58:43.660133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_report)
[0m14:58:43.661582 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m14:58:43.666059 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m14:58:43.666727 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m14:58:43.667219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.669185 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.672163 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m14:58:43.672897 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m14:58:43.673957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.674622 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m14:58:43.675132 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m14:58:43.676017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.678024 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m14:58:43.678570 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m14:58:43.679251 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m14:58:43.680417 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.681128 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m14:58:43.682215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m14:58:43.683219 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m14:58:43.687763 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m14:58:43.688640 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m14:58:43.689408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.691166 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.694273 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m14:58:43.695155 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m14:58:43.696295 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:58:43.696834 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m14:58:43.697407 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m14:58:43.699013 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:43.701604 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m14:58:43.702259 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m14:58:43.702826 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m14:58:43.703949 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:43.704779 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m14:58:43.712069 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m14:58:43.724226 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m14:58:43.725194 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m14:58:43.725812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:43.726901 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:43.727720 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m14:58:43.728317 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m14:58:43.768949 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m14:58:43.773179 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m14:58:43.776131 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m14:58:43.776843 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m14:58:43.777957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_staging)
[0m14:58:43.783123 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m14:58:43.783800 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m14:58:43.784376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.785448 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:43.786273 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m14:58:43.787095 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m14:58:43.795707 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:58:43.799189 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m14:58:43.800786 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m14:58:43.801444 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m14:58:43.802678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_report)
[0m14:58:43.809220 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m14:58:43.810035 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m14:58:43.810609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.811859 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:58:43.812500 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m14:58:43.813081 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m14:58:43.822898 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:58:43.826312 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m14:58:43.827785 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m14:58:43.828678 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m14:58:43.830385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m14:58:43.834749 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m14:58:43.837062 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m14:58:43.837873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:43.839464 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:58:43.840082 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m14:58:43.840851 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m14:58:43.851062 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:58:43.854189 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m14:58:43.855637 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m14:58:43.856299 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m14:58:43.860722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28CE6A8D0>]}
[0m14:58:43.861814 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:43.862507 [debug] [MainThread]: On master: BEGIN
[0m14:58:43.863154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:43.864154 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:58:43.864960 [debug] [MainThread]: On master: COMMIT
[0m14:58:43.865855 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:43.866436 [debug] [MainThread]: On master: COMMIT
[0m14:58:43.867433 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:58:43.868310 [debug] [MainThread]: On master: Close
[0m14:58:43.874534 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m14:58:43.875711 [info ] [Thread-1 (]: 1 of 24 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m14:58:43.877238 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m14:58:43.878155 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m14:58:43.896520 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:43.900515 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m14:58:44.007706 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:44.012691 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:44.014257 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m14:58:44.015836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:58:44.018086 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.020669 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:44.023024 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m14:58:44.026697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.062858 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:44.064372 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m14:58:44.067762 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.083372 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:44.085024 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m14:58:44.087574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:44.151445 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m14:58:44.158603 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:44.160833 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m14:58:44.168533 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:44.201170 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m14:58:44.202870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m14:58:44.211403 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:44.229406 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m14:58:44.246428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D28C940>]}
[0m14:58:44.252166 [info ] [Thread-1 (]: 1 of 24 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.35s]
[0m14:58:44.262775 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m14:58:44.264681 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m14:58:44.266733 [info ] [Thread-1 (]: 2 of 24 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m14:58:44.277025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m14:58:44.282123 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m14:58:44.318888 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.326580 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m14:58:44.342472 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.348444 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.350351 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m14:58:44.351938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:44.358467 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:44.361081 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.362580 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m14:58:44.366580 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.385390 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.387740 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m14:58:44.391180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:44.402558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.404534 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m14:58:44.408226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:44.414705 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m14:58:44.416050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.417170 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m14:58:44.422380 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:44.428933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m14:58:44.430400 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m14:58:44.435731 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:44.441434 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m14:58:44.443269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D2FA350>]}
[0m14:58:44.445073 [info ] [Thread-1 (]: 2 of 24 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.17s]
[0m14:58:44.448611 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m14:58:44.450551 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m14:58:44.453151 [info ] [Thread-1 (]: 3 of 24 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m14:58:44.455791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m14:58:44.457094 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m14:58:44.464344 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.467398 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m14:58:44.481696 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.485138 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.486994 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m14:58:44.489395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:44.492577 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:44.494414 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.496443 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m14:58:44.500679 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.514685 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.515964 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m14:58:44.519115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:44.530909 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.532226 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m14:58:44.534813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:44.540143 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m14:58:44.541771 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.542893 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m14:58:44.547978 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:44.556759 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m14:58:44.558046 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m14:58:44.563373 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:44.567748 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m14:58:44.569725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D152250>]}
[0m14:58:44.572783 [info ] [Thread-1 (]: 3 of 24 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.11s]
[0m14:58:44.575431 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m14:58:44.576717 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m14:58:44.578313 [info ] [Thread-1 (]: 4 of 24 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m14:58:44.580635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m14:58:44.582615 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m14:58:44.591931 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.594893 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m14:58:44.616309 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.619844 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.621939 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m14:58:44.623616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:44.626572 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:44.628346 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.630355 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m14:58:44.634578 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.647395 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.649496 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m14:58:44.652644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:44.666470 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.668481 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m14:58:44.673736 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.681473 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m14:58:44.683436 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.684886 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m14:58:44.692325 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:44.845805 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m14:58:44.847594 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m14:58:44.854184 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:44.860970 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m14:58:44.862936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D2D6EB0>]}
[0m14:58:44.865744 [info ] [Thread-1 (]: 4 of 24 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.28s]
[0m14:58:44.868560 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m14:58:44.871010 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m14:58:44.874776 [info ] [Thread-1 (]: 5 of 24 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m14:58:44.877428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m14:58:44.879777 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m14:58:44.892103 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.896286 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m14:58:44.908009 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.913095 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.915221 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m14:58:44.917003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:44.919905 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:44.923685 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.927122 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m14:58:44.932098 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:44.944598 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.946138 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m14:58:44.948679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:44.962940 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.964527 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.967486 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:44.974703 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m14:58:44.976654 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.978011 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m14:58:44.984011 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:44.992508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m14:58:44.993921 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m14:58:45.000057 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:45.006850 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m14:58:45.008804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D15BA10>]}
[0m14:58:45.010935 [info ] [Thread-1 (]: 5 of 24 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.13s]
[0m14:58:45.014042 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m14:58:45.015486 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m14:58:45.017819 [info ] [Thread-1 (]: 6 of 24 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m14:58:45.021389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m14:58:45.023206 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m14:58:45.031474 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.035282 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m14:58:45.046396 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.050373 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.051892 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m14:58:45.053157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:45.056428 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:45.058923 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.060911 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m14:58:45.064604 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.077090 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.078828 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m14:58:45.081344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:45.095309 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.097708 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.101454 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.109300 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m14:58:45.111407 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.113413 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m14:58:45.120350 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:45.132070 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m14:58:45.133851 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m14:58:45.141048 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:45.145957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m14:58:45.147780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B88C0B0>]}
[0m14:58:45.150324 [info ] [Thread-1 (]: 6 of 24 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.13s]
[0m14:58:45.153992 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m14:58:45.156328 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m14:58:45.159262 [info ] [Thread-1 (]: 7 of 24 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m14:58:45.161984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m14:58:45.164371 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m14:58:45.181219 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.188867 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m14:58:45.219337 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.226817 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.229139 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m14:58:45.230408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:45.232638 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.234003 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.235147 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m14:58:45.239101 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:45.248337 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.250719 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m14:58:45.254224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:45.266477 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.267949 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m14:58:45.271848 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.276823 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m14:58:45.278482 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.280246 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m14:58:45.285758 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:45.294273 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m14:58:45.295999 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m14:58:45.304401 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:45.310531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m14:58:45.312411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D1B2F30>]}
[0m14:58:45.315936 [info ] [Thread-1 (]: 7 of 24 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.15s]
[0m14:58:45.318975 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m14:58:45.322541 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m14:58:45.324752 [info ] [Thread-1 (]: 8 of 24 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m14:58:45.327842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m14:58:45.329709 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m14:58:45.344421 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.350369 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m14:58:45.364309 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.368508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.371104 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m14:58:45.372868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:45.375242 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.377210 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.379099 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m14:58:45.383058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.394671 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.396129 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m14:58:45.398524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:45.411418 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.413224 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m14:58:45.416598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:45.421916 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m14:58:45.424008 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.426395 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m14:58:45.432414 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:45.442318 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m14:58:45.443761 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m14:58:45.450006 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:45.456689 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m14:58:45.459879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28BA2B530>]}
[0m14:58:45.462778 [info ] [Thread-1 (]: 8 of 24 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.13s]
[0m14:58:45.467079 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m14:58:45.469505 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m14:58:45.473768 [info ] [Thread-1 (]: 9 of 24 START sql view model intermediate.model_int_driver_profile_active ...... [RUN]
[0m14:58:45.476159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m14:58:45.478336 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m14:58:45.490085 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.495180 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m14:58:45.508830 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.513898 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.515440 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m14:58:45.516723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:45.519193 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.521470 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.522848 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m14:58:45.526078 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.537410 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.540995 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m14:58:45.544546 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:45.557533 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.559783 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m14:58:45.562803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:45.574491 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m14:58:45.577508 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.579347 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m14:58:45.585182 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:45.593286 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m14:58:45.594777 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m14:58:45.600331 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:45.607751 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m14:58:45.610179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D1B2FF0>]}
[0m14:58:45.613254 [info ] [Thread-1 (]: 9 of 24 OK created sql view model intermediate.model_int_driver_profile_active . [[32mOK[0m in 0.13s]
[0m14:58:45.618363 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m14:58:45.621686 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m14:58:45.624055 [info ] [Thread-1 (]: 10 of 24 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m14:58:45.626362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m14:58:45.627994 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m14:58:45.641861 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.648014 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m14:58:45.700619 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.707262 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.709766 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m14:58:45.711865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:45.715385 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:45.717774 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.720437 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m14:58:45.740167 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:58:45.762804 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.766472 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m14:58:45.772653 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:45.807447 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.810274 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m14:58:45.814206 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:45.825618 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m14:58:45.828063 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.830722 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m14:58:45.850897 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:45.866146 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m14:58:45.868418 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m14:58:45.876301 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:45.884888 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m14:58:45.888812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D15B7D0>]}
[0m14:58:45.894022 [info ] [Thread-1 (]: 10 of 24 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.26s]
[0m14:58:45.947261 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m14:58:45.955062 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m14:58:45.958622 [info ] [Thread-1 (]: 11 of 24 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m14:58:45.961742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m14:58:45.964138 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m14:58:45.979654 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:45.984742 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m14:58:46.051000 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:46.060084 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:46.062513 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m14:58:46.063945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:46.067320 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:46.070716 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:46.073067 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m14:58:46.082940 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:58:46.096458 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:46.098408 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m14:58:46.101864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:46.114686 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:46.116794 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m14:58:46.120478 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:46.126991 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m14:58:46.128568 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:46.130584 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m14:58:46.137740 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:46.147794 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m14:58:46.149412 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m14:58:46.155510 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:46.161718 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m14:58:46.164569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28CEDE030>]}
[0m14:58:46.166982 [info ] [Thread-1 (]: 11 of 24 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.20s]
[0m14:58:46.173026 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m14:58:46.175022 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m14:58:46.177805 [info ] [Thread-1 (]: 12 of 24 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m14:58:46.180826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m14:58:46.183721 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m14:58:46.196876 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.202045 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m14:58:46.217610 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.224487 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.226892 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m14:58:46.228353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:46.230905 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:46.232367 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.234780 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m14:58:46.252311 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:58:46.268263 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.271320 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m14:58:46.275432 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:46.288925 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.291278 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m14:58:46.294181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:46.301148 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m14:58:46.303574 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.305899 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m14:58:46.313698 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:46.325409 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m14:58:46.327528 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m14:58:46.333747 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:46.340200 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m14:58:46.343189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28BA2AAB0>]}
[0m14:58:46.346051 [info ] [Thread-1 (]: 12 of 24 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.16s]
[0m14:58:46.349514 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m14:58:46.351784 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m14:58:46.353909 [info ] [Thread-1 (]: 13 of 24 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m14:58:46.356550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m14:58:46.358360 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m14:58:46.378052 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.383457 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m14:58:46.396501 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.401105 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.402799 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m14:58:46.405284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:46.408753 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:46.410852 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.413016 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
select
    ot.order_id,
    ot.driver_id,
    ot.delivery_zone,
    ot.order_datetime,
    ot.pickup_datetime,
    ot.delivery_datetime,
    ot.is_late_delivery,
    case when (ot.order_status  = 'completed') then 1 else 0 end as is_completed,
    case when (ot.order_status  != 'completed') then 1 else 0 end as is_failed,
    extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
    extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
    case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,
    ld.bonus_amount,
    extract(epoch from ot.delivery_datetime - ot.order_datetime)/60.0 as delivery_duration_mins,
    st.csat_score,
    st.ticket_id,
    ld.delivery_target,
    ld.actual_deliveries
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m14:58:46.423650 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:58:46.433759 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.435516 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary" rename to "model_int_order_delivery_summary__dbt_backup"
[0m14:58:46.439609 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:46.454413 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.456111 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m14:58:46.460132 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:46.465659 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m14:58:46.467866 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.469497 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m14:58:46.478767 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:58:46.492253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m14:58:46.495082 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m14:58:46.501964 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:46.507953 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m14:58:46.509999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28BA2AAB0>]}
[0m14:58:46.512026 [info ] [Thread-1 (]: 13 of 24 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.15s]
[0m14:58:46.515275 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m14:58:46.516960 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m14:58:46.518942 [info ] [Thread-1 (]: 14 of 24 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m14:58:46.522427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m14:58:46.524656 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m14:58:46.536668 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.542790 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m14:58:46.633033 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.639202 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.640678 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m14:58:46.641808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:46.644012 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:46.645213 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.646500 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m14:58:46.836443 [debug] [Thread-1 (]: SQL status: OK in 0.188 seconds
[0m14:58:46.848165 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.850364 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m14:58:46.854455 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:46.866304 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.868320 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m14:58:46.873212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:46.897485 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m14:58:46.899933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.901823 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m14:58:46.917376 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:58:46.927707 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m14:58:46.929245 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m14:58:46.937419 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:46.944652 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m14:58:46.946680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28CE63B90>]}
[0m14:58:46.948796 [info ] [Thread-1 (]: 14 of 24 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.42s]
[0m14:58:46.952713 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m14:58:46.954960 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m14:58:46.957302 [info ] [Thread-1 (]: 15 of 24 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m14:58:46.960081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m14:58:46.961617 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m14:58:46.979979 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:46.984411 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m14:58:47.002602 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:47.009339 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:47.011987 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m14:58:47.014209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:47.017244 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:47.019202 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:47.023636 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m14:58:48.199514 [debug] [Thread-1 (]: SQL status: OK in 1.173 seconds
[0m14:58:48.209605 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:48.211142 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m14:58:48.214393 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:48.226659 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:48.228990 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m14:58:48.231484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:48.238722 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m14:58:48.240580 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:48.241923 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m14:58:48.259892 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:58:48.271995 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m14:58:48.273431 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m14:58:48.283407 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:58:48.290581 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m14:58:48.293402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D1B2A50>]}
[0m14:58:48.296152 [info ] [Thread-1 (]: 15 of 24 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 1.33s]
[0m14:58:48.299996 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m14:58:48.301571 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m14:58:48.304207 [info ] [Thread-1 (]: 16 of 24 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m14:58:48.308004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m14:58:48.311332 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m14:58:48.331581 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:48.335128 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m14:58:48.354826 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:48.359526 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:48.361201 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m14:58:48.362352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:48.364407 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:48.365694 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:48.367463 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m14:58:49.642762 [debug] [Thread-1 (]: SQL status: OK in 1.272 seconds
[0m14:58:49.654709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:49.656080 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m14:58:49.658911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:49.671933 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:49.673902 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m14:58:49.677201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:49.683563 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m14:58:49.685527 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:49.687383 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m14:58:49.696093 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:58:49.710894 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m14:58:49.713562 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m14:58:49.721782 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:58:49.727265 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m14:58:49.728880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D1B35F0>]}
[0m14:58:49.730905 [info ] [Thread-1 (]: 16 of 24 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 1.42s]
[0m14:58:49.735000 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m14:58:49.737826 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m14:58:49.740094 [info ] [Thread-1 (]: 17 of 24 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m14:58:49.743058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m14:58:49.745050 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m14:58:49.758448 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.762993 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m14:58:49.782612 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.788496 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.790884 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m14:58:49.792694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:49.797945 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:49.799883 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.801960 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    --sum(is_unassigned) as no_driver_orders,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m14:58:49.816175 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:58:49.833174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.834754 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates" rename to "model_int_zone_delivery_aggregates__dbt_backup"
[0m14:58:49.838687 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:49.851769 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.854966 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m14:58:49.858926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:49.868819 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m14:58:49.871853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.873517 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m14:58:49.879788 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:49.888819 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m14:58:49.891104 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m14:58:49.897540 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:58:49.904064 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m14:58:49.906691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D1B0110>]}
[0m14:58:49.909004 [info ] [Thread-1 (]: 17 of 24 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.16s]
[0m14:58:49.912282 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m14:58:49.913925 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m14:58:49.915799 [info ] [Thread-1 (]: 18 of 24 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m14:58:49.918041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_performance)
[0m14:58:49.920956 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m14:58:49.953416 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:49.963756 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m14:58:49.979209 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:49.983896 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:49.985481 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m14:58:49.987510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:49.989826 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:49.991058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:49.992335 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    round(avg(ods.csat_score),2) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m14:58:50.323508 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:58:50.333027 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:50.334380 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance" rename to "model_mart_driver_performance__dbt_backup"
[0m14:58:50.338362 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:50.346972 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:50.348245 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m14:58:50.350703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:50.356696 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m14:58:50.358064 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:50.359132 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m14:58:50.370623 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:58:50.377858 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m14:58:50.379199 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m14:58:50.384687 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:50.390369 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m14:58:50.392382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B88C0B0>]}
[0m14:58:50.394243 [info ] [Thread-1 (]: 18 of 24 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.47s]
[0m14:58:50.396904 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m14:58:50.398187 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m14:58:50.400023 [info ] [Thread-1 (]: 19 of 24 START sql table model mart.model_mart_driver_zone_heatmap ............. [RUN]
[0m14:58:50.402553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.model_mart_driver_zone_heatmap)
[0m14:58:50.404577 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m14:58:50.416000 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m14:58:50.421485 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m14:58:50.430666 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m14:58:50.433957 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m14:58:50.435213 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: BEGIN
[0m14:58:50.437420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:50.439425 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:50.441031 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m14:58:50.442438 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp"
  
    as (
      

with aggregates as(
    select
        ods.delivery_zone,
        count(ods.order_id) as total_requests,
        sum(ods.is_completed) as completed_requests,
        round(avg(delivery_duration_mins),2) as avg_delivery_time_mins,
        zda.no_driver_orders,
        zda.unique_drivers,
        dsd.available_drivers,
        sum(ods.is_failed) as failed_requests
    from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
    left join (
        select region as delivery_zone_pf, count(driver_id) as available_drivers
        from "ae_exam_db"."intermediate"."model_int_driver_profile_active"
        group by region
    ) dsd on zda.delivery_zone = dsd.delivery_zone_pf
    group by 
        ods.delivery_zone,
        zda.no_driver_orders,
        zda.unique_drivers,
        dsd.available_drivers        

)

select 
    delivery_zone,
    total_requests,
    completed_requests,
    failed_requests,
    avg_delivery_time_mins,
    available_drivers,
    case when total_requests > 0 then round((completed_requests::numeric / total_requests)*100,2) else 0 end as completion_rate,
    case when available_drivers > 0 then round((total_requests::numeric / available_drivers)*100,2) else 0 end as demand_supply_rate
from aggregates
    );
  
  
[0m14:58:50.462155 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp"
  
    as (
      

with aggregates as(
    select
        ods.delivery_zone,
        count(ods.order_id) as total_requests,
        sum(ods.is_completed) as completed_requests,
        round(avg(delivery_duration_mins),2) as avg_delivery_time_mins,
        zda.no_driver_orders,
        zda.unique_drivers,
        dsd.available_drivers,
        sum(ods.is_failed) as failed_requests
    from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
    left join (
        select region as delivery_zone_pf, count(driver_id) as available_drivers
        from "ae_exam_db"."intermediate"."model_int_driver_profile_active"
        group by region
    ) dsd on zda.delivery_zone = dsd.delivery_zone_pf
    group by 
        ods.delivery_zone,
        zda.no_driver_orders,
        zda.unique_drivers,
        dsd.available_drivers        

)

select 
    delivery_zone,
    total_requests,
    completed_requests,
    failed_requests,
    avg_delivery_time_mins,
    available_drivers,
    case when total_requests > 0 then round((completed_requests::numeric / total_requests)*100,2) else 0 end as completion_rate,
    case when available_drivers > 0 then round((total_requests::numeric / available_drivers)*100,2) else 0 end as demand_supply_rate
from aggregates
    );
  
  
[0m14:58:50.463609 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:58:50.464985 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: ROLLBACK
[0m14:58:50.498356 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_driver_zone_heatmap'
[0m14:58:50.499636 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: Close
[0m14:58:50.515782 [debug] [Thread-1 (]: Runtime Error in model model_mart_driver_zone_heatmap (models\mart\feet\model_mart_driver_zone_heatmap.sql)
  Binder Error: Referenced table "zda" not found!
  Candidate tables: "ods"
  
  LINE 28:     ) dsd on zda.delivery_zone = dsd.delivery_zone_pf
                        ^
[0m14:58:50.517226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D2C38F0>]}
[0m14:58:50.519534 [error] [Thread-1 (]: 19 of 24 ERROR creating sql table model mart.model_mart_driver_zone_heatmap .... [[31mERROR[0m in 0.12s]
[0m14:58:50.522987 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m14:58:50.524212 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m14:58:50.527050 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_driver_zone_heatmap' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_driver_zone_heatmap (models\mart\feet\model_mart_driver_zone_heatmap.sql)
  Binder Error: Referenced table "zda" not found!
  Candidate tables: "ods"
  
  LINE 28:     ) dsd on zda.delivery_zone = dsd.delivery_zone_pf
                        ^.
[0m14:58:50.525519 [info ] [Thread-1 (]: 20 of 24 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m14:58:50.532013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_zone_heatmap, now model.ae_exam_project.report_campaign_effectiveness)
[0m14:58:50.533936 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m14:58:50.545356 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.549983 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m14:58:50.564555 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.570415 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.572888 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m14:58:50.576186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:50.580609 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:50.583650 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.585513 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m14:58:50.634966 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m14:58:50.645545 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.646725 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m14:58:50.648844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:50.655983 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.657127 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m14:58:50.659533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:50.664548 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m14:58:50.665761 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.666730 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m14:58:50.713380 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m14:58:50.720715 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m14:58:50.722336 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m14:58:50.763912 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m14:58:50.767938 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m14:58:50.769780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B8E3B30>]}
[0m14:58:50.771940 [info ] [Thread-1 (]: 20 of 24 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.24s]
[0m14:58:50.774260 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m14:58:50.775380 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m14:58:50.777160 [info ] [Thread-1 (]: 21 of 24 START sql table model report.report_customer _acquisition ............. [RUN]
[0m14:58:50.780063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m14:58:50.781850 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m14:58:50.792195 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.795401 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m14:58:50.807545 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.811347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.812754 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m14:58:50.813772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:50.815411 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:50.816343 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.817319 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m14:58:50.841130 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:58:50.848586 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.850073 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m14:58:50.852025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:50.860415 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.861592 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m14:58:50.863526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:50.868505 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m14:58:50.871319 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.872569 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m14:58:50.910294 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m14:58:50.917031 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m14:58:50.918300 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m14:58:50.954712 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m14:58:50.958559 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m14:58:50.960053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28B8E1310>]}
[0m14:58:50.961600 [info ] [Thread-1 (]: 21 of 24 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.18s]
[0m14:58:50.964117 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m14:58:50.965304 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m14:58:50.966557 [info ] [Thread-1 (]: 22 of 24 START sql table model report.report_retargeting_performance ........... [RUN]
[0m14:58:50.968340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m14:58:50.970119 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m14:58:50.977571 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m14:58:50.987134 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m14:58:50.995564 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m14:58:50.998416 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m14:58:50.999739 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m14:58:51.001055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:51.003237 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:58:51.004302 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m14:58:51.005423 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m14:58:51.034965 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m14:58:51.042717 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m14:58:51.043793 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m14:58:51.045606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:51.053009 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m14:58:51.054140 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m14:58:51.055935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:51.059466 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m14:58:51.060467 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m14:58:51.061309 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m14:58:51.111780 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m14:58:51.117153 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m14:58:51.118269 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m14:58:51.157889 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m14:58:51.162154 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m14:58:51.163890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D1B36B0>]}
[0m14:58:52.486602 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m14:58:52.488664 [info ] [Thread-1 (]: 22 of 24 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.20s]
[0m14:58:52.490658 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m14:58:52.491694 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m14:58:52.492716 [info ] [Thread-1 (]: 23 of 24 START sql table model report.report_driver_perfornance ................ [RUN]
[0m14:58:52.494084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_perfornance)
[0m14:58:52.494748 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m14:58:52.499538 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.501351 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m14:58:52.505130 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.506361 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.506792 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m14:58:52.507059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:52.507614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:52.507893 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.508153 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m14:58:52.512259 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:58:52.514842 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.515169 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance" rename to "report_driver_perfornance__dbt_backup"
[0m14:58:52.515820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:58:52.518506 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.519090 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m14:58:52.520231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:58:52.521737 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m14:58:52.522128 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.522458 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m14:58:52.534535 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:58:52.537770 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m14:58:52.538184 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m14:58:52.541287 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:58:52.542568 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m14:58:52.543039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b765442-c608-43ba-bbd3-7286f299a4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28D2C0BF0>]}
[0m14:58:52.543539 [info ] [Thread-1 (]: 23 of 24 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.05s]
[0m14:58:52.544961 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m14:58:52.545282 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_zone_heatmap
[0m14:58:52.545585 [info ] [Thread-1 (]: 24 of 24 SKIP relation report.report_driver_zone_heatmap ....................... [[33mSKIP[0m]
[0m14:58:52.546258 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_zone_heatmap
[0m14:58:52.547670 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:52.547956 [debug] [MainThread]: On master: BEGIN
[0m14:58:52.548178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:52.548685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:58:52.549073 [debug] [MainThread]: On master: COMMIT
[0m14:58:52.549330 [debug] [MainThread]: Using duckdb connection "master"
[0m14:58:52.549586 [debug] [MainThread]: On master: COMMIT
[0m14:58:52.550122 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:58:52.550418 [debug] [MainThread]: On master: Close
[0m14:58:52.550766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:52.550993 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m14:58:52.551179 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m14:58:52.551371 [debug] [MainThread]: Connection 'model.ae_exam_project.report_driver_perfornance' was properly closed.
[0m14:58:52.551802 [info ] [MainThread]: 
[0m14:58:52.553001 [info ] [MainThread]: Finished running 10 table models, 14 view models in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m14:58:52.556827 [debug] [MainThread]: Command end result
[0m14:58:52.589201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m14:58:52.591613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m14:58:52.600744 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m14:58:52.601392 [info ] [MainThread]: 
[0m14:58:52.602288 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:58:52.603201 [info ] [MainThread]: 
[0m14:58:52.603970 [error] [MainThread]:   Runtime Error in model model_mart_driver_zone_heatmap (models\mart\feet\model_mart_driver_zone_heatmap.sql)
  Binder Error: Referenced table "zda" not found!
  Candidate tables: "ods"
  
  LINE 28:     ) dsd on zda.delivery_zone = dsd.delivery_zone_pf
                        ^
[0m14:58:52.604716 [info ] [MainThread]: 
[0m14:58:52.605507 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=1 SKIP=1 TOTAL=24
[0m14:58:52.606793 [debug] [MainThread]: Command `dbt run` failed at 14:58:52.606617 after 10.42 seconds
[0m14:58:52.607243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28CE63350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28ACF46B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A28ACA2F90>]}
[0m14:58:52.607634 [debug] [MainThread]: Flushing usage events
[0m14:58:53.565632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:01.604779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290BF35A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C02D7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C04C7ED0>]}


============================== 15:00:01.609183 | 4d160a72-95f7-4555-ba1c-77b6afc2d978 ==============================
[0m15:00:01.609183 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:00:01.610119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:01.840933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290BFA090F0>]}
[0m15:00:01.915308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C0383AC0>]}
[0m15:00:01.919008 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:00:02.240228 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:00:02.464348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:02.465034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:02.465839 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m15:00:02.467100 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m15:00:02.468221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C059C850>]}
[0m15:00:02.527725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C18AAC60>]}
[0m15:00:02.642801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m15:00:02.646099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m15:00:02.677428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1B05010>]}
[0m15:00:02.678133 [info ] [MainThread]: Found 24 models, 11 sources, 429 macros
[0m15:00:02.679300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1AB4050>]}
[0m15:00:02.683017 [info ] [MainThread]: 
[0m15:00:02.684020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:02.684822 [info ] [MainThread]: 
[0m15:00:02.685921 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:00:02.697066 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m15:00:02.814952 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:00:02.815676 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:00:02.816155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:02.867005 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m15:00:02.872207 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:00:02.876451 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:00:02.877275 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:00:02.877824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:02.879455 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:00:02.882286 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:00:02.885471 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:00:02.886333 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:00:02.887010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:02.888604 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:00:02.891804 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:00:02.897416 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m15:00:02.898356 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m15:00:02.898988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:02.901095 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:00:02.903355 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m15:00:02.904724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m15:00:02.905542 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m15:00:02.919085 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:00:02.920080 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:00:02.920632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:02.922653 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:00:02.926203 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:00:02.927073 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m15:00:02.928240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:00:02.929065 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:00:02.929882 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m15:00:02.931345 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:02.934058 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m15:00:02.934933 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m15:00:02.935642 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m15:00:02.936657 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:00:02.937263 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m15:00:02.938371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_report)
[0m15:00:02.939861 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m15:00:02.944695 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:00:02.945714 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:00:02.946457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:02.948530 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:00:02.952216 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:00:02.953172 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m15:00:02.955867 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:02.956905 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:00:02.957773 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m15:00:02.959186 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:02.961599 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m15:00:02.962500 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m15:00:02.963273 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m15:00:02.964635 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:02.965477 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m15:00:02.966968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m15:00:02.968163 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m15:00:02.973483 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:00:02.974598 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:00:02.976472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:02.978657 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:00:02.982238 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:00:02.982982 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m15:00:02.984196 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:02.984955 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:00:02.985703 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m15:00:02.987731 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:02.992176 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m15:00:02.993213 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m15:00:02.994049 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m15:00:02.995375 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:02.996138 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m15:00:02.997211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_intermediate)
[0m15:00:02.998278 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m15:00:03.002109 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:00:03.003040 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m15:00:03.003887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:03.007502 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:00:03.011708 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:00:03.012780 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m15:00:03.014107 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:00:03.014831 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:00:03.015531 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m15:00:03.016593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:00:03.018334 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m15:00:03.019016 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m15:00:03.019691 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m15:00:03.021292 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:03.022015 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m15:00:03.029771 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m15:00:03.041054 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m15:00:03.041805 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m15:00:03.042706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:03.044102 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:00:03.044733 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m15:00:03.045299 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:00:03.082866 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m15:00:03.086556 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m15:00:03.088877 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m15:00:03.089677 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m15:00:03.090844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m15:00:03.095698 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m15:00:03.096436 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m15:00:03.097017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:03.098367 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:03.099054 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m15:00:03.099759 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:00:03.110525 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m15:00:03.114809 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m15:00:03.116458 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m15:00:03.117521 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m15:00:03.119479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m15:00:03.126109 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m15:00:03.126870 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m15:00:03.127429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:03.128504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:03.129124 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m15:00:03.129735 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:00:03.138296 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:00:03.142240 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m15:00:03.143538 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m15:00:03.144225 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m15:00:03.145280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_intermediate)
[0m15:00:03.152438 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m15:00:03.153180 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m15:00:03.153768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:03.154937 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:00:03.155586 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m15:00:03.156810 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m15:00:03.165434 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:00:03.168394 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m15:00:03.169785 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m15:00:03.170470 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m15:00:03.174239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1AC2450>]}
[0m15:00:03.175234 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:03.175885 [debug] [MainThread]: On master: BEGIN
[0m15:00:03.176427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:03.177501 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:00:03.178162 [debug] [MainThread]: On master: COMMIT
[0m15:00:03.178825 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:03.179656 [debug] [MainThread]: On master: COMMIT
[0m15:00:03.181099 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:00:03.182060 [debug] [MainThread]: On master: Close
[0m15:00:03.186473 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m15:00:03.187914 [info ] [Thread-1 (]: 1 of 24 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m15:00:03.190295 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m15:00:03.191297 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m15:00:03.207748 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.211192 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m15:00:03.283571 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.285857 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.286677 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m15:00:03.287350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:03.288604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.289515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.290435 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m15:00:03.292786 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:00:03.306456 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.307379 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m15:00:03.308921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.315294 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.316139 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m15:00:03.317492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.344585 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m15:00:03.345752 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.346656 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m15:00:03.352635 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:00:03.362846 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m15:00:03.363800 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m15:00:03.368164 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.373191 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m15:00:03.378003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1EF0940>]}
[0m15:00:03.379431 [info ] [Thread-1 (]: 1 of 24 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.18s]
[0m15:00:03.381729 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m15:00:03.382568 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m15:00:03.383462 [info ] [Thread-1 (]: 2 of 24 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m15:00:03.385506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m15:00:03.386516 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m15:00:03.395342 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.397406 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m15:00:03.403599 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.406247 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.407491 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m15:00:03.408832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.410224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.410983 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.411693 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m15:00:03.413482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.419035 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.419862 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m15:00:03.421271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.428130 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.429367 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m15:00:03.430997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.433704 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m15:00:03.434536 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.435243 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m15:00:03.440081 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:03.445621 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m15:00:03.446540 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m15:00:03.451208 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:03.454104 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m15:00:03.455248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1F5A350>]}
[0m15:00:03.457117 [info ] [Thread-1 (]: 2 of 24 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.07s]
[0m15:00:03.459522 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m15:00:03.460424 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m15:00:03.461387 [info ] [Thread-1 (]: 3 of 24 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m15:00:03.462814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m15:00:03.463602 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m15:00:03.468718 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.470810 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m15:00:03.478817 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.480888 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.481691 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m15:00:03.482360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.483509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.484320 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.484991 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m15:00:03.486702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.492568 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.493561 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m15:00:03.494940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.500839 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.501707 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m15:00:03.503091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.505727 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m15:00:03.507178 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.508505 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m15:00:03.512859 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.517787 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m15:00:03.518559 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m15:00:03.522995 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.526910 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m15:00:03.528083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1DA0150>]}
[0m15:00:03.529399 [info ] [Thread-1 (]: 3 of 24 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.07s]
[0m15:00:03.531074 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m15:00:03.531925 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m15:00:03.532829 [info ] [Thread-1 (]: 4 of 24 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m15:00:03.534066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m15:00:03.534965 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m15:00:03.540491 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.543116 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m15:00:03.556193 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.560683 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.561590 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m15:00:03.562295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.563494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.564237 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.564894 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m15:00:03.566630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.572604 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.574451 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m15:00:03.576528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.582368 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.583389 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m15:00:03.584948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.587952 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m15:00:03.589807 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.591255 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m15:00:03.596332 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:03.693089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m15:00:03.694065 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m15:00:03.698434 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.701662 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m15:00:03.702955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1F282F0>]}
[0m15:00:03.704312 [info ] [Thread-1 (]: 4 of 24 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.17s]
[0m15:00:03.706418 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m15:00:03.707552 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m15:00:03.708520 [info ] [Thread-1 (]: 5 of 24 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m15:00:03.710175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m15:00:03.711004 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m15:00:03.716559 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.719164 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m15:00:03.728246 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.730979 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.731863 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m15:00:03.732623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.734010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.735178 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.736453 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m15:00:03.738370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.746018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.747027 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m15:00:03.748624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.754353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.755268 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.757168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.760382 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m15:00:03.761304 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.762053 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m15:00:03.766022 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.771842 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m15:00:03.773555 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m15:00:03.778302 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.781476 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m15:00:03.782682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1DABE30>]}
[0m15:00:03.784005 [info ] [Thread-1 (]: 5 of 24 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.07s]
[0m15:00:03.787109 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m15:00:03.789931 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m15:00:03.791577 [info ] [Thread-1 (]: 6 of 24 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m15:00:03.793414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m15:00:03.794485 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m15:00:03.803173 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.805223 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m15:00:03.813735 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.815973 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.817138 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m15:00:03.818019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.819352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.820117 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.820852 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m15:00:03.823365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.831001 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.831957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m15:00:03.833492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.840321 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.841682 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.843540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.846445 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m15:00:03.847353 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.848109 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m15:00:03.852325 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.857998 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m15:00:03.859513 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m15:00:03.864094 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.867518 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m15:00:03.868908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C0028E30>]}
[0m15:00:03.870273 [info ] [Thread-1 (]: 6 of 24 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.08s]
[0m15:00:03.871960 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m15:00:03.873926 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m15:00:03.875149 [info ] [Thread-1 (]: 7 of 24 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m15:00:03.877302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m15:00:03.878846 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m15:00:03.885548 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.887646 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m15:00:03.897466 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.899924 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.900919 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m15:00:03.901660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.903082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.903910 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.904714 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m15:00:03.909181 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:03.920058 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.921617 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m15:00:03.924434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.931671 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.932997 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m15:00:03.935156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:03.939624 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m15:00:03.940840 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.941766 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m15:00:03.946911 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:03.953006 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m15:00:03.954039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m15:00:03.958940 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:03.964337 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m15:00:03.966331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED34D0>]}
[0m15:00:03.968528 [info ] [Thread-1 (]: 7 of 24 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.09s]
[0m15:00:03.972022 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m15:00:03.974501 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m15:00:03.976105 [info ] [Thread-1 (]: 8 of 24 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m15:00:03.978199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m15:00:03.979306 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m15:00:03.986650 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:03.989402 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m15:00:03.998992 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:04.002181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:04.003752 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m15:00:04.004708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.006727 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:00:04.008049 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:04.009271 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m15:00:04.012214 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:00:04.019890 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:04.021530 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m15:00:04.023988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.035083 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:04.036173 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m15:00:04.037743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.041763 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m15:00:04.043255 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:04.044376 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m15:00:04.060444 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:00:04.066020 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m15:00:04.067056 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m15:00:04.071819 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.076151 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m15:00:04.077463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C06AF530>]}
[0m15:00:04.078941 [info ] [Thread-1 (]: 8 of 24 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.10s]
[0m15:00:04.080850 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m15:00:04.081891 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m15:00:04.083212 [info ] [Thread-1 (]: 9 of 24 START sql view model intermediate.model_int_driver_profile_active ...... [RUN]
[0m15:00:04.084794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m15:00:04.085787 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m15:00:04.093357 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.096782 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m15:00:04.108418 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.111188 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.112199 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m15:00:04.112999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.114472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.115394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.116251 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m15:00:04.118526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.128264 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.129576 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m15:00:04.131341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.138768 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.140971 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m15:00:04.143544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.148452 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m15:00:04.149617 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.150561 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m15:00:04.154950 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:04.161154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m15:00:04.162134 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m15:00:04.166357 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:04.170542 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m15:00:04.172100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED32F0>]}
[0m15:00:04.174527 [info ] [Thread-1 (]: 9 of 24 OK created sql view model intermediate.model_int_driver_profile_active . [[32mOK[0m in 0.09s]
[0m15:00:04.176624 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m15:00:04.177720 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m15:00:04.178967 [info ] [Thread-1 (]: 10 of 24 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m15:00:04.180482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m15:00:04.181405 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m15:00:04.193770 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.197309 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m15:00:04.206039 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.209513 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.210620 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m15:00:04.211479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.212963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.213816 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.214718 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m15:00:04.224963 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:00:04.232038 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.233349 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m15:00:04.235744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.243364 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.244494 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m15:00:04.246255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.249754 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m15:00:04.250769 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.251627 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m15:00:04.256335 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.262467 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m15:00:04.263499 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m15:00:04.268085 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.271729 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m15:00:04.273396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1DAB5F0>]}
[0m15:00:04.274936 [info ] [Thread-1 (]: 10 of 24 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.09s]
[0m15:00:04.277942 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m15:00:04.279388 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m15:00:04.281174 [info ] [Thread-1 (]: 11 of 24 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m15:00:04.282677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m15:00:04.284019 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m15:00:04.294671 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.297106 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m15:00:04.313567 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.316145 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.317136 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m15:00:04.317981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.319975 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:00:04.321072 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.323427 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m15:00:04.330805 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:00:04.337865 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.339457 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m15:00:04.341919 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.348363 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.349674 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m15:00:04.351628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.355109 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m15:00:04.356607 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.357628 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m15:00:04.362294 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.368739 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m15:00:04.369800 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m15:00:04.374125 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:04.377760 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m15:00:04.379211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C03D32F0>]}
[0m15:00:04.380753 [info ] [Thread-1 (]: 11 of 24 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.10s]
[0m15:00:04.382937 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m15:00:04.383962 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m15:00:04.385037 [info ] [Thread-1 (]: 12 of 24 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m15:00:04.386525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m15:00:04.387432 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m15:00:04.394903 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.397479 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m15:00:04.406073 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.409675 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.410777 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m15:00:04.411625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.413067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.414019 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.414989 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m15:00:04.421077 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:00:04.431899 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.433073 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m15:00:04.434847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.443146 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.444278 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m15:00:04.446030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.450096 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m15:00:04.451582 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.452594 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m15:00:04.458131 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.463879 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m15:00:04.464924 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m15:00:04.469584 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.473587 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m15:00:04.475189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C06AC710>]}
[0m15:00:04.476706 [info ] [Thread-1 (]: 12 of 24 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.09s]
[0m15:00:04.478787 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m15:00:04.479795 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m15:00:04.480936 [info ] [Thread-1 (]: 13 of 24 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m15:00:04.482529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m15:00:04.483553 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m15:00:04.492760 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.495700 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m15:00:04.503175 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.506181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.508725 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m15:00:04.510264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.512455 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:00:04.513412 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.514448 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
select
    ot.order_id,
    ot.driver_id,
    ot.delivery_zone,
    ot.order_datetime,
    ot.pickup_datetime,
    ot.delivery_datetime,
    ot.is_late_delivery,
    case when (ot.order_status  = 'completed') then 1 else 0 end as is_completed,
    case when (ot.order_status  != 'completed') then 1 else 0 end as is_failed,
    extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
    extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
    case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,
    ld.bonus_amount,
    extract(epoch from ot.delivery_datetime - ot.order_datetime)/60.0 as delivery_duration_mins,
    st.csat_score,
    st.ticket_id,
    ld.delivery_target,
    ld.actual_deliveries
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m15:00:04.520333 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:00:04.529611 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.531160 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary" rename to "model_int_order_delivery_summary__dbt_backup"
[0m15:00:04.533782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.543036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.544206 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m15:00:04.546089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.549598 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m15:00:04.550689 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.551517 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m15:00:04.556756 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.562005 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m15:00:04.563039 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m15:00:04.567627 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:04.571059 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m15:00:04.572365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C054A090>]}
[0m15:00:04.574877 [info ] [Thread-1 (]: 13 of 24 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.09s]
[0m15:00:04.576936 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m15:00:04.578006 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m15:00:04.579196 [info ] [Thread-1 (]: 14 of 24 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m15:00:04.580799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m15:00:04.581765 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m15:00:04.590000 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.592701 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m15:00:04.661499 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.665133 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.666678 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m15:00:04.668146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.669975 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:00:04.671129 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.672180 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m15:00:04.780660 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m15:00:04.787346 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.788380 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m15:00:04.790995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.797907 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.798926 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m15:00:04.800936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.819952 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m15:00:04.821029 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.821999 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m15:00:04.832545 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:00:04.838122 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m15:00:04.839491 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m15:00:04.844690 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:04.847964 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m15:00:04.849288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1DAA3F0>]}
[0m15:00:04.850752 [info ] [Thread-1 (]: 14 of 24 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.27s]
[0m15:00:04.852699 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m15:00:04.853646 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m15:00:04.854655 [info ] [Thread-1 (]: 15 of 24 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m15:00:04.856637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m15:00:04.857861 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m15:00:04.866306 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:04.868976 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m15:00:04.877148 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:04.880216 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:04.881240 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m15:00:04.882039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:04.883702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:04.884614 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:04.885683 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m15:00:05.472232 [debug] [Thread-1 (]: SQL status: OK in 0.585 seconds
[0m15:00:05.479199 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:05.480175 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m15:00:05.481830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:05.487863 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:05.489476 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m15:00:05.491622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:05.495796 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m15:00:05.496795 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:05.497744 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m15:00:05.521639 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m15:00:05.526885 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m15:00:05.527859 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m15:00:05.532487 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:05.535720 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m15:00:05.537042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C06AC470>]}
[0m15:00:05.538454 [info ] [Thread-1 (]: 15 of 24 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.68s]
[0m15:00:05.541348 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m15:00:05.542362 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m15:00:05.543946 [info ] [Thread-1 (]: 16 of 24 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m15:00:05.545523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m15:00:05.546429 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m15:00:05.557290 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:05.560528 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m15:00:05.571400 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:05.575502 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:05.576675 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m15:00:05.577532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:05.578958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:05.580127 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:05.581195 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m15:00:06.302783 [debug] [Thread-1 (]: SQL status: OK in 0.720 seconds
[0m15:00:06.308043 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:06.308855 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m15:00:06.310192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.314700 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:06.315406 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m15:00:06.316754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.319163 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m15:00:06.319844 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:06.320457 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m15:00:06.337653 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m15:00:06.342822 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m15:00:06.343563 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m15:00:06.350077 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:00:06.352582 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m15:00:06.353574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED2F30>]}
[0m15:00:06.354664 [info ] [Thread-1 (]: 16 of 24 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.81s]
[0m15:00:06.356615 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m15:00:06.357473 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m15:00:06.358652 [info ] [Thread-1 (]: 17 of 24 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m15:00:06.359954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m15:00:06.360693 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m15:00:06.365090 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.367124 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m15:00:06.372718 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.374853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.375723 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m15:00:06.376353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:06.377431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.378099 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.378733 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    --sum(is_unassigned) as no_driver_orders,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m15:00:06.383105 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:06.389558 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.390378 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates" rename to "model_int_zone_delivery_aggregates__dbt_backup"
[0m15:00:06.391727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.396931 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.397663 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m15:00:06.398941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.401431 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m15:00:06.402132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.402750 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m15:00:06.406640 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:06.410620 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m15:00:06.411382 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m15:00:06.415070 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:06.417595 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m15:00:06.418688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED2F30>]}
[0m15:00:06.419797 [info ] [Thread-1 (]: 17 of 24 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.06s]
[0m15:00:06.421727 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m15:00:06.422898 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m15:00:06.424079 [info ] [Thread-1 (]: 18 of 24 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m15:00:06.425288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_performance)
[0m15:00:06.425967 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m15:00:06.435505 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.437873 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m15:00:06.443984 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.446936 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.447962 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m15:00:06.448555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:06.449735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.450370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.450986 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    round(avg(ods.csat_score),2) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m15:00:06.579776 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m15:00:06.585546 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.586337 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance" rename to "model_mart_driver_performance__dbt_backup"
[0m15:00:06.587578 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.593794 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.594523 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m15:00:06.595705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.598038 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m15:00:06.598731 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.599347 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m15:00:06.607886 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:00:06.611567 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m15:00:06.612227 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m15:00:06.615997 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:06.618611 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m15:00:06.619544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C054A1B0>]}
[0m15:00:06.620656 [info ] [Thread-1 (]: 18 of 24 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.19s]
[0m15:00:06.622323 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m15:00:06.623085 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m15:00:06.623974 [info ] [Thread-1 (]: 19 of 24 START sql table model mart.model_mart_driver_zone_heatmap ............. [RUN]
[0m15:00:06.625452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.model_mart_driver_zone_heatmap)
[0m15:00:06.626071 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m15:00:06.631723 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m15:00:06.633325 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m15:00:06.638806 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m15:00:06.642257 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m15:00:06.643048 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: BEGIN
[0m15:00:06.643597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:06.644556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.645155 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m15:00:06.645767 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp"
  
    as (
      

with aggregates as(
    select
        ods.delivery_zone,
        count(ods.order_id) as total_requests,
        sum(ods.is_completed) as completed_requests,
        round(avg(delivery_duration_mins),2) as avg_delivery_time_mins,
        dsd.available_drivers,
        sum(ods.is_failed) as failed_requests
    from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
    left join (
        select region as delivery_zone_pf, count(driver_id) as available_drivers
        from "ae_exam_db"."intermediate"."model_int_driver_profile_active"
        group by region
    ) dsd on ods.delivery_zone = dsd.delivery_zone_pf
    group by 
        ods.delivery_zone,
        dsd.available_drivers        

)

select 
    delivery_zone,
    total_requests,
    completed_requests,
    failed_requests,
    avg_delivery_time_mins,
    available_drivers,
    case when total_requests > 0 then round((completed_requests::numeric / total_requests)*100,2) else 0 end as completion_rate,
    case when available_drivers > 0 then round((total_requests::numeric / available_drivers)*100,2) else 0 end as demand_supply_rate
from aggregates
    );
  
  
[0m15:00:06.737771 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m15:00:06.742175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m15:00:06.742842 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp" rename to "model_mart_driver_zone_heatmap"
[0m15:00:06.744000 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.746088 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m15:00:06.746708 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m15:00:06.747248 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m15:00:06.752102 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:06.755946 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m15:00:06.756628 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_backup" cascade
[0m15:00:06.757646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:00:06.759897 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: Close
[0m15:00:06.760759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C06AE4B0>]}
[0m15:00:06.761710 [info ] [Thread-1 (]: 19 of 24 OK created sql table model mart.model_mart_driver_zone_heatmap ........ [[32mOK[0m in 0.14s]
[0m15:00:06.763109 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m15:00:06.763762 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m15:00:06.764488 [info ] [Thread-1 (]: 20 of 24 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m15:00:06.765657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_zone_heatmap, now model.ae_exam_project.report_campaign_effectiveness)
[0m15:00:06.766264 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m15:00:06.771867 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.774315 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m15:00:06.780006 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.782930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.783666 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m15:00:06.784172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:06.785113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.785646 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.786123 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m15:00:06.795749 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:00:06.802892 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.804006 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m15:00:06.806078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.813593 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.814327 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m15:00:06.816056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.819311 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m15:00:06.820642 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.821612 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m15:00:06.834081 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:00:06.839086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m15:00:06.840077 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m15:00:06.844509 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:06.846917 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m15:00:06.847809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED25D0>]}
[0m15:00:06.848898 [info ] [Thread-1 (]: 20 of 24 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.08s]
[0m15:00:06.850525 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m15:00:06.851909 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m15:00:06.853241 [info ] [Thread-1 (]: 21 of 24 START sql table model report.report_customer _acquisition ............. [RUN]
[0m15:00:06.855738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m15:00:06.856965 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m15:00:06.863729 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.866720 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m15:00:06.875647 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.878332 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.879508 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m15:00:06.880426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:06.882910 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:00:06.884168 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.885413 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m15:00:06.904729 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m15:00:06.913290 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.914226 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m15:00:06.915952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.923367 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.924299 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m15:00:06.925791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.928881 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m15:00:06.929689 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.930379 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m15:00:06.940149 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:00:06.944403 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m15:00:06.945281 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m15:00:06.949830 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:06.954559 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m15:00:06.956032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED2450>]}
[0m15:00:06.957314 [info ] [Thread-1 (]: 21 of 24 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.10s]
[0m15:00:06.958996 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m15:00:06.959854 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m15:00:06.960910 [info ] [Thread-1 (]: 22 of 24 START sql table model report.report_retargeting_performance ........... [RUN]
[0m15:00:06.962218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m15:00:06.963028 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m15:00:06.971336 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m15:00:06.975579 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m15:00:06.981798 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m15:00:06.984095 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m15:00:06.985084 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m15:00:06.985846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:06.987181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:06.987903 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m15:00:06.989178 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m15:00:06.994253 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:07.000526 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m15:00:07.001437 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m15:00:07.003144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:07.010753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m15:00:07.011858 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m15:00:07.013458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:07.017519 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m15:00:07.018739 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m15:00:07.019942 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m15:00:07.025670 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:00:07.030477 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m15:00:07.031428 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m15:00:07.036146 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:07.040097 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m15:00:07.041490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED28D0>]}
[0m15:00:10.388777 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m15:00:10.390879 [info ] [Thread-1 (]: 22 of 24 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.08s]
[0m15:00:10.392897 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m15:00:10.393699 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m15:00:10.394500 [info ] [Thread-1 (]: 23 of 24 START sql table model report.report_driver_perfornance ................ [RUN]
[0m15:00:10.395674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_perfornance)
[0m15:00:10.396366 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m15:00:10.398927 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.399955 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m15:00:10.402727 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.403849 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.404437 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m15:00:10.405060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:10.405819 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:10.406324 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.406667 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m15:00:10.411694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:00:10.413833 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.414140 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance" rename to "report_driver_perfornance__dbt_backup"
[0m15:00:10.414733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:00:10.417181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.417498 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m15:00:10.418103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:00:10.419109 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m15:00:10.419387 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.419663 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m15:00:10.438211 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m15:00:10.440719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m15:00:10.441169 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m15:00:10.444375 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:10.445502 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m15:00:10.445917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1ED26F0>]}
[0m15:00:10.446347 [info ] [Thread-1 (]: 23 of 24 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.05s]
[0m15:00:10.447629 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m15:00:10.447948 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_zone_heatmap
[0m15:00:10.448261 [info ] [Thread-1 (]: 24 of 24 START sql table model report.report_driver_zone_heatmap ............... [RUN]
[0m15:00:10.448904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_perfornance, now model.ae_exam_project.report_driver_zone_heatmap)
[0m15:00:10.449361 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_zone_heatmap
[0m15:00:10.451687 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m15:00:10.452558 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_zone_heatmap
[0m15:00:10.455515 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m15:00:10.456866 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m15:00:10.457360 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: BEGIN
[0m15:00:10.457618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:10.458130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:00:10.458409 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m15:00:10.458645 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_zone_heatmap"
order by delivery_zone asc
    );
  
  
[0m15:00:10.460200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:00:10.462438 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m15:00:10.462745 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp" rename to "report_driver_zone_heatmap"
[0m15:00:10.463353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:00:10.464309 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m15:00:10.464581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m15:00:10.464812 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m15:00:10.468218 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:00:10.469973 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m15:00:10.470267 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_backup" cascade
[0m15:00:10.470766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:00:10.472438 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: Close
[0m15:00:10.473092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d160a72-95f7-4555-ba1c-77b6afc2d978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1F0CBF0>]}
[0m15:00:10.473821 [info ] [Thread-1 (]: 24 of 24 OK created sql table model report.report_driver_zone_heatmap .......... [[32mOK[0m in 0.02s]
[0m15:00:10.474872 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_zone_heatmap
[0m15:00:10.476734 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:10.477025 [debug] [MainThread]: On master: BEGIN
[0m15:00:10.477225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:10.477688 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:00:10.477926 [debug] [MainThread]: On master: COMMIT
[0m15:00:10.478125 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:10.478306 [debug] [MainThread]: On master: COMMIT
[0m15:00:10.478641 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:00:10.478911 [debug] [MainThread]: On master: Close
[0m15:00:10.479183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:10.479437 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m15:00:10.479638 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m15:00:10.479797 [debug] [MainThread]: Connection 'model.ae_exam_project.report_driver_zone_heatmap' was properly closed.
[0m15:00:10.480066 [info ] [MainThread]: 
[0m15:00:10.480633 [info ] [MainThread]: Finished running 10 table models, 14 view models in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m15:00:10.484344 [debug] [MainThread]: Command end result
[0m15:00:10.507873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m15:00:10.510436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m15:00:10.517257 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m15:00:10.517632 [info ] [MainThread]: 
[0m15:00:10.518257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:10.518925 [info ] [MainThread]: 
[0m15:00:10.519495 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m15:00:10.520408 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:10.520304 after 9.08 seconds
[0m15:00:10.520695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C04EE270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290BF9B74D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290C1FF7B90>]}
[0m15:00:10.520985 [debug] [MainThread]: Flushing usage events
[0m15:00:11.502287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:56.858271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B070A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B1687890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B1877ED0>]}


============================== 16:45:56.864084 | e203ba82-f05d-4bf9-9b90-ac60b9522413 ==============================
[0m16:45:56.864084 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:45:56.865427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:45:57.170792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e203ba82-f05d-4bf9-9b90-ac60b9522413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B0DB10F0>]}
[0m16:45:57.227811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e203ba82-f05d-4bf9-9b90-ac60b9522413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B1737AC0>]}
[0m16:45:57.251675 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m16:45:57.530134 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:45:57.632043 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m16:45:57.632570 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\report\report_driver_incentive_impact.sql
[0m16:45:57.632952 [debug] [MainThread]: Partial parsing: added file: ae_exam_project://models\mart\feet\model_mart_driver_incentive_impact.sql
[0m16:45:57.633189 [debug] [MainThread]: Partial parsing: deleted file: ae_exam_project://models\mart\feet\model_driver_incentive_impact.sql
[0m16:45:57.633463 [debug] [MainThread]: Partial parsing: updated file: ae_exam_project://models\intermediate\model_int_order_delivery_summary.sql
[0m16:45:57.793441 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ae_exam_project.report_driver_incentive_impact' (models\report\report_driver_incentive_impact.sql) depends on a node named 'model_driver_incentive_impact' which was not found
[0m16:45:57.794884 [debug] [MainThread]: Command `dbt run` failed at 16:45:57.794740 after 1.27 seconds
[0m16:45:57.795193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B194E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B194F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108B2EBE3F0>]}
[0m16:45:57.795511 [debug] [MainThread]: Flushing usage events
[0m16:45:59.266269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:30.869045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37EC6A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37FBE7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37FDD7ED0>]}


============================== 16:46:30.875390 | 98d390ab-bc0e-4018-9b7a-bfeb25b40755 ==============================
[0m16:46:30.875390 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:46:30.876722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:46:31.154302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37F3110F0>]}
[0m16:46:31.280729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37FC97AC0>]}
[0m16:46:31.289590 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m16:46:31.634741 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:46:31.843285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:31.843923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:31.844784 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m16:46:31.845873 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:46:31.846808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37FEAB950>]}
[0m16:46:31.906044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30131AC60>]}
[0m16:46:32.011950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m16:46:32.032869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m16:46:32.127986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301571010>]}
[0m16:46:32.128936 [info ] [MainThread]: Found 26 models, 11 sources, 429 macros
[0m16:46:32.129973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30152C050>]}
[0m16:46:32.136466 [info ] [MainThread]: 
[0m16:46:32.137774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:32.138885 [info ] [MainThread]: 
[0m16:46:32.140202 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:46:32.156068 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m16:46:34.566909 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m16:46:34.567547 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m16:46:34.568003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:34.691149 [debug] [ThreadPool]: SQL status: OK in 0.123 seconds
[0m16:46:34.693823 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m16:46:34.696653 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m16:46:34.697106 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m16:46:34.697466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.698586 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.700019 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m16:46:34.702149 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m16:46:34.702715 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m16:46:34.703196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.704307 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.705725 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m16:46:34.708385 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m16:46:34.708810 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m16:46:34.709274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.710450 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.711859 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m16:46:34.712942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m16:46:34.713824 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m16:46:34.726605 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m16:46:34.727090 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m16:46:34.727445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.728549 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.730147 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m16:46:34.730511 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m16:46:34.731085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.731412 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m16:46:34.731723 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m16:46:34.733242 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.734411 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m16:46:34.734838 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m16:46:34.735190 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m16:46:34.735778 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.736188 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m16:46:34.736885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m16:46:34.737410 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m16:46:34.739374 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m16:46:34.739785 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m16:46:34.740137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.741202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.742814 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m16:46:34.743198 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m16:46:34.743779 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.744116 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m16:46:34.744441 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m16:46:34.745026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.746081 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m16:46:34.746478 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m16:46:34.746836 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m16:46:34.747378 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.747718 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m16:46:34.748335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_report)
[0m16:46:34.748878 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m16:46:34.751232 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m16:46:34.751645 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m16:46:34.752005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.753036 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.754816 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m16:46:34.755228 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m16:46:34.755804 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.756169 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m16:46:34.756493 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m16:46:34.757105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.758140 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m16:46:34.758490 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m16:46:34.758826 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m16:46:34.759368 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.759750 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m16:46:34.760385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m16:46:34.760896 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m16:46:34.762818 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m16:46:34.763221 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m16:46:34.763754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.764837 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.766437 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m16:46:34.766818 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m16:46:34.767376 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.767723 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m16:46:34.768042 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m16:46:34.768605 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.769645 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m16:46:34.770054 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m16:46:34.770389 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m16:46:34.770948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:46:34.771338 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m16:46:34.775840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m16:46:34.782409 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m16:46:34.782859 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m16:46:34.783231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:34.784389 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:46:34.784816 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m16:46:34.785183 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m16:46:34.830240 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m16:46:34.832664 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m16:46:34.874708 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m16:46:34.875682 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m16:46:34.876946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m16:46:34.879273 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m16:46:34.879696 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m16:46:34.880031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.881673 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:46:34.882035 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m16:46:34.882377 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m16:46:34.887186 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:46:34.888844 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m16:46:34.889568 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m16:46:34.889918 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m16:46:34.890487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_report)
[0m16:46:34.892245 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m16:46:34.892617 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m16:46:34.892916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.894707 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:46:34.895099 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m16:46:34.895456 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m16:46:34.900127 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:46:34.901720 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m16:46:34.902462 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m16:46:34.902860 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m16:46:34.903480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m16:46:34.905906 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m16:46:34.906305 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m16:46:34.906628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:34.908216 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:46:34.908594 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m16:46:34.908932 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m16:46:34.913401 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:46:34.915186 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m16:46:34.915907 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m16:46:34.916271 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m16:46:34.918587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301536750>]}
[0m16:46:34.919120 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:34.919449 [debug] [MainThread]: On master: BEGIN
[0m16:46:34.919740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:34.920378 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:46:34.920734 [debug] [MainThread]: On master: COMMIT
[0m16:46:34.921029 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:34.921318 [debug] [MainThread]: On master: COMMIT
[0m16:46:34.921802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:46:34.922146 [debug] [MainThread]: On master: Close
[0m16:46:34.926004 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m16:46:34.926751 [info ] [Thread-1 (]: 1 of 26 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m16:46:34.927808 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m16:46:34.928294 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m16:46:34.937924 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:34.941465 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m16:46:34.980759 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:34.983289 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:34.983806 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m16:46:34.984180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:34.984951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:34.985360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:34.985738 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m16:46:34.987072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.000923 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:35.001496 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m16:46:35.003237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.007151 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:35.007660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m16:46:35.008491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.023422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m16:46:35.024013 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:35.024446 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m16:46:35.028996 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:35.034945 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m16:46:35.035477 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m16:46:35.039018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.042236 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m16:46:35.045679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3019489F0>]}
[0m16:46:35.046529 [info ] [Thread-1 (]: 1 of 26 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.12s]
[0m16:46:35.047529 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m16:46:35.047996 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m16:46:35.048513 [info ] [Thread-1 (]: 2 of 26 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m16:46:35.049321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m16:46:35.049763 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m16:46:35.053417 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.055007 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m16:46:35.058363 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.059494 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.059981 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m16:46:35.060360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.061085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.061703 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.062258 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m16:46:35.063545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.067167 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.067706 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m16:46:35.068885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.074458 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.074975 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m16:46:35.075999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.078815 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m16:46:35.079399 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.079830 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m16:46:35.083550 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.086547 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m16:46:35.087792 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m16:46:35.091342 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.093034 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m16:46:35.093658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3019BE490>]}
[0m16:46:35.094345 [info ] [Thread-1 (]: 2 of 26 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.04s]
[0m16:46:35.095367 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m16:46:35.095870 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m16:46:35.096384 [info ] [Thread-1 (]: 3 of 26 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m16:46:35.097157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m16:46:35.097598 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m16:46:35.100390 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.101932 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m16:46:35.105944 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.107435 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.107954 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m16:46:35.108344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.109048 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.109443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.109808 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m16:46:35.110755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.114341 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.114896 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m16:46:35.115940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.119483 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.120459 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m16:46:35.121717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.123499 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m16:46:35.123982 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.124371 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m16:46:35.127651 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.130625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m16:46:35.131132 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m16:46:35.134613 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.136969 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m16:46:35.137914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3019C0050>]}
[0m16:46:35.138851 [info ] [Thread-1 (]: 3 of 26 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m16:46:35.140124 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m16:46:35.140846 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m16:46:35.141692 [info ] [Thread-1 (]: 4 of 26 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m16:46:35.142668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m16:46:35.143158 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m16:46:35.146136 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.147698 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m16:46:35.154865 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.157027 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.157607 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m16:46:35.158014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.158760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.159197 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.159605 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m16:46:35.161017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.164912 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.165433 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m16:46:35.166308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.169401 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.169901 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m16:46:35.171353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.173422 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m16:46:35.173973 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.174368 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m16:46:35.178225 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.237002 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m16:46:35.237568 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m16:46:35.241227 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.242891 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m16:46:35.243508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301951010>]}
[0m16:46:35.244177 [info ] [Thread-1 (]: 4 of 26 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.10s]
[0m16:46:35.245249 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m16:46:35.245735 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m16:46:35.246280 [info ] [Thread-1 (]: 5 of 26 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m16:46:35.247102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m16:46:35.247557 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m16:46:35.250553 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.252242 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m16:46:35.255915 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.257484 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.258368 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m16:46:35.258970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.259775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.260188 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.260575 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m16:46:35.261558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.265263 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.265731 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m16:46:35.266661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.269852 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.270379 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.271307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.272973 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m16:46:35.273449 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.273832 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m16:46:35.277355 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.280389 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m16:46:35.280910 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m16:46:35.284448 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.286619 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m16:46:35.287395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301434170>]}
[0m16:46:35.288172 [info ] [Thread-1 (]: 5 of 26 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.04s]
[0m16:46:35.289520 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m16:46:35.290283 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m16:46:35.291152 [info ] [Thread-1 (]: 6 of 26 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m16:46:35.292107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m16:46:35.292595 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m16:46:35.296272 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.298059 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m16:46:35.301652 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.303370 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.304126 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m16:46:35.304663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.305478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.305943 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.306366 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m16:46:35.307466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.312260 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.312860 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m16:46:35.313925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.317389 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.317906 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.318779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.320514 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m16:46:35.321085 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.321530 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m16:46:35.325347 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.329231 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m16:46:35.329838 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m16:46:35.333080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.334882 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m16:46:35.335530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37EBC30B0>]}
[0m16:46:35.336666 [info ] [Thread-1 (]: 6 of 26 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.04s]
[0m16:46:35.337909 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m16:46:35.338661 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m16:46:35.339561 [info ] [Thread-1 (]: 7 of 26 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m16:46:35.340498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m16:46:35.340982 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m16:46:35.344425 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.346214 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m16:46:35.350180 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.351905 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.352473 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m16:46:35.353099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.354357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.355070 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.355731 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m16:46:35.357592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.362163 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.362941 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m16:46:35.364581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.368535 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.369084 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m16:46:35.370199 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.371950 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m16:46:35.372499 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.372937 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m16:46:35.376441 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.379394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m16:46:35.379957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m16:46:35.383711 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.386564 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m16:46:35.387607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3000BA810>]}
[0m16:46:35.388723 [info ] [Thread-1 (]: 7 of 26 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.05s]
[0m16:46:35.389985 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m16:46:35.390563 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m16:46:35.391289 [info ] [Thread-1 (]: 8 of 26 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m16:46:35.392114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m16:46:35.392611 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m16:46:35.396508 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.397903 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m16:46:35.401450 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.402745 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.403524 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m16:46:35.404021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.404800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.405239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.405662 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m16:46:35.406849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.411789 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.412376 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m16:46:35.413428 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.417784 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.418367 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m16:46:35.419464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.421577 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m16:46:35.422397 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.422889 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m16:46:35.426579 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.429472 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m16:46:35.430017 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m16:46:35.433314 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.435176 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m16:46:35.435875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3000B8BF0>]}
[0m16:46:35.437123 [info ] [Thread-1 (]: 8 of 26 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.04s]
[0m16:46:35.438513 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m16:46:35.439314 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m16:46:35.440252 [info ] [Thread-1 (]: 9 of 26 START sql view model intermediate.model_int_driver_profile_active ...... [RUN]
[0m16:46:35.441556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m16:46:35.442079 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m16:46:35.445530 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.447868 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m16:46:35.452344 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.456162 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.456829 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m16:46:35.457289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.458150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.458657 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.459092 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m16:46:35.460280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.463840 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.464369 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m16:46:35.465268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:46:35.468619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.469121 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m16:46:35.470361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.472874 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m16:46:35.473496 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.473957 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m16:46:35.477757 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.480847 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m16:46:35.481393 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m16:46:35.484789 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.487278 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m16:46:35.488225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301937110>]}
[0m16:46:35.489160 [info ] [Thread-1 (]: 9 of 26 OK created sql view model intermediate.model_int_driver_profile_active . [[32mOK[0m in 0.05s]
[0m16:46:35.490389 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m16:46:35.490905 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m16:46:35.491481 [info ] [Thread-1 (]: 10 of 26 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m16:46:35.492481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m16:46:35.493014 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m16:46:35.497374 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.498659 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m16:46:35.503003 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.504505 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.505021 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m16:46:35.505460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.506345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.507025 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.507720 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m16:46:35.511549 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.515967 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.516815 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m16:46:35.518058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.523087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.523760 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m16:46:35.524897 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.526984 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m16:46:35.527595 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.528155 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m16:46:35.532257 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.537579 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m16:46:35.538232 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m16:46:35.541899 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.544097 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m16:46:35.545359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301936FF0>]}
[0m16:46:35.546521 [info ] [Thread-1 (]: 10 of 26 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.05s]
[0m16:46:35.548189 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m16:46:35.548799 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m16:46:35.549458 [info ] [Thread-1 (]: 11 of 26 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m16:46:35.550505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m16:46:35.551046 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m16:46:35.555769 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.557435 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m16:46:35.561765 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.563768 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.564685 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m16:46:35.565520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.566913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.567751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.568758 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m16:46:35.572827 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.581354 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.582497 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m16:46:35.584185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.588580 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.589238 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m16:46:35.590377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.593913 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m16:46:35.594965 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.595862 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m16:46:35.600635 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:35.606405 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m16:46:35.607311 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m16:46:35.611222 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.613930 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m16:46:35.615022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37EB7AA50>]}
[0m16:46:35.616121 [info ] [Thread-1 (]: 11 of 26 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.06s]
[0m16:46:35.618218 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m16:46:35.619424 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m16:46:35.620793 [info ] [Thread-1 (]: 12 of 26 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m16:46:35.622084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m16:46:35.622812 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m16:46:35.629274 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.631823 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m16:46:35.639464 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.642340 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.643119 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m16:46:35.643730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.645154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.646235 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.647246 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m16:46:35.652074 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:35.658875 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.659702 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m16:46:35.661089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.666529 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.667296 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m16:46:35.668554 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.671173 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m16:46:35.672072 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.672867 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m16:46:35.677127 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.681158 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m16:46:35.682000 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m16:46:35.686185 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:35.690215 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m16:46:35.691261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F300130710>]}
[0m16:46:35.692337 [info ] [Thread-1 (]: 12 of 26 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.07s]
[0m16:46:35.693797 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m16:46:35.694602 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m16:46:35.695754 [info ] [Thread-1 (]: 13 of 26 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m16:46:35.697675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m16:46:35.698487 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m16:46:35.705702 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m16:46:35.707926 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m16:46:35.712839 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m16:46:35.714812 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m16:46:35.715539 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m16:46:35.716135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:35.717172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:35.717779 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m16:46:35.718427 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
select
    ot.order_id,
    ot.driver_id,
    ot.delivery_zone,
    ot.order_datetime,
    ot.pickup_datetime,
    ot.delivery_datetime,
    ot.is_late_delivery,
    case when (ot.order_status  = 'completed') then 1 else 0 end as is_completed,
    case when (ot.order_status  != 'completed') then 1 else 0 end as is_filed,
    extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
    extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
    case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,
    ld.bonus_amount,
    extract(epoch from ot.delivery_datetime - ot.order_datetime)/60.0 as delivery_duration_mins,
    st.csat_score,
    st.ticket_id,
    ld.delivery_target,
    ld.actual_deliveries,
    ld.incentive_program,
    ld.applied_date,
    ld.bonus_qualified_sessions,
    case when ld,bonus_qualified_sessions = true then 1 else 0 end as bonus_qualified,
    ld.region as region_log,
    ld.log_id
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m16:46:35.726366 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
select
    ot.order_id,
    ot.driver_id,
    ot.delivery_zone,
    ot.order_datetime,
    ot.pickup_datetime,
    ot.delivery_datetime,
    ot.is_late_delivery,
    case when (ot.order_status  = 'completed') then 1 else 0 end as is_completed,
    case when (ot.order_status  != 'completed') then 1 else 0 end as is_filed,
    extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
    extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
    case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,
    ld.bonus_amount,
    extract(epoch from ot.delivery_datetime - ot.order_datetime)/60.0 as delivery_duration_mins,
    st.csat_score,
    st.ticket_id,
    ld.delivery_target,
    ld.actual_deliveries,
    ld.incentive_program,
    ld.applied_date,
    ld.bonus_qualified_sessions,
    case when ld,bonus_qualified_sessions = true then 1 else 0 end as bonus_qualified,
    ld.region as region_log,
    ld.log_id
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m16:46:35.727284 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:46:35.728145 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: ROLLBACK
[0m16:46:36.131291 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_int_order_delivery_summary'
[0m16:46:36.132101 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m16:46:36.140073 [debug] [Thread-1 (]: Runtime Error in model model_int_order_delivery_summary (models\intermediate\model_int_order_delivery_summary.sql)
  Parser Error: syntax error at or near ","
[0m16:46:36.140977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30195B890>]}
[0m16:46:36.142035 [error] [Thread-1 (]: 13 of 26 ERROR creating sql view model intermediate.model_int_order_delivery_summary  [[31mERROR[0m in 0.44s]
[0m16:46:36.143502 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m16:46:36.144177 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m16:46:36.145954 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_int_order_delivery_summary' to be skipped because of status 'error'.  Reason: Runtime Error in model model_int_order_delivery_summary (models\intermediate\model_int_order_delivery_summary.sql)
  Parser Error: syntax error at or near ",".
[0m16:46:36.144955 [info ] [Thread-1 (]: 14 of 26 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m16:46:36.148593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m16:46:36.149252 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m16:46:36.155348 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.158779 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m16:46:36.196724 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.200211 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.201040 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m16:46:36.201602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:36.203098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:36.204127 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.205042 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m16:46:36.289657 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m16:46:36.294445 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.295209 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m16:46:36.296998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:36.302048 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.302857 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m16:46:36.304275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:36.312937 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m16:46:36.313731 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.314331 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m16:46:36.323061 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:46:36.326884 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m16:46:36.327582 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m16:46:36.331447 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:36.334057 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m16:46:36.335296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3019589B0>]}
[0m16:46:36.336991 [info ] [Thread-1 (]: 14 of 26 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.19s]
[0m16:46:36.338540 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m16:46:36.339260 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m16:46:36.340076 [info ] [Thread-1 (]: 15 of 26 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m16:46:36.341362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m16:46:36.342065 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m16:46:36.350845 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.352887 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m16:46:36.358941 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.362184 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.363566 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m16:46:36.364452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:36.365950 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:46:36.366612 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.367396 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m16:46:36.874969 [debug] [Thread-1 (]: SQL status: OK in 0.506 seconds
[0m16:46:36.882464 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.883506 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m16:46:36.886336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:36.898203 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.899571 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m16:46:36.901341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:36.906517 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m16:46:36.908007 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.909247 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m16:46:36.922942 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:46:36.930965 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m16:46:36.932276 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m16:46:36.936928 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:36.942432 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m16:46:36.944809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3000B9FD0>]}
[0m16:46:36.947045 [info ] [Thread-1 (]: 15 of 26 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.60s]
[0m16:46:36.949265 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m16:46:36.950251 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m16:46:36.952320 [info ] [Thread-1 (]: 16 of 26 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m16:46:36.954134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m16:46:36.955551 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m16:46:36.967469 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:36.969782 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m16:46:36.976977 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:36.979952 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:36.981266 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m16:46:36.982221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:36.983657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:36.984469 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:36.985470 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m16:46:37.828750 [debug] [Thread-1 (]: SQL status: OK in 0.842 seconds
[0m16:46:37.835092 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:37.836001 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m16:46:37.837520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:37.843142 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:37.844074 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m16:46:37.845689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:37.848598 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m16:46:37.849516 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:37.850326 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m16:46:37.860777 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:46:37.866237 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m16:46:37.867149 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m16:46:37.871758 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:37.874840 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m16:46:37.876116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30007CB90>]}
[0m16:46:37.877465 [info ] [Thread-1 (]: 16 of 26 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.92s]
[0m16:46:37.879226 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m16:46:37.880089 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m16:46:37.880890 [info ] [Thread-1 (]: 17 of 26 SKIP relation intermediate.model_int_zone_delivery_aggregates ......... [[33mSKIP[0m]
[0m16:46:37.882469 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m16:46:37.883344 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m16:46:37.884140 [info ] [Thread-1 (]: 18 of 26 SKIP relation mart.model_mart_driver_incentive_impact ................. [[33mSKIP[0m]
[0m16:46:37.885910 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m16:46:37.887073 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m16:46:37.887936 [info ] [Thread-1 (]: 19 of 26 SKIP relation mart.model_mart_driver_performance ...................... [[33mSKIP[0m]
[0m16:46:37.889340 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m16:46:37.890173 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m16:46:37.890968 [info ] [Thread-1 (]: 20 of 26 SKIP relation mart.model_mart_driver_zone_heatmap ..................... [[33mSKIP[0m]
[0m16:46:37.892338 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m16:46:37.893178 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m16:46:37.894156 [info ] [Thread-1 (]: 21 of 26 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m16:46:37.895772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.report_campaign_effectiveness)
[0m16:46:37.896866 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m16:46:37.902939 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.906562 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m16:46:37.912362 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.916728 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.918089 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m16:46:37.918944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:37.920421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:37.921483 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.922270 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m16:46:37.937410 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:46:37.944527 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.945438 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m16:46:37.946970 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:37.952452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.953326 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m16:46:37.954848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:37.957670 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m16:46:37.958492 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.959195 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m16:46:37.967134 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:46:37.971852 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m16:46:37.972735 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m16:46:37.977227 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:37.981194 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m16:46:37.982374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301937B90>]}
[0m16:46:37.983715 [info ] [Thread-1 (]: 21 of 26 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.09s]
[0m16:46:37.985602 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m16:46:37.986767 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m16:46:37.987749 [info ] [Thread-1 (]: 22 of 26 START sql table model report.report_customer _acquisition ............. [RUN]
[0m16:46:37.989190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m16:46:37.989953 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m16:46:37.995227 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m16:46:37.997879 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m16:46:38.004168 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m16:46:38.007213 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m16:46:38.008908 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m16:46:38.009899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:38.011141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:38.011855 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m16:46:38.012509 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m16:46:38.026603 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:46:38.038847 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m16:46:38.040198 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m16:46:38.042246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:38.048079 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m16:46:38.048906 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m16:46:38.050219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:38.053375 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m16:46:38.054751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m16:46:38.055866 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m16:46:38.064010 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:46:38.073178 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m16:46:38.075708 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m16:46:38.079964 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:38.082938 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m16:46:38.084012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301937230>]}
[0m16:46:38.085262 [info ] [Thread-1 (]: 22 of 26 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.09s]
[0m16:46:38.087171 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m16:46:38.088022 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m16:46:38.088933 [info ] [Thread-1 (]: 23 of 26 START sql table model report.report_retargeting_performance ........... [RUN]
[0m16:46:38.090240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m16:46:38.090983 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m16:46:38.097307 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.099797 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m16:46:38.105981 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.108011 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.108807 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m16:46:38.109447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:38.110833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:38.112018 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.112798 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m16:46:38.116944 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:46:38.122622 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.123510 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m16:46:38.124949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:38.131378 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.132334 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m16:46:38.133810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:46:38.136971 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m16:46:38.138037 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.139038 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m16:46:38.143551 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:38.147762 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m16:46:38.148522 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m16:46:38.152920 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:46:38.155836 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m16:46:38.156900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d390ab-bc0e-4018-9b7a-bfeb25b40755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301958170>]}
[0m16:46:38.158058 [info ] [Thread-1 (]: 23 of 26 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.07s]
[0m16:46:38.160113 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m16:46:38.161026 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_incentive_impact
[0m16:46:38.161765 [info ] [Thread-1 (]: 24 of 26 SKIP relation report.report_driver_incentive_impact ................... [[33mSKIP[0m]
[0m16:46:38.163162 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_incentive_impact
[0m16:46:38.163940 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m16:46:38.164680 [info ] [Thread-1 (]: 25 of 26 SKIP relation report.report_driver_perfornance ........................ [[33mSKIP[0m]
[0m16:46:38.165937 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m16:46:38.166904 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_zone_heatmap
[0m16:46:38.167700 [info ] [Thread-1 (]: 26 of 26 SKIP relation report.report_driver_zone_heatmap ....................... [[33mSKIP[0m]
[0m16:46:38.169347 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_zone_heatmap
[0m16:46:38.172209 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:38.172886 [debug] [MainThread]: On master: BEGIN
[0m16:46:38.173458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:38.174527 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:46:38.175129 [debug] [MainThread]: On master: COMMIT
[0m16:46:38.175906 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:38.177099 [debug] [MainThread]: On master: COMMIT
[0m16:46:38.179025 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:46:38.180359 [debug] [MainThread]: On master: Close
[0m16:46:38.181216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:38.181986 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m16:46:38.182586 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m16:46:38.183109 [debug] [MainThread]: Connection 'model.ae_exam_project.report_retargeting_performance' was properly closed.
[0m16:46:38.183863 [info ] [MainThread]: 
[0m16:46:38.185448 [info ] [MainThread]: Finished running 12 table models, 14 view models in 0 hours 0 minutes and 6.04 seconds (6.04s).
[0m16:46:38.194337 [debug] [MainThread]: Command end result
[0m16:46:38.247845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m16:46:38.252385 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m16:46:38.268351 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m16:46:38.269549 [info ] [MainThread]: 
[0m16:46:38.271305 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:46:38.272672 [info ] [MainThread]: 
[0m16:46:38.274026 [error] [MainThread]:   Runtime Error in model model_int_order_delivery_summary (models\intermediate\model_int_order_delivery_summary.sql)
  Parser Error: syntax error at or near ","
[0m16:46:38.275361 [info ] [MainThread]: 
[0m16:46:38.276660 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=7 TOTAL=26
[0m16:46:38.279018 [debug] [MainThread]: Command `dbt run` failed at 16:46:38.278622 after 7.62 seconds
[0m16:46:38.280251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37CDE0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37CCA2DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F301A97E90>]}
[0m16:46:38.281380 [debug] [MainThread]: Flushing usage events
[0m16:46:39.640850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:02:50.967289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A57ABA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A58A47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A58C37ED0>]}


============================== 17:02:50.971562 | 7edb0011-b15f-4db1-ae13-312548a1ee99 ==============================
[0m17:02:50.971562 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:02:50.972378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:51.133621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A581710F0>]}
[0m17:02:51.186815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A58AF3AC0>]}
[0m17:02:51.189580 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:02:51.355895 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:02:51.454798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:02:51.455195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:02:51.455689 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m17:02:51.456312 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m17:02:51.456876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A58D0B950>]}
[0m17:02:51.489536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59FFAC60>]}
[0m17:02:51.552993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m17:02:51.556283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m17:02:51.576184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A259010>]}
[0m17:02:51.576812 [info ] [MainThread]: Found 26 models, 11 sources, 429 macros
[0m17:02:51.577415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A210050>]}
[0m17:02:51.580151 [info ] [MainThread]: 
[0m17:02:51.580727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:51.581189 [info ] [MainThread]: 
[0m17:02:51.581791 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:02:51.587130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m17:02:51.651180 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:02:51.651539 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:02:51.651783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:51.675104 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:02:51.676719 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:02:51.680024 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:02:51.680462 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:02:51.680941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.682082 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.683137 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:02:51.684706 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:02:51.684986 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:02:51.685239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.686099 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.687035 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:02:51.688805 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:02:51.689060 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:02:51.689269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.689973 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.690852 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:02:51.691527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_mart)
[0m17:02:51.692445 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m17:02:51.698045 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:02:51.698366 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:02:51.698677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.699513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.700535 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:02:51.700779 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m17:02:51.701148 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.701373 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:02:51.701565 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m17:02:51.703386 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:02:51.704142 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m17:02:51.704398 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:02:51.704597 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m17:02:51.705003 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.705272 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m17:02:51.705714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_report)
[0m17:02:51.706038 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m17:02:51.707250 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:02:51.707513 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:02:51.707757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.708493 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.709535 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:02:51.709796 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m17:02:51.710196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.710453 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:02:51.710645 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m17:02:51.711033 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.712805 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m17:02:51.713152 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:02:51.713455 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m17:02:51.713951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.714243 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m17:02:51.714870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m17:02:51.715307 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m17:02:51.717231 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:02:51.717611 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:02:51.717898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.718747 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.719775 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:02:51.720026 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m17:02:51.720419 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.720664 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:02:51.720911 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m17:02:51.721324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.722053 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m17:02:51.722383 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:02:51.722814 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m17:02:51.723523 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.723969 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m17:02:51.724823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m17:02:51.725522 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m17:02:51.727291 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:02:51.727711 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:02:51.727982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.728809 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.729979 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:02:51.730271 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m17:02:51.730709 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.730954 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:02:51.731180 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m17:02:51.731662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.732429 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m17:02:51.732688 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:02:51.732920 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m17:02:51.733376 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:02:51.733624 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m17:02:51.737710 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_mart'
[0m17:02:51.742530 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m17:02:51.743066 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m17:02:51.743431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:51.744176 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.744452 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m17:02:51.744726 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:02:51.765758 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:02:51.767584 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m17:02:51.768681 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m17:02:51.768982 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m17:02:51.769446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m17:02:51.770788 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m17:02:51.771068 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m17:02:51.771308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.772540 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.772828 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m17:02:51.773072 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:02:51.776914 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:02:51.778334 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m17:02:51.778920 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m17:02:51.779193 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m17:02:51.779684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m17:02:51.781032 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m17:02:51.781300 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m17:02:51.781532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.782790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.783080 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m17:02:51.783331 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:02:51.787547 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:02:51.789026 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m17:02:51.789584 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m17:02:51.789863 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m17:02:51.790265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m17:02:51.791804 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m17:02:51.792052 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m17:02:51.792266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:51.793591 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:02:51.793888 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m17:02:51.794198 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:02:51.797481 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:02:51.798611 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m17:02:51.799080 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m17:02:51.799318 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m17:02:51.801615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A21A750>]}
[0m17:02:51.802192 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:51.802404 [debug] [MainThread]: On master: BEGIN
[0m17:02:51.802591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:51.802999 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:02:51.803222 [debug] [MainThread]: On master: COMMIT
[0m17:02:51.803429 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:51.803614 [debug] [MainThread]: On master: COMMIT
[0m17:02:51.803953 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:02:51.804200 [debug] [MainThread]: On master: Close
[0m17:02:51.808290 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m17:02:51.808766 [info ] [Thread-1 (]: 1 of 26 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m17:02:51.809434 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m17:02:51.809772 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m17:02:51.815949 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.817368 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m17:02:51.844715 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.846015 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.846419 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m17:02:51.846675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:02:51.847263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:51.847582 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.847827 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m17:02:51.849016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:51.854124 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.854487 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m17:02:51.855692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:51.858277 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.858584 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m17:02:51.859156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.868975 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m17:02:51.869371 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.869629 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m17:02:51.874621 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:02:51.878835 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:02:51.879185 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m17:02:51.894802 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:02:51.896878 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m17:02:51.898964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A6289F0>]}
[0m17:02:51.899525 [info ] [Thread-1 (]: 1 of 26 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.09s]
[0m17:02:51.900321 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m17:02:51.900712 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m17:02:51.901065 [info ] [Thread-1 (]: 2 of 26 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m17:02:51.901676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m17:02:51.901959 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m17:02:51.904222 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.905095 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m17:02:51.907254 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.908045 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.908358 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m17:02:51.908600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:51.909126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.909394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.909688 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m17:02:51.910501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:51.912694 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.912989 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m17:02:51.913554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.916517 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.917022 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m17:02:51.917743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.918904 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m17:02:51.919246 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.919533 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m17:02:51.923031 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:51.925014 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:02:51.925375 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m17:02:51.928376 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:51.929642 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m17:02:51.930252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A6CA490>]}
[0m17:02:51.930866 [info ] [Thread-1 (]: 2 of 26 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.03s]
[0m17:02:51.931588 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m17:02:51.931910 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m17:02:51.932363 [info ] [Thread-1 (]: 3 of 26 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m17:02:51.932980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m17:02:51.933292 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m17:02:51.935386 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.936311 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m17:02:51.939004 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.939941 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.940273 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m17:02:51.940526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:51.941060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.941309 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.941536 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m17:02:51.942247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.944637 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.945031 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m17:02:51.945773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.948401 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.948814 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m17:02:51.949781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:51.951609 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m17:02:51.952028 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.952318 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m17:02:51.955518 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:51.957707 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:02:51.958045 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m17:02:51.960961 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:51.962871 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m17:02:51.963523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A6CC050>]}
[0m17:02:51.964119 [info ] [Thread-1 (]: 3 of 26 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.03s]
[0m17:02:51.964898 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m17:02:51.965231 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m17:02:51.965609 [info ] [Thread-1 (]: 4 of 26 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m17:02:51.966399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m17:02:51.966984 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m17:02:51.969940 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:51.970905 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m17:02:51.975464 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:51.976636 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:51.977219 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m17:02:51.977635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:51.978275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:51.978587 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:51.978870 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m17:02:51.979767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.982548 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:51.982898 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m17:02:51.983654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.987310 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:51.987736 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m17:02:51.988395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:51.989437 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m17:02:51.989731 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:51.989989 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m17:02:51.993462 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.048649 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:02:52.049033 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m17:02:52.051984 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.053128 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m17:02:52.053521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A6708A0>]}
[0m17:02:52.054051 [info ] [Thread-1 (]: 4 of 26 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.09s]
[0m17:02:52.054803 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m17:02:52.055209 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:02:52.055609 [info ] [Thread-1 (]: 5 of 26 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m17:02:52.056233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m17:02:52.056568 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:02:52.058486 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.059662 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:02:52.062462 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.063513 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.063888 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m17:02:52.064140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.064754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.065032 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.065366 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m17:02:52.066102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.068517 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.068837 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m17:02:52.069381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.072360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.072858 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.073599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.074734 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m17:02:52.075081 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.075427 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m17:02:52.078513 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.080695 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:02:52.081078 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m17:02:52.084524 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.086015 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m17:02:52.086541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A57A10BF0>]}
[0m17:02:52.087040 [info ] [Thread-1 (]: 5 of 26 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.03s]
[0m17:02:52.087873 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:02:52.088215 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:02:52.088556 [info ] [Thread-1 (]: 6 of 26 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m17:02:52.089198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m17:02:52.089545 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:02:52.091459 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.092397 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:02:52.095133 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.096199 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.096588 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m17:02:52.096864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.097486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.097949 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.098463 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m17:02:52.099759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.103626 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.103997 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m17:02:52.104694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.107199 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.107646 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.108415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.109553 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m17:02:52.109931 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.110228 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m17:02:52.113293 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.115264 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:02:52.115765 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m17:02:52.119057 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.120305 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m17:02:52.120748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFF1D0>]}
[0m17:02:52.121215 [info ] [Thread-1 (]: 6 of 26 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.03s]
[0m17:02:52.122515 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:02:52.122865 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m17:02:52.123451 [info ] [Thread-1 (]: 7 of 26 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m17:02:52.124361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m17:02:52.124744 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m17:02:52.128061 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.129280 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m17:02:52.131793 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.133251 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.133779 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m17:02:52.134154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.135036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.135387 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.135648 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m17:02:52.136449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.138694 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.139034 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m17:02:52.139720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.141984 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.142267 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m17:02:52.142834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.144386 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m17:02:52.144758 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.145066 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m17:02:52.148848 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.151571 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:02:52.151952 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m17:02:52.154962 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.156508 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m17:02:52.156968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFCDD0>]}
[0m17:02:52.157451 [info ] [Thread-1 (]: 7 of 26 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.03s]
[0m17:02:52.158280 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m17:02:52.158618 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m17:02:52.158941 [info ] [Thread-1 (]: 8 of 26 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m17:02:52.159748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m17:02:52.160098 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m17:02:52.162738 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.163720 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m17:02:52.166416 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.168114 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.168520 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m17:02:52.168787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.169365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.169644 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.169880 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m17:02:52.170638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.172752 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.173027 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m17:02:52.173552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.175960 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.176348 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m17:02:52.177117 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.178878 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m17:02:52.179624 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.179957 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m17:02:52.183251 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.185083 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:02:52.185481 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m17:02:52.188425 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.189645 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m17:02:52.190073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFE2D0>]}
[0m17:02:52.190518 [info ] [Thread-1 (]: 8 of 26 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.03s]
[0m17:02:52.191278 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m17:02:52.191588 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m17:02:52.191966 [info ] [Thread-1 (]: 9 of 26 START sql view model intermediate.model_int_driver_profile_active ...... [RUN]
[0m17:02:52.192799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m17:02:52.193158 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m17:02:52.195666 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.196702 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m17:02:52.200112 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.201730 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.202114 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m17:02:52.202374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.202935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.203217 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.203468 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m17:02:52.204259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.206441 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.206716 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m17:02:52.207297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.209195 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.209470 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m17:02:52.210371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.212393 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m17:02:52.212795 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.213096 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m17:02:52.216208 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.218239 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:02:52.218622 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m17:02:52.221810 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.223021 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m17:02:52.223442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DA60F0>]}
[0m17:02:52.223889 [info ] [Thread-1 (]: 9 of 26 OK created sql view model intermediate.model_int_driver_profile_active . [[32mOK[0m in 0.03s]
[0m17:02:52.224669 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m17:02:52.225112 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:02:52.225603 [info ] [Thread-1 (]: 10 of 26 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m17:02:52.226429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m17:02:52.226805 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:02:52.230297 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.231239 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:02:52.234935 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.236227 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.236595 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m17:02:52.236858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.237425 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.237719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.237998 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m17:02:52.239931 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:02:52.242276 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.242612 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m17:02:52.243327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.245690 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.246028 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m17:02:52.246692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.247776 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m17:02:52.248144 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.248422 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m17:02:52.251602 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.253564 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:02:52.253907 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m17:02:52.257178 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.258525 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m17:02:52.258952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFF530>]}
[0m17:02:52.259387 [info ] [Thread-1 (]: 10 of 26 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.03s]
[0m17:02:52.260066 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:02:52.260401 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m17:02:52.260817 [info ] [Thread-1 (]: 11 of 26 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m17:02:52.261585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m17:02:52.261998 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m17:02:52.264536 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.265702 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m17:02:52.268831 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.269869 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.270256 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m17:02:52.270508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.271050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.271317 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.271599 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m17:02:52.274167 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:02:52.278938 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.279299 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m17:02:52.280011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.282450 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.282907 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m17:02:52.283915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.285426 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m17:02:52.285767 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.286027 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m17:02:52.289208 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.291282 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:02:52.291586 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m17:02:52.294638 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.295996 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m17:02:52.296511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A58CB8770>]}
[0m17:02:52.296993 [info ] [Thread-1 (]: 11 of 26 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.04s]
[0m17:02:52.297922 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m17:02:52.298398 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m17:02:52.298850 [info ] [Thread-1 (]: 12 of 26 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m17:02:52.299634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m17:02:52.299967 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m17:02:52.302812 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.303964 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m17:02:52.306447 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.307357 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.307689 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m17:02:52.307940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.308471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.308732 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.309008 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m17:02:52.312493 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.315238 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.315711 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m17:02:52.316588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.319394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.319754 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m17:02:52.320418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.321456 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m17:02:52.321744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.321980 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m17:02:52.325253 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.327275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:02:52.327681 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m17:02:52.330774 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.331925 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m17:02:52.332343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A115610>]}
[0m17:02:52.332799 [info ] [Thread-1 (]: 12 of 26 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.03s]
[0m17:02:52.333554 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m17:02:52.333866 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m17:02:52.334260 [info ] [Thread-1 (]: 13 of 26 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m17:02:52.335053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m17:02:52.335460 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m17:02:52.338163 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.339127 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m17:02:52.341317 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.342310 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.342644 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m17:02:52.342916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.343512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.343810 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.344142 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
    select
        ot.order_id,
        ot.driver_id,
        ot.delivery_zone,
        ot.order_datetime,
        ot.pickup_datetime,
        ot.delivery_datetime,
        ot.is_late_delivery,

        case when ot.order_status = 'completed' then 1 else 0 end as is_completed,
        case when ot.order_status != 'completed' then 1 else 0 end as is_failed,

        extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
        extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
        extract(epoch from ot.delivery_datetime - ot.order_datetime) / 60.0 as delivery_duration_mins,

        case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,

        st.csat_score,
        st.ticket_id,

        ld.bonus_amount,
        ld.delivery_target,
        ld.actual_deliveries,
        ld.incentive_program,
        ld.applied_date,
        ld.bonus_qualified,
        case when ld.bonus_qualified = true then 1 else 0 end as bonus_qualified_sessions,
        ld.region as region_log,
        ld.log_id

    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_support_tickets" st
        on ot.order_id = st.order_id

    left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld
        on ot.driver_id = ld.driver_id
        -- *Optional*: ถ้ามีช่วงเวลาที่แม่นยำ แนะนำเพิ่มเงื่อนไขช่วงเวลา เช่น
        -- and ot.order_datetime between ld.session_start and ld.session_end
)

select * from summary
  );

[0m17:02:52.346096 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:02:52.348365 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.348740 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary" rename to "model_int_order_delivery_summary__dbt_backup"
[0m17:02:52.349488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.352919 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.353274 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m17:02:52.354083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.355138 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m17:02:52.355469 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.355713 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m17:02:52.359079 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.361036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:02:52.361394 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m17:02:52.364758 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.366577 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m17:02:52.367302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFCB30>]}
[0m17:02:52.368064 [info ] [Thread-1 (]: 13 of 26 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.03s]
[0m17:02:52.368952 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m17:02:52.369273 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m17:02:52.369606 [info ] [Thread-1 (]: 14 of 26 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m17:02:52.370391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m17:02:52.370664 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m17:02:52.372938 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.374173 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m17:02:52.391298 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.392813 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.393387 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m17:02:52.393727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.394329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.394649 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.395003 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m17:02:52.439675 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m17:02:52.441840 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.442150 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m17:02:52.443627 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.446086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.446431 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m17:02:52.447010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.450679 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m17:02:52.450982 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.451219 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m17:02:52.457706 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:02:52.459515 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:02:52.459880 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m17:02:52.463147 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.464410 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m17:02:52.464896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A5687D0>]}
[0m17:02:52.465406 [info ] [Thread-1 (]: 14 of 26 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.09s]
[0m17:02:52.466267 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m17:02:52.466612 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m17:02:52.466944 [info ] [Thread-1 (]: 15 of 26 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m17:02:52.467631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m17:02:52.467942 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m17:02:52.470616 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.471748 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m17:02:52.474206 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.475449 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.475862 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m17:02:52.476119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.476738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.477086 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.477433 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m17:02:52.657381 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m17:02:52.659728 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.660122 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m17:02:52.660788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.663073 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.663442 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m17:02:52.664048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:52.665553 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m17:02:52.665878 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.666138 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m17:02:52.672416 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:02:52.674222 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:02:52.674586 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m17:02:52.677564 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:52.678893 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m17:02:52.679441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFCFB0>]}
[0m17:02:52.679960 [info ] [Thread-1 (]: 15 of 26 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.21s]
[0m17:02:52.680712 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m17:02:52.681067 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m17:02:52.681448 [info ] [Thread-1 (]: 16 of 26 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m17:02:52.682154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m17:02:52.682479 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m17:02:52.685784 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:52.686667 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m17:02:52.689337 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:52.690220 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:52.690563 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m17:02:52.690818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:52.691360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:52.691639 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:52.691969 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m17:02:53.069160 [debug] [Thread-1 (]: SQL status: OK in 0.377 seconds
[0m17:02:53.071705 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:53.072051 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m17:02:53.072696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.074738 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:53.075043 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m17:02:53.075590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.076719 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m17:02:53.077035 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:53.077294 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m17:02:53.080909 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:53.083001 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:02:53.083316 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m17:02:53.086014 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:02:53.087300 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m17:02:53.087849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A56BBF0>]}
[0m17:02:53.088373 [info ] [Thread-1 (]: 16 of 26 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.41s]
[0m17:02:53.089307 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m17:02:53.089843 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:02:53.090523 [info ] [Thread-1 (]: 17 of 26 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m17:02:53.091308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m17:02:53.091637 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:02:53.093965 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.094923 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:02:53.097311 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.098327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.098854 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m17:02:53.099306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:53.100137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:53.100583 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.101082 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    --sum(is_unassigned) as no_driver_orders,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m17:02:53.103849 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:02:53.106954 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.107349 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates" rename to "model_int_zone_delivery_aggregates__dbt_backup"
[0m17:02:53.108249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.112265 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.112770 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m17:02:53.113652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:53.114872 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m17:02:53.115282 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.115563 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m17:02:53.118663 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:53.120645 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:02:53.120991 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m17:02:53.123876 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:02:53.125226 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m17:02:53.125745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A638050>]}
[0m17:02:53.126337 [info ] [Thread-1 (]: 17 of 26 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.03s]
[0m17:02:53.127184 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:02:53.127579 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:02:53.128192 [info ] [Thread-1 (]: 18 of 26 START sql table model mart.model_mart_driver_incentive_impact ......... [RUN]
[0m17:02:53.128915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_incentive_impact)
[0m17:02:53.129419 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:02:53.137131 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:02:53.138922 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:02:53.142679 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:02:53.145272 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:02:53.145893 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: BEGIN
[0m17:02:53.146437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:53.147091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:53.147417 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:02:53.147829 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp"
  
    as (
      


select
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log,
    count(ods.log_id) as total_sessions,
    sum(ods.actual_deliveries) as total_deliveries,
    sum(ods.bonus_qualified_sessions) as total_bonus_qualified_sessions,
    sum(case when ods.bonus_qualified = true then ods.bonus_amount end) as total_bonus_earned,
    round(avg(ods.csat_score), 2) as avg_feedback_score,
    round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
group by
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log
    );
  
  
[0m17:02:53.214227 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m17:02:53.217614 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:02:53.218062 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
alter table "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp" rename to "model_mart_driver_incentive_impact"
[0m17:02:53.218820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.220161 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m17:02:53.220575 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:02:53.220896 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m17:02:53.225503 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:02:53.228419 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:02:53.228891 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_backup" cascade
[0m17:02:53.229642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.231105 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: Close
[0m17:02:53.231793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A56BD70>]}
[0m17:02:53.232517 [info ] [Thread-1 (]: 18 of 26 OK created sql table model mart.model_mart_driver_incentive_impact .... [[32mOK[0m in 0.10s]
[0m17:02:53.234004 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:02:53.234860 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m17:02:53.235697 [info ] [Thread-1 (]: 19 of 26 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m17:02:53.236703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_incentive_impact, now model.ae_exam_project.model_mart_driver_performance)
[0m17:02:53.237149 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m17:02:53.240200 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.241281 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m17:02:53.245610 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.247540 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.248264 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m17:02:53.248856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:53.249887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:53.250481 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.251152 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    round(avg(ods.csat_score),2) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m17:02:53.332885 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m17:02:53.336126 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.336582 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance" rename to "model_mart_driver_performance__dbt_backup"
[0m17:02:53.337395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.340080 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.340481 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m17:02:53.341175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.342610 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m17:02:53.343064 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.343468 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m17:02:53.350286 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:02:53.353104 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:02:53.353541 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m17:02:53.356638 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:53.358149 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m17:02:53.358762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFC9B0>]}
[0m17:02:53.359443 [info ] [Thread-1 (]: 19 of 26 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.12s]
[0m17:02:53.360443 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m17:02:53.360891 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:02:53.361404 [info ] [Thread-1 (]: 20 of 26 START sql table model mart.model_mart_driver_zone_heatmap ............. [RUN]
[0m17:02:53.362252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.model_mart_driver_zone_heatmap)
[0m17:02:53.362682 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:02:53.366648 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.367786 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:02:53.370679 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.371785 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.372208 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: BEGIN
[0m17:02:53.372551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:53.373203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:53.373576 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.373962 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp"
  
    as (
      

with failed_requests_unavailable_driver as (
    select  
        delivery_zone,
        count(*) as total_cancel_or_failed_requests
    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_drivers_master" dm 
      on ot.driver_id = dm.driver_id
    where ot.order_status in ('cancelled', 'failed')
      and (ot.driver_id is null or dm.active_status = 'inactive')
    group by delivery_zone
),

aggregates as (
    select
        ods.delivery_zone,
        count(ods.order_id) as total_requests,
        sum(ods.is_completed) as completed_requests,
        round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
        dsd.available_drivers,
        coalesce(rud.total_cancel_or_failed_requests, 0) as failed_requests
    from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
    left join (
        select region as delivery_zone, count(driver_id) as available_drivers
        from "ae_exam_db"."intermediate"."model_int_driver_profile_active"
        group by region
    ) dsd on ods.delivery_zone = dsd.delivery_zone
    left join failed_requests_unavailable_driver rud  
      on ods.delivery_zone = rud.delivery_zone
    group by 
        ods.delivery_zone,
        dsd.available_drivers,
        rud.total_cancel_or_failed_requests
)

select 
    delivery_zone,
    total_requests,
    completed_requests,
    failed_requests,
    avg_delivery_time_mins,
    available_drivers,
    case 
        when total_requests > 0 
        then round((completed_requests::numeric / total_requests) * 100, 2) 
        else 0 
    end as completion_rate,
    case 
        when available_drivers > 0 
        then round((total_requests::numeric / available_drivers) * 100, 2) 
        else 0 
    end as demand_supply_rate
from aggregates
    );
  
  
[0m17:02:53.453411 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m17:02:53.456985 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.457469 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap" rename to "model_mart_driver_zone_heatmap__dbt_backup"
[0m17:02:53.458282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.461722 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.462209 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp" rename to "model_mart_driver_zone_heatmap"
[0m17:02:53.463045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.464623 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m17:02:53.465066 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.465447 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m17:02:53.468717 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:53.471450 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:02:53.471881 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_backup" cascade
[0m17:02:53.475074 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:53.476964 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: Close
[0m17:02:53.477676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DA6570>]}
[0m17:02:53.478394 [info ] [Thread-1 (]: 20 of 26 OK created sql table model mart.model_mart_driver_zone_heatmap ........ [[32mOK[0m in 0.12s]
[0m17:02:53.479384 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:02:53.479842 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m17:02:53.480379 [info ] [Thread-1 (]: 21 of 26 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m17:02:53.481282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_zone_heatmap, now model.ae_exam_project.report_campaign_effectiveness)
[0m17:02:53.481721 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m17:02:53.484621 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.485781 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m17:02:53.489047 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.490297 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.490731 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m17:02:53.491112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:53.491786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:53.492168 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.492546 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m17:02:53.501379 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:02:53.505578 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.506129 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m17:02:53.507013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.510087 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.510593 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m17:02:53.511488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.513102 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m17:02:53.513567 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.513947 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m17:02:53.520818 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:02:53.523333 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:02:53.523782 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m17:02:53.527225 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:53.529054 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m17:02:53.529933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59DFF3B0>]}
[0m17:02:53.530852 [info ] [Thread-1 (]: 21 of 26 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.05s]
[0m17:02:53.531932 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m17:02:53.532382 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m17:02:53.532896 [info ] [Thread-1 (]: 22 of 26 START sql table model report.report_customer _acquisition ............. [RUN]
[0m17:02:53.533710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m17:02:53.534170 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m17:02:53.537731 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.538856 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m17:02:53.541899 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.543118 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.543602 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m17:02:53.544074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:53.544867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:53.545321 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.545695 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m17:02:53.553237 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:02:53.556378 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.556859 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m17:02:53.557700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.561254 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.561786 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m17:02:53.562683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:53.564384 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m17:02:53.564863 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.565259 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m17:02:53.571892 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:02:53.574374 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:02:53.574811 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m17:02:53.578203 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:53.580003 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m17:02:53.580711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A56B170>]}
[0m17:02:56.987714 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m17:02:56.990223 [info ] [Thread-1 (]: 22 of 26 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.05s]
[0m17:02:56.991745 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m17:02:56.992502 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m17:02:56.993296 [info ] [Thread-1 (]: 23 of 26 START sql table model report.report_retargeting_performance ........... [RUN]
[0m17:02:56.994018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m17:02:56.994398 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m17:02:56.997126 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m17:02:56.998077 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m17:02:57.000970 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m17:02:57.001859 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:02:57.002177 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m17:02:57.002409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:57.003076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:57.003331 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:02:57.003572 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m17:02:57.006621 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:57.009021 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:02:57.009458 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m17:02:57.010378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.012675 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:02:57.012977 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m17:02:57.013625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.014890 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m17:02:57.015375 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:02:57.015810 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m17:02:57.019594 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:57.021397 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:02:57.021725 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m17:02:57.024960 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:57.026453 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m17:02:57.027107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A56B770>]}
[0m17:02:57.027722 [info ] [Thread-1 (]: 23 of 26 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.03s]
[0m17:02:57.028634 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m17:02:57.028975 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_incentive_impact
[0m17:02:57.029343 [info ] [Thread-1 (]: 24 of 26 START sql table model report.report_driver_incentive_impact ........... [RUN]
[0m17:02:57.029929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_incentive_impact)
[0m17:02:57.030222 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_incentive_impact
[0m17:02:57.032629 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_incentive_impact"
[0m17:02:57.034154 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_incentive_impact
[0m17:02:57.037052 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_incentive_impact"
[0m17:02:57.038174 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:02:57.038512 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: BEGIN
[0m17:02:57.038751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:57.039286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.039576 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:02:57.039814 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_incentive_impact"
--order by interaction_date asc
    );
  
  
[0m17:02:57.041184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:57.043658 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:02:57.044004 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
alter table "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp" rename to "report_driver_incentive_impact"
[0m17:02:57.044832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.045946 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m17:02:57.046284 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:02:57.046536 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m17:02:57.050291 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:57.052218 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:02:57.052667 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."report"."report_driver_incentive_impact__dbt_backup" cascade
[0m17:02:57.053240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.054228 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: Close
[0m17:02:57.054687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A639910>]}
[0m17:02:57.055163 [info ] [Thread-1 (]: 24 of 26 OK created sql table model report.report_driver_incentive_impact ...... [[32mOK[0m in 0.02s]
[0m17:02:57.055981 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_incentive_impact
[0m17:02:57.056311 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m17:02:57.056662 [info ] [Thread-1 (]: 25 of 26 START sql table model report.report_driver_perfornance ................ [RUN]
[0m17:02:57.057304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_incentive_impact, now model.ae_exam_project.report_driver_perfornance)
[0m17:02:57.057629 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m17:02:57.062453 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.063823 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m17:02:57.066911 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.068151 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.068592 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m17:02:57.068845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:57.069384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.069657 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.069899 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m17:02:57.073795 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:02:57.076662 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.077069 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance" rename to "report_driver_perfornance__dbt_backup"
[0m17:02:57.077775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.079882 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.080328 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m17:02:57.081062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.082476 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m17:02:57.082853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.083170 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m17:02:57.089065 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:02:57.091402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:02:57.091729 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m17:02:57.094963 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:57.096195 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m17:02:57.096822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A4D7770>]}
[0m17:02:57.097507 [info ] [Thread-1 (]: 25 of 26 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.04s]
[0m17:02:57.098568 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m17:02:57.099071 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_zone_heatmap
[0m17:02:57.099725 [info ] [Thread-1 (]: 26 of 26 START sql table model report.report_driver_zone_heatmap ............... [RUN]
[0m17:02:57.100611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_perfornance, now model.ae_exam_project.report_driver_zone_heatmap)
[0m17:02:57.100983 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_zone_heatmap
[0m17:02:57.103422 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.104673 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_zone_heatmap
[0m17:02:57.106840 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.107700 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.108035 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: BEGIN
[0m17:02:57.108270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:57.108849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:57.109153 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.109429 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_zone_heatmap"
order by delivery_zone asc
    );
  
  
[0m17:02:57.111035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:02:57.113459 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.113882 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap" rename to "report_driver_zone_heatmap__dbt_backup"
[0m17:02:57.114580 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.117138 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.117454 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp" rename to "report_driver_zone_heatmap"
[0m17:02:57.118062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:02:57.119093 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m17:02:57.119369 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.119619 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m17:02:57.122851 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:57.124574 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:02:57.124866 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_backup" cascade
[0m17:02:57.128215 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:02:57.129507 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: Close
[0m17:02:57.130088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edb0011-b15f-4db1-ae13-312548a1ee99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A58CB9E50>]}
[0m17:02:57.130636 [info ] [Thread-1 (]: 26 of 26 OK created sql table model report.report_driver_zone_heatmap .......... [[32mOK[0m in 0.03s]
[0m17:02:57.131633 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_zone_heatmap
[0m17:02:57.133603 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:57.133956 [debug] [MainThread]: On master: BEGIN
[0m17:02:57.134162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:02:57.134752 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:02:57.135005 [debug] [MainThread]: On master: COMMIT
[0m17:02:57.135268 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:57.135483 [debug] [MainThread]: On master: COMMIT
[0m17:02:57.135836 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:02:57.136096 [debug] [MainThread]: On master: Close
[0m17:02:57.136382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:57.136567 [debug] [MainThread]: Connection 'create_ae_exam_db_staging' was properly closed.
[0m17:02:57.136732 [debug] [MainThread]: Connection 'list_ae_exam_db_staging' was properly closed.
[0m17:02:57.136899 [debug] [MainThread]: Connection 'model.ae_exam_project.report_driver_zone_heatmap' was properly closed.
[0m17:02:57.137176 [info ] [MainThread]: 
[0m17:02:57.137742 [info ] [MainThread]: Finished running 12 table models, 14 view models in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m17:02:57.141067 [debug] [MainThread]: Command end result
[0m17:02:57.162067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m17:02:57.165430 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m17:02:57.172194 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m17:02:57.172714 [info ] [MainThread]: 
[0m17:02:57.173276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:57.173839 [info ] [MainThread]: 
[0m17:02:57.174371 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m17:02:57.175285 [debug] [MainThread]: Command `dbt run` succeeded at 17:02:57.175146 after 6.39 seconds
[0m17:02:57.175735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59E50770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A55B2EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5A753E30>]}
[0m17:02:57.176089 [debug] [MainThread]: Flushing usage events
[0m17:02:58.195804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:27.466562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60FC3A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A610BC7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A610DB7ED0>]}


============================== 17:12:27.470991 | 63cb4379-05b9-4db2-81a3-41bb11d9929c ==============================
[0m17:12:27.470991 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:12:27.472261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:12:27.636141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6102F10F0>]}
[0m17:12:27.688132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A610C77AC0>]}
[0m17:12:27.691059 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:12:27.842181 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:12:27.945409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:27.945778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:27.946241 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m17:12:27.947317 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m17:12:27.947919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A610E8B950>]}
[0m17:12:27.981599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61226AC60>]}
[0m17:12:28.058709 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m17:12:28.061453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m17:12:28.085170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6124C9010>]}
[0m17:12:28.085757 [info ] [MainThread]: Found 26 models, 11 sources, 429 macros
[0m17:12:28.086366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612480050>]}
[0m17:12:28.089624 [info ] [MainThread]: 
[0m17:12:28.090301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:28.090861 [info ] [MainThread]: 
[0m17:12:28.091629 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:28.099318 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m17:12:28.179183 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:12:28.179684 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:12:28.180041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:28.210914 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m17:12:28.212694 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:12:28.215090 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:12:28.215500 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:12:28.215829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.216843 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.218160 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:12:28.219981 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:12:28.220356 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:12:28.220807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.221999 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.223895 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:12:28.226710 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m17:12:28.227375 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m17:12:28.227769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.228895 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.230292 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m17:12:28.231443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m17:12:28.232501 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m17:12:28.239800 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:12:28.240358 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:12:28.240727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.242266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.244452 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:12:28.244907 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m17:12:28.245850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.246324 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:12:28.246664 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m17:12:28.249322 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:12:28.250587 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m17:12:28.251496 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m17:12:28.252017 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m17:12:28.252981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.253939 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m17:12:28.255126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_intermediate)
[0m17:12:28.255986 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m17:12:28.259452 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:12:28.260016 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:12:28.260665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.262071 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.264151 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:12:28.264841 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m17:12:28.265569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.265921 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:12:28.266232 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m17:12:28.266794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.267779 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m17:12:28.268161 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m17:12:28.268467 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m17:12:28.268969 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.269315 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m17:12:28.269902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m17:12:28.270384 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m17:12:28.272977 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:12:28.273476 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:12:28.273816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.275031 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.276583 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:12:28.276940 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m17:12:28.277500 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.277832 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:12:28.278120 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m17:12:28.278759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.279746 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m17:12:28.280098 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m17:12:28.280406 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m17:12:28.280874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.281181 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m17:12:28.281842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m17:12:28.282334 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m17:12:28.284069 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:12:28.284419 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m17:12:28.284735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.285670 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.287063 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:12:28.287425 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m17:12:28.287922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.288236 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:12:28.288540 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m17:12:28.289103 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.290108 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m17:12:28.290457 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m17:12:28.290759 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m17:12:28.291244 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:28.291570 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m17:12:28.295451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m17:12:28.301551 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m17:12:28.302314 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m17:12:28.302704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:28.303361 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.303696 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m17:12:28.304085 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:12:28.332278 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:12:28.334777 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m17:12:28.336148 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m17:12:28.336538 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m17:12:28.337137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_intermediate)
[0m17:12:28.338908 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m17:12:28.339317 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m17:12:28.339652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.341547 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:12:28.341944 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m17:12:28.342293 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:12:28.347230 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:12:28.348937 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m17:12:28.349720 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m17:12:28.350105 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m17:12:28.350701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m17:12:28.352526 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m17:12:28.352891 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m17:12:28.353217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.355372 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:12:28.356015 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m17:12:28.356590 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:12:28.362830 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:12:28.364631 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m17:12:28.365348 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m17:12:28.365707 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m17:12:28.368178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m17:12:28.370419 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m17:12:28.370789 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m17:12:28.371108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:28.371741 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:28.372139 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m17:12:28.372466 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m17:12:28.377518 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:12:28.379259 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m17:12:28.380010 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m17:12:28.380385 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m17:12:28.382809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61248A390>]}
[0m17:12:28.383367 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:28.383722 [debug] [MainThread]: On master: BEGIN
[0m17:12:28.384043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:28.384718 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:12:28.385070 [debug] [MainThread]: On master: COMMIT
[0m17:12:28.385374 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:28.385673 [debug] [MainThread]: On master: COMMIT
[0m17:12:28.386200 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:28.386585 [debug] [MainThread]: On master: Close
[0m17:12:28.390502 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m17:12:28.391179 [info ] [Thread-1 (]: 1 of 26 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m17:12:28.392204 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m17:12:28.392654 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m17:12:28.401079 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.402888 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m17:12:28.445524 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.447338 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.447971 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m17:12:28.448384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:28.449364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.449919 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.450348 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m17:12:28.452674 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:28.460264 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.460804 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m17:12:28.462399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.466360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.466882 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m17:12:28.467757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.483517 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m17:12:28.484253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.484730 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m17:12:28.490206 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:28.496604 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m17:12:28.497207 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m17:12:28.506805 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:12:28.510086 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m17:12:28.513123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6128A49F0>]}
[0m17:12:28.514080 [info ] [Thread-1 (]: 1 of 26 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.12s]
[0m17:12:28.515215 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m17:12:28.515746 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m17:12:28.516350 [info ] [Thread-1 (]: 2 of 26 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m17:12:28.517188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m17:12:28.517670 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m17:12:28.521282 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.522735 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m17:12:28.527686 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.529408 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.530016 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m17:12:28.530439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.531333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.532001 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.532613 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m17:12:28.534575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.538513 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.539494 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m17:12:28.541153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.547437 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.549753 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m17:12:28.551166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.553727 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m17:12:28.554612 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.555325 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m17:12:28.559070 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.561820 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m17:12:28.562332 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m17:12:28.565728 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.567595 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m17:12:28.568336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61290A490>]}
[0m17:12:28.569122 [info ] [Thread-1 (]: 2 of 26 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.05s]
[0m17:12:28.570189 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m17:12:28.570678 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m17:12:28.571222 [info ] [Thread-1 (]: 3 of 26 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m17:12:28.572097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m17:12:28.572684 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m17:12:28.575846 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.577083 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m17:12:28.581048 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.582447 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.582972 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m17:12:28.583397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.584309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.584849 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.585304 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m17:12:28.586532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.590540 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.591208 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m17:12:28.592861 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.596710 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.597263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m17:12:28.598198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.599871 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m17:12:28.600357 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.600766 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m17:12:28.604031 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.607904 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m17:12:28.608559 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m17:12:28.612603 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.614720 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m17:12:28.615505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61290C050>]}
[0m17:12:28.616482 [info ] [Thread-1 (]: 3 of 26 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m17:12:28.617594 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m17:12:28.618124 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m17:12:28.618726 [info ] [Thread-1 (]: 4 of 26 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m17:12:28.619486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m17:12:28.619925 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m17:12:28.623644 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.625289 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m17:12:28.632605 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.634082 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.634788 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m17:12:28.635276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.636077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.636533 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.636962 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m17:12:28.638049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.642377 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.643030 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m17:12:28.644055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.648415 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.649033 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m17:12:28.650180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.652131 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m17:12:28.652678 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.653134 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m17:12:28.656857 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.721541 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m17:12:28.722730 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m17:12:28.726825 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.728833 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m17:12:28.729558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6128E4FA0>]}
[0m17:12:28.730390 [info ] [Thread-1 (]: 4 of 26 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.11s]
[0m17:12:28.731574 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m17:12:28.732107 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:12:28.732718 [info ] [Thread-1 (]: 5 of 26 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m17:12:28.733631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m17:12:28.734190 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:12:28.737548 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.739544 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:12:28.744755 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.746639 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.747311 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m17:12:28.747810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.748695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.749254 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.750321 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m17:12:28.752493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.757540 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.758258 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m17:12:28.759326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.763061 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.763626 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.764563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.766367 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m17:12:28.766922 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.767403 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m17:12:28.771070 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.775168 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m17:12:28.775831 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m17:12:28.779484 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.782850 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m17:12:28.784481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6127532F0>]}
[0m17:12:28.785503 [info ] [Thread-1 (]: 5 of 26 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m17:12:28.787121 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m17:12:28.788021 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:12:28.789069 [info ] [Thread-1 (]: 6 of 26 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m17:12:28.790269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m17:12:28.790962 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:12:28.796880 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.798503 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:12:28.803669 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.805835 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.806763 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m17:12:28.807459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.808761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.809530 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.810306 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m17:12:28.812249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.818228 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.818949 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m17:12:28.820109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.824147 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.824972 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.826111 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.828055 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m17:12:28.828655 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.829471 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m17:12:28.833729 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.836811 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m17:12:28.837397 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m17:12:28.840975 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.843502 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m17:12:28.844417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A610E3B530>]}
[0m17:12:28.845368 [info ] [Thread-1 (]: 6 of 26 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.05s]
[0m17:12:28.847273 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m17:12:28.847865 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m17:12:28.848495 [info ] [Thread-1 (]: 7 of 26 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m17:12:28.849710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m17:12:28.850511 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m17:12:28.854675 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.856272 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m17:12:28.861263 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.862887 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.863552 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m17:12:28.864062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.865281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.865876 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.866381 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m17:12:28.867815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.871917 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.872743 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m17:12:28.873895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.878439 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.879164 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m17:12:28.880764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.883310 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m17:12:28.883977 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.884561 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m17:12:28.888493 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.892050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m17:12:28.892711 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m17:12:28.896611 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.899006 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m17:12:28.899908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612048BF0>]}
[0m17:12:28.900828 [info ] [Thread-1 (]: 7 of 26 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.05s]
[0m17:12:28.902156 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m17:12:28.902729 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m17:12:28.903388 [info ] [Thread-1 (]: 8 of 26 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m17:12:28.904520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_tickets)
[0m17:12:28.905193 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m17:12:28.910176 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.911692 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m17:12:28.916117 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.917647 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.918265 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m17:12:28.918769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.919694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.920199 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.920685 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m17:12:28.922212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.926851 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.927503 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m17:12:28.928574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.933701 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.934448 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m17:12:28.935570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.937561 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m17:12:28.938149 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.938814 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m17:12:28.942647 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:28.946010 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m17:12:28.946867 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m17:12:28.950135 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:28.952347 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m17:12:28.953166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61204B8F0>]}
[0m17:12:28.954127 [info ] [Thread-1 (]: 8 of 26 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.05s]
[0m17:12:28.955799 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m17:12:28.956456 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m17:12:28.957430 [info ] [Thread-1 (]: 9 of 26 START sql view model intermediate.model_int_driver_profile_active ...... [RUN]
[0m17:12:28.958645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m17:12:28.959282 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m17:12:28.962982 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:28.965314 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m17:12:28.970050 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:28.972171 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:28.972992 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m17:12:28.973553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:28.974642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.975231 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:28.975753 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m17:12:28.977179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.981860 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:28.982554 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m17:12:28.983634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:28.987619 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:28.988245 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m17:12:28.989330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:28.992055 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m17:12:28.992715 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:28.993263 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m17:12:28.997704 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:29.001550 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m17:12:29.002198 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m17:12:29.010760 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:12:29.013017 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m17:12:29.013877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612015B50>]}
[0m17:12:29.014874 [info ] [Thread-1 (]: 9 of 26 OK created sql view model intermediate.model_int_driver_profile_active . [[32mOK[0m in 0.06s]
[0m17:12:29.016191 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m17:12:29.016807 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:12:29.017515 [info ] [Thread-1 (]: 10 of 26 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m17:12:29.018790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m17:12:29.019436 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:12:29.024788 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.026639 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:12:29.032003 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.033959 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.035076 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m17:12:29.035969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:29.037464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.038401 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.039436 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m17:12:29.046182 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:12:29.050819 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.051546 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m17:12:29.052676 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.057598 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.058615 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m17:12:29.059852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.062041 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m17:12:29.062680 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.063429 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m17:12:29.067248 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:29.071070 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m17:12:29.071683 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m17:12:29.075722 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:29.078038 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m17:12:29.078893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612887230>]}
[0m17:12:29.079869 [info ] [Thread-1 (]: 10 of 26 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.06s]
[0m17:12:29.081949 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m17:12:29.082989 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m17:12:29.083759 [info ] [Thread-1 (]: 11 of 26 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m17:12:29.085113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m17:12:29.085727 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m17:12:29.092171 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.093751 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m17:12:29.098085 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.099670 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.100312 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m17:12:29.100836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:29.101776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.102327 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.102936 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m17:12:29.107456 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:29.116381 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.117096 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m17:12:29.118331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.122817 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.123662 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m17:12:29.125698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.129479 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m17:12:29.130551 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.131497 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m17:12:29.136374 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:29.141783 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m17:12:29.142616 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m17:12:29.146704 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:29.149074 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m17:12:29.150181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A610E3B530>]}
[0m17:12:29.151194 [info ] [Thread-1 (]: 11 of 26 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.07s]
[0m17:12:29.152626 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m17:12:29.153278 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m17:12:29.154026 [info ] [Thread-1 (]: 12 of 26 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m17:12:29.155185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m17:12:29.156061 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m17:12:29.161701 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.163537 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m17:12:29.169072 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.170886 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.171586 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m17:12:29.172511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:29.173893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.174686 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.175398 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, ---ต้องใส้เพิ่มไหมนะ and issue_type = 'delivery' and issue_sub_type != 'not_delivered'
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m17:12:29.180702 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:29.187876 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.188704 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m17:12:29.190161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.194703 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.195432 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m17:12:29.197606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.201166 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m17:12:29.202017 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.202629 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m17:12:29.206776 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:29.211332 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m17:12:29.212111 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m17:12:29.215254 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:29.218186 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m17:12:29.219452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612048530>]}
[0m17:12:29.220586 [info ] [Thread-1 (]: 12 of 26 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.06s]
[0m17:12:29.222301 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m17:12:29.223181 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m17:12:29.224034 [info ] [Thread-1 (]: 13 of 26 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m17:12:29.225209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m17:12:29.225875 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m17:12:29.231676 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.233626 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m17:12:29.239393 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.241613 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.242353 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m17:12:29.243161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:29.244814 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:29.246209 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.247610 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
    select
        ot.order_id,
        ot.driver_id,
        ot.delivery_zone,
        ot.order_datetime,
        ot.pickup_datetime,
        ot.delivery_datetime,
        ot.is_late_delivery,

        case when ot.order_status = 'completed' then 1 else 0 end as is_completed,
        case when ot.order_status != 'completed' then 1 else 0 end as is_failed,

        extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
        extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
        extract(epoch from ot.delivery_datetime - ot.order_datetime) / 60.0 as delivery_duration_mins,

        case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,

        st.csat_score,
        st.ticket_id,

        ld.bonus_amount,
        ld.delivery_target,
        ld.actual_deliveries,
        ld.incentive_program,
        ld.applied_date,
        ld.bonus_qualified,
        case when ld.bonus_qualified = true then 1 else 0 end as bonus_qualified_sessions,
        ld.region as region_log,
        ld.log_id

    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_support_tickets" st
        on ot.order_id = st.order_id

    left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld
        on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m17:12:29.252608 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:29.259822 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.261099 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary" rename to "model_int_order_delivery_summary__dbt_backup"
[0m17:12:29.263147 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.271460 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.272709 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m17:12:29.275481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.278507 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m17:12:29.279571 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.280709 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m17:12:29.285668 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:29.291753 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m17:12:29.292585 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m17:12:29.296778 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:29.299437 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m17:12:29.300451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612048DD0>]}
[0m17:12:29.301494 [info ] [Thread-1 (]: 13 of 26 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.08s]
[0m17:12:29.303022 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m17:12:29.303755 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m17:12:29.304841 [info ] [Thread-1 (]: 14 of 26 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m17:12:29.306382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m17:12:29.307294 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m17:12:29.313130 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.315879 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m17:12:29.363323 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.366216 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.367382 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m17:12:29.368143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:29.369295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.370079 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.370792 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m17:12:29.463441 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m17:12:29.468398 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.469207 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m17:12:29.471520 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:29.477574 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.478383 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m17:12:29.479807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.489388 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m17:12:29.490250 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.490926 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m17:12:29.500629 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:12:29.504676 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m17:12:29.505578 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m17:12:29.510268 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:29.512964 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m17:12:29.514041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61204A030>]}
[0m17:12:29.515224 [info ] [Thread-1 (]: 14 of 26 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.21s]
[0m17:12:29.516723 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m17:12:29.517439 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m17:12:29.518332 [info ] [Thread-1 (]: 15 of 26 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m17:12:29.519659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m17:12:29.520343 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m17:12:29.528236 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:29.530163 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m17:12:29.536077 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:29.538475 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:29.539747 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m17:12:29.540947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:29.542174 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:29.542878 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:29.543738 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m17:12:30.039440 [debug] [Thread-1 (]: SQL status: OK in 0.495 seconds
[0m17:12:30.047160 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:30.048170 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m17:12:30.050440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:30.060063 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:30.061583 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m17:12:30.064128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:30.071792 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m17:12:30.074139 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:30.076317 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m17:12:30.087794 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:12:30.094738 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m17:12:30.095868 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m17:12:30.101253 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:30.104791 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m17:12:30.107181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612887EF0>]}
[0m17:12:30.108922 [info ] [Thread-1 (]: 15 of 26 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.59s]
[0m17:12:30.111158 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m17:12:30.112224 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m17:12:30.114404 [info ] [Thread-1 (]: 16 of 26 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m17:12:30.116308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m17:12:30.117651 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m17:12:30.129249 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:30.133217 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m17:12:30.153239 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:30.159860 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:30.161591 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m17:12:30.163110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:30.165746 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:30.167341 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:30.169109 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m17:12:31.469505 [debug] [Thread-1 (]: SQL status: OK in 1.298 seconds
[0m17:12:31.480689 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:31.482380 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m17:12:31.485662 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:31.498182 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:31.500127 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m17:12:31.502550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:31.508813 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m17:12:31.510774 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:31.512824 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m17:12:31.522070 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:31.530351 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m17:12:31.531670 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m17:12:31.537087 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:31.544449 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m17:12:31.546517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61204A030>]}
[0m17:12:31.548335 [info ] [Thread-1 (]: 16 of 26 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 1.43s]
[0m17:12:31.551978 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m17:12:31.553972 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:12:31.556254 [info ] [Thread-1 (]: 17 of 26 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m17:12:31.559156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m17:12:31.561499 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:12:31.570292 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.575222 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:12:31.586525 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.593864 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.595844 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m17:12:31.597319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:31.599353 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:31.600667 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.602106 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    --sum(is_unassigned) as no_driver_orders,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m17:12:31.614887 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:12:31.632494 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.635134 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates" rename to "model_int_zone_delivery_aggregates__dbt_backup"
[0m17:12:31.640288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:31.655591 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.659477 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m17:12:31.663230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:31.670077 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m17:12:31.673424 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.675967 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m17:12:31.682916 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:31.694223 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m17:12:31.695635 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m17:12:31.700948 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:31.706719 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m17:12:31.709881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612884EF0>]}
[0m17:12:31.712645 [info ] [Thread-1 (]: 17 of 26 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.15s]
[0m17:12:31.716272 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m17:12:31.718371 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:12:31.720919 [info ] [Thread-1 (]: 18 of 26 START sql table model mart.model_mart_driver_incentive_impact ......... [RUN]
[0m17:12:31.727643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_incentive_impact)
[0m17:12:31.730323 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:12:31.758939 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:31.765689 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:12:31.779116 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:31.785448 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:31.788548 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: BEGIN
[0m17:12:31.790494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:31.793932 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:31.795927 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:31.797927 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp"
  
    as (
      


select
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log,
    count(ods.log_id) as total_sessions,
    sum(ods.actual_deliveries) as total_deliveries,
    sum(ods.bonus_qualified_sessions) as total_bonus_qualified_sessions,
    round(sum(case when ods.bonus_qualified = true then ods.bonus_amount else 0 end),2) as total_bonus_earned,
    round(avg(ods.csat_score), 2) as avg_feedback_score,
    round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
where ods.is_completed = 1 and ods.incentive_program is not null
group by
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log
    );
  
  
[0m17:12:32.044627 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m17:12:32.054385 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:32.055927 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
alter table "ae_exam_db"."mart"."model_mart_driver_incentive_impact" rename to "model_mart_driver_incentive_impact__dbt_backup"
[0m17:12:32.058675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:32.067800 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:32.069197 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
alter table "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp" rename to "model_mart_driver_incentive_impact"
[0m17:12:32.071587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:32.076183 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m17:12:32.077482 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:32.078651 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m17:12:32.087094 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:32.094466 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m17:12:32.096115 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_backup" cascade
[0m17:12:32.101999 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:32.106775 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: Close
[0m17:12:32.108707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6101E6870>]}
[0m17:12:32.110680 [info ] [Thread-1 (]: 18 of 26 OK created sql table model mart.model_mart_driver_incentive_impact .... [[32mOK[0m in 0.38s]
[0m17:12:32.113530 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m17:12:32.115005 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m17:12:32.116824 [info ] [Thread-1 (]: 19 of 26 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m17:12:32.119373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_incentive_impact, now model.ae_exam_project.model_mart_driver_performance)
[0m17:12:32.121169 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m17:12:32.134775 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.140689 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m17:12:32.151232 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.155769 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.158353 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m17:12:32.161129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:32.163889 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:32.165621 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.167082 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    round(avg(ods.csat_score),2) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m17:12:32.468234 [debug] [Thread-1 (]: SQL status: OK in 0.300 seconds
[0m17:12:32.476835 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.478279 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance" rename to "model_mart_driver_performance__dbt_backup"
[0m17:12:32.480628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:32.490994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.492542 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m17:12:32.495395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:32.499930 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m17:12:32.501373 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.502645 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m17:12:32.516994 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:12:32.523925 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m17:12:32.525322 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m17:12:32.530795 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:32.535841 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m17:12:32.537572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6127532F0>]}
[0m17:12:32.540051 [info ] [Thread-1 (]: 19 of 26 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.42s]
[0m17:12:32.542946 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m17:12:32.544408 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:12:32.546322 [info ] [Thread-1 (]: 20 of 26 START sql table model mart.model_mart_driver_zone_heatmap ............. [RUN]
[0m17:12:32.549374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.model_mart_driver_zone_heatmap)
[0m17:12:32.551383 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:12:32.566070 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:32.570891 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:12:32.582402 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:32.587052 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:32.589196 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: BEGIN
[0m17:12:32.591381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:32.593927 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:32.595298 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:32.596897 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp"
  
    as (
      

with failed_requests_unavailable_driver as (
    select  
        delivery_zone,
        count(*) as total_cancel_or_failed_requests
    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_drivers_master" dm 
      on ot.driver_id = dm.driver_id
    where ot.order_status in ('cancelled', 'failed')
      and (ot.driver_id is null or dm.active_status = 'inactive')
    group by delivery_zone
),

aggregates as (
    select
        ods.delivery_zone,
        count(ods.order_id) as total_requests,
        sum(ods.is_completed) as completed_requests,
        round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
        dsd.available_drivers,
        coalesce(rud.total_cancel_or_failed_requests, 0) as failed_requests
    from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
    left join (
        select region as delivery_zone, count(driver_id) as available_drivers
        from "ae_exam_db"."intermediate"."model_int_driver_profile_active"
        group by region
    ) dsd on ods.delivery_zone = dsd.delivery_zone
    left join failed_requests_unavailable_driver rud  
      on ods.delivery_zone = rud.delivery_zone
    group by 
        ods.delivery_zone,
        dsd.available_drivers,
        rud.total_cancel_or_failed_requests
)

select 
    delivery_zone,
    total_requests,
    completed_requests,
    failed_requests,
    avg_delivery_time_mins,
    available_drivers,
    case 
        when total_requests > 0 
        then round((completed_requests::numeric / total_requests) * 100, 2) 
        else 0 
    end as completion_rate,
    case 
        when available_drivers > 0 
        then round((total_requests::numeric / available_drivers) * 100, 2) 
        else 0 
    end as demand_supply_rate
from aggregates
    );
  
  
[0m17:12:32.944854 [debug] [Thread-1 (]: SQL status: OK in 0.346 seconds
[0m17:12:32.955337 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:32.957302 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap" rename to "model_mart_driver_zone_heatmap__dbt_backup"
[0m17:12:32.960263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:32.974411 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:32.977278 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp" rename to "model_mart_driver_zone_heatmap"
[0m17:12:32.982049 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:32.989436 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m17:12:32.990822 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:32.992301 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m17:12:32.998131 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:33.005156 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m17:12:33.006495 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_backup" cascade
[0m17:12:33.013580 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:33.018317 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: Close
[0m17:12:33.020173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612886E70>]}
[0m17:12:33.022287 [info ] [Thread-1 (]: 20 of 26 OK created sql table model mart.model_mart_driver_zone_heatmap ........ [[32mOK[0m in 0.47s]
[0m17:12:33.025405 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m17:12:33.026735 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m17:12:33.028256 [info ] [Thread-1 (]: 21 of 26 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m17:12:33.030743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_zone_heatmap, now model.ae_exam_project.report_campaign_effectiveness)
[0m17:12:33.032059 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m17:12:33.041991 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.046440 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m17:12:33.061535 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.065569 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.067325 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m17:12:33.068403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:33.070183 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:33.071413 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.073549 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m17:12:33.096268 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:12:33.104369 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.106084 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m17:12:33.108491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:33.116651 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.117875 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m17:12:33.120015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:33.124312 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m17:12:33.125591 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.126621 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m17:12:33.135796 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:12:33.143015 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m17:12:33.144235 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m17:12:33.149358 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:33.153464 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m17:12:33.155006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6120152B0>]}
[0m17:12:33.156756 [info ] [Thread-1 (]: 21 of 26 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.12s]
[0m17:12:33.159491 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m17:12:33.160790 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m17:12:33.162124 [info ] [Thread-1 (]: 22 of 26 START sql table model report.report_customer _acquisition ............. [RUN]
[0m17:12:33.163876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m17:12:33.165235 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m17:12:33.174110 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.177377 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m17:12:33.187702 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.193791 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.195353 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m17:12:33.197089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:33.198915 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:33.200245 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.201480 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m17:12:33.227293 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m17:12:33.242326 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.243927 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m17:12:33.246453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:33.257054 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.258342 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m17:12:33.260688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:33.267484 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m17:12:33.268853 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.270002 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m17:12:33.284814 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:12:33.291303 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m17:12:33.292573 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m17:12:33.298170 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:33.302315 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m17:12:33.303849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A612753B90>]}
[0m17:12:36.636993 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m17:12:36.638777 [info ] [Thread-1 (]: 22 of 26 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.14s]
[0m17:12:36.640273 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m17:12:36.640718 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m17:12:36.641204 [info ] [Thread-1 (]: 23 of 26 START sql table model report.report_retargeting_performance ........... [RUN]
[0m17:12:36.642043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m17:12:36.642332 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m17:12:36.644506 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.645462 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m17:12:36.647669 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.648501 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.648822 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m17:12:36.649055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:36.649574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.649820 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.650043 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m17:12:36.652837 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:36.656831 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.657382 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m17:12:36.658313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.661003 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.661421 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m17:12:36.662225 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.663327 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m17:12:36.663609 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.663858 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m17:12:36.667387 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:36.669402 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m17:12:36.669729 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m17:12:36.672739 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:36.674649 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m17:12:36.675865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6128847D0>]}
[0m17:12:36.676443 [info ] [Thread-1 (]: 23 of 26 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.03s]
[0m17:12:36.677432 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m17:12:36.677903 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_incentive_impact
[0m17:12:36.678392 [info ] [Thread-1 (]: 24 of 26 START sql table model report.report_driver_incentive_impact ........... [RUN]
[0m17:12:36.679022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_incentive_impact)
[0m17:12:36.679597 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_incentive_impact
[0m17:12:36.682066 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.683840 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_incentive_impact
[0m17:12:36.686131 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.687046 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.687458 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: BEGIN
[0m17:12:36.687754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:36.688862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:36.689447 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.690120 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_incentive_impact"
--order by interaction_date asc
    );
  
  
[0m17:12:36.691711 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:36.694190 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.694689 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
alter table "ae_exam_db"."report"."report_driver_incentive_impact" rename to "report_driver_incentive_impact__dbt_backup"
[0m17:12:36.695471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.699309 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.699609 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
alter table "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp" rename to "report_driver_incentive_impact"
[0m17:12:36.700202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.701178 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m17:12:36.701441 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.701668 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m17:12:36.705389 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:36.707981 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m17:12:36.708395 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."report"."report_driver_incentive_impact__dbt_backup" cascade
[0m17:12:36.711849 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:36.713098 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: Close
[0m17:12:36.713553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6128ABA70>]}
[0m17:12:36.714045 [info ] [Thread-1 (]: 24 of 26 OK created sql table model report.report_driver_incentive_impact ...... [[32mOK[0m in 0.03s]
[0m17:12:36.715028 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_incentive_impact
[0m17:12:36.715412 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m17:12:36.715740 [info ] [Thread-1 (]: 25 of 26 START sql table model report.report_driver_perfornance ................ [RUN]
[0m17:12:36.716533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_incentive_impact, now model.ae_exam_project.report_driver_perfornance)
[0m17:12:36.716800 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m17:12:36.718733 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.719532 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m17:12:36.722680 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.723825 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.724204 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m17:12:36.724447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:36.725041 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:36.725369 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.725639 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m17:12:36.730044 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:36.732278 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.732604 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance" rename to "report_driver_perfornance__dbt_backup"
[0m17:12:36.733286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.735650 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.735950 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m17:12:36.736524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.737670 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m17:12:36.738025 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.738293 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m17:12:36.744133 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:36.745938 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m17:12:36.746369 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m17:12:36.749608 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:36.750774 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m17:12:36.751189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6128AAFF0>]}
[0m17:12:36.751924 [info ] [Thread-1 (]: 25 of 26 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.03s]
[0m17:12:36.753098 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m17:12:36.753517 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_zone_heatmap
[0m17:12:36.754034 [info ] [Thread-1 (]: 26 of 26 START sql table model report.report_driver_zone_heatmap ............... [RUN]
[0m17:12:36.754853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_perfornance, now model.ae_exam_project.report_driver_zone_heatmap)
[0m17:12:36.755421 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_zone_heatmap
[0m17:12:36.758033 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.759247 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_zone_heatmap
[0m17:12:36.762079 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.763085 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.763606 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: BEGIN
[0m17:12:36.763855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:36.764686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:36.765075 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.765540 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_zone_heatmap"
order by delivery_zone asc
    );
  
  
[0m17:12:36.766769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:36.768747 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.769018 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap" rename to "report_driver_zone_heatmap__dbt_backup"
[0m17:12:36.769566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.772096 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.772618 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp" rename to "report_driver_zone_heatmap"
[0m17:12:36.773376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:36.774523 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m17:12:36.774864 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.775130 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m17:12:36.778548 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:36.781171 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m17:12:36.781643 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_backup" cascade
[0m17:12:36.784781 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:36.786090 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: Close
[0m17:12:36.786511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cb4379-05b9-4db2-81a3-41bb11d9929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6101E6870>]}
[0m17:12:36.786961 [info ] [Thread-1 (]: 26 of 26 OK created sql table model report.report_driver_zone_heatmap .......... [[32mOK[0m in 0.03s]
[0m17:12:36.787886 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_zone_heatmap
[0m17:12:36.789731 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:36.790095 [debug] [MainThread]: On master: BEGIN
[0m17:12:36.790374 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:36.790914 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:12:36.791170 [debug] [MainThread]: On master: COMMIT
[0m17:12:36.791368 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:36.791550 [debug] [MainThread]: On master: COMMIT
[0m17:12:36.791894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:36.792125 [debug] [MainThread]: On master: Close
[0m17:12:36.792437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:36.792664 [debug] [MainThread]: Connection 'create_ae_exam_db_mart' was properly closed.
[0m17:12:36.792844 [debug] [MainThread]: Connection 'list_ae_exam_db_mart' was properly closed.
[0m17:12:36.793106 [debug] [MainThread]: Connection 'model.ae_exam_project.report_driver_zone_heatmap' was properly closed.
[0m17:12:36.793449 [info ] [MainThread]: 
[0m17:12:36.794084 [info ] [MainThread]: Finished running 12 table models, 14 view models in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m17:12:36.797565 [debug] [MainThread]: Command end result
[0m17:12:36.819155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m17:12:36.822144 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m17:12:36.830681 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m17:12:36.831081 [info ] [MainThread]: 
[0m17:12:36.831602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:36.832187 [info ] [MainThread]: 
[0m17:12:36.832770 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m17:12:36.833692 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:36.833584 after 9.51 seconds
[0m17:12:36.833989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A610970110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61298BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A61298B9B0>]}
[0m17:12:36.834276 [debug] [MainThread]: Flushing usage events
[0m17:12:37.838948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:03.223032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258813A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225890C7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225892B7ED0>]}


============================== 18:31:03.228042 | 127d4ca2-77fa-4654-9cf4-72f2d78c3178 ==============================
[0m18:31:03.228042 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:31:03.228902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:31:03.463766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '127d4ca2-77fa-4654-9cf4-72f2d78c3178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225887F10F0>]}
[0m18:31:03.514571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '127d4ca2-77fa-4654-9cf4-72f2d78c3178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022589173AC0>]}
[0m18:31:03.517931 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:31:03.702982 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:31:03.807133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:03.807523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:03.807962 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m18:31:03.808928 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m18:31:03.809520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '127d4ca2-77fa-4654-9cf4-72f2d78c3178', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258938B950>]}
[0m18:31:03.839191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '127d4ca2-77fa-4654-9cf4-72f2d78c3178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258A6DAC60>]}
[0m18:31:03.903588 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m18:31:03.907096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m18:31:03.938325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '127d4ca2-77fa-4654-9cf4-72f2d78c3178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258A93D010>]}
[0m18:31:03.939101 [info ] [MainThread]: Found 29 models, 11 sources, 429 macros
[0m18:31:03.939846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '127d4ca2-77fa-4654-9cf4-72f2d78c3178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258A8F8050>]}
[0m18:31:03.942563 [info ] [MainThread]: 
[0m18:31:03.943345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:03.943833 [info ] [MainThread]: 
[0m18:31:03.944523 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:31:03.951093 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m18:31:04.022882 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:04.023260 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.023506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.173149 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.173543 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:31:04.175202 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:04.175619 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.175871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.272819 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.273221 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:31:04.274901 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:04.275263 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.275526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.382670 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.383078 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:31:04.385318 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:04.385803 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.386076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.486626 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:04.487011 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:31:04.488817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:04.489461 [debug] [MainThread]: Connection 'list_ae_exam_db' was properly closed.
[0m18:31:04.490370 [info ] [MainThread]: 
[0m18:31:04.491001 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m18:31:04.491801 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Jiraporn(Aom)Chattur\AppData\Local\DBeaver\dbeaver.exe (PID 27208)
[0m18:31:04.492736 [debug] [MainThread]: Command `dbt run` failed at 18:31:04.492632 after 1.58 seconds
[0m18:31:04.493018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022589162D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258A906990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258AC60470>]}
[0m18:31:04.493307 [debug] [MainThread]: Flushing usage events
[0m18:31:06.055713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:20.222178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E182EA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E19267890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E19457ED0>]}


============================== 18:31:20.226992 | 71f527ad-a041-4a70-93f9-447e96a85cb0 ==============================
[0m18:31:20.226992 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:31:20.228470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:31:20.493539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E189910F0>]}
[0m18:31:20.571253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E19313AC0>]}
[0m18:31:20.575066 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:31:20.774784 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:31:20.924563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:20.925002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:20.925585 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.report_customer _acquisition`
[0m18:31:20.926647 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m18:31:20.927549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1952B950>]}
[0m18:31:20.966873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A81AC60>]}
[0m18:31:21.046706 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m18:31:21.048965 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m18:31:21.072994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AA7D010>]}
[0m18:31:21.073518 [info ] [MainThread]: Found 29 models, 11 sources, 429 macros
[0m18:31:21.074277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AA38050>]}
[0m18:31:21.077635 [info ] [MainThread]: 
[0m18:31:21.078197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:21.078875 [info ] [MainThread]: 
[0m18:31:21.079815 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:31:21.088002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m18:31:21.167240 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:21.167745 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:21.168101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:21.278779 [debug] [ThreadPool]: SQL status: OK in 0.111 seconds
[0m18:31:21.281290 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:31:21.284014 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:21.284640 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:21.285336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.286870 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:31:21.288384 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:31:21.290388 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:21.290780 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:21.291124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.292148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.293456 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:31:21.295955 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:31:21.296346 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:31:21.296905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.298105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.299591 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:31:21.300560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_report)
[0m18:31:21.301763 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m18:31:21.309740 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:31:21.310230 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:31:21.310596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.311724 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.313197 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:31:21.313717 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m18:31:21.314308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.314631 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:31:21.314942 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m18:31:21.316562 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.317669 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m18:31:21.318036 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:31:21.318390 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m18:31:21.319021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.319428 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m18:31:21.320078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_report, now create_ae_exam_db_staging)
[0m18:31:21.320590 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m18:31:21.322386 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:31:21.322766 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:31:21.323086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.324055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.325503 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:31:21.325846 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m18:31:21.326358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.326720 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:31:21.327034 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m18:31:21.327632 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.328599 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m18:31:21.328965 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:31:21.329527 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m18:31:21.330061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.330394 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m18:31:21.331177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m18:31:21.331704 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m18:31:21.333968 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:31:21.334384 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:31:21.334708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.336040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.337695 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:31:21.338100 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m18:31:21.338679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.339028 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:31:21.339339 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m18:31:21.339887 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.340843 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m18:31:21.341203 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:31:21.341520 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m18:31:21.342006 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.342338 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m18:31:21.342936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_intermediate)
[0m18:31:21.343464 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m18:31:21.345340 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:31:21.345744 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:31:21.346074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.347066 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.348592 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:31:21.349000 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m18:31:21.349577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.349914 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:31:21.350235 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m18:31:21.350815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.351861 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m18:31:21.352242 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:31:21.352671 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m18:31:21.353304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:31:21.353635 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m18:31:21.357473 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_report'
[0m18:31:21.363746 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m18:31:21.364190 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m18:31:21.364505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:21.365416 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.365799 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m18:31:21.366128 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:31:21.390450 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:31:21.393174 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m18:31:21.399098 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m18:31:21.399564 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m18:31:21.400195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_report, now list_ae_exam_db_staging)
[0m18:31:21.402035 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m18:31:21.403805 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m18:31:21.404280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.405015 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:31:21.405355 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m18:31:21.405665 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:31:21.410494 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:31:21.412167 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m18:31:21.412881 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m18:31:21.413243 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m18:31:21.413822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m18:31:21.415592 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m18:31:21.415952 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m18:31:21.416258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.418293 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:31:21.418689 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m18:31:21.419034 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:31:21.423785 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:31:21.425415 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m18:31:21.426110 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m18:31:21.426450 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m18:31:21.427119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_intermediate)
[0m18:31:21.429390 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m18:31:21.429776 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m18:31:21.430113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.431806 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:31:21.432180 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m18:31:21.432516 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:31:21.437324 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:31:21.439320 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m18:31:21.440098 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m18:31:21.440458 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m18:31:21.443015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AA462D0>]}
[0m18:31:21.443621 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:21.443950 [debug] [MainThread]: On master: BEGIN
[0m18:31:21.444237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:21.444860 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:31:21.445185 [debug] [MainThread]: On master: COMMIT
[0m18:31:21.445476 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:21.445747 [debug] [MainThread]: On master: COMMIT
[0m18:31:21.446242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:31:21.446595 [debug] [MainThread]: On master: Close
[0m18:31:21.450134 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m18:31:21.450752 [info ] [Thread-1 (]: 1 of 29 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m18:31:21.451884 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m18:31:21.452397 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m18:31:21.461207 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.464427 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m18:31:21.505552 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.508334 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.508901 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m18:31:21.509306 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:21.510121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.510547 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.510934 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m18:31:21.512084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.519957 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.520554 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m18:31:21.521941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.525826 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.526331 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m18:31:21.527188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:21.542724 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m18:31:21.543298 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.543729 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m18:31:21.548593 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:21.554569 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:31:21.555122 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m18:31:21.558287 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.561304 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m18:31:21.564796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE64B50>]}
[0m18:31:21.565677 [info ] [Thread-1 (]: 1 of 29 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.11s]
[0m18:31:21.567421 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m18:31:21.567970 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m18:31:21.568803 [info ] [Thread-1 (]: 2 of 29 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m18:31:21.569886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m18:31:21.570537 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m18:31:21.574011 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.575671 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m18:31:21.579252 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.581019 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.581642 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m18:31:21.582049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.582862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.583333 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.583808 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m18:31:21.585622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.589883 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.590445 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m18:31:21.591326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:21.595101 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.595660 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m18:31:21.596526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:21.598103 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m18:31:21.598577 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.598976 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m18:31:21.602246 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.604959 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:31:21.605450 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m18:31:21.608722 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.610925 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m18:31:21.612062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AEFA670>]}
[0m18:31:21.613063 [info ] [Thread-1 (]: 2 of 29 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.04s]
[0m18:31:21.614528 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m18:31:21.615137 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m18:31:21.615831 [info ] [Thread-1 (]: 3 of 29 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m18:31:21.616850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m18:31:21.617424 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m18:31:21.621401 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.623471 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m18:31:21.628603 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.630388 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.631029 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m18:31:21.631553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.632477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.633023 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.633537 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m18:31:21.634856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.642121 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.642779 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m18:31:21.643888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.648347 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.649000 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m18:31:21.650112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.652489 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m18:31:21.653547 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.654402 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m18:31:21.658237 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.666527 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:31:21.667264 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m18:31:21.670814 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.673336 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m18:31:21.674220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1ACE6BD0>]}
[0m18:31:21.675140 [info ] [Thread-1 (]: 3 of 29 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.06s]
[0m18:31:21.676462 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m18:31:21.677035 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m18:31:21.677961 [info ] [Thread-1 (]: 4 of 29 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m18:31:21.679213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m18:31:21.679816 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m18:31:21.683465 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.685126 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m18:31:21.758191 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.760162 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.760785 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m18:31:21.761301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.762273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.762801 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.763327 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m18:31:21.764683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.769568 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.770238 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m18:31:21.771316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:21.775137 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.775736 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m18:31:21.776717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:21.778656 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m18:31:21.779243 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.779890 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m18:31:21.783663 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.787457 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:31:21.788123 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m18:31:21.791690 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.793948 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m18:31:21.794750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A62AC10>]}
[0m18:31:21.795670 [info ] [Thread-1 (]: 4 of 29 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.12s]
[0m18:31:21.797742 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m18:31:21.798445 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:31:21.799260 [info ] [Thread-1 (]: 5 of 29 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m18:31:21.800546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m18:31:21.801137 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:31:21.805274 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.807310 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:31:21.812519 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.814181 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.814827 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m18:31:21.815367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.816329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.816881 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.817419 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m18:31:21.819113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.823390 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.824125 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m18:31:21.825278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.830537 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.831203 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.832351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.834430 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m18:31:21.835166 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.835793 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m18:31:21.839789 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.843930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:31:21.844684 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m18:31:21.848737 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.850892 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m18:31:21.851770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1947DFD0>]}
[0m18:31:21.852864 [info ] [Thread-1 (]: 5 of 29 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.05s]
[0m18:31:21.854506 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:31:21.855287 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:31:21.856030 [info ] [Thread-1 (]: 6 of 29 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m18:31:21.857157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m18:31:21.857859 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:31:21.861575 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.863477 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:31:21.867699 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.869733 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.870420 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m18:31:21.870957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.871903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.872443 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.873107 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m18:31:21.875294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.883522 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.884684 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m18:31:21.887982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.895117 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.896146 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.897723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.900764 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m18:31:21.901801 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.902517 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m18:31:21.906704 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.909931 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:31:21.910531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m18:31:21.914027 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.916339 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m18:31:21.917180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5F9610>]}
[0m18:31:21.918150 [info ] [Thread-1 (]: 6 of 29 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.06s]
[0m18:31:21.920719 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:31:21.921683 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m18:31:21.922438 [info ] [Thread-1 (]: 7 of 29 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m18:31:21.923550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m18:31:21.924113 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m18:31:21.928391 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.930342 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m18:31:21.934565 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.937442 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.938225 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m18:31:21.938755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.939672 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.940229 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.940737 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m18:31:21.942140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.946369 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.946982 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m18:31:21.947994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:21.953494 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.954161 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m18:31:21.955203 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:21.957205 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m18:31:21.957811 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.958358 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m18:31:21.961996 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.965187 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:31:21.966019 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m18:31:21.969838 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:21.972006 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m18:31:21.972804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5F8D70>]}
[0m18:31:21.973772 [info ] [Thread-1 (]: 7 of 29 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.05s]
[0m18:31:21.975328 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m18:31:21.976038 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:31:21.976993 [info ] [Thread-1 (]: 8 of 29 START sql view model staging.model_stg_support_ticket_status_logs ...... [RUN]
[0m18:31:21.978665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_ticket_status_logs)
[0m18:31:21.979485 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:31:21.984169 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:31:21.986299 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:31:21.992425 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:31:21.994209 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:31:21.995037 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: BEGIN
[0m18:31:21.995615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.996536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:21.997100 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:31:21.997732 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_ticket_status_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_ticket_status_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_ticket_status_logs"
)

select *
from source_data
  );

[0m18:31:21.999085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.003354 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:31:22.004141 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_ticket_status_logs"} */
alter view "ae_exam_db"."staging"."model_stg_support_ticket_status_logs__dbt_tmp" rename to "model_stg_support_ticket_status_logs"
[0m18:31:22.005326 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.007286 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: COMMIT
[0m18:31:22.007888 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:31:22.008400 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: COMMIT
[0m18:31:22.011972 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.017132 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:31:22.018064 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_ticket_status_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_ticket_status_logs__dbt_backup" cascade
[0m18:31:22.019679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.022153 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: Close
[0m18:31:22.023038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5BDFD0>]}
[0m18:31:22.023995 [info ] [Thread-1 (]: 8 of 29 OK created sql view model staging.model_stg_support_ticket_status_logs . [[32mOK[0m in 0.04s]
[0m18:31:22.025649 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:31:22.026622 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m18:31:22.027819 [info ] [Thread-1 (]: 9 of 29 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m18:31:22.029415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_ticket_status_logs, now model.ae_exam_project.model_stg_support_tickets)
[0m18:31:22.030701 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m18:31:22.037820 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.040138 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m18:31:22.046749 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.048468 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.049142 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m18:31:22.049705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.050720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.051328 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.052466 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m18:31:22.054324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.058583 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.059287 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m18:31:22.060898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.065858 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.066581 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m18:31:22.067825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.070217 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m18:31:22.070955 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.071537 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m18:31:22.075487 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.079661 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:31:22.080324 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m18:31:22.083736 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.087165 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m18:31:22.088681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5F8710>]}
[0m18:31:22.090220 [info ] [Thread-1 (]: 9 of 29 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.06s]
[0m18:31:22.091781 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m18:31:22.092499 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m18:31:22.093490 [info ] [Thread-1 (]: 10 of 29 START sql view model intermediate.model_int_driver_profile_active ..... [RUN]
[0m18:31:22.094844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m18:31:22.095596 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m18:31:22.099470 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.102712 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m18:31:22.110087 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.113127 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.113844 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m18:31:22.114387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.115338 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.115902 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.116540 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m18:31:22.119096 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:31:22.128245 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.129324 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m18:31:22.130510 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.134594 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.135490 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m18:31:22.137470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.141377 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m18:31:22.142476 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.143422 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m18:31:22.147922 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:22.151211 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:31:22.152131 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m18:31:22.156264 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.158512 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m18:31:22.159343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5CAD0>]}
[0m18:31:22.160297 [info ] [Thread-1 (]: 10 of 29 OK created sql view model intermediate.model_int_driver_profile_active  [[32mOK[0m in 0.06s]
[0m18:31:22.161641 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m18:31:22.162309 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:31:22.163013 [info ] [Thread-1 (]: 11 of 29 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m18:31:22.164074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m18:31:22.164657 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:31:22.176953 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.179515 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:31:22.186769 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.189094 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.190127 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m18:31:22.190749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.191763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.192356 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.192995 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m18:31:22.197019 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.202287 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.203087 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m18:31:22.204419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.208769 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.209715 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m18:31:22.211407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.213966 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m18:31:22.214624 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.215141 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m18:31:22.221249 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:22.224796 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:31:22.225453 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m18:31:22.229076 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.231836 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m18:31:22.232855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5BCB90>]}
[0m18:31:22.234022 [info ] [Thread-1 (]: 11 of 29 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.07s]
[0m18:31:22.236037 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:31:22.236857 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m18:31:22.237892 [info ] [Thread-1 (]: 12 of 29 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m18:31:22.239299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m18:31:22.240224 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m18:31:22.247378 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.249242 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m18:31:22.256843 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.259611 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.260364 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m18:31:22.260968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.262517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.263774 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.264634 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m18:31:22.269083 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.276924 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.278359 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m18:31:22.280234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.288013 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.289329 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m18:31:22.291532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.294674 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m18:31:22.295497 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.296112 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m18:31:22.300085 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.304389 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:31:22.305163 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m18:31:22.308956 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.311398 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m18:31:22.312326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5FB5F0>]}
[0m18:31:22.313399 [info ] [Thread-1 (]: 12 of 29 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.07s]
[0m18:31:22.315261 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m18:31:22.316376 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m18:31:22.317515 [info ] [Thread-1 (]: 13 of 29 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m18:31:22.319013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m18:31:22.320049 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m18:31:22.325719 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.327512 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m18:31:22.332949 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.336105 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.336916 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m18:31:22.337523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.338557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.339171 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.340097 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, 
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m18:31:22.344660 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:22.349458 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.350217 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m18:31:22.351914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.359582 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.360680 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m18:31:22.362597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.366261 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m18:31:22.367376 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.368409 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m18:31:22.372555 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.377815 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:31:22.378513 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m18:31:22.382157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.384746 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m18:31:22.386791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5F98B0>]}
[0m18:31:22.388067 [info ] [Thread-1 (]: 13 of 29 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.07s]
[0m18:31:22.389772 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m18:31:22.390494 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m18:31:22.391496 [info ] [Thread-1 (]: 14 of 29 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m18:31:22.392837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m18:31:22.393914 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m18:31:22.402357 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.405539 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m18:31:22.414261 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.417665 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.419865 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m18:31:22.420946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.422561 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:31:22.423610 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.424555 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
    select
        ot.order_id,
        ot.driver_id,
        ot.delivery_zone,
        ot.order_datetime,
        ot.pickup_datetime,
        ot.delivery_datetime,
        ot.is_late_delivery,

        case when ot.order_status = 'completed' then 1 else 0 end as is_completed,
        case when ot.order_status != 'completed' then 1 else 0 end as is_failed,

        extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
        extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
        extract(epoch from ot.delivery_datetime - ot.order_datetime) / 60.0 as delivery_duration_mins,

        case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,

        st.csat_score,
        st.ticket_id,

        ld.bonus_amount,
        ld.delivery_target,
        ld.actual_deliveries,
        ld.incentive_program,
        ld.applied_date,
        ld.bonus_qualified,
        case when ld.bonus_qualified = true then 1 else 0 end as bonus_qualified_sessions,
        ld.region as region_log,
        ld.log_id

    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_support_tickets" st
        on ot.order_id = st.order_id

    left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld
        on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m18:31:22.429432 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:22.434498 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.435750 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary" rename to "model_int_order_delivery_summary__dbt_backup"
[0m18:31:22.437306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.442184 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.442945 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m18:31:22.444511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.447217 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m18:31:22.448075 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.448754 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m18:31:22.452871 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.457690 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:31:22.458486 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m18:31:22.462296 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.465010 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m18:31:22.465989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5FA570>]}
[0m18:31:22.467080 [info ] [Thread-1 (]: 14 of 29 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.07s]
[0m18:31:22.468948 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m18:31:22.470320 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:31:22.471742 [info ] [Thread-1 (]: 15 of 29 START sql view model intermediate.model_int_ticket_resolution_summary . [RUN]
[0m18:31:22.473592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_int_ticket_resolution_summary)
[0m18:31:22.474842 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:31:22.481833 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:31:22.484505 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:31:22.491058 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:31:22.493714 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:31:22.495072 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: BEGIN
[0m18:31:22.496463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.497709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.498394 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:31:22.499033 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_ticket_resolution_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary__dbt_tmp" as (
    select
  ticket_id,
  issue_type,
  opened_datetime,
  resolved_datetime,
  extract(epoch from resolved_datetime - opened_datetime) / 60.0 as resolution_duration_mins,
  case when status = 'resolved' then 1 else 0 end as is_resolved,
  status,
  compensation_amount,
from "ae_exam_db"."staging"."model_stg_support_tickets"
  );

[0m18:31:22.501066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.507073 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:31:22.507891 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_ticket_resolution_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary__dbt_tmp" rename to "model_int_ticket_resolution_summary"
[0m18:31:22.509095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.512489 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: COMMIT
[0m18:31:22.513970 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:31:22.515144 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: COMMIT
[0m18:31:22.519260 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.523466 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:31:22.524205 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_ticket_resolution_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary__dbt_backup" cascade
[0m18:31:22.525339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:22.527776 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: Close
[0m18:31:22.528708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5F7D0>]}
[0m18:31:22.529741 [info ] [Thread-1 (]: 15 of 29 OK created sql view model intermediate.model_int_ticket_resolution_summary  [[32mOK[0m in 0.06s]
[0m18:31:22.531106 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:31:22.531797 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m18:31:22.532933 [info ] [Thread-1 (]: 16 of 29 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m18:31:22.534118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_ticket_resolution_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m18:31:22.535121 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m18:31:22.540249 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.544146 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m18:31:22.585780 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.590079 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.590884 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m18:31:22.591478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.592521 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.593127 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.593774 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m18:31:22.690320 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m18:31:22.695497 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.696336 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m18:31:22.698495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.704533 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.705368 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m18:31:22.706758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.716407 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m18:31:22.717298 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.717942 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m18:31:22.728949 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:31:22.733220 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:31:22.734407 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m18:31:22.738900 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:22.741641 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m18:31:22.742687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5F2F0>]}
[0m18:31:22.743782 [info ] [Thread-1 (]: 16 of 29 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.21s]
[0m18:31:22.745805 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m18:31:22.747022 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m18:31:22.748402 [info ] [Thread-1 (]: 17 of 29 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m18:31:22.749715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m18:31:22.750823 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m18:31:22.758769 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:22.762594 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m18:31:22.769932 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:22.773095 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:22.774089 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m18:31:22.774785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:22.776439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:22.777383 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:22.778927 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m18:31:23.215013 [debug] [Thread-1 (]: SQL status: OK in 0.434 seconds
[0m18:31:23.221602 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:23.222475 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m18:31:23.224130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.228779 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:23.229488 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m18:31:23.230733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.233376 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m18:31:23.234602 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:23.235710 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m18:31:23.246659 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:31:23.257532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:31:23.258812 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m18:31:23.263005 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:23.265796 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m18:31:23.266885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A6112B0>]}
[0m18:31:23.268037 [info ] [Thread-1 (]: 17 of 29 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.52s]
[0m18:31:23.270906 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m18:31:23.272031 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m18:31:23.273313 [info ] [Thread-1 (]: 18 of 29 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m18:31:23.274935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m18:31:23.275821 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m18:31:23.282823 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.284964 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m18:31:23.292078 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.294118 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.294824 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m18:31:23.295409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:23.296575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.297275 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.298130 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m18:31:23.896876 [debug] [Thread-1 (]: SQL status: OK in 0.598 seconds
[0m18:31:23.901665 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.902453 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m18:31:23.903832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.908814 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.909491 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m18:31:23.910641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.912965 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m18:31:23.913591 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.914110 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m18:31:23.919618 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:23.923911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:31:23.924659 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m18:31:23.928431 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:23.930927 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m18:31:23.931888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A963FB0>]}
[0m18:31:23.932908 [info ] [Thread-1 (]: 18 of 29 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.66s]
[0m18:31:23.934351 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m18:31:23.935587 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:31:23.936746 [info ] [Thread-1 (]: 19 of 29 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m18:31:23.937797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m18:31:23.938631 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:31:23.944690 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.947048 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:31:23.953252 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.955674 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.956389 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m18:31:23.956985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:23.958091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.958715 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.959313 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m18:31:23.963613 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:23.969930 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.971222 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates" rename to "model_int_zone_delivery_aggregates__dbt_backup"
[0m18:31:23.972888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.977635 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.978324 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m18:31:23.979578 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:23.982042 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m18:31:23.982751 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.983317 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m18:31:23.988170 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:23.993452 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:31:23.994333 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m18:31:23.998693 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:24.001508 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m18:31:24.002755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A5BEA50>]}
[0m18:31:24.003991 [info ] [Thread-1 (]: 19 of 29 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.06s]
[0m18:31:24.005366 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:31:24.006072 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:31:24.006961 [info ] [Thread-1 (]: 20 of 29 START sql table model mart.model_mart_driver_incentive_impact ......... [RUN]
[0m18:31:24.007919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_incentive_impact)
[0m18:31:24.008518 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:31:24.013605 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.015958 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:31:24.022877 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.025984 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.026739 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: BEGIN
[0m18:31:24.027321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:24.028371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:24.028943 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.029546 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp"
  
    as (
      


select
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log,
    count(ods.log_id) as total_sessions,
    sum(ods.actual_deliveries) as total_deliveries,
    sum(ods.bonus_qualified_sessions) as total_bonus_qualified_sessions,
    round(sum(case when ods.bonus_qualified = true then ods.bonus_amount else 0 end),2) as total_bonus_earned,
    round(avg(ods.csat_score), 2) as avg_feedback_score,
    round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
where ods.is_completed = 1 and ods.incentive_program is not null
group by
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log
    );
  
  
[0m18:31:24.115921 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m18:31:24.120843 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.121564 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
alter table "ae_exam_db"."mart"."model_mart_driver_incentive_impact" rename to "model_mart_driver_incentive_impact__dbt_backup"
[0m18:31:24.123058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:24.128683 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.129345 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
alter table "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp" rename to "model_mart_driver_incentive_impact"
[0m18:31:24.130438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:24.132519 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m18:31:24.133119 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.133634 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m18:31:24.139308 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:24.142839 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:31:24.143586 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_backup" cascade
[0m18:31:24.147390 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:24.149669 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: Close
[0m18:31:24.150576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5EF90>]}
[0m18:31:24.151603 [info ] [Thread-1 (]: 20 of 29 OK created sql table model mart.model_mart_driver_incentive_impact .... [[32mOK[0m in 0.14s]
[0m18:31:24.153134 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:31:24.153742 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m18:31:24.154459 [info ] [Thread-1 (]: 21 of 29 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m18:31:24.155470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_incentive_impact, now model.ae_exam_project.model_mart_driver_performance)
[0m18:31:24.156041 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m18:31:24.161424 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.163052 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m18:31:24.167678 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.169359 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.169991 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m18:31:24.170478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:24.171402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:24.171961 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.172697 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    round(avg(ods.csat_score),2) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m18:31:24.283450 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m18:31:24.287519 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.288106 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance" rename to "model_mart_driver_performance__dbt_backup"
[0m18:31:24.289113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:24.293302 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.293860 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m18:31:24.294812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:24.296864 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m18:31:24.297425 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.297950 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m18:31:24.305649 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:31:24.308647 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:31:24.309197 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m18:31:24.312730 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:24.314918 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m18:31:24.315697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5CDD0>]}
[0m18:31:24.316555 [info ] [Thread-1 (]: 21 of 29 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.16s]
[0m18:31:24.317706 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m18:31:24.318510 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:31:24.319184 [info ] [Thread-1 (]: 22 of 29 START sql table model mart.model_mart_driver_zone_heatmap ............. [RUN]
[0m18:31:24.320296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.model_mart_driver_zone_heatmap)
[0m18:31:24.320811 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:31:24.325405 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.326946 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:31:24.331843 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.333610 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.334207 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: BEGIN
[0m18:31:24.334960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:24.336396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:24.337388 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.338028 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp"
  
    as (
      

with failed_requests_unavailable_driver as (
    select  
        delivery_zone,
        count(*) as total_cancel_or_failed_requests
    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_drivers_master" dm 
      on ot.driver_id = dm.driver_id
    where ot.order_status in ('cancelled', 'failed')
      and (ot.driver_id is null or dm.active_status = 'inactive')
    group by delivery_zone
),

aggregates as (
    select
        ods.delivery_zone,
        count(ods.order_id) as total_requests,
        sum(ods.is_completed) as completed_requests,
        round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
        dsd.available_drivers,
        coalesce(rud.total_cancel_or_failed_requests, 0) as failed_requests
    from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
    left join (
        select region as delivery_zone, count(driver_id) as available_drivers
        from "ae_exam_db"."intermediate"."model_int_driver_profile_active"
        group by region
    ) dsd on ods.delivery_zone = dsd.delivery_zone
    left join failed_requests_unavailable_driver rud  
      on ods.delivery_zone = rud.delivery_zone
    group by 
        ods.delivery_zone,
        dsd.available_drivers,
        rud.total_cancel_or_failed_requests
)

select 
    delivery_zone,
    total_requests,
    completed_requests,
    failed_requests,
    avg_delivery_time_mins,
    available_drivers,
    case 
        when total_requests > 0 
        then round((completed_requests::numeric / total_requests) * 100, 2) 
        else 0 
    end as completion_rate,
    case 
        when available_drivers > 0 
        then round((total_requests::numeric / available_drivers) * 100, 2) 
        else 0 
    end as demand_supply_rate
from aggregates
    );
  
  
[0m18:31:24.429080 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m18:31:24.432553 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.433081 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap" rename to "model_mart_driver_zone_heatmap__dbt_backup"
[0m18:31:24.434037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:24.437512 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.438054 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp" rename to "model_mart_driver_zone_heatmap"
[0m18:31:24.438969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:24.440711 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m18:31:24.441191 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.441606 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m18:31:24.445970 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:24.449261 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:31:24.449767 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_backup" cascade
[0m18:31:24.453273 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:24.455249 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: Close
[0m18:31:24.455988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5FD70>]}
[0m18:31:25.718659 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m18:31:25.719744 [info ] [Thread-1 (]: 22 of 29 OK created sql table model mart.model_mart_driver_zone_heatmap ........ [[32mOK[0m in 0.14s]
[0m18:31:25.720842 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:31:25.721516 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_complaint_summary
[0m18:31:25.722282 [info ] [Thread-1 (]: 23 of 29 START sql table model mart.model_mart_complaint_summary ............... [RUN]
[0m18:31:25.723288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_zone_heatmap, now model.ae_exam_project.model_mart_complaint_summary)
[0m18:31:25.723817 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_complaint_summary
[0m18:31:25.727468 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_complaint_summary"
[0m18:31:25.729382 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_complaint_summary
[0m18:31:25.732971 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_complaint_summary"
[0m18:31:25.734589 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_complaint_summary"
[0m18:31:25.735149 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: BEGIN
[0m18:31:25.735477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:25.736302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:25.736630 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_complaint_summary"
[0m18:31:25.736925 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_complaint_summary"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_complaint_summary__dbt_tmp"
  
    as (
      

select
  ticket_type,
  date_trunc('day',opened_datetime) as complaint_date,
  count(distinct ticket_id) as total_complaints,
  sum(compensation_amount) as total_compensation,
  avg(resolution_duration_mins) as avg_resolution_time,
  sum(is_resolved) as total_resolved,
from "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary"
group by 1, 2
    );
  
  
[0m18:31:25.742791 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_complaint_summary"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_complaint_summary__dbt_tmp"
  
    as (
      

select
  ticket_type,
  date_trunc('day',opened_datetime) as complaint_date,
  count(distinct ticket_id) as total_complaints,
  sum(compensation_amount) as total_compensation,
  avg(resolution_duration_mins) as avg_resolution_time,
  sum(is_resolved) as total_resolved,
from "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary"
group by 1, 2
    );
  
  
[0m18:31:25.743270 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:31:25.743698 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: ROLLBACK
[0m18:31:25.761424 [debug] [Thread-1 (]: Failed to rollback 'model.ae_exam_project.model_mart_complaint_summary'
[0m18:31:25.761871 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: Close
[0m18:31:25.765701 [debug] [Thread-1 (]: Runtime Error in model model_mart_complaint_summary (models\mart\service\model_mart_complaint_summary.sql)
  Binder Error: Referenced column "ticket_type" not found in FROM clause!
  Candidate bindings: "ticket_id", "issue_type", "opened_datetime", "resolved_datetime", "status"
  
  LINE 14:   ticket_type,
             ^
[0m18:31:25.766182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AF280B0>]}
[0m18:31:25.766777 [error] [Thread-1 (]: 23 of 29 ERROR creating sql table model mart.model_mart_complaint_summary ...... [[31mERROR[0m in 0.04s]
[0m18:31:25.767985 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_complaint_summary
[0m18:31:25.768425 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m18:31:25.769058 [debug] [Thread-4 (]: Marking all children of 'model.ae_exam_project.model_mart_complaint_summary' to be skipped because of status 'error'.  Reason: Runtime Error in model model_mart_complaint_summary (models\mart\service\model_mart_complaint_summary.sql)
  Binder Error: Referenced column "ticket_type" not found in FROM clause!
  Candidate bindings: "ticket_id", "issue_type", "opened_datetime", "resolved_datetime", "status"
  
  LINE 14:   ticket_type,
             ^.
[0m18:31:25.769708 [info ] [Thread-1 (]: 24 of 29 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m18:31:25.771932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_complaint_summary, now model.ae_exam_project.report_campaign_effectiveness)
[0m18:31:25.772490 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m18:31:25.774932 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.776867 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m18:31:25.779381 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.781005 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.781367 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m18:31:25.781669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:25.782246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:25.782565 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.782846 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m18:31:25.789805 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:31:25.792870 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.793266 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m18:31:25.793992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.796539 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.796929 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m18:31:25.797652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.798939 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m18:31:25.799282 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.799573 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m18:31:25.805200 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:25.807645 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:31:25.808149 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m18:31:25.811360 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:25.813037 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m18:31:25.813593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5F470>]}
[0m18:31:25.814153 [info ] [Thread-1 (]: 24 of 29 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.04s]
[0m18:31:25.815049 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m18:31:25.815404 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m18:31:25.815804 [info ] [Thread-1 (]: 25 of 29 START sql table model report.report_customer _acquisition ............. [RUN]
[0m18:31:25.816428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m18:31:25.816771 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m18:31:25.823251 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.824348 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m18:31:25.826979 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.828280 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.829001 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m18:31:25.829486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:25.830116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:25.830454 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.830758 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m18:31:25.837370 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:31:25.840185 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.840624 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m18:31:25.841383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.844718 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.845258 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m18:31:25.846399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:25.847851 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m18:31:25.848243 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.848616 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m18:31:25.854428 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:25.856674 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:31:25.857136 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m18:31:25.860488 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:25.862414 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m18:31:25.863020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AF289B0>]}
[0m18:31:25.863750 [info ] [Thread-1 (]: 25 of 29 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.05s]
[0m18:31:25.864818 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m18:31:25.865320 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m18:31:25.865792 [info ] [Thread-1 (]: 26 of 29 START sql table model report.report_retargeting_performance ........... [RUN]
[0m18:31:25.866500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m18:31:25.866892 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m18:31:25.871184 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.872659 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m18:31:25.875503 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.876463 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.876960 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m18:31:25.877333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:25.878162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:25.878887 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.879547 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m18:31:25.882149 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:31:25.885579 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.886067 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m18:31:25.886923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.890141 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.890577 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m18:31:25.891374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.893012 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m18:31:25.893511 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.894002 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m18:31:25.898224 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:25.900507 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:31:25.900981 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m18:31:25.904512 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:25.906473 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m18:31:25.907126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1AE5F6B0>]}
[0m18:31:25.907780 [info ] [Thread-1 (]: 26 of 29 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.04s]
[0m18:31:25.908751 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m18:31:25.909174 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_incentive_impact
[0m18:31:25.910053 [info ] [Thread-1 (]: 27 of 29 START sql table model report.report_driver_incentive_impact ........... [RUN]
[0m18:31:25.910879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_incentive_impact)
[0m18:31:25.911364 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_incentive_impact
[0m18:31:25.914384 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.915774 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_incentive_impact
[0m18:31:25.920070 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.921284 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.921736 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: BEGIN
[0m18:31:25.922077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:25.922881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:25.923427 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.924004 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_incentive_impact"
--order by interaction_date asc
    );
  
  
[0m18:31:25.926287 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:31:25.929563 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.930024 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
alter table "ae_exam_db"."report"."report_driver_incentive_impact" rename to "report_driver_incentive_impact__dbt_backup"
[0m18:31:25.930811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.933431 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.933871 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
alter table "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp" rename to "report_driver_incentive_impact"
[0m18:31:25.934709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.936203 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m18:31:25.936644 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.936993 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m18:31:25.940940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:25.943628 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:31:25.944031 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."report"."report_driver_incentive_impact__dbt_backup" cascade
[0m18:31:25.947512 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:25.949126 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: Close
[0m18:31:25.949676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A6100B0>]}
[0m18:31:25.950281 [info ] [Thread-1 (]: 27 of 29 OK created sql table model report.report_driver_incentive_impact ...... [[32mOK[0m in 0.04s]
[0m18:31:25.951356 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_incentive_impact
[0m18:31:25.951871 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m18:31:25.952379 [info ] [Thread-1 (]: 28 of 29 START sql table model report.report_driver_perfornance ................ [RUN]
[0m18:31:25.953111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_incentive_impact, now model.ae_exam_project.report_driver_perfornance)
[0m18:31:25.953532 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m18:31:25.956276 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.957944 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m18:31:25.961834 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.963117 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.963658 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m18:31:25.964035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:25.964710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:25.965077 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.965424 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m18:31:25.971195 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:25.974577 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.975046 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance" rename to "report_driver_perfornance__dbt_backup"
[0m18:31:25.975872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.978727 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.979178 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m18:31:25.979974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:25.981442 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m18:31:25.981844 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.982201 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m18:31:25.987771 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:31:25.990506 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:31:25.990980 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m18:31:25.994338 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:25.996015 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m18:31:25.996614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E194D9850>]}
[0m18:31:25.997279 [info ] [Thread-1 (]: 28 of 29 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.04s]
[0m18:31:25.998150 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m18:31:25.998566 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_zone_heatmap
[0m18:31:25.999059 [info ] [Thread-1 (]: 29 of 29 START sql table model report.report_driver_zone_heatmap ............... [RUN]
[0m18:31:25.999927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_perfornance, now model.ae_exam_project.report_driver_zone_heatmap)
[0m18:31:26.000427 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_zone_heatmap
[0m18:31:26.005512 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.007541 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_zone_heatmap
[0m18:31:26.010664 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.012165 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.012617 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: BEGIN
[0m18:31:26.012991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:26.013698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:26.014094 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.014440 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_zone_heatmap"
order by delivery_zone asc
    );
  
  
[0m18:31:26.015976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:26.019923 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.020450 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap" rename to "report_driver_zone_heatmap__dbt_backup"
[0m18:31:26.021318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:31:26.024488 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.025024 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp" rename to "report_driver_zone_heatmap"
[0m18:31:26.026053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:31:26.027649 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m18:31:26.028203 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.028579 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m18:31:26.033378 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:31:26.036585 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:31:26.037140 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_backup" cascade
[0m18:31:26.040929 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:31:26.042555 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: Close
[0m18:31:26.043168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f527ad-a041-4a70-93f9-447e96a85cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A6100B0>]}
[0m18:31:26.043842 [info ] [Thread-1 (]: 29 of 29 OK created sql table model report.report_driver_zone_heatmap .......... [[32mOK[0m in 0.04s]
[0m18:31:26.045714 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_zone_heatmap
[0m18:31:26.047629 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:26.048049 [debug] [MainThread]: On master: BEGIN
[0m18:31:26.048352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:26.048979 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:31:26.049305 [debug] [MainThread]: On master: COMMIT
[0m18:31:26.049609 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:26.049875 [debug] [MainThread]: On master: COMMIT
[0m18:31:26.050336 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:31:26.050699 [debug] [MainThread]: On master: Close
[0m18:31:26.051272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:26.051757 [debug] [MainThread]: Connection 'create_ae_exam_db_intermediate' was properly closed.
[0m18:31:26.052196 [debug] [MainThread]: Connection 'list_ae_exam_db_intermediate' was properly closed.
[0m18:31:26.052649 [debug] [MainThread]: Connection 'model.ae_exam_project.report_driver_zone_heatmap' was properly closed.
[0m18:31:26.053293 [info ] [MainThread]: 
[0m18:31:26.054015 [info ] [MainThread]: Finished running 13 table models, 16 view models in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m18:31:26.059452 [debug] [MainThread]: Command end result
[0m18:31:26.091355 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m18:31:26.094370 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m18:31:26.104439 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m18:31:26.104926 [info ] [MainThread]: 
[0m18:31:26.105614 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:31:26.106315 [info ] [MainThread]: 
[0m18:31:26.106999 [error] [MainThread]:   Runtime Error in model model_mart_complaint_summary (models\mart\service\model_mart_complaint_summary.sql)
  Binder Error: Referenced column "ticket_type" not found in FROM clause!
  Candidate bindings: "ticket_id", "issue_type", "opened_datetime", "resolved_datetime", "status"
  
  LINE 14:   ticket_type,
             ^
[0m18:31:26.107690 [info ] [MainThread]: 
[0m18:31:26.108395 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=0 TOTAL=29
[0m18:31:26.109550 [debug] [MainThread]: Command `dbt run` failed at 18:31:26.109390 after 6.08 seconds
[0m18:31:26.109986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A610290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E16E2F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1A9042F0>]}
[0m18:31:26.110399 [debug] [MainThread]: Flushing usage events
[0m18:31:27.075000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:24.907408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5241A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A533A7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A53597ED0>]}


============================== 18:35:24.911326 | 27697d52-7847-45ac-8e7d-0ef2dca25b0b ==============================
[0m18:35:24.911326 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:35:24.913227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Jiraporn(Aom)Chattur\\.dbt', 'log_path': 'C:\\Users\\Jiraporn(Aom)Chattur\\Desktop\\Jira\\ae-exam-main\\ae_exam_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:35:25.077952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A52AD10F0>]}
[0m18:35:25.132222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A53453AC0>]}
[0m18:35:25.135211 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:35:25.280912 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:35:25.389616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:25.389958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:25.390730 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.ae_exam_project.model_mart_retargeting _performance`
[0m18:35:25.391463 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 2 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m18:35:25.392212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5366B950>]}
[0m18:35:25.426350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54A2AC60>]}
[0m18:35:25.488711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m18:35:25.491502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m18:35:25.519940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54C91010>]}
[0m18:35:25.520483 [info ] [MainThread]: Found 30 models, 11 sources, 429 macros
[0m18:35:25.521075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54C48050>]}
[0m18:35:25.523443 [info ] [MainThread]: 
[0m18:35:25.524011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:25.524503 [info ] [MainThread]: 
[0m18:35:25.525233 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:35:25.530815 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db'
[0m18:35:25.590089 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:35:25.590639 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:35:25.591286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:25.615761 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:35:25.616958 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:35:25.618602 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:35:25.618865 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:35:25.619098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.619860 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.620840 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:35:25.622554 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:35:25.622821 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:35:25.623036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.623844 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.625079 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:35:25.627036 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db"
[0m18:35:25.627393 [debug] [ThreadPool]: On list_ae_exam_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"ae_exam_db"'
    
  
  
[0m18:35:25.627674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.628505 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.629412 [debug] [ThreadPool]: On list_ae_exam_db: Close
[0m18:35:25.630113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db, now create_ae_exam_db_intermediate)
[0m18:35:25.630482 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "intermediate"
"
[0m18:35:25.635499 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:35:25.635804 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:35:25.636035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.637019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.638099 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:35:25.638345 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: BEGIN
[0m18:35:25.638741 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.638983 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:35:25.639189 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_intermediate"} */

    
    
        create schema if not exists "ae_exam_db"."intermediate"
    
[0m18:35:25.639605 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.640267 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m18:35:25.640515 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_intermediate"
[0m18:35:25.640752 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: COMMIT
[0m18:35:25.641301 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.641574 [debug] [ThreadPool]: On create_ae_exam_db_intermediate: Close
[0m18:35:25.642103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_intermediate, now create_ae_exam_db_staging)
[0m18:35:25.642436 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "staging"
"
[0m18:35:25.643673 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:35:25.643947 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:35:25.644224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.644968 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.645927 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:35:25.646158 [debug] [ThreadPool]: On create_ae_exam_db_staging: BEGIN
[0m18:35:25.646527 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.646754 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:35:25.646949 [debug] [ThreadPool]: On create_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_staging"} */

    
    
        create schema if not exists "ae_exam_db"."staging"
    
[0m18:35:25.647410 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.648061 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m18:35:25.648285 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_staging"
[0m18:35:25.648478 [debug] [ThreadPool]: On create_ae_exam_db_staging: COMMIT
[0m18:35:25.648815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.649051 [debug] [ThreadPool]: On create_ae_exam_db_staging: Close
[0m18:35:25.649449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_staging, now create_ae_exam_db_mart)
[0m18:35:25.649753 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "mart"
"
[0m18:35:25.651250 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:35:25.651613 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:35:25.651948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.652857 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.654819 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:35:25.655258 [debug] [ThreadPool]: On create_ae_exam_db_mart: BEGIN
[0m18:35:25.655877 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.656201 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:35:25.656508 [debug] [ThreadPool]: On create_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_mart"} */

    
    
        create schema if not exists "ae_exam_db"."mart"
    
[0m18:35:25.657187 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.658744 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m18:35:25.659235 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_mart"
[0m18:35:25.659488 [debug] [ThreadPool]: On create_ae_exam_db_mart: COMMIT
[0m18:35:25.659955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.660195 [debug] [ThreadPool]: On create_ae_exam_db_mart: Close
[0m18:35:25.660686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ae_exam_db_mart, now create_ae_exam_db_report)
[0m18:35:25.661144 [debug] [ThreadPool]: Creating schema "database: "ae_exam_db"
schema: "report"
"
[0m18:35:25.662514 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:35:25.662795 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
        select type from duckdb_databases()
        where lower(database_name)='ae_exam_db'
        and type='sqlite'
    
  
[0m18:35:25.663053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.663908 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.665018 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:35:25.665451 [debug] [ThreadPool]: On create_ae_exam_db_report: BEGIN
[0m18:35:25.665911 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.666172 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:35:25.666494 [debug] [ThreadPool]: On create_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "create_ae_exam_db_report"} */

    
    
        create schema if not exists "ae_exam_db"."report"
    
[0m18:35:25.667126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.668950 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m18:35:25.669744 [debug] [ThreadPool]: Using duckdb connection "create_ae_exam_db_report"
[0m18:35:25.670186 [debug] [ThreadPool]: On create_ae_exam_db_report: COMMIT
[0m18:35:25.670691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:35:25.670983 [debug] [ThreadPool]: On create_ae_exam_db_report: Close
[0m18:35:25.676766 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ae_exam_db_intermediate'
[0m18:35:25.681226 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m18:35:25.681554 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: BEGIN
[0m18:35:25.681773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:25.682412 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.682675 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_intermediate"
[0m18:35:25.682902 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_intermediate"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:35:25.694793 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:35:25.696481 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: ROLLBACK
[0m18:35:25.697574 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_intermediate'
[0m18:35:25.697833 [debug] [ThreadPool]: On list_ae_exam_db_intermediate: Close
[0m18:35:25.698258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_intermediate, now list_ae_exam_db_staging)
[0m18:35:25.699549 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m18:35:25.699799 [debug] [ThreadPool]: On list_ae_exam_db_staging: BEGIN
[0m18:35:25.700014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.701426 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.701669 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_staging"
[0m18:35:25.701878 [debug] [ThreadPool]: On list_ae_exam_db_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_staging"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:35:25.705055 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:35:25.706156 [debug] [ThreadPool]: On list_ae_exam_db_staging: ROLLBACK
[0m18:35:25.706697 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_staging'
[0m18:35:25.706937 [debug] [ThreadPool]: On list_ae_exam_db_staging: Close
[0m18:35:25.707453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_staging, now list_ae_exam_db_mart)
[0m18:35:25.708986 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m18:35:25.709267 [debug] [ThreadPool]: On list_ae_exam_db_mart: BEGIN
[0m18:35:25.709474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.710966 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.711245 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_mart"
[0m18:35:25.711471 [debug] [ThreadPool]: On list_ae_exam_db_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_mart"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'mart'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:35:25.714915 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:35:25.716221 [debug] [ThreadPool]: On list_ae_exam_db_mart: ROLLBACK
[0m18:35:25.716834 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_mart'
[0m18:35:25.717144 [debug] [ThreadPool]: On list_ae_exam_db_mart: Close
[0m18:35:25.717609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ae_exam_db_mart, now list_ae_exam_db_report)
[0m18:35:25.719287 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m18:35:25.719600 [debug] [ThreadPool]: On list_ae_exam_db_report: BEGIN
[0m18:35:25.719850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:25.721178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:35:25.721434 [debug] [ThreadPool]: Using duckdb connection "list_ae_exam_db_report"
[0m18:35:25.721648 [debug] [ThreadPool]: On list_ae_exam_db_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "connection_name": "list_ae_exam_db_report"} */
select
      'ae_exam_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'report'
    and lower(table_catalog) = 'ae_exam_db'
  
[0m18:35:25.725195 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:35:25.726378 [debug] [ThreadPool]: On list_ae_exam_db_report: ROLLBACK
[0m18:35:25.726938 [debug] [ThreadPool]: Failed to rollback 'list_ae_exam_db_report'
[0m18:35:25.727234 [debug] [ThreadPool]: On list_ae_exam_db_report: Close
[0m18:35:25.728789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54C5BB90>]}
[0m18:35:25.729147 [debug] [MainThread]: Using duckdb connection "master"
[0m18:35:25.729364 [debug] [MainThread]: On master: BEGIN
[0m18:35:25.729552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:25.730137 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:35:25.730469 [debug] [MainThread]: On master: COMMIT
[0m18:35:25.730724 [debug] [MainThread]: Using duckdb connection "master"
[0m18:35:25.730965 [debug] [MainThread]: On master: COMMIT
[0m18:35:25.731322 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:35:25.731572 [debug] [MainThread]: On master: Close
[0m18:35:25.734062 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_interactions
[0m18:35:25.734482 [info ] [Thread-1 (]: 1 of 30 START sql view model staging.model_stg_campaign_interactions ........... [RUN]
[0m18:35:25.735259 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ae_exam_project.model_stg_campaign_interactions'
[0m18:35:25.735613 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_interactions
[0m18:35:25.741058 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.742071 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_interactions
[0m18:35:25.770160 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.771218 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.771581 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: BEGIN
[0m18:35:25.771869 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:25.772461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.772729 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.772959 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_interactions"
)

select *
from source_data
  );

[0m18:35:25.773729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.779371 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.779751 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions" rename to "model_stg_campaign_interactions__dbt_backup"
[0m18:35:25.780447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.782744 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.783039 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_tmp" rename to "model_stg_campaign_interactions"
[0m18:35:25.783624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.793588 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m18:35:25.793994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.794268 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: COMMIT
[0m18:35:25.798439 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:35:25.804274 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_interactions"
[0m18:35:25.804626 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_interactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_interactions__dbt_backup" cascade
[0m18:35:25.808132 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:25.810380 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_interactions: Close
[0m18:35:25.812528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A55060C00>]}
[0m18:35:25.813077 [info ] [Thread-1 (]: 1 of 30 OK created sql view model staging.model_stg_campaign_interactions ...... [[32mOK[0m in 0.08s]
[0m18:35:25.813910 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_interactions
[0m18:35:25.814257 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_campaign_master
[0m18:35:25.814622 [info ] [Thread-1 (]: 2 of 30 START sql view model staging.model_stg_campaign_master ................. [RUN]
[0m18:35:25.815272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_interactions, now model.ae_exam_project.model_stg_campaign_master)
[0m18:35:25.815541 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_campaign_master
[0m18:35:25.817899 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.818860 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_campaign_master
[0m18:35:25.821055 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.821834 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.822283 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: BEGIN
[0m18:35:25.822638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:25.823276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.823564 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.823809 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."campaign_master"
)

select *
from source_data
  );

[0m18:35:25.825059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.827997 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.828599 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master" rename to "model_stg_campaign_master__dbt_backup"
[0m18:35:25.829473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.832202 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.832567 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
alter view "ae_exam_db"."staging"."model_stg_campaign_master__dbt_tmp" rename to "model_stg_campaign_master"
[0m18:35:25.833198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.834386 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m18:35:25.834735 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.835002 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: COMMIT
[0m18:35:25.837876 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:25.839596 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_campaign_master"
[0m18:35:25.839895 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_campaign_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_campaign_master__dbt_backup" cascade
[0m18:35:25.842902 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:25.845190 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_campaign_master: Close
[0m18:35:25.845849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A550DE710>]}
[0m18:35:25.846445 [info ] [Thread-1 (]: 2 of 30 OK created sql view model staging.model_stg_campaign_master ............ [[32mOK[0m in 0.03s]
[0m18:35:25.847255 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_campaign_master
[0m18:35:25.847704 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_customers_master
[0m18:35:25.848335 [info ] [Thread-1 (]: 3 of 30 START sql view model staging.model_stg_customers_master ................ [RUN]
[0m18:35:25.848920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_campaign_master, now model.ae_exam_project.model_stg_customers_master)
[0m18:35:25.849250 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_customers_master
[0m18:35:25.851683 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.852547 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_customers_master
[0m18:35:25.855414 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.856288 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.856655 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: BEGIN
[0m18:35:25.856897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:25.857572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.858154 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.858706 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."customers_master"
)

select *
from source_data
  );

[0m18:35:25.860634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.863288 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.863881 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master" rename to "model_stg_customers_master__dbt_backup"
[0m18:35:25.864718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.867117 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.867464 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
alter view "ae_exam_db"."staging"."model_stg_customers_master__dbt_tmp" rename to "model_stg_customers_master"
[0m18:35:25.868060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.869805 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m18:35:25.870457 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.870873 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: COMMIT
[0m18:35:25.874121 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:25.879657 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_customers_master"
[0m18:35:25.880070 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_customers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_customers_master__dbt_backup" cascade
[0m18:35:25.883157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:25.884874 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_customers_master: Close
[0m18:35:25.885549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54EF5CD0>]}
[0m18:35:25.886214 [info ] [Thread-1 (]: 3 of 30 OK created sql view model staging.model_stg_customers_master ........... [[32mOK[0m in 0.04s]
[0m18:35:25.887058 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_customers_master
[0m18:35:25.887420 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_drivers_master
[0m18:35:25.887844 [info ] [Thread-1 (]: 4 of 30 START sql view model staging.model_stg_drivers_master .................. [RUN]
[0m18:35:25.888455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_customers_master, now model.ae_exam_project.model_stg_drivers_master)
[0m18:35:25.888735 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_drivers_master
[0m18:35:25.890834 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.892787 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_drivers_master
[0m18:35:25.955590 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.956559 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.956915 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: BEGIN
[0m18:35:25.957197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:25.958152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.958785 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.959170 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */

  
  create view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."drivers_master"
)

select *
from source_data
  );

[0m18:35:25.959966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.962690 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.963073 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master" rename to "model_stg_drivers_master__dbt_backup"
[0m18:35:25.963776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.965776 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.966057 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
alter view "ae_exam_db"."staging"."model_stg_drivers_master__dbt_tmp" rename to "model_stg_drivers_master"
[0m18:35:25.966611 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.967651 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m18:35:25.967950 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.968204 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: COMMIT
[0m18:35:25.971470 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:25.973407 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_drivers_master"
[0m18:35:25.973694 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_drivers_master"} */
drop view if exists "ae_exam_db"."staging"."model_stg_drivers_master__dbt_backup" cascade
[0m18:35:25.977095 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:25.978594 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_drivers_master: Close
[0m18:35:25.979098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5483AC10>]}
[0m18:35:25.979595 [info ] [Thread-1 (]: 4 of 30 OK created sql view model staging.model_stg_drivers_master ............. [[32mOK[0m in 0.09s]
[0m18:35:25.980474 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_drivers_master
[0m18:35:25.980765 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:35:25.981090 [info ] [Thread-1 (]: 5 of 30 START sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [RUN]
[0m18:35:25.981894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_drivers_master, now model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions)
[0m18:35:25.982181 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:35:25.984082 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:25.984924 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:35:25.987544 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:25.988471 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:25.988816 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: BEGIN
[0m18:35:25.989077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:25.989690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.989961 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:25.990245 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_customer_app_sessions"
)

select *
from source_data
  );

[0m18:35:25.991328 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:25.994234 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:25.994669 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup"
[0m18:35:25.995424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:25.997849 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:25.998504 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:25.999800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.001041 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m18:35:26.001354 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:26.001600 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: COMMIT
[0m18:35:26.004659 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.006656 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"
[0m18:35:26.006962 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions__dbt_backup" cascade
[0m18:35:26.010426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.012025 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions: Close
[0m18:35:26.012734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54FA9B50>]}
[0m18:35:26.013472 [info ] [Thread-1 (]: 5 of 30 OK created sql view model staging.model_stg_order_log_incentive_sessions_customer_app_sessions  [[32mOK[0m in 0.03s]
[0m18:35:26.014831 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions
[0m18:35:26.015161 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:35:26.015523 [info ] [Thread-1 (]: 6 of 30 START sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [RUN]
[0m18:35:26.016245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_customer_app_sessions, now model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs)
[0m18:35:26.016543 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:35:26.018749 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.019631 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:35:26.021810 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.022994 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.023531 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: BEGIN
[0m18:35:26.024113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.025272 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.025902 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.026390 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_log_incentive_sessions_driver_incentive_logs"
)

select *
from source_data
  );

[0m18:35:26.027782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.031133 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.031605 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup"
[0m18:35:26.032507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.035205 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.035546 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
alter view "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_tmp" rename to "model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.036232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.037307 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m18:35:26.037612 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.037861 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: COMMIT
[0m18:35:26.041192 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.043455 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"
[0m18:35:26.043836 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs__dbt_backup" cascade
[0m18:35:26.047104 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.048951 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs: Close
[0m18:35:26.049570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54813770>]}
[0m18:35:26.050146 [info ] [Thread-1 (]: 6 of 30 OK created sql view model staging.model_stg_order_log_incentive_sessions_driver_incentive_logs  [[32mOK[0m in 0.03s]
[0m18:35:26.051078 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs
[0m18:35:26.051573 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_order_transactions
[0m18:35:26.052080 [info ] [Thread-1 (]: 7 of 30 START sql view model staging.model_stg_order_transactions .............. [RUN]
[0m18:35:26.052899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_log_incentive_sessions_driver_incentive_logs, now model.ae_exam_project.model_stg_order_transactions)
[0m18:35:26.053289 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_order_transactions
[0m18:35:26.055710 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.056595 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_order_transactions
[0m18:35:26.059385 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.060813 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.061298 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: BEGIN
[0m18:35:26.061590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.062156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.062457 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.062711 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */

  
  create view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."order_transactions"
)

select *
from source_data
  );

[0m18:35:26.063458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.065596 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.065877 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions" rename to "model_stg_order_transactions__dbt_backup"
[0m18:35:26.066423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.068726 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.069043 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
alter view "ae_exam_db"."staging"."model_stg_order_transactions__dbt_tmp" rename to "model_stg_order_transactions"
[0m18:35:26.069647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.070875 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m18:35:26.071248 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.071549 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: COMMIT
[0m18:35:26.074905 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.077022 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_order_transactions"
[0m18:35:26.077409 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_order_transactions"} */
drop view if exists "ae_exam_db"."staging"."model_stg_order_transactions__dbt_backup" cascade
[0m18:35:26.080607 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.083076 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_order_transactions: Close
[0m18:35:26.083671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54813770>]}
[0m18:35:26.084278 [info ] [Thread-1 (]: 7 of 30 OK created sql view model staging.model_stg_order_transactions ......... [[32mOK[0m in 0.03s]
[0m18:35:26.085191 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_order_transactions
[0m18:35:26.085657 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:35:26.086091 [info ] [Thread-1 (]: 8 of 30 START sql view model staging.model_stg_support_ticket_status_logs ...... [RUN]
[0m18:35:26.086966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_order_transactions, now model.ae_exam_project.model_stg_support_ticket_status_logs)
[0m18:35:26.087385 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:35:26.090347 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.091804 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:35:26.094522 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.095616 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.096263 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: BEGIN
[0m18:35:26.096627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.097360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.097763 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.098112 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_ticket_status_logs"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_ticket_status_logs__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_ticket_status_logs"
)

select *
from source_data
  );

[0m18:35:26.098939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.101320 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.101846 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_ticket_status_logs"} */
alter view "ae_exam_db"."staging"."model_stg_support_ticket_status_logs" rename to "model_stg_support_ticket_status_logs__dbt_backup"
[0m18:35:26.103019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.106913 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.107318 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_ticket_status_logs"} */
alter view "ae_exam_db"."staging"."model_stg_support_ticket_status_logs__dbt_tmp" rename to "model_stg_support_ticket_status_logs"
[0m18:35:26.108535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.109811 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: COMMIT
[0m18:35:26.110213 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.110502 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: COMMIT
[0m18:35:26.113599 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.115439 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_ticket_status_logs"
[0m18:35:26.115731 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_ticket_status_logs"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_ticket_status_logs__dbt_backup" cascade
[0m18:35:26.118545 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:35:26.119790 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_ticket_status_logs: Close
[0m18:35:26.120275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A547CC590>]}
[0m18:35:26.120769 [info ] [Thread-1 (]: 8 of 30 OK created sql view model staging.model_stg_support_ticket_status_logs . [[32mOK[0m in 0.03s]
[0m18:35:26.121646 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_ticket_status_logs
[0m18:35:26.122003 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_stg_support_tickets
[0m18:35:26.122402 [info ] [Thread-1 (]: 9 of 30 START sql view model staging.model_stg_support_tickets ................. [RUN]
[0m18:35:26.123162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_ticket_status_logs, now model.ae_exam_project.model_stg_support_tickets)
[0m18:35:26.123717 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_stg_support_tickets
[0m18:35:26.127332 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.128757 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_stg_support_tickets
[0m18:35:26.132197 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.133433 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.134056 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: BEGIN
[0m18:35:26.134387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.135137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.135541 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.135838 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */

  
  create view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" as (
    with source_data as (
    select *
    from "ae_exam_db"."main"."support_tickets"
)

select *
from source_data
  );

[0m18:35:26.136819 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.139677 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.140128 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets" rename to "model_stg_support_tickets__dbt_backup"
[0m18:35:26.141119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.144974 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.145476 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
alter view "ae_exam_db"."staging"."model_stg_support_tickets__dbt_tmp" rename to "model_stg_support_tickets"
[0m18:35:26.146196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.147819 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m18:35:26.148186 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.148477 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: COMMIT
[0m18:35:26.152030 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.153920 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_stg_support_tickets"
[0m18:35:26.154245 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_stg_support_tickets"} */
drop view if exists "ae_exam_db"."staging"."model_stg_support_tickets__dbt_backup" cascade
[0m18:35:26.156895 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:35:26.159595 [debug] [Thread-1 (]: On model.ae_exam_project.model_stg_support_tickets: Close
[0m18:35:26.160487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A547CEDB0>]}
[0m18:35:26.161387 [info ] [Thread-1 (]: 9 of 30 OK created sql view model staging.model_stg_support_tickets ............ [[32mOK[0m in 0.04s]
[0m18:35:26.162258 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_stg_support_tickets
[0m18:35:26.162605 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_profile_active
[0m18:35:26.163154 [info ] [Thread-1 (]: 10 of 30 START sql view model intermediate.model_int_driver_profile_active ..... [RUN]
[0m18:35:26.163943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_stg_support_tickets, now model.ae_exam_project.model_int_driver_profile_active)
[0m18:35:26.164376 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_profile_active
[0m18:35:26.166570 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.167555 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_profile_active
[0m18:35:26.170246 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.171097 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.171431 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: BEGIN
[0m18:35:26.171700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.172247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.172516 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.172782 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" as (
    select
    driver_id,
    vehicle_type,
    region,
    active_status,
    driver_rating,
    bonus_tier
from "ae_exam_db"."staging"."model_stg_drivers_master"
where active_status = 'active'
  );

[0m18:35:26.173555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.176867 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.177372 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active" rename to "model_int_driver_profile_active__dbt_backup"
[0m18:35:26.178488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.181036 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.181400 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_tmp" rename to "model_int_driver_profile_active"
[0m18:35:26.182015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.183092 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m18:35:26.183387 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.183645 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: COMMIT
[0m18:35:26.186786 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.190436 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_profile_active"
[0m18:35:26.190860 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_profile_active"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_profile_active__dbt_backup" cascade
[0m18:35:26.194930 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.196601 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_profile_active: Close
[0m18:35:26.197195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A53601130>]}
[0m18:35:26.197759 [info ] [Thread-1 (]: 10 of 30 OK created sql view model intermediate.model_int_driver_profile_active  [[32mOK[0m in 0.03s]
[0m18:35:26.198655 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_profile_active
[0m18:35:26.198987 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:35:26.199333 [info ] [Thread-1 (]: 11 of 30 START sql view model intermediate.model_int_campaign_customer_orders .. [RUN]
[0m18:35:26.200006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_profile_active, now model.ae_exam_project.model_int_campaign_customer_orders)
[0m18:35:26.200311 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:35:26.202768 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.203634 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:35:26.205985 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.206904 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.207261 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: BEGIN
[0m18:35:26.207689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.208781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.209330 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.209839 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */

  
  create view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" as (
    with interaction_base as (
    select
        i.interaction_id,
        i.customer_id,
        i.campaign_id,
        i.interaction_datetime,
        i.event_type,
        i.platform,
        i.device_type,
        i.ad_cost,
        i.order_id,
        i.session_id,
        i.is_new_customer,
        i.revenue,
        c.campaign_name,
        c.channel,
        c.cost_model,
        c.start_date as campaign_start,
        c.end_date as campaign_end,
        c.targeting_strategy

    from "ae_exam_db"."staging"."model_stg_campaign_interactions" i
    left join "ae_exam_db"."staging"."model_stg_campaign_master" c
        on i.campaign_id = c.campaign_id
),

enriched_with_orders as (
    select
        ib.*,
        o.order_datetime,
        o.total_amount,
        o.payment_method,
        o.order_status
    from interaction_base ib
    left join "ae_exam_db"."staging"."model_stg_order_transactions" o
        on ib.order_id = o.order_id
),

final as (
    select
        e.*,
        cust.signup_date,
        cust.customer_segment,
        cust.referral_source
    from enriched_with_orders e
    left join "ae_exam_db"."staging"."model_stg_customers_master" cust
        on e.customer_id = cust.customer_id
)

select * from final
  );

[0m18:35:26.212583 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:35:26.215709 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.216078 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders" rename to "model_int_campaign_customer_orders__dbt_backup"
[0m18:35:26.216739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.218756 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.219043 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
alter view "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_tmp" rename to "model_int_campaign_customer_orders"
[0m18:35:26.219595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.220800 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m18:35:26.221089 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.221342 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: COMMIT
[0m18:35:26.224766 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.228088 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_campaign_customer_orders"
[0m18:35:26.228782 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_campaign_customer_orders"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_campaign_customer_orders__dbt_backup" cascade
[0m18:35:26.232091 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.233268 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_campaign_customer_orders: Close
[0m18:35:26.233703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A52A8CF50>]}
[0m18:35:26.234260 [info ] [Thread-1 (]: 11 of 30 OK created sql view model intermediate.model_int_campaign_customer_orders  [[32mOK[0m in 0.03s]
[0m18:35:26.235218 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_campaign_customer_orders
[0m18:35:26.235595 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_customer_sessions
[0m18:35:26.235936 [info ] [Thread-1 (]: 12 of 30 START sql view model intermediate.model_int_customer_sessions ......... [RUN]
[0m18:35:26.236787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_campaign_customer_orders, now model.ae_exam_project.model_int_customer_sessions)
[0m18:35:26.237199 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_customer_sessions
[0m18:35:26.239951 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.241167 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_customer_sessions
[0m18:35:26.246028 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.247707 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.248168 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: BEGIN
[0m18:35:26.248464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.249153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.249633 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.249980 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */

  
  create view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" as (
    with base_sessions as (
    select
        session_id,
        customer_id,
        session_start,
        session_end,
        device_type
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

interactions as (
    select
        'SESS'||right(session_id,6) as session_id,
        interaction_datetime,
        campaign_id,
        event_type,
        ad_cost
    from "ae_exam_db"."staging"."model_stg_campaign_interactions"
),

orders as (
    select
        order_id,
        customer_id,
        order_datetime,
        total_amount,
        order_status
    from "ae_exam_db"."staging"."model_stg_order_transactions"
)

select
    s.session_id,
    s.customer_id,
    s.session_start,
    s.session_end,
 --   s.platform,
    s.device_type,
    i.campaign_id,
    i.event_type,
    i.ad_cost,
    i.interaction_datetime,
    o.order_id,
    o.order_datetime,
    o.total_amount,
    o.order_status,
    -- คำนวณเวลาจาก session start → interaction / order
    datediff('minute', s.session_start, i.interaction_datetime) as time_to_click_min,
    datediff('minute', s.session_start, o.order_datetime) as time_to_order_min

from base_sessions s
left join interactions i
    on s.session_id = i.session_id
left join orders o
    on s.customer_id = o.customer_id
    and o.order_datetime between s.session_start and s.session_end
  );

[0m18:35:26.251699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.254083 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.254370 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions" rename to "model_int_customer_sessions__dbt_backup"
[0m18:35:26.254937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.258231 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.258797 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
alter view "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_tmp" rename to "model_int_customer_sessions"
[0m18:35:26.259720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.260999 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m18:35:26.261543 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.261902 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: COMMIT
[0m18:35:26.265669 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.267449 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_customer_sessions"
[0m18:35:26.267742 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_customer_sessions"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_customer_sessions__dbt_backup" cascade
[0m18:35:26.270834 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.272435 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_customer_sessions: Close
[0m18:35:26.272913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54810E30>]}
[0m18:35:26.273395 [info ] [Thread-1 (]: 12 of 30 OK created sql view model intermediate.model_int_customer_sessions .... [[32mOK[0m in 0.04s]
[0m18:35:26.274467 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_customer_sessions
[0m18:35:26.275111 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_driver_task_summary
[0m18:35:26.275853 [info ] [Thread-1 (]: 13 of 30 START sql view model intermediate.model_int_driver_task_summary ....... [RUN]
[0m18:35:26.276695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_customer_sessions, now model.ae_exam_project.model_int_driver_task_summary)
[0m18:35:26.277142 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_driver_task_summary
[0m18:35:26.281559 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.282747 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_driver_task_summary
[0m18:35:26.284975 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.285823 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.286194 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: BEGIN
[0m18:35:26.286511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.287247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.287581 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.287900 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" as (
    with summary as (
select
    ot.driver_id,
    ot.delivery_zone,
    sum(ld.bonus_amount) as total_bonus,
    sum(delivery_target) as total_target,
    sum(actual_deliveries) as total_actual_deliveries,
    count(ot.order_id) as total_tasks,
    count(case when (ot.order_status  = 'completed') then 1 end) as completed_tasks, 
    avg(extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0) as avg_response_time_mins,
    avg(extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0) as avg_delivery_time_mins,
    count(case when ot.is_late_delivery = true then 1 end) as late_deliveries,
    avg(st.csat_score) as avg_feedback_score,
    count(st.ticket_id) as total_feedbacks
from "ae_exam_db"."staging"."model_stg_order_transactions" ot
left join "ae_exam_db"."staging"."model_stg_support_tickets" st   on ot.order_id = st.order_id
left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld  on ot.driver_id = ld.driver_id
group by ot.driver_id,ot.delivery_zone
)

select * from summary
  );

[0m18:35:26.289916 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:35:26.293788 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.294632 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary" rename to "model_int_driver_task_summary__dbt_backup"
[0m18:35:26.295918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.299815 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.300325 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_tmp" rename to "model_int_driver_task_summary"
[0m18:35:26.301140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.302965 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m18:35:26.303351 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.303611 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: COMMIT
[0m18:35:26.306942 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.309935 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_driver_task_summary"
[0m18:35:26.310389 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_driver_task_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_driver_task_summary__dbt_backup" cascade
[0m18:35:26.313613 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.314830 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_driver_task_summary: Close
[0m18:35:26.315287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54FA9010>]}
[0m18:35:26.315745 [info ] [Thread-1 (]: 13 of 30 OK created sql view model intermediate.model_int_driver_task_summary .. [[32mOK[0m in 0.04s]
[0m18:35:26.316565 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_driver_task_summary
[0m18:35:26.316924 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_order_delivery_summary
[0m18:35:26.317278 [info ] [Thread-1 (]: 14 of 30 START sql view model intermediate.model_int_order_delivery_summary .... [RUN]
[0m18:35:26.317922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_driver_task_summary, now model.ae_exam_project.model_int_order_delivery_summary)
[0m18:35:26.318223 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_order_delivery_summary
[0m18:35:26.320516 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.321342 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_order_delivery_summary
[0m18:35:26.323835 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.325149 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.325821 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: BEGIN
[0m18:35:26.326440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.327100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.327496 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.327831 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" as (
    with summary as (
    select
        ot.order_id,
        ot.driver_id,
        ot.delivery_zone,
        ot.order_datetime,
        ot.pickup_datetime,
        ot.delivery_datetime,
        ot.is_late_delivery,

        case when ot.order_status = 'completed' then 1 else 0 end as is_completed,
        case when ot.order_status != 'completed' then 1 else 0 end as is_failed,

        extract(epoch from ot.pickup_datetime - ot.order_datetime) / 60.0 as response_time_mins,
        extract(epoch from ot.delivery_datetime - ot.pickup_datetime) / 60.0 as delivery_time_mins,
        extract(epoch from ot.delivery_datetime - ot.order_datetime) / 60.0 as delivery_duration_mins,

        case when ot.is_late_delivery = true then 1 else 0 end as late_deliveries,

        st.csat_score,
        st.ticket_id,

        ld.bonus_amount,
        ld.delivery_target,
        ld.actual_deliveries,
        ld.incentive_program,
        ld.applied_date,
        ld.bonus_qualified,
        case when ld.bonus_qualified = true then 1 else 0 end as bonus_qualified_sessions,
        ld.region as region_log,
        ld.log_id

    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_support_tickets" st
        on ot.order_id = st.order_id

    left join "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_driver_incentive_logs" ld
        on ot.driver_id = ld.driver_id
)

select * from summary
  );

[0m18:35:26.329876 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:35:26.332050 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.332364 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary" rename to "model_int_order_delivery_summary__dbt_backup"
[0m18:35:26.332948 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.335815 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.336176 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_tmp" rename to "model_int_order_delivery_summary"
[0m18:35:26.336812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.337866 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m18:35:26.338158 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.338407 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: COMMIT
[0m18:35:26.341565 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.343697 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_order_delivery_summary"
[0m18:35:26.344050 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_order_delivery_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_order_delivery_summary__dbt_backup" cascade
[0m18:35:26.347605 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.349213 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_order_delivery_summary: Close
[0m18:35:26.349771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54FA8710>]}
[0m18:35:26.350362 [info ] [Thread-1 (]: 14 of 30 OK created sql view model intermediate.model_int_order_delivery_summary  [[32mOK[0m in 0.03s]
[0m18:35:26.351144 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_order_delivery_summary
[0m18:35:26.351469 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:35:26.351795 [info ] [Thread-1 (]: 15 of 30 START sql view model intermediate.model_int_ticket_resolution_summary . [RUN]
[0m18:35:26.352655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_order_delivery_summary, now model.ae_exam_project.model_int_ticket_resolution_summary)
[0m18:35:26.352942 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:35:26.354922 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.355881 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:35:26.359155 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.360524 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.361054 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: BEGIN
[0m18:35:26.361418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.362053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.362343 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.362651 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_ticket_resolution_summary"} */

  
  create view "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary__dbt_tmp" as (
    select
  ticket_id,
  issue_type,
  opened_datetime,
  resolved_datetime,
  extract(epoch from resolved_datetime - opened_datetime) / 60.0 as resolution_duration_mins,
  case when status = 'resolved' then 1 else 0 end as is_resolved,
  status,
  compensation_amount,
from "ae_exam_db"."staging"."model_stg_support_tickets"
  );

[0m18:35:26.364080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.366463 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.366810 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_ticket_resolution_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary" rename to "model_int_ticket_resolution_summary__dbt_backup"
[0m18:35:26.367527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.369560 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.369851 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_ticket_resolution_summary"} */
alter view "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary__dbt_tmp" rename to "model_int_ticket_resolution_summary"
[0m18:35:26.370405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.371369 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: COMMIT
[0m18:35:26.371648 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.371941 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: COMMIT
[0m18:35:26.375192 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.378124 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_ticket_resolution_summary"
[0m18:35:26.378653 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_ticket_resolution_summary"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary__dbt_backup" cascade
[0m18:35:26.382235 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.383477 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_ticket_resolution_summary: Close
[0m18:35:26.383901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54FA9490>]}
[0m18:35:26.384366 [info ] [Thread-1 (]: 15 of 30 OK created sql view model intermediate.model_int_ticket_resolution_summary  [[32mOK[0m in 0.03s]
[0m18:35:26.385214 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_ticket_resolution_summary
[0m18:35:26.385568 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_campaign_performance
[0m18:35:26.385902 [info ] [Thread-1 (]: 16 of 30 START sql table model mart.model_mart_campaign_performance ............ [RUN]
[0m18:35:26.386812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_ticket_resolution_summary, now model.ae_exam_project.model_mart_campaign_performance)
[0m18:35:26.387156 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_campaign_performance
[0m18:35:26.389422 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.390291 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_campaign_performance
[0m18:35:26.407838 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.409672 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.410171 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: BEGIN
[0m18:35:26.410474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.411609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.411982 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.412304 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp"
  
    as (
      

with base as (
    select
        campaign_id,
        campaign_name,
        customer_id,
        event_type,
        interaction_datetime,
        ad_cost,
        order_id,
        order_status,
        revenue
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
),

aggregated as (
    select
        campaign_id,
        campaign_name,
        date(interaction_datetime) as interaction_date,
        count(case when event_type = 'impression' then customer_id end) as impression,
        count(case when event_type = 'click' then customer_id end) as click,
        count(case when (event_type = 'conversion' and order_id is not null and order_status = 'completed') then customer_id end) as converted_customers,
        count(distinct(case when (order_id is not null and order_status = 'completed') then order_id end)) as total_orders,
        round(sum(ad_cost),2) as total_ad_cost,
        round(sum(revenue),2) as total_revenue,
        round(  case 
                    when sum(ad_cost) > 0 then sum(revenue) / sum(ad_cost)
                    else 0
                end,
            2)as roas,   
        round(  case 
                    when count(distinct (case when order_id is not null then customer_id END)) > 0
                        then sum(ad_cost) / count(distinct (case when order_id is not null then customer_id END))
                    else 0
                end
            ,2)as cpa
    from base
    group by campaign_id,campaign_name,interaction_date
)

select * from aggregated
    );
  
  
[0m18:35:26.449424 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m18:35:26.451719 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.452048 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance" rename to "model_mart_campaign_performance__dbt_backup"
[0m18:35:26.452777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.454712 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.454991 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
alter table "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_tmp" rename to "model_mart_campaign_performance"
[0m18:35:26.455539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.460262 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m18:35:26.460635 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.460893 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: COMMIT
[0m18:35:26.467695 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:35:26.469673 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_campaign_performance"
[0m18:35:26.469954 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_campaign_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_campaign_performance__dbt_backup" cascade
[0m18:35:26.472994 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.475003 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_campaign_performance: Close
[0m18:35:26.475552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5506B710>]}
[0m18:35:26.476034 [info ] [Thread-1 (]: 16 of 30 OK created sql table model mart.model_mart_campaign_performance ....... [[32mOK[0m in 0.09s]
[0m18:35:26.476824 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_campaign_performance
[0m18:35:26.477176 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_customer_acquisition
[0m18:35:26.477577 [info ] [Thread-1 (]: 17 of 30 START sql table model mart.model_mart_customer_acquisition ............ [RUN]
[0m18:35:26.478205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_campaign_performance, now model.ae_exam_project.model_mart_customer_acquisition)
[0m18:35:26.478535 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_customer_acquisition
[0m18:35:26.481309 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.482142 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_customer_acquisition
[0m18:35:26.484268 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.485092 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.485416 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: BEGIN
[0m18:35:26.485657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.486195 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.486493 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.486821 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp"
  
    as (
      

with new_customer_orders as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(date(order_datetime)) as acquisition_date,
        min(order_datetime) as first_purchase_datetime,
        count(order_id) as total_orders,
        sum(total_amount) as total_revenue,
        round(avg(total_amount), 2) as avg_order_value,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true and order_status = 'completed'
    group by customer_id, campaign_id, campaign_name, channel, platform
),

first_interaction as (
    select
        customer_id,
        campaign_id,
        campaign_name,
        channel,
        platform,
        min(interaction_datetime) as first_interaction_datetime
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = true
    group by customer_id, campaign_id, campaign_name, channel, platform
),

order_log_sessions_customer_app as (
    select * 
    from "ae_exam_db"."staging"."model_stg_order_log_incentive_sessions_customer_app_sessions"
),

customer_activitytime as (
    select
        nco.campaign_id,
        nco.customer_id,
        nco.campaign_name,
        nco.channel,
        nco.platform,
        nco.first_purchase_datetime,
        greatest(
            max(ot.order_datetime),
            (select max(session_start) 
             from order_log_sessions_customer_app 
             where customer_id = nco.customer_id)
        ) as last_activity_datetime
    from new_customer_orders nco
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot 
      on nco.customer_id = ot.customer_id
    where ot.order_status = 'completed'
    group by nco.campaign_id, nco.campaign_name, nco.customer_id, nco.first_purchase_datetime, nco.channel, nco.platform
)

select
    nco.acquisition_date,
    nco.campaign_id,
    nco.campaign_name,
    count(*) as new_customers,
    round(avg(nco.avg_order_value), 2) as avg_purchase_value,
    MAX(nco.total_orders) - 1 as repeat_orders,

    round(
    avg(extract(epoch from (ca.last_activity_datetime - nco.first_purchase_datetime)) / (60*60*24)) 
     ,2)  as avg_days_active_after_purchase,

    round(avg(
        case 
            when nco.first_purchase_datetime >= fi.first_interaction_datetime then
                extract(epoch from (nco.first_purchase_datetime - fi.first_interaction_datetime)) / (60*60*24)
            else null
        end
    ),2) as avg_days_to_first_purchase,

    round(sum(nco.total_revenue),2) as revenue,
    round(sum(nco.total_ad_cost) / nullif(count(*), 0), 2) as cac,
    round(sum(nco.total_revenue) / nullif(sum(nco.total_ad_cost), 0), 2) as roas,
    nco.channel,
    nco.platform
from new_customer_orders as nco
inner join first_interaction fi
  on nco.campaign_id = fi.campaign_id and nco.customer_id = fi.customer_id
left join customer_activitytime ca
  on nco.campaign_id = ca.campaign_id and nco.customer_id = ca.customer_id
group by 
    nco.acquisition_date, 
    nco.campaign_id, 
    nco.campaign_name, 
    nco.channel, 
    nco.platform
    );
  
  
[0m18:35:26.684815 [debug] [Thread-1 (]: SQL status: OK in 0.197 seconds
[0m18:35:26.693473 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.693909 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition" rename to "model_mart_customer_acquisition__dbt_backup"
[0m18:35:26.694738 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.697279 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.697669 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
alter table "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_tmp" rename to "model_mart_customer_acquisition"
[0m18:35:26.698393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:26.699620 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m18:35:26.699931 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.700188 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: COMMIT
[0m18:35:26.708642 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:35:26.710642 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_customer_acquisition"
[0m18:35:26.711042 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_customer_acquisition"} */
drop table if exists "ae_exam_db"."mart"."model_mart_customer_acquisition__dbt_backup" cascade
[0m18:35:26.714175 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:26.715524 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_customer_acquisition: Close
[0m18:35:26.716068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A55068AD0>]}
[0m18:35:26.716616 [info ] [Thread-1 (]: 17 of 30 OK created sql table model mart.model_mart_customer_acquisition ....... [[32mOK[0m in 0.24s]
[0m18:35:26.717388 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_customer_acquisition
[0m18:35:26.717727 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_retargeting _performance
[0m18:35:26.718294 [info ] [Thread-1 (]: 18 of 30 START sql table model mart.model_mart_retargeting _performance ........ [RUN]
[0m18:35:26.718955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_customer_acquisition, now model.ae_exam_project.model_mart_retargeting _performance)
[0m18:35:26.719289 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_retargeting _performance
[0m18:35:26.723076 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:26.724228 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_retargeting _performance
[0m18:35:26.727488 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:26.728780 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:26.729329 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: BEGIN
[0m18:35:26.729646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:26.730266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:26.730629 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:26.731000 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp"
  
    as (
      

with retargeted_customers as (
    
    select
        customer_id,
        campaign_id,
        min(interaction_datetime) as first_retarget_datetime,
        sum(ad_cost) as total_ad_cost
    from "ae_exam_db"."intermediate"."model_int_campaign_customer_orders"
    where is_new_customer = false
    group by campaign_id, customer_id
),

returned_customers as (
   
    select
        rc.customer_id,
        rc.campaign_id,
        min(ot.order_datetime) as return_order_time,
        count(distinct ot.order_id) as orders_after_retarget,
        sum(ot.total_amount) as revenue_after_retarget
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

original_orders as (
    
    select
        rc.customer_id,
        rc.campaign_id,
        max(ot.order_datetime) as original_order_time
    from retargeted_customers rc
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime < rc.first_retarget_datetime
     and ot.order_status = 'completed'
    group by rc.customer_id, rc.campaign_id
),

retention_customers as (
 
    select
        rc.customer_id,
        rc.campaign_id,
        count(distinct ot.order_id) as orders_created_after_return
    from retargeted_customers rc
    join returned_customers r
      on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
    join "ae_exam_db"."staging"."model_stg_order_transactions" ot
      on rc.customer_id = ot.customer_id
     and ot.order_datetime > r.return_order_time
    group by rc.customer_id, rc.campaign_id
),

campaign_info as (
   
    select
        campaign_id,
        campaign_type,
        targeting_strategy
    from "ae_exam_db"."staging"."model_stg_campaign_master"
)

select
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy,
    count(distinct rc.customer_id) as targeted_customers,
    count(distinct r.customer_id) as returned_customers,
    round(1.0 * count(distinct r.customer_id) / count(distinct rc.customer_id), 2) as return_rate,
    round(sum(r.revenue_after_retarget), 2) as total_revenue_post_retarget,
    round(avg(datediff('day', o.original_order_time, r.return_order_time)), 1) as avg_days_between_orders,
    round(sum(coalesce(rt.orders_created_after_return, 0)), 0) as orders_created_after_return,
    round(sum(rc.total_ad_cost), 2) as total_ad_cost

from retargeted_customers rc
left join returned_customers r
  on rc.customer_id = r.customer_id and rc.campaign_id = r.campaign_id
left join original_orders o 
  on rc.customer_id = o.customer_id and rc.campaign_id = o.campaign_id
left join retention_customers rt
  on rc.customer_id = rt.customer_id and rc.campaign_id = rt.campaign_id
left join campaign_info ci
  on rc.campaign_id = ci.campaign_id
group by
    rc.campaign_id,
    ci.campaign_type,
    ci.targeting_strategy
    );
  
  
[0m18:35:27.030598 [debug] [Thread-1 (]: SQL status: OK in 0.299 seconds
[0m18:35:27.034778 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:27.035233 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance" rename to "model_mart_retargeting _performance__dbt_backup"
[0m18:35:27.036133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:27.038735 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:27.039157 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
alter table "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_tmp" rename to "model_mart_retargeting _performance"
[0m18:35:27.039914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.042595 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m18:35:27.043285 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:27.043637 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: COMMIT
[0m18:35:27.047285 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:27.049253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_retargeting _performance"
[0m18:35:27.049616 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_retargeting _performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_retargeting _performance__dbt_backup" cascade
[0m18:35:27.052989 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:27.054541 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_retargeting _performance: Close
[0m18:35:27.055141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A55069010>]}
[0m18:35:27.055737 [info ] [Thread-1 (]: 18 of 30 OK created sql table model mart.model_mart_retargeting _performance ... [[32mOK[0m in 0.34s]
[0m18:35:27.056517 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_retargeting _performance
[0m18:35:27.056934 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:35:27.057626 [info ] [Thread-1 (]: 19 of 30 START sql view model intermediate.model_int_zone_delivery_aggregates .. [RUN]
[0m18:35:27.058804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_retargeting _performance, now model.ae_exam_project.model_int_zone_delivery_aggregates)
[0m18:35:27.059421 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:35:27.063862 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.065036 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:35:27.067813 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.068908 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.069433 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: BEGIN
[0m18:35:27.069846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:27.070605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:27.070911 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.071189 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */

  
  create view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" as (
    select
    delivery_zone,
    count(order_id) as total_requests,
    sum(is_completed) as completed_requests,
    round(avg(delivery_duration_mins), 2) as avg_delivery_time_mins,
    count(distinct driver_id) as unique_drivers
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary"
group by delivery_zone
  );

[0m18:35:27.073509 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:35:27.077431 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.078021 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates" rename to "model_int_zone_delivery_aggregates__dbt_backup"
[0m18:35:27.078834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.082890 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.083695 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
alter view "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_tmp" rename to "model_int_zone_delivery_aggregates"
[0m18:35:27.084533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.085805 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m18:35:27.086180 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.086514 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: COMMIT
[0m18:35:27.089782 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:27.092999 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_int_zone_delivery_aggregates"
[0m18:35:27.093735 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_int_zone_delivery_aggregates"} */
drop view if exists "ae_exam_db"."intermediate"."model_int_zone_delivery_aggregates__dbt_backup" cascade
[0m18:35:27.097971 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:27.099501 [debug] [Thread-1 (]: On model.ae_exam_project.model_int_zone_delivery_aggregates: Close
[0m18:35:27.100061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54813770>]}
[0m18:35:27.100593 [info ] [Thread-1 (]: 19 of 30 OK created sql view model intermediate.model_int_zone_delivery_aggregates  [[32mOK[0m in 0.04s]
[0m18:35:27.101393 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_int_zone_delivery_aggregates
[0m18:35:27.101805 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:35:27.102202 [info ] [Thread-1 (]: 20 of 30 START sql table model mart.model_mart_driver_incentive_impact ......... [RUN]
[0m18:35:27.102830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_int_zone_delivery_aggregates, now model.ae_exam_project.model_mart_driver_incentive_impact)
[0m18:35:27.103175 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:35:27.105389 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.106267 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:35:27.110500 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.112185 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.112585 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: BEGIN
[0m18:35:27.112859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:27.113423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:27.113734 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.114049 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp"
  
    as (
      


select
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log,
    count(ods.log_id) as total_sessions,
    sum(ods.actual_deliveries) as total_deliveries,
    sum(ods.bonus_qualified_sessions) as total_bonus_qualified_sessions,
    round(sum(case when ods.bonus_qualified = true then ods.bonus_amount else 0 end),2) as total_bonus_earned,
    round(avg(ods.csat_score), 2) as avg_feedback_score,
    round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
where ods.is_completed = 1 and ods.incentive_program is not null
group by
    ods.driver_id,
    ods.incentive_program,
    ods.applied_date,
    ods.region_log
    );
  
  
[0m18:35:27.154907 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m18:35:27.157571 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.158081 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
alter table "ae_exam_db"."mart"."model_mart_driver_incentive_impact" rename to "model_mart_driver_incentive_impact__dbt_backup"
[0m18:35:27.158908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.161582 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.162027 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
alter table "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_tmp" rename to "model_mart_driver_incentive_impact"
[0m18:35:27.162719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.163860 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m18:35:27.164175 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.164420 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: COMMIT
[0m18:35:27.168722 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:35:27.170802 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_incentive_impact"
[0m18:35:27.171154 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_incentive_impact__dbt_backup" cascade
[0m18:35:27.174711 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:27.176157 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_incentive_impact: Close
[0m18:35:27.176662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5506A7B0>]}
[0m18:35:27.177119 [info ] [Thread-1 (]: 20 of 30 OK created sql table model mart.model_mart_driver_incentive_impact .... [[32mOK[0m in 0.07s]
[0m18:35:27.177951 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_incentive_impact
[0m18:35:27.178291 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_performance
[0m18:35:27.178666 [info ] [Thread-1 (]: 21 of 30 START sql table model mart.model_mart_driver_performance .............. [RUN]
[0m18:35:27.179355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_incentive_impact, now model.ae_exam_project.model_mart_driver_performance)
[0m18:35:27.179622 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_performance
[0m18:35:27.181887 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.182667 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_performance
[0m18:35:27.185618 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.186586 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.186944 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: BEGIN
[0m18:35:27.187234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:27.187999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:27.188367 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.188702 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp"
  
    as (
      

select
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    sum(ods.delivery_target) as total_target,
    sum(ods.actual_deliveries) as total_actual_deliveries,   
    round(avg(ods.response_time_mins), 2) as avg_response_time_mins,
    round(avg(ods.delivery_time_mins), 2) as avg_delivery_time_mins,
    sum(ods.late_deliveries) as late_deliveries,
    round(avg(ods.csat_score),2) as avg_feedback_score,
    count(ods.ticket_id) as total_feedbacks
from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
left join "ae_exam_db"."intermediate"."model_int_driver_profile_active" dp on ods.driver_id = dp.driver_id
where ods.driver_id is not null
group by  
    ods.driver_id,
    dp.vehicle_type,
    dp.region,
    ods.csat_score,
    ods.ticket_id
    );
  
  
[0m18:35:27.250101 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m18:35:27.252343 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.252662 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance" rename to "model_mart_driver_performance__dbt_backup"
[0m18:35:27.253291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.255194 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.255467 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
alter table "ae_exam_db"."mart"."model_mart_driver_performance__dbt_tmp" rename to "model_mart_driver_performance"
[0m18:35:27.255980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.257011 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m18:35:27.257349 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.257867 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: COMMIT
[0m18:35:27.264959 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:35:27.266974 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_performance"
[0m18:35:27.267293 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_performance"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_performance__dbt_backup" cascade
[0m18:35:27.270491 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:27.271647 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_performance: Close
[0m18:35:27.272071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54810BF0>]}
[0m18:35:27.272526 [info ] [Thread-1 (]: 21 of 30 OK created sql table model mart.model_mart_driver_performance ......... [[32mOK[0m in 0.09s]
[0m18:35:27.273844 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_performance
[0m18:35:27.274358 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:35:27.274884 [info ] [Thread-1 (]: 22 of 30 START sql table model mart.model_mart_driver_zone_heatmap ............. [RUN]
[0m18:35:27.275727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_performance, now model.ae_exam_project.model_mart_driver_zone_heatmap)
[0m18:35:27.276039 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:35:27.278812 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.279721 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:35:27.281849 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.282630 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.282955 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: BEGIN
[0m18:35:27.283215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:27.283786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:27.284041 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.284316 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp"
  
    as (
      

with failed_requests_unavailable_driver as (
    select  
        delivery_zone,
        count(*) as total_cancel_or_failed_requests
    from "ae_exam_db"."staging"."model_stg_order_transactions" ot
    left join "ae_exam_db"."staging"."model_stg_drivers_master" dm 
      on ot.driver_id = dm.driver_id
    where ot.order_status in ('cancelled', 'failed')
      and (ot.driver_id is null or dm.active_status = 'inactive')
    group by delivery_zone
),

aggregates as (
    select
        ods.delivery_zone,
        count(ods.order_id) as total_requests,
        sum(ods.is_completed) as completed_requests,
        round(avg(ods.delivery_duration_mins), 2) as avg_delivery_time_mins,
        dsd.available_drivers,
        coalesce(rud.total_cancel_or_failed_requests, 0) as failed_requests
    from "ae_exam_db"."intermediate"."model_int_order_delivery_summary" ods
    left join (
        select region as delivery_zone, count(driver_id) as available_drivers
        from "ae_exam_db"."intermediate"."model_int_driver_profile_active"
        group by region
    ) dsd on ods.delivery_zone = dsd.delivery_zone
    left join failed_requests_unavailable_driver rud  
      on ods.delivery_zone = rud.delivery_zone
    group by 
        ods.delivery_zone,
        dsd.available_drivers,
        rud.total_cancel_or_failed_requests
)

select 
    delivery_zone,
    total_requests,
    completed_requests,
    failed_requests,
    avg_delivery_time_mins,
    available_drivers,
    case 
        when total_requests > 0 
        then round((completed_requests::numeric / total_requests) * 100, 2) 
        else 0 
    end as completion_rate,
    case 
        when available_drivers > 0 
        then round((total_requests::numeric / available_drivers) * 100, 2) 
        else 0 
    end as demand_supply_rate
from aggregates
    );
  
  
[0m18:35:27.339758 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m18:35:27.343043 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.343425 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap" rename to "model_mart_driver_zone_heatmap__dbt_backup"
[0m18:35:27.344225 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.346360 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.346640 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
alter table "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_tmp" rename to "model_mart_driver_zone_heatmap"
[0m18:35:27.347220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:27.348344 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m18:35:27.348622 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.348861 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: COMMIT
[0m18:35:27.352897 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:35:27.354526 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_driver_zone_heatmap"
[0m18:35:27.354803 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."mart"."model_mart_driver_zone_heatmap__dbt_backup" cascade
[0m18:35:27.357780 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:27.359411 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_driver_zone_heatmap: Close
[0m18:35:27.359880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A55069D30>]}
[0m18:35:30.783132 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m18:35:30.784501 [info ] [Thread-1 (]: 22 of 30 OK created sql table model mart.model_mart_driver_zone_heatmap ........ [[32mOK[0m in 0.08s]
[0m18:35:30.785763 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_driver_zone_heatmap
[0m18:35:30.786207 [debug] [Thread-1 (]: Began running node model.ae_exam_project.model_mart_complaint_summary
[0m18:35:30.786569 [info ] [Thread-1 (]: 23 of 30 START sql table model mart.model_mart_complaint_summary ............... [RUN]
[0m18:35:30.787355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_driver_zone_heatmap, now model.ae_exam_project.model_mart_complaint_summary)
[0m18:35:30.787678 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.model_mart_complaint_summary
[0m18:35:30.790010 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.model_mart_complaint_summary"
[0m18:35:30.791054 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.model_mart_complaint_summary
[0m18:35:30.793321 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.model_mart_complaint_summary"
[0m18:35:30.794199 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_complaint_summary"
[0m18:35:30.794522 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: BEGIN
[0m18:35:30.794761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.795369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.795608 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_complaint_summary"
[0m18:35:30.795846 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_complaint_summary"} */

  
    
    

    create  table
      "ae_exam_db"."mart"."model_mart_complaint_summary__dbt_tmp"
  
    as (
      

select
  issue_type,
  date_trunc('day',opened_datetime) as complaint_date,
  count(distinct ticket_id) as total_complaints,
  sum(compensation_amount) as total_compensation,
  avg(resolution_duration_mins) as avg_resolution_time,
  sum(is_resolved) as total_resolved,
from "ae_exam_db"."intermediate"."model_int_ticket_resolution_summary"
group by 1, 2
    );
  
  
[0m18:35:30.802850 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:35:30.805843 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_complaint_summary"
[0m18:35:30.806393 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_complaint_summary"} */
alter table "ae_exam_db"."mart"."model_mart_complaint_summary__dbt_tmp" rename to "model_mart_complaint_summary"
[0m18:35:30.808525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.810529 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: COMMIT
[0m18:35:30.811096 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_complaint_summary"
[0m18:35:30.811586 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: COMMIT
[0m18:35:30.816251 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:35:30.818170 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.model_mart_complaint_summary"
[0m18:35:30.818510 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.model_mart_complaint_summary"} */
drop table if exists "ae_exam_db"."mart"."model_mart_complaint_summary__dbt_backup" cascade
[0m18:35:30.819051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:30.820172 [debug] [Thread-1 (]: On model.ae_exam_project.model_mart_complaint_summary: Close
[0m18:35:30.820620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A551313D0>]}
[0m18:35:30.821128 [info ] [Thread-1 (]: 23 of 30 OK created sql table model mart.model_mart_complaint_summary .......... [[32mOK[0m in 0.03s]
[0m18:35:30.821990 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.model_mart_complaint_summary
[0m18:35:30.822325 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_campaign_effectiveness
[0m18:35:30.822672 [info ] [Thread-1 (]: 24 of 30 START sql table model report.report_campaign_effectiveness ............ [RUN]
[0m18:35:30.823675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.model_mart_complaint_summary, now model.ae_exam_project.report_campaign_effectiveness)
[0m18:35:30.824248 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_campaign_effectiveness
[0m18:35:30.828144 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.829866 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_campaign_effectiveness
[0m18:35:30.835356 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.836740 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.837261 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: BEGIN
[0m18:35:30.837583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.838275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.838539 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.838777 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_campaign_performance"
order by interaction_date asc
    );
  
  
[0m18:35:30.845064 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:35:30.848385 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.849035 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness" rename to "report_campaign_effectiveness__dbt_backup"
[0m18:35:30.850073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.853660 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.854248 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
alter table "ae_exam_db"."report"."report_campaign_effectiveness__dbt_tmp" rename to "report_campaign_effectiveness"
[0m18:35:30.887391 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m18:35:30.889678 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m18:35:30.891740 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.892408 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: COMMIT
[0m18:35:30.899205 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:35:30.902818 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_campaign_effectiveness"
[0m18:35:30.903434 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_campaign_effectiveness"} */
drop table if exists "ae_exam_db"."report"."report_campaign_effectiveness__dbt_backup" cascade
[0m18:35:30.907190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:30.909839 [debug] [Thread-1 (]: On model.ae_exam_project.report_campaign_effectiveness: Close
[0m18:35:30.910675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5278B470>]}
[0m18:35:30.911561 [info ] [Thread-1 (]: 24 of 30 OK created sql table model report.report_campaign_effectiveness ....... [[32mOK[0m in 0.09s]
[0m18:35:30.925807 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_campaign_effectiveness
[0m18:35:30.926434 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_customer _acquisition
[0m18:35:30.927216 [info ] [Thread-1 (]: 25 of 30 START sql table model report.report_customer _acquisition ............. [RUN]
[0m18:35:30.930436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_campaign_effectiveness, now model.ae_exam_project.report_customer _acquisition)
[0m18:35:30.931022 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_customer _acquisition
[0m18:35:30.933796 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.935052 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_customer _acquisition
[0m18:35:30.938128 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.940650 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.941198 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: BEGIN
[0m18:35:30.941589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.942247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.942615 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.942916 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_customer_acquisition"
order by acquisition_date asc
    );
  
  
[0m18:35:30.950644 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:35:30.961616 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.962333 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition" rename to "report_customer _acquisition__dbt_backup"
[0m18:35:30.963441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.966807 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.967469 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
alter table "ae_exam_db"."report"."report_customer _acquisition__dbt_tmp" rename to "report_customer _acquisition"
[0m18:35:30.968705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.970188 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m18:35:30.970526 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.970777 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: COMMIT
[0m18:35:30.976592 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:35:30.978958 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_customer _acquisition"
[0m18:35:30.979316 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_customer _acquisition"} */
drop table if exists "ae_exam_db"."report"."report_customer _acquisition__dbt_backup" cascade
[0m18:35:30.982416 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:30.983631 [debug] [Thread-1 (]: On model.ae_exam_project.report_customer _acquisition: Close
[0m18:35:30.984082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5278B470>]}
[0m18:35:30.984699 [info ] [Thread-1 (]: 25 of 30 OK created sql table model report.report_customer _acquisition ........ [[32mOK[0m in 0.05s]
[0m18:35:30.985729 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_customer _acquisition
[0m18:35:30.986048 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_retargeting_performance
[0m18:35:30.986541 [info ] [Thread-1 (]: 26 of 30 START sql table model report.report_retargeting_performance ........... [RUN]
[0m18:35:30.987084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_customer _acquisition, now model.ae_exam_project.report_retargeting_performance)
[0m18:35:30.987389 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_retargeting_performance
[0m18:35:30.989518 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_retargeting_performance"
[0m18:35:30.990884 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_retargeting_performance
[0m18:35:30.993226 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_retargeting_performance"
[0m18:35:30.994352 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:35:30.994713 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: BEGIN
[0m18:35:30.994994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.995507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:30.995802 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:35:30.996059 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_retargeting _performance"
order by campaign_id asc
    );
  
  
[0m18:35:30.997437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:30.999918 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:35:31.000232 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance" rename to "report_retargeting_performance__dbt_backup"
[0m18:35:31.001024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.003410 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:35:31.003821 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
alter table "ae_exam_db"."report"."report_retargeting_performance__dbt_tmp" rename to "report_retargeting_performance"
[0m18:35:31.004444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.005621 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m18:35:31.006030 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:35:31.006316 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: COMMIT
[0m18:35:31.010604 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:35:31.012576 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_retargeting_performance"
[0m18:35:31.013002 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_retargeting_performance"} */
drop table if exists "ae_exam_db"."report"."report_retargeting_performance__dbt_backup" cascade
[0m18:35:31.016136 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:31.017631 [debug] [Thread-1 (]: On model.ae_exam_project.report_retargeting_performance: Close
[0m18:35:31.018096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5506A090>]}
[0m18:35:31.018588 [info ] [Thread-1 (]: 26 of 30 OK created sql table model report.report_retargeting_performance ...... [[32mOK[0m in 0.03s]
[0m18:35:31.019673 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_retargeting_performance
[0m18:35:31.019997 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_incentive_impact
[0m18:35:31.020475 [info ] [Thread-1 (]: 27 of 30 START sql table model report.report_driver_incentive_impact ........... [RUN]
[0m18:35:31.021115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_retargeting_performance, now model.ae_exam_project.report_driver_incentive_impact)
[0m18:35:31.021409 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_incentive_impact
[0m18:35:31.024190 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.026001 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_incentive_impact
[0m18:35:31.028633 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.030426 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.030831 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: BEGIN
[0m18:35:31.031100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:31.031791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:31.032135 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.032406 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_incentive_impact"
--order by interaction_date asc
    );
  
  
[0m18:35:31.033793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:31.035916 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.036217 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
alter table "ae_exam_db"."report"."report_driver_incentive_impact" rename to "report_driver_incentive_impact__dbt_backup"
[0m18:35:31.036813 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.039253 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.039587 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
alter table "ae_exam_db"."report"."report_driver_incentive_impact__dbt_tmp" rename to "report_driver_incentive_impact"
[0m18:35:31.040484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.041791 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m18:35:31.042136 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.042410 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: COMMIT
[0m18:35:31.045871 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:31.048371 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_incentive_impact"
[0m18:35:31.048768 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_incentive_impact"} */
drop table if exists "ae_exam_db"."report"."report_driver_incentive_impact__dbt_backup" cascade
[0m18:35:31.051786 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:31.053009 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_incentive_impact: Close
[0m18:35:31.053495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5506A090>]}
[0m18:35:31.054013 [info ] [Thread-1 (]: 27 of 30 OK created sql table model report.report_driver_incentive_impact ...... [[32mOK[0m in 0.03s]
[0m18:35:31.054779 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_incentive_impact
[0m18:35:31.055134 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_perfornance
[0m18:35:31.055519 [info ] [Thread-1 (]: 28 of 30 START sql table model report.report_driver_perfornance ................ [RUN]
[0m18:35:31.056133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_incentive_impact, now model.ae_exam_project.report_driver_perfornance)
[0m18:35:31.056438 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_perfornance
[0m18:35:31.059349 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.060623 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_perfornance
[0m18:35:31.064832 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.066315 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.066690 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: BEGIN
[0m18:35:31.066949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:31.067596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:31.067893 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.068144 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_performance"
order by driver_id asc
    );
  
  
[0m18:35:31.072093 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:35:31.074643 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.075085 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance" rename to "report_driver_perfornance__dbt_backup"
[0m18:35:31.076016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.078748 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.079189 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
alter table "ae_exam_db"."report"."report_driver_perfornance__dbt_tmp" rename to "report_driver_perfornance"
[0m18:35:31.080644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:31.081828 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m18:35:31.082129 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.082368 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: COMMIT
[0m18:35:31.087609 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:35:31.089419 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_perfornance"
[0m18:35:31.089716 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_perfornance"} */
drop table if exists "ae_exam_db"."report"."report_driver_perfornance__dbt_backup" cascade
[0m18:35:31.093202 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:31.094703 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_perfornance: Close
[0m18:35:31.095377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54FA9970>]}
[0m18:35:31.095998 [info ] [Thread-1 (]: 28 of 30 OK created sql table model report.report_driver_perfornance ........... [[32mOK[0m in 0.04s]
[0m18:35:31.096910 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_perfornance
[0m18:35:31.097272 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_driver_zone_heatmap
[0m18:35:31.097638 [info ] [Thread-1 (]: 29 of 30 START sql table model report.report_driver_zone_heatmap ............... [RUN]
[0m18:35:31.098270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_perfornance, now model.ae_exam_project.report_driver_zone_heatmap)
[0m18:35:31.098544 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_driver_zone_heatmap
[0m18:35:31.100505 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.101632 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_driver_zone_heatmap
[0m18:35:31.104156 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.105226 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.105587 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: BEGIN
[0m18:35:31.105846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:31.106378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.106850 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.107231 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_driver_zone_heatmap"
order by delivery_zone asc
    );
  
  
[0m18:35:31.109039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:31.111803 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.112132 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap" rename to "report_driver_zone_heatmap__dbt_backup"
[0m18:35:31.112786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.114729 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.115003 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
alter table "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_tmp" rename to "report_driver_zone_heatmap"
[0m18:35:31.115521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.116694 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m18:35:31.116984 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.117240 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: COMMIT
[0m18:35:31.120652 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:31.122625 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_driver_zone_heatmap"
[0m18:35:31.122916 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_driver_zone_heatmap"} */
drop table if exists "ae_exam_db"."report"."report_driver_zone_heatmap__dbt_backup" cascade
[0m18:35:31.126331 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:31.127587 [debug] [Thread-1 (]: On model.ae_exam_project.report_driver_zone_heatmap: Close
[0m18:35:31.128107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54FA8710>]}
[0m18:35:31.128692 [info ] [Thread-1 (]: 29 of 30 OK created sql table model report.report_driver_zone_heatmap .......... [[32mOK[0m in 0.03s]
[0m18:35:31.129560 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_driver_zone_heatmap
[0m18:35:31.129997 [debug] [Thread-1 (]: Began running node model.ae_exam_project.report_complaint_summary
[0m18:35:31.130506 [info ] [Thread-1 (]: 30 of 30 START sql table model report.report_complaint_summary ................. [RUN]
[0m18:35:31.131229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ae_exam_project.report_driver_zone_heatmap, now model.ae_exam_project.report_complaint_summary)
[0m18:35:31.131548 [debug] [Thread-1 (]: Began compiling node model.ae_exam_project.report_complaint_summary
[0m18:35:31.133589 [debug] [Thread-1 (]: Writing injected SQL for node "model.ae_exam_project.report_complaint_summary"
[0m18:35:31.135132 [debug] [Thread-1 (]: Began executing node model.ae_exam_project.report_complaint_summary
[0m18:35:31.137401 [debug] [Thread-1 (]: Writing runtime sql for node "model.ae_exam_project.report_complaint_summary"
[0m18:35:31.138532 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_complaint_summary"
[0m18:35:31.138903 [debug] [Thread-1 (]: On model.ae_exam_project.report_complaint_summary: BEGIN
[0m18:35:31.139233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:31.139812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:31.140165 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_complaint_summary"
[0m18:35:31.140581 [debug] [Thread-1 (]: On model.ae_exam_project.report_complaint_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_complaint_summary"} */

  
    
    

    create  table
      "ae_exam_db"."report"."report_complaint_summary__dbt_tmp"
  
    as (
      

select *
from "ae_exam_db"."mart"."model_mart_complaint_summary"
order by complaint_date asc
    );
  
  
[0m18:35:31.142823 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:35:31.145797 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_complaint_summary"
[0m18:35:31.146267 [debug] [Thread-1 (]: On model.ae_exam_project.report_complaint_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_complaint_summary"} */
alter table "ae_exam_db"."report"."report_complaint_summary__dbt_tmp" rename to "report_complaint_summary"
[0m18:35:31.147269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:35:31.148466 [debug] [Thread-1 (]: On model.ae_exam_project.report_complaint_summary: COMMIT
[0m18:35:31.148762 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_complaint_summary"
[0m18:35:31.148998 [debug] [Thread-1 (]: On model.ae_exam_project.report_complaint_summary: COMMIT
[0m18:35:31.152275 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:35:31.153959 [debug] [Thread-1 (]: Using duckdb connection "model.ae_exam_project.report_complaint_summary"
[0m18:35:31.154243 [debug] [Thread-1 (]: On model.ae_exam_project.report_complaint_summary: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ae_exam_project", "target_name": "dev", "node_id": "model.ae_exam_project.report_complaint_summary"} */
drop table if exists "ae_exam_db"."report"."report_complaint_summary__dbt_backup" cascade
[0m18:35:31.154773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:35:31.155776 [debug] [Thread-1 (]: On model.ae_exam_project.report_complaint_summary: Close
[0m18:35:31.156169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27697d52-7847-45ac-8e7d-0ef2dca25b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A54FA99D0>]}
[0m18:35:31.157091 [info ] [Thread-1 (]: 30 of 30 OK created sql table model report.report_complaint_summary ............ [[32mOK[0m in 0.02s]
[0m18:35:31.158161 [debug] [Thread-1 (]: Finished running node model.ae_exam_project.report_complaint_summary
[0m18:35:31.159737 [debug] [MainThread]: Using duckdb connection "master"
[0m18:35:31.160054 [debug] [MainThread]: On master: BEGIN
[0m18:35:31.160274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:31.160760 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:35:31.161022 [debug] [MainThread]: On master: COMMIT
[0m18:35:31.161260 [debug] [MainThread]: Using duckdb connection "master"
[0m18:35:31.161476 [debug] [MainThread]: On master: COMMIT
[0m18:35:31.161953 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:35:31.162336 [debug] [MainThread]: On master: Close
[0m18:35:31.162757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:31.163014 [debug] [MainThread]: Connection 'create_ae_exam_db_report' was properly closed.
[0m18:35:31.163239 [debug] [MainThread]: Connection 'list_ae_exam_db_report' was properly closed.
[0m18:35:31.163448 [debug] [MainThread]: Connection 'model.ae_exam_project.report_complaint_summary' was properly closed.
[0m18:35:31.163880 [info ] [MainThread]: 
[0m18:35:31.164542 [info ] [MainThread]: Finished running 14 table models, 16 view models in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m18:35:31.168326 [debug] [MainThread]: Command end result
[0m18:35:31.190564 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\manifest.json
[0m18:35:31.193279 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\semantic_manifest.json
[0m18:35:31.200664 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Jiraporn(Aom)Chattur\Desktop\Jira\ae-exam-main\ae_exam_project\target\run_results.json
[0m18:35:31.201031 [info ] [MainThread]: 
[0m18:35:31.201683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:31.202248 [info ] [MainThread]: 
[0m18:35:31.202871 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 TOTAL=30
[0m18:35:31.203775 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:31.203669 after 6.45 seconds
[0m18:35:31.204088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A526C3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A51F034D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A53155130>]}
[0m18:35:31.204366 [debug] [MainThread]: Flushing usage events
[0m18:35:32.193697 [debug] [MainThread]: An error was encountered while trying to flush usage events
